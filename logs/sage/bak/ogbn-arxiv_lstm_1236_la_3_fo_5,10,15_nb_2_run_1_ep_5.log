main start at this time 1649563626.3969333
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
for loop block_dataloader item  time:  0.3596382141113281
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1864013671875 GB
    Memory Allocated: 0.09113454818725586  GigaBytes
Max Memory Allocated: 0.09113454818725586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1864013671875 GB
    Memory Allocated: 0.09113454818725586  GigaBytes
Max Memory Allocated: 0.09113454818725586  GigaBytes

torch.Size([160178, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1864013671875 GB
    Memory Allocated: 0.09113454818725586  GigaBytes
Max Memory Allocated: 0.09113454818725586  GigaBytes

m.shape torch.Size([15141, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6180419921875 GB
    Memory Allocated: 0.40758562088012695  GigaBytes
Max Memory Allocated: 0.40798044204711914  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6180419921875 GB
    Memory Allocated: 0.40758562088012695  GigaBytes
Max Memory Allocated: 0.40798044204711914  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.6375732421875 GB
    Memory Allocated: 0.422025203704834  GigaBytes
Max Memory Allocated: 0.422025203704834  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7664794921875 GB
    Memory Allocated: 0.538794994354248  GigaBytes
Max Memory Allocated: 0.5460147857666016  GigaBytes

torch.Size([1, 15141, 128])
m.shape torch.Size([15630, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.7821044921875 GB
    Memory Allocated: 0.5472002029418945  GigaBytes
Max Memory Allocated: 0.5475502014160156  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7821044921875 GB
    Memory Allocated: 0.5472002029418945  GigaBytes
Max Memory Allocated: 0.5475502014160156  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.8016357421875 GB
    Memory Allocated: 0.5621061325073242  GigaBytes
Max Memory Allocated: 0.5621061325073242  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0633544921875 GB
    Memory Allocated: 0.7856950759887695  GigaBytes
Max Memory Allocated: 0.8013200759887695  GigaBytes

torch.Size([1, 15630, 128])
m.shape torch.Size([13533, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0828857421875 GB
    Memory Allocated: 0.7977733612060547  GigaBytes
Max Memory Allocated: 0.8013200759887695  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0828857421875 GB
    Memory Allocated: 0.7977733612060547  GigaBytes
Max Memory Allocated: 0.8013200759887695  GigaBytes

----------------------------------------3
 Nvidia-smi: 3.0828857421875 GB
    Memory Allocated: 0.8114461898803711  GigaBytes
Max Memory Allocated: 0.8114461898803711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3875732421875 GB
    Memory Allocated: 1.0955519676208496  GigaBytes
Max Memory Allocated: 1.1150832176208496  GigaBytes

torch.Size([1, 13533, 128])
m.shape torch.Size([11449, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.4110107421875 GB
    Memory Allocated: 1.110936164855957  GigaBytes
Max Memory Allocated: 1.1150832176208496  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4110107421875 GB
    Memory Allocated: 1.110936164855957  GigaBytes
Max Memory Allocated: 1.1150832176208496  GigaBytes

----------------------------------------3
 Nvidia-smi: 3.4110107421875 GB
    Memory Allocated: 1.1221866607666016  GigaBytes
Max Memory Allocated: 1.1221866607666016  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7547607421875 GB
    Memory Allocated: 1.438826560974121  GigaBytes
Max Memory Allocated: 1.4606637954711914  GigaBytes

torch.Size([1, 11449, 128])
m.shape torch.Size([98400, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.9910888671875 GB
    Memory Allocated: 1.667971134185791  GigaBytes
Max Memory Allocated: 1.6745080947875977  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9910888671875 GB
    Memory Allocated: 1.667971134185791  GigaBytes
Max Memory Allocated: 1.6745080947875977  GigaBytes

----------------------------------------3
 Nvidia-smi: 4.0887451171875 GB
    Memory Allocated: 1.761812686920166  GigaBytes
Max Memory Allocated: 1.761812686920166  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 5.140108585357666  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

torch.Size([1, 98400, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.865007400512695  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.901760578155518  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.93851375579834  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.900611877441406  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

torch.Size([154153, 64])
input nodes number: 160178
output nodes number: 154153
edges number: 624796
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.939952850341797  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.976706027984619  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.985894680023193  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.985894680023193  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

torch.Size([154153, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7528076171875 GB
    Memory Allocated: 4.985894680023193  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

m.shape torch.Size([10589, 1, 64])
----------------------------------------1
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.191865921020508  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.191865921020508  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.197277069091797  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.237713813781738  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

torch.Size([1, 10589, 64])
m.shape torch.Size([11488, 2, 64])
----------------------------------------1
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.241030216217041  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.241030216217041  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.2465081214904785  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.328676700592041  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

torch.Size([1, 11488, 64])
m.shape torch.Size([10400, 3, 64])
----------------------------------------1
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.333609104156494  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.333609104156494  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.7547607421875 GB
    Memory Allocated: 5.338655471801758  GigaBytes
Max Memory Allocated: 5.3747124671936035  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7742919921875 GB
    Memory Allocated: 5.448512077331543  GigaBytes
Max Memory Allocated: 5.455950736999512  GigaBytes

torch.Size([1, 10400, 64])
m.shape torch.Size([9156, 4, 64])
----------------------------------------1
 Nvidia-smi: 7.7742919921875 GB
    Memory Allocated: 5.455037593841553  GigaBytes
Max Memory Allocated: 5.455950736999512  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7742919921875 GB
    Memory Allocated: 5.455037593841553  GigaBytes
Max Memory Allocated: 5.455950736999512  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.7742919921875 GB
    Memory Allocated: 5.4595842361450195  GigaBytes
Max Memory Allocated: 5.4595842361450195  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9305419921875 GB
    Memory Allocated: 5.586653709411621  GigaBytes
Max Memory Allocated: 5.595385551452637  GigaBytes

torch.Size([1, 9156, 64])
m.shape torch.Size([8005, 5, 64])
----------------------------------------1
 Nvidia-smi: 7.9324951171875 GB
    Memory Allocated: 5.5943121910095215  GigaBytes
Max Memory Allocated: 5.595385551452637  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9324951171875 GB
    Memory Allocated: 5.5943121910095215  GigaBytes
Max Memory Allocated: 5.595385551452637  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.9324951171875 GB
    Memory Allocated: 5.5981926918029785  GigaBytes
Max Memory Allocated: 5.5981926918029785  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0887451171875 GB
    Memory Allocated: 5.737817764282227  GigaBytes
Max Memory Allocated: 5.747360706329346  GigaBytes

torch.Size([1, 8005, 64])
m.shape torch.Size([6695, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.0887451171875 GB
    Memory Allocated: 5.745511531829834  GigaBytes
Max Memory Allocated: 5.747360706329346  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0887451171875 GB
    Memory Allocated: 5.745511531829834  GigaBytes
Max Memory Allocated: 5.747360706329346  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.0887451171875 GB
    Memory Allocated: 5.748712062835693  GigaBytes
Max Memory Allocated: 5.748712062835693  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2254638671875 GB
    Memory Allocated: 5.888390064239502  GigaBytes
Max Memory Allocated: 5.897967338562012  GigaBytes

torch.Size([1, 6695, 64])
m.shape torch.Size([5863, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.2254638671875 GB
    Memory Allocated: 5.896711349487305  GigaBytes
Max Memory Allocated: 5.897967338562012  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2254638671875 GB
    Memory Allocated: 5.896711349487305  GigaBytes
Max Memory Allocated: 5.897967338562012  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.2254638671875 GB
    Memory Allocated: 5.899587631225586  GigaBytes
Max Memory Allocated: 5.899587631225586  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3621826171875 GB
    Memory Allocated: 6.0419416427612305  GigaBytes
Max Memory Allocated: 6.051726818084717  GigaBytes

torch.Size([1, 5863, 64])
m.shape torch.Size([5226, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.3621826171875 GB
    Memory Allocated: 6.050451278686523  GigaBytes
Max Memory Allocated: 6.051726818084717  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3621826171875 GB
    Memory Allocated: 6.050451278686523  GigaBytes
Max Memory Allocated: 6.051726818084717  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.3621826171875 GB
    Memory Allocated: 6.053991317749023  GigaBytes
Max Memory Allocated: 6.053991317749023  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5301513671875 GB
    Memory Allocated: 6.20640754699707  GigaBytes
Max Memory Allocated: 6.216375350952148  GigaBytes

torch.Size([1, 5226, 64])
m.shape torch.Size([4583, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.5301513671875 GB
    Memory Allocated: 6.214798450469971  GigaBytes
Max Memory Allocated: 6.216375350952148  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5301513671875 GB
    Memory Allocated: 6.214798450469971  GigaBytes
Max Memory Allocated: 6.216375350952148  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.5301513671875 GB
    Memory Allocated: 6.2171149253845215  GigaBytes
Max Memory Allocated: 6.2171149253845215  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6395263671875 GB
    Memory Allocated: 6.369937419891357  GigaBytes
Max Memory Allocated: 6.379771709442139  GigaBytes

torch.Size([1, 4583, 64])
m.shape torch.Size([50093, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.7606201171875 GB
    Memory Allocated: 6.491456031799316  GigaBytes
Max Memory Allocated: 6.494213104248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7606201171875 GB
    Memory Allocated: 6.491456031799316  GigaBytes
Max Memory Allocated: 6.494213104248047  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.7879638671875 GB
    Memory Allocated: 6.515342712402344  GigaBytes
Max Memory Allocated: 6.515342712402344  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6746826171875 GB
    Memory Allocated: 8.211268424987793  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

torch.Size([1, 50093, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.032189846038818  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.061300277709961  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.090410709381104  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.06039047241211  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

torch.Size([122098, 64])
input nodes number: 154153
output nodes number: 122098
edges number: 806610
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.092074394226074  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.121184825897217  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.128708362579346  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.128708362579346  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

m.shape torch.Size([6774, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.209179401397705  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.209179401397705  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.212636470794678  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.239682674407959  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

torch.Size([1, 6774, 64])
m.shape torch.Size([5887, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.241611003875732  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.241611003875732  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.245068073272705  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.289929866790771  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

torch.Size([1, 5887, 64])
m.shape torch.Size([4636, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.292459964752197  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.292459964752197  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.29591703414917  GigaBytes
Max Memory Allocated: 8.330699443817139  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.350635528564453  GigaBytes
Max Memory Allocated: 8.354291439056396  GigaBytes

torch.Size([1, 4636, 64])
m.shape torch.Size([3677, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.352631092071533  GigaBytes
Max Memory Allocated: 8.354291439056396  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.352631092071533  GigaBytes
Max Memory Allocated: 8.354291439056396  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.6766357421875 GB
    Memory Allocated: 8.354384899139404  GigaBytes
Max Memory Allocated: 8.354384899139404  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6864013671875 GB
    Memory Allocated: 8.41052770614624  GigaBytes
Max Memory Allocated: 8.414034366607666  GigaBytes

torch.Size([1, 3677, 64])
m.shape torch.Size([3086, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.6864013671875 GB
    Memory Allocated: 8.413444995880127  GigaBytes
Max Memory Allocated: 8.414034366607666  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6864013671875 GB
    Memory Allocated: 8.413444995880127  GigaBytes
Max Memory Allocated: 8.414034366607666  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.6864013671875 GB
    Memory Allocated: 8.414916515350342  GigaBytes
Max Memory Allocated: 8.414916515350342  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7371826171875 GB
    Memory Allocated: 8.467891216278076  GigaBytes
Max Memory Allocated: 8.471570014953613  GigaBytes

torch.Size([1, 3086, 64])
m.shape torch.Size([2458, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7371826171875 GB
    Memory Allocated: 8.470781803131104  GigaBytes
Max Memory Allocated: 8.471570014953613  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7371826171875 GB
    Memory Allocated: 8.470781803131104  GigaBytes
Max Memory Allocated: 8.471570014953613  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7391357421875 GB
    Memory Allocated: 8.471953868865967  GigaBytes
Max Memory Allocated: 8.471953868865967  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7860107421875 GB
    Memory Allocated: 8.525372505187988  GigaBytes
Max Memory Allocated: 8.528888702392578  GigaBytes

torch.Size([1, 2458, 64])
m.shape torch.Size([2018, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7860107421875 GB
    Memory Allocated: 8.528259754180908  GigaBytes
Max Memory Allocated: 8.528888702392578  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7860107421875 GB
    Memory Allocated: 8.528259754180908  GigaBytes
Max Memory Allocated: 8.528888702392578  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7860107421875 GB
    Memory Allocated: 8.529222011566162  GigaBytes
Max Memory Allocated: 8.529222011566162  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8309326171875 GB
    Memory Allocated: 8.578388214111328  GigaBytes
Max Memory Allocated: 8.581756114959717  GigaBytes

torch.Size([1, 2018, 64])
m.shape torch.Size([1731, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.8309326171875 GB
    Memory Allocated: 8.58131217956543  GigaBytes
Max Memory Allocated: 8.581756114959717  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8309326171875 GB
    Memory Allocated: 8.58131217956543  GigaBytes
Max Memory Allocated: 8.581756114959717  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.8309326171875 GB
    Memory Allocated: 8.582138061523438  GigaBytes
Max Memory Allocated: 8.582138061523438  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8797607421875 GB
    Memory Allocated: 8.630331039428711  GigaBytes
Max Memory Allocated: 8.63363265991211  GigaBytes

torch.Size([1, 1731, 64])
m.shape torch.Size([1472, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.8797607421875 GB
    Memory Allocated: 8.633175373077393  GigaBytes
Max Memory Allocated: 8.63363265991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8797607421875 GB
    Memory Allocated: 8.633175373077393  GigaBytes
Max Memory Allocated: 8.63363265991211  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.8797607421875 GB
    Memory Allocated: 8.633877277374268  GigaBytes
Max Memory Allocated: 8.633877277374268  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9266357421875 GB
    Memory Allocated: 8.678799152374268  GigaBytes
Max Memory Allocated: 8.681957721710205  GigaBytes

torch.Size([1, 1472, 64])
m.shape torch.Size([1331, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.9266357421875 GB
    Memory Allocated: 8.681720733642578  GigaBytes
Max Memory Allocated: 8.681957721710205  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9266357421875 GB
    Memory Allocated: 8.681720733642578  GigaBytes
Max Memory Allocated: 8.681957721710205  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.9266357421875 GB
    Memory Allocated: 8.682355880737305  GigaBytes
Max Memory Allocated: 8.682355880737305  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9735107421875 GB
    Memory Allocated: 8.728156566619873  GigaBytes
Max Memory Allocated: 8.731329917907715  GigaBytes

torch.Size([1, 1331, 64])
m.shape torch.Size([1061, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.9735107421875 GB
    Memory Allocated: 8.730709075927734  GigaBytes
Max Memory Allocated: 8.731329917907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9735107421875 GB
    Memory Allocated: 8.730709075927734  GigaBytes
Max Memory Allocated: 8.731329917907715  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.9735107421875 GB
    Memory Allocated: 8.731215476989746  GigaBytes
Max Memory Allocated: 8.731329917907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9774169921875 GB
    Memory Allocated: 8.77199935913086  GigaBytes
Max Memory Allocated: 8.775557518005371  GigaBytes

torch.Size([1, 1061, 64])
m.shape torch.Size([960, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.9774169921875 GB
    Memory Allocated: 8.775390148162842  GigaBytes
Max Memory Allocated: 8.775557518005371  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9774169921875 GB
    Memory Allocated: 8.775390148162842  GigaBytes
Max Memory Allocated: 8.775557518005371  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.9774169921875 GB
    Memory Allocated: 8.775847911834717  GigaBytes
Max Memory Allocated: 8.775847911834717  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0399169921875 GB
    Memory Allocated: 8.814757823944092  GigaBytes
Max Memory Allocated: 8.817504405975342  GigaBytes

torch.Size([1, 960, 64])
m.shape torch.Size([834, 13, 64])
----------------------------------------1
 Nvidia-smi: 11.0399169921875 GB
    Memory Allocated: 8.817194938659668  GigaBytes
Max Memory Allocated: 8.817504405975342  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0399169921875 GB
    Memory Allocated: 8.817194938659668  GigaBytes
Max Memory Allocated: 8.817504405975342  GigaBytes

----------------------------------------3
 Nvidia-smi: 11.0399169921875 GB
    Memory Allocated: 8.81759262084961  GigaBytes
Max Memory Allocated: 8.81759262084961  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0789794921875 GB
    Memory Allocated: 8.854179382324219  GigaBytes
Max Memory Allocated: 8.856764316558838  GigaBytes

torch.Size([1, 834, 64])
m.shape torch.Size([692, 14, 64])
----------------------------------------1
 Nvidia-smi: 11.0789794921875 GB
    Memory Allocated: 8.85636281967163  GigaBytes
Max Memory Allocated: 8.856764316558838  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0789794921875 GB
    Memory Allocated: 8.85636281967163  GigaBytes
Max Memory Allocated: 8.856764316558838  GigaBytes

----------------------------------------3
 Nvidia-smi: 11.0789794921875 GB
    Memory Allocated: 8.856692790985107  GigaBytes
Max Memory Allocated: 8.856764316558838  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1180419921875 GB
    Memory Allocated: 8.889359951019287  GigaBytes
Max Memory Allocated: 8.891669750213623  GigaBytes

torch.Size([1, 692, 64])
m.shape torch.Size([8854, 15, 64])
----------------------------------------1
 Nvidia-smi: 11.1512451171875 GB
    Memory Allocated: 8.921849250793457  GigaBytes
Max Memory Allocated: 8.922344207763672  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1512451171875 GB
    Memory Allocated: 8.921849250793457  GigaBytes
Max Memory Allocated: 8.922344207763672  GigaBytes

----------------------------------------3
 Nvidia-smi: 11.1512451171875 GB
    Memory Allocated: 8.926071166992188  GigaBytes
Max Memory Allocated: 8.926071166992188  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6531982421875 GB
    Memory Allocated: 9.385844707489014  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 8854, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.6531982421875 GB
    Memory Allocated: 9.318414211273193  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.6531982421875 GB
    Memory Allocated: 9.32519006729126  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.6531982421875 GB
    Memory Allocated: 9.331965923309326  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.6531982421875 GB
    Memory Allocated: 9.324851036071777  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([45471, 40])
input nodes number: 122098
output nodes number: 45471
edges number: 308405
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.6551513671875 GB
    Memory Allocated: 9.332875728607178  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0540928840637207 |0.3499464988708496 |0.6583237648010254 |0.00015234947204589844 |0.08828234672546387 |0.008343696594238281 |
----------------------------------------------------------pseudo_mini_loss sum 4.939579486846924
for loop block_dataloader item  time:  1.809020757675171
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.09987592697143555  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.09987592697143555  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([160075, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.09987592697143555  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

m.shape torch.Size([15132, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.41632795333862305  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.41632795333862305  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.4307589530944824  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.5475115776062012  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 15132, 128])
m.shape torch.Size([15587, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.5559210777282715  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.5559210777282715  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.5707859992980957  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.793759822845459  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 15587, 128])
m.shape torch.Size([13531, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.8058586120605469  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.8058586120605469  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 0.8187713623046875  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 1.1048345565795898  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 13531, 128])
m.shape torch.Size([11454, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 1.1202292442321777  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 1.1202292442321777  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 1.1327080726623535  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 1.4533748626708984  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 11454, 128])
m.shape torch.Size([98516, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 1.6827936172485352  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 1.6827936172485352  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 1.7767457962036133  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.159024238586426  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 98516, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 4.884093761444092  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 4.920862674713135  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 4.957631587982178  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 4.919713497161865  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([154220, 64])
input nodes number: 160075
output nodes number: 154220
edges number: 625295
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 4.959152698516846  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 4.995921611785889  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.0051140785217285  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.0051140785217285  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([154220, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.0051140785217285  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

m.shape torch.Size([10478, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.212486267089844  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.212486267089844  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.218374252319336  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.258344650268555  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 10478, 64])
m.shape torch.Size([11531, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.26151704788208  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.26151704788208  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.2670159339904785  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.349493503570557  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 11531, 64])
m.shape torch.Size([10493, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.3544840812683105  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.3544840812683105  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.35983419418335  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.4714789390563965  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 10493, 64])
m.shape torch.Size([9083, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.478772163391113  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.478772163391113  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.483439922332764  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.61604118347168  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 9083, 64])
m.shape torch.Size([8073, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.623800277709961  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.623800277709961  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.627885818481445  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.768431186676025  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 8073, 64])
m.shape torch.Size([6781, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.77622652053833  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.77622652053833  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.7797956466674805  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.923258304595947  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 6781, 64])
m.shape torch.Size([5871, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.931155204772949  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.931155204772949  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 5.934195518493652  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.076362609863281  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 5871, 64])
m.shape torch.Size([5248, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.085136413574219  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.085136413574219  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.088075160980225  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.236405849456787  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 5248, 64])
m.shape torch.Size([4580, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.244950294494629  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.244950294494629  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.247298240661621  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.398421764373779  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 4580, 64])
m.shape torch.Size([50421, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.521795749664307  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.521795749664307  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 6.545838832855225  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.274413585662842  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 50421, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.095056533813477  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.124277114868164  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.153497695922852  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.123363971710205  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([122559, 64])
input nodes number: 154220
output nodes number: 122559
edges number: 810913
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.155047416687012  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.1842679977417  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.19177770614624  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.19177770614624  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

m.shape torch.Size([6654, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.272474765777588  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.272474765777588  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.276565551757812  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.30365514755249  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 6654, 64])
m.shape torch.Size([5819, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.305077075958252  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.305077075958252  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.307852268218994  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.35291051864624  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 5819, 64])
m.shape torch.Size([4641, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.355036735534668  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.355036735534668  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.357348442077637  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.40802001953125  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 4641, 64])
m.shape torch.Size([3643, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.410619258880615  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.410619258880615  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.412356853485107  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.465835571289062  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 3643, 64])
m.shape torch.Size([3136, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.468822002410889  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.468822002410889  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.470317363739014  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.525884628295898  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 3136, 64])
m.shape torch.Size([2410, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.528692245483398  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.528692245483398  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.529841423034668  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.579256057739258  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 2410, 64])
m.shape torch.Size([2027, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.582170486450195  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.582170486450195  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.583137512207031  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.63273000717163  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 2027, 64])
m.shape torch.Size([1741, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.635671138763428  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.635671138763428  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.636501789093018  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.683825969696045  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 1741, 64])
m.shape torch.Size([1504, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.686738967895508  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.686738967895508  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.687456130981445  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.734915256500244  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 1504, 64])
m.shape torch.Size([1268, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.737674713134766  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.737674713134766  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.738279342651367  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.781845092773438  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 1268, 64])
m.shape torch.Size([1142, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.784631729125977  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.784631729125977  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.785176277160645  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.827785968780518  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 1142, 64])
m.shape torch.Size([977, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.83039665222168  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.83039665222168  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.830862998962402  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.870468139648438  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 977, 64])
m.shape torch.Size([822, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.872862339019775  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.872862339019775  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.873254299163818  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.909314632415771  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 822, 64])
m.shape torch.Size([742, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.911673069000244  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.911673069000244  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2000732421875 GB
    Memory Allocated: 8.91202688217163  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 8.947054386138916  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

torch.Size([1, 742, 64])
m.shape torch.Size([8944, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 8.979880332946777  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 8.979880332946777  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 8.984663009643555  GigaBytes
Max Memory Allocated: 9.417509078979492  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 9.440335273742676  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 8944, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 9.373519897460938  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 9.380295753479004  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 9.38707160949707  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2020263671875 GB
    Memory Allocated: 9.379956722259521  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([45470, 40])
input nodes number: 122559
output nodes number: 45470
edges number: 310780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 9.381208896636963  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0426485538482666 |0.17857909202575684 |0.3986901044845581 |0.00039196014404296875 |0.08755087852478027 |0.005941152572631836 |
----------------------------------------------------------pseudo_mini_loss sum 3.8589489459991455
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  873283
Number of first layer input nodes during this epoch:  320253
for loop block_dataloader item  time:  0.2983863353729248
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.10051727294921875  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.10051727294921875  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([160267, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.10051727294921875  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

m.shape torch.Size([15087, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.41695642471313477  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.41695642471313477  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.43134450912475586  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.548011302947998  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 15087, 128])
m.shape torch.Size([15649, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.5564422607421875  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.5564422607421875  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.5713663101196289  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.79522705078125  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 15649, 128])
m.shape torch.Size([13540, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.8072962760925293  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.8072962760925293  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 0.8202519416809082  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 1.1064538955688477  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 13540, 128])
m.shape torch.Size([11475, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 1.1218843460083008  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 1.1218843460083008  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 1.1343040466308594  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 1.4553537368774414  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 11475, 128])
m.shape torch.Size([98593, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 1.684946060180664  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 1.684946060180664  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 1.7789716720581055  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.163893699645996  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 98593, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 4.8887481689453125  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 4.925546646118164  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 4.962345123291016  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 4.924396514892578  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([154344, 64])
input nodes number: 160267
output nodes number: 154344
edges number: 625870
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 4.963747978210449  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.000546455383301  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.009746074676514  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.009746074676514  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([154344, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.009746074676514  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

m.shape torch.Size([10548, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.2171149253845215  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.2171149253845215  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.22245979309082  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.262697219848633  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 10548, 64])
m.shape torch.Size([11640, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.266041278839111  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.266041278839111  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.271591663360596  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.354847431182861  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 11640, 64])
m.shape torch.Size([10507, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.36063289642334  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.36063289642334  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.365775108337402  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.4763288497924805  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 10507, 64])
m.shape torch.Size([9093, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.483605861663818  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.483605861663818  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.488332748413086  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.620172023773193  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 9093, 64])
m.shape torch.Size([8053, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.627066135406494  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.627066135406494  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.631006717681885  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.771008014678955  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 8053, 64])
m.shape torch.Size([6754, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.778720855712891  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.778720855712891  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.782351493835449  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.925508499145508  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 6754, 64])
m.shape torch.Size([5892, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.933398246765137  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.933398246765137  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 5.936434745788574  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.079018592834473  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 5892, 64])
m.shape torch.Size([5208, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.087711811065674  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.087711811065674  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.090515613555908  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.234951496124268  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 5208, 64])
m.shape torch.Size([4637, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.243811130523682  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.243811130523682  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.246763706207275  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.398014545440674  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 4637, 64])
m.shape torch.Size([50441, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.521518707275391  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.521518707275391  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 6.545571327209473  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.274270057678223  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 50441, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.095421314239502  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.124692916870117  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.153964519500732  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.123777866363525  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([122773, 64])
input nodes number: 154344
output nodes number: 122773
edges number: 811561
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.155367374420166  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.184638977050781  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.19214391708374  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.19214391708374  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

m.shape torch.Size([6655, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.272407531738281  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.272407531738281  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.276833057403564  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.303148746490479  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 6655, 64])
m.shape torch.Size([5883, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.3048095703125  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.3048095703125  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.307708263397217  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.35273790359497  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 5883, 64])
m.shape torch.Size([4734, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.354880809783936  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.354880809783936  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.357197284698486  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.409047603607178  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 4734, 64])
m.shape torch.Size([3631, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.411373138427734  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.411373138427734  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.413105010986328  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.466495037078857  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 3631, 64])
m.shape torch.Size([3132, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.46947956085205  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.46947956085205  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.470973014831543  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.524760723114014  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 3132, 64])
m.shape torch.Size([2401, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.527556419372559  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.527556419372559  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.528701782226562  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.578003883361816  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 2401, 64])
m.shape torch.Size([2044, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.580949306488037  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.580949306488037  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.581923961639404  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.63122034072876  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 2044, 64])
m.shape torch.Size([1728, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.634131908416748  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.634131908416748  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.634955883026123  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.683237075805664  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 1728, 64])
m.shape torch.Size([1449, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.686031818389893  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.686031818389893  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.686723232269287  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.73157787322998  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 1449, 64])
m.shape torch.Size([1310, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.734453201293945  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.734453201293945  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.735077857971191  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.781105995178223  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 1310, 64])
m.shape torch.Size([1064, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.783671379089355  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.783671379089355  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.784178733825684  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.825535774230957  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 1064, 64])
m.shape torch.Size([984, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.828185558319092  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.828185558319092  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.828654766082764  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.868537425994873  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 984, 64])
m.shape torch.Size([828, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.870949745178223  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.870949745178223  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.871344566345215  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.907668113708496  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 828, 64])
m.shape torch.Size([716, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.909935474395752  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.909935474395752  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.910276889801025  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.944077014923096  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 716, 64])
m.shape torch.Size([8912, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.976786136627197  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.976786136627197  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 8.981035709381104  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 9.43651533126831  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 8912, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 9.370102405548096  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 9.376878261566162  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 9.383654117584229  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 9.37653923034668  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([45471, 40])
input nodes number: 122773
output nodes number: 45471
edges number: 309466
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2039794921875 GB
    Memory Allocated: 9.377793312072754  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03151249885559082 |0.007287263870239258 |0.1379382610321045 |0.0006971359252929688 |0.08353543281555176 |0.010380983352661133 |
----------------------------------------------------------pseudo_mini_loss sum 3.1293299198150635
for loop block_dataloader item  time:  0.8282268047332764
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10045051574707031  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10045051574707031  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([160098, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10045051574707031  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

m.shape torch.Size([15152, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.41691160202026367  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.41691160202026367  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.43136167526245117  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5481524467468262  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 15152, 128])
m.shape torch.Size([15523, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5565524101257324  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5565524101257324  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5713562965393066  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.7934145927429199  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 15523, 128])
m.shape torch.Size([13584, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8055438995361328  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8055438995361328  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8190088272094727  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1068811416625977  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 13584, 128])
m.shape torch.Size([11469, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1215620040893555  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1215620040893555  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1341018676757812  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.4553003311157227  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 11469, 128])
m.shape torch.Size([98468, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6845974922180176  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6845974922180176  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.7785038948059082  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.159134387969971  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 98468, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.88498067855835  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.921743869781494  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.958507061004639  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.920594692230225  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([154196, 64])
input nodes number: 160098
output nodes number: 154196
edges number: 625166
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.95994234085083  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.996705532073975  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.00589656829834  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.00589656829834  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([154196, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.00589656829834  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

m.shape torch.Size([10589, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.212826728820801  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.212826728820801  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.218777656555176  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.259172439575195  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 10589, 64])
m.shape torch.Size([11520, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.262312412261963  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.262312412261963  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.267805576324463  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.350203037261963  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 11520, 64])
m.shape torch.Size([10435, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.355929851531982  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.355929851531982  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.361300945281982  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.471987724304199  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 10435, 64])
m.shape torch.Size([9107, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.479351043701172  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.479351043701172  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.484029769897461  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.616487503051758  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 9107, 64])
m.shape torch.Size([8021, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.624176979064941  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.624176979064941  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.628109931945801  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.768362045288086  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 8021, 64])
m.shape torch.Size([6734, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.775976657867432  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.775976657867432  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.779257297515869  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.9194111824035645  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 6734, 64])
m.shape torch.Size([5897, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.927920341491699  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.927920341491699  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.930788993835449  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.073244094848633  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 5897, 64])
m.shape torch.Size([5257, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.082022666931152  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.082022666931152  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.084879398345947  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.2363176345825195  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 5257, 64])
m.shape torch.Size([4583, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.244584560394287  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.244584560394287  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.2483344078063965  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.3988776206970215  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 4583, 64])
m.shape torch.Size([50442, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.522469997406006  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.522469997406006  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.546522617340088  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.275222301483154  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 50442, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.095955848693848  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.125182628631592  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.154409408569336  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.124269008636475  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([122585, 64])
input nodes number: 154196
output nodes number: 122585
edges number: 810873
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.155972480773926  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.18519926071167  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.192704200744629  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.192704200744629  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

m.shape torch.Size([6773, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.273385524749756  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.273385524749756  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.277469635009766  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.305090427398682  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 6773, 64])
m.shape torch.Size([5823, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.306832313537598  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.306832313537598  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.309609413146973  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.354639053344727  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 5823, 64])
m.shape torch.Size([4543, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.356765270233154  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.356765270233154  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.359307765960693  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.408415794372559  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 4543, 64])
m.shape torch.Size([3689, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.411674976348877  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.411674976348877  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.413434505462646  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.468498706817627  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 3689, 64])
m.shape torch.Size([3090, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.471417903900146  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.471417903900146  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.472891330718994  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.527929306030273  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 3090, 64])
m.shape torch.Size([2467, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.530832290649414  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.530832290649414  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.53200912475586  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58400297164917  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 2467, 64])
m.shape torch.Size([2001, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.586858749389648  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.586858749389648  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.587813377380371  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.63650131225586  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 2001, 64])
m.shape torch.Size([1744, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.640392780303955  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.640392780303955  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.641224384307861  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.688812732696533  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 1744, 64])
m.shape torch.Size([1527, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.691776275634766  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.691776275634766  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.6925048828125  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.739738464355469  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 1527, 64])
m.shape torch.Size([1289, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.742543697357178  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.742543697357178  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.74315881729126  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.787615776062012  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 1289, 64])
m.shape torch.Size([1139, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.790389060974121  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.790389060974121  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.790932655334473  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.83392858505249  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 1139, 64])
m.shape torch.Size([953, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.836468696594238  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.836468696594238  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.836923599243164  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.875555992126465  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 953, 64])
m.shape torch.Size([828, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.877975463867188  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.877975463867188  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.87837028503418  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.914693832397461  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 828, 64])
m.shape torch.Size([718, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.91696834564209  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.91696834564209  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.91731071472168  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.951205253601074  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

torch.Size([1, 718, 64])
m.shape torch.Size([8886, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.983818531036377  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.983818531036377  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.98805570602417  GigaBytes
Max Memory Allocated: 9.472321510314941  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.442791938781738  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 8886, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.37624979019165  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.383025646209717  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.389801502227783  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.382686614990234  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([45470, 40])
input nodes number: 122585
output nodes number: 45470
edges number: 309719
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.383939266204834  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03145623207092285 |0.007441520690917969 |0.13882958889007568 |0.0007143020629882812 |0.06625914573669434 |0.009938955307006836 |
----------------------------------------------------------pseudo_mini_loss sum 2.7820444107055664
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  874263
Number of first layer input nodes during this epoch:  320365
block dataloader generation time/epoch 7.152557373046875e-07
for loop block_dataloader item  time:  0.3027503490447998
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10050678253173828  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10050678253173828  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([160305, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10050678253173828  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

m.shape torch.Size([15175, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4169783592224121  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4169783592224121  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.43145036697387695  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5482850074768066  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 15175, 128])
m.shape torch.Size([15591, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5566740036010742  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5566740036010742  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5715427398681641  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.7945737838745117  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 15591, 128])
m.shape torch.Size([13582, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8066706657409668  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8066706657409668  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8201332092285156  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.10797119140625  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 13582, 128])
m.shape torch.Size([11465, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1226434707641602  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1226434707641602  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1351184844970703  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.4608983993530273  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 11465, 128])
m.shape torch.Size([98423, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6891212463378906  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6891212463378906  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.782984733581543  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.162070274353027  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 98423, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.886972427368164  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.923745155334473  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.960517883300781  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.922595977783203  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([154236, 64])
input nodes number: 160305
output nodes number: 154236
edges number: 625078
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.961956977844238  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.998729705810547  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.007923126220703  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.007923126220703  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([154236, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.007923126220703  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

m.shape torch.Size([10543, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.215230464935303  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.215230464935303  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.2202582359313965  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.260477542877197  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 10543, 64])
m.shape torch.Size([11532, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.26363468170166  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.26363468170166  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.269529342651367  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.352400302886963  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 11532, 64])
m.shape torch.Size([10471, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.357374668121338  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.357374668121338  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.362562656402588  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.47405481338501  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 10471, 64])
m.shape torch.Size([9118, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.481375217437744  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.481375217437744  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.486048698425293  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.618937969207764  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 9118, 64])
m.shape torch.Size([8053, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.626664638519287  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.626664638519287  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.630666255950928  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.771301746368408  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 8053, 64])
m.shape torch.Size([6773, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.7790422439575195  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.7790422439575195  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.782437801361084  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.923637866973877  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 6773, 64])
m.shape torch.Size([5880, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.932032108306885  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.932032108306885  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.934908390045166  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.076782703399658  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 5880, 64])
m.shape torch.Size([5248, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.085535526275635  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.085535526275635  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.088374614715576  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.239843368530273  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 5248, 64])
m.shape torch.Size([4604, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.248135089874268  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.248135089874268  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.251134872436523  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.402398109436035  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 4604, 64])
m.shape torch.Size([50348, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.525510787963867  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.525510787963867  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.549518585205078  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.27763557434082  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 50348, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.096933364868164  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.126156330108643  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.155379295349121  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.125242710113525  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([122570, 64])
input nodes number: 154236
output nodes number: 122570
edges number: 810455
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.156949996948242  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.18617296218872  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.193700313568115  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.193700313568115  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

m.shape torch.Size([6698, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.274648666381836  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.274648666381836  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.278759479522705  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.304664611816406  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 6698, 64])
m.shape torch.Size([5882, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.306349277496338  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.306349277496338  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.309154033660889  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.35417890548706  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 5882, 64])
m.shape torch.Size([4585, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.356534957885742  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.356534957885742  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.35878610610962  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.40964412689209  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 4585, 64])
m.shape torch.Size([3556, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.41282844543457  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.41282844543457  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.41452407836914  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.46816635131836  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 3556, 64])
m.shape torch.Size([3116, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.471149444580078  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.471149444580078  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.472635269165039  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.528247833251953  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 3116, 64])
m.shape torch.Size([2441, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.531105995178223  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.531105995178223  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.532270431518555  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.584285736083984  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 2441, 64])
m.shape torch.Size([2075, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58727502822876  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58727502822876  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58826494216919  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.638081073760986  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 2075, 64])
m.shape torch.Size([1757, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.641042232513428  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.641042232513428  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.641880512237549  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.689876556396484  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 1757, 64])
m.shape torch.Size([1502, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.692781448364258  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.692781448364258  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.693497657775879  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.740283489227295  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 1502, 64])
m.shape torch.Size([1289, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.74309492111206  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.74309492111206  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.743710041046143  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.787861824035645  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 1289, 64])
m.shape torch.Size([1144, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.790648460388184  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.790648460388184  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.791193962097168  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.833942890167236  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 1144, 64])
m.shape torch.Size([933, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.83642292022705  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.83642292022705  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.836868286132812  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.874690055847168  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 933, 64])
m.shape torch.Size([834, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.8771333694458  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.8771333694458  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.877531051635742  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.914117813110352  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 834, 64])
m.shape torch.Size([707, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.91635274887085  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.91635274887085  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.916690349578857  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.950072765350342  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

torch.Size([1, 707, 64])
m.shape torch.Size([8952, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.982938289642334  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.982938289642334  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.987206935882568  GigaBytes
Max Memory Allocated: 9.474570751190186  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.443498134613037  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 8952, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.376359462738037  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.383135318756104  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.38991117477417  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.382796287536621  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([45471, 40])
input nodes number: 122570
output nodes number: 45471
edges number: 310456
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.38404893875122  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03163409233093262 |0.009951353073120117 |0.14215850830078125 |0.0007081031799316406 |0.04800534248352051 |0.00982522964477539 |
----------------------------------------------------------pseudo_mini_loss sum 2.5632448196411133
for loop block_dataloader item  time:  0.9354081153869629
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10094118118286133  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10094118118286133  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([160301, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10094118118286133  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([15140, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4179959297180176  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4179959297180176  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4324345588684082  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.549128532409668  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 15140, 128])
m.shape torch.Size([15646, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5575342178344727  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5575342178344727  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5724554061889648  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.7962732315063477  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 15646, 128])
m.shape torch.Size([13579, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8083438873291016  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8083438873291016  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8220157623291016  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.10980224609375  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 13579, 128])
m.shape torch.Size([11481, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.12522554397583  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.12522554397583  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.137648105621338  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.4588565826416016  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 11481, 128])
m.shape torch.Size([98547, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6883363723754883  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6883363723754883  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.782318115234375  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.165660858154297  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 98547, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.890681743621826  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.927492141723633  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.9643025398254395  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.926341533660889  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([154393, 64])
input nodes number: 160301
output nodes number: 154393
edges number: 625828
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.9657111167907715  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.002521514892578  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.011724472045898  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.011724472045898  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([154393, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.011724472045898  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([10639, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.218586444854736  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.218586444854736  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.224140644073486  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.264726161956787  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 10639, 64])
m.shape torch.Size([11545, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.267866611480713  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.267866611480713  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.273712635040283  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.356290340423584  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 11545, 64])
m.shape torch.Size([10453, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.362029075622559  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.362029075622559  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.367226600646973  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.477900505065918  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 10453, 64])
m.shape torch.Size([9053, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.485240459442139  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.485240459442139  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.48985481262207  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.622456073760986  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 9053, 64])
m.shape torch.Size([8055, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.630200386047363  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.630200386047363  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.634326934814453  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.77455997467041  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 8055, 64])
m.shape torch.Size([6702, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.782200336456299  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.782200336456299  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.785874843597412  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.929315090179443  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 6702, 64])
m.shape torch.Size([5915, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.937248706817627  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.937248706817627  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.940118312835693  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.0820393562316895  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5915, 64])
m.shape torch.Size([5225, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.090827465057373  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.090827465057373  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.093642711639404  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.240098476409912  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5225, 64])
m.shape torch.Size([4585, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.2487053871154785  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.2487053871154785  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.250975608825684  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.402210712432861  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 4585, 64])
m.shape torch.Size([50372, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.525137901306152  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.525137901306152  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.54915714263916  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.277422904968262  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 50372, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.09668779373169  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.125904560089111  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.155121326446533  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.124991416931152  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([122544, 64])
input nodes number: 154393
output nodes number: 122544
edges number: 809977
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.156611919403076  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.185828685760498  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.193350315093994  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.193350315093994  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([6730, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.27393913269043  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.27393913269043  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.277148246765137  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.302821159362793  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 6730, 64])
m.shape torch.Size([5824, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.304389953613281  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.304389953613281  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.307322978973389  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.352452754974365  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5824, 64])
m.shape torch.Size([4692, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.354142665863037  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.354142665863037  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.356849193572998  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.409348011016846  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 4692, 64])
m.shape torch.Size([3764, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.411518573760986  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.411518573760986  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.413313388824463  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.467632293701172  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 3764, 64])
m.shape torch.Size([3106, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.470553398132324  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.470553398132324  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.472034454345703  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.525776863098145  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 3106, 64])
m.shape torch.Size([2427, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.528616905212402  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.528616905212402  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.52977466583252  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.579541206359863  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 2427, 64])
m.shape torch.Size([1970, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.582353115081787  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.582353115081787  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.583292484283447  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.63144588470459  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1970, 64])
m.shape torch.Size([1715, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.634349822998047  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.634349822998047  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.635168075561523  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.682596206665039  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1715, 64])
m.shape torch.Size([1474, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.685449123382568  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.685449123382568  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.68615198135376  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.732149124145508  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1474, 64])
m.shape torch.Size([1310, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.735018730163574  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.735018730163574  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.73564338684082  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.780801773071289  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1310, 64])
m.shape torch.Size([1059, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.78335428237915  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.78335428237915  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.783859729766846  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.824132442474365  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1059, 64])
m.shape torch.Size([1004, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.826842308044434  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.826842308044434  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.82732105255127  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.868014335632324  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1004, 64])
m.shape torch.Size([822, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.870402336120605  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.870402336120605  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.870794296264648  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.906854629516602  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 822, 64])
m.shape torch.Size([727, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.909161567687988  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.909161567687988  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.90950870513916  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.943835258483887  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 727, 64])
m.shape torch.Size([8846, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.976752758026123  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.976752758026123  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.980970859527588  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.434454917907715  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 8846, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.36814260482788  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.374918460845947  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.381694316864014  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.374579429626465  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([45470, 40])
input nodes number: 122544
output nodes number: 45470
edges number: 308729
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.375831604003906  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03396403789520264 |0.009454727172851562 |0.13990676403045654 |0.0007123947143554688 |0.048343658447265625 |0.010005950927734375 |
----------------------------------------------------------pseudo_mini_loss sum 2.4305379390716553
Total (block generation + training)time/epoch 1.2383785247802734
Training time/epoch 1.2382521629333496
Training time without block to device /epoch 1.2193427085876465
Training time without total dataloading part /epoch 0.38793158531188965
load block tensor time/epoch 0.06792807579040527
block to device time/epoch 0.018909454345703125
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  874349
Number of first layer input nodes during this epoch:  320606
block dataloader generation time/epoch 5.960464477539062e-07
for loop block_dataloader item  time:  0.24436020851135254
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10064125061035156  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10064125061035156  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([160178, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10064125061035156  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([15166, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.41718196868896484  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.41718196868896484  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.43164539337158203  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5484628677368164  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 15166, 128])
m.shape torch.Size([15605, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5568561553955078  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5568561553955078  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5717382431030273  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.7949695587158203  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 15605, 128])
m.shape torch.Size([13516, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8070597648620605  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8070597648620605  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8204913139343262  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.10719633102417  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 13516, 128])
m.shape torch.Size([11498, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1219000816345215  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1219000816345215  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.134361743927002  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.4608850479125977  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 11498, 128])
m.shape torch.Size([98440, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6891441345214844  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6891441345214844  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.7830238342285156  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.162693023681641  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 98440, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.8876471519470215  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.924417495727539  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.961187839508057  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.9232683181762695  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([154225, 64])
input nodes number: 160178
output nodes number: 154225
edges number: 625116
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.962674617767334  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.999444961547852  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.00863790512085  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.00863790512085  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([154225, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.00863790512085  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([10664, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.21562385559082  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.21562385559082  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.220708847045898  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.262348175048828  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 10664, 64])
m.shape torch.Size([11527, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.266022205352783  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.266022205352783  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.271519184112549  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.353968143463135  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 11527, 64])
m.shape torch.Size([10359, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.359696388244629  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.359696388244629  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.365053176879883  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.474769592285156  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 10359, 64])
m.shape torch.Size([9077, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.481226921081543  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.481226921081543  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.485660076141357  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.61201286315918  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 9077, 64])
m.shape torch.Size([8011, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.619697093963623  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.619697093963623  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.6240034103393555  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.764110565185547  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 8011, 64])
m.shape torch.Size([6748, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.771724224090576  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.771724224090576  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.7750468254089355  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.915721416473389  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 6748, 64])
m.shape torch.Size([5863, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.924118995666504  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.924118995666504  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.927090644836426  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.068634033203125  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5863, 64])
m.shape torch.Size([5248, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.077449798583984  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.077449798583984  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.0805206298828125  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.231858253479004  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5248, 64])
m.shape torch.Size([4617, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.240187168121338  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.240187168121338  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.243963718414307  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.395744800567627  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 4617, 64])
m.shape torch.Size([50191, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.517683506011963  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.517683506011963  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.541616916656494  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.269728183746338  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 50191, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.09038782119751  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.119547843933105  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.148707866668701  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.118636131286621  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([122305, 64])
input nodes number: 154225
output nodes number: 122305
edges number: 808134
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.150137901306152  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.179297924041748  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.186862468719482  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.186862468719482  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([6834, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.266926288604736  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.266926288604736  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.270724773406982  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.298548221588135  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 6834, 64])
m.shape torch.Size([5907, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.300166130065918  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.300166130065918  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.302983283996582  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.348370552062988  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5907, 64])
m.shape torch.Size([4570, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.349984645843506  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.349984645843506  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.352452278137207  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.402071952819824  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 4570, 64])
m.shape torch.Size([3625, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.405133724212646  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.405133724212646  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.406862735748291  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.460371494293213  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 3625, 64])
m.shape torch.Size([3135, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.463361263275146  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.463361263275146  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.464856624603271  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.521252155303955  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 3135, 64])
m.shape torch.Size([2482, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.524166107177734  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.524166107177734  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.525349617004395  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.57736873626709  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 2482, 64])
m.shape torch.Size([2028, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.580267429351807  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.580267429351807  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.581234455108643  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.630098819732666  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 2028, 64])
m.shape torch.Size([1734, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.633026123046875  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.633026123046875  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.6338529586792  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.681453704833984  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1734, 64])
m.shape torch.Size([1491, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.684340000152588  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.684340000152588  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.685051441192627  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.730557918548584  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1491, 64])
m.shape torch.Size([1304, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.733408451080322  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.733408451080322  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.73403024673462  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.779674053192139  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1304, 64])
m.shape torch.Size([1091, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.78231430053711  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.78231430053711  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.782835006713867  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.825006484985352  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1091, 64])
m.shape torch.Size([923, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.827469825744629  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.827469825744629  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.827910423278809  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.865326881408691  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 923, 64])
m.shape torch.Size([845, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.867807865142822  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.867807865142822  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.868211269378662  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.905287265777588  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 845, 64])
m.shape torch.Size([717, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.907553672790527  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.907553672790527  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.907896041870117  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.941750526428223  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 717, 64])
m.shape torch.Size([8785, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.973979473114014  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.973979473114014  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.978168964385986  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.428733348846436  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 8785, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.362704277038574  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.369649410247803  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.37642526626587  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.369141101837158  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([45471, 40])
input nodes number: 122305
output nodes number: 45471
edges number: 307827
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.370561122894287  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031294822692871094 |0.007483243942260742 |0.13755488395690918 |0.0007245540618896484 |0.04687905311584473 |0.009968280792236328 |
----------------------------------------------------------pseudo_mini_loss sum 2.342012882232666
for loop block_dataloader item  time:  0.8271651268005371
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10011863708496094  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10011863708496094  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([160165, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10011863708496094  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([15017, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4165201187133789  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4165201187133789  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.43084144592285156  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5473747253417969  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 15017, 128])
m.shape torch.Size([15566, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5558390617370605  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5558390617370605  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5706839561462402  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.7933573722839355  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 15566, 128])
m.shape torch.Size([13586, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8054661750793457  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8054661750793457  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.818488597869873  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1050963401794434  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 13586, 128])
m.shape torch.Size([11470, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.120495319366455  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.120495319366455  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1329941749572754  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.454115390777588  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 11470, 128])
m.shape torch.Size([98577, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6836719512939453  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6836719512939453  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.7776823043823242  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.162055015563965  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 98577, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.887001037597656  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.923768997192383  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.960536956787109  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.922619819641113  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([154216, 64])
input nodes number: 160165
output nodes number: 154216
edges number: 625672
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.961968421936035  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.998736381530762  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.007928371429443  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.007928371429443  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([154216, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.007928371429443  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([10510, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.216027736663818  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.216027736663818  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.221928596496582  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.262021064758301  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 10510, 64])
m.shape torch.Size([11489, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.265165328979492  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.265165328979492  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.270644187927246  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.352821350097656  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 11489, 64])
m.shape torch.Size([10531, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.357850074768066  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.357850074768066  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.3632731437683105  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.475414276123047  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 10531, 64])
m.shape torch.Size([9110, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.482663154602051  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.482663154602051  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.487346172332764  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.619813919067383  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 9110, 64])
m.shape torch.Size([8073, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.627566814422607  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.627566814422607  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.631559371948242  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.772238731384277  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 8073, 64])
m.shape torch.Size([6820, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.780091762542725  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.780091762542725  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.783596992492676  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.926278114318848  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 6820, 64])
m.shape torch.Size([5957, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.934905052185059  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.934905052185059  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.937766075134277  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.080793380737305  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5957, 64])
m.shape torch.Size([5244, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.0896759033203125  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.0896759033203125  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.092465400695801  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.239935874938965  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5244, 64])
m.shape torch.Size([4656, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.248678684234619  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.248678684234619  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.250956058502197  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.401226997375488  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 4656, 64])
m.shape torch.Size([50566, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.525343894958496  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.525343894958496  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.549455642700195  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.278923988342285  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 50566, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.098500728607178  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.12781572341919  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.157130718231201  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.126899242401123  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([122956, 64])
input nodes number: 154216
output nodes number: 122956
edges number: 814021
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.15856409072876  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.187879085540771  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.195332050323486  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.195332050323486  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

m.shape torch.Size([6594, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.276679992675781  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.276679992675781  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.281656265258789  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.308642387390137  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 6594, 64])
m.shape torch.Size([5799, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.310242176055908  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.310242176055908  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.313007831573486  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.357860088348389  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 5799, 64])
m.shape torch.Size([4707, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.35990858078003  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.35990858078003  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.362218379974365  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.414612770080566  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 4707, 64])
m.shape torch.Size([3695, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.4169921875  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.4169921875  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.418754577636719  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.473209857940674  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 3695, 64])
m.shape torch.Size([3087, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.476124286651611  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.476124286651611  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.477596759796143  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.531070232391357  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 3087, 64])
m.shape torch.Size([2386, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.533854007720947  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.533854007720947  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.53499174118042  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.584104061126709  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 2386, 64])
m.shape torch.Size([2017, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58700704574585  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58700704574585  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.587969303131104  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.63635778427124  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 2017, 64])
m.shape torch.Size([1738, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.63929557800293  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.63929557800293  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.640124320983887  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.68798542022705  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1738, 64])
m.shape torch.Size([1485, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.690857410430908  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.690857410430908  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.691565990447998  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.737128257751465  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1485, 64])
m.shape torch.Size([1295, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.7399582862854  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.7399582862854  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.740576267242432  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.785036087036133  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1295, 64])
m.shape torch.Size([1112, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.788294792175293  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.788294792175293  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.788825035095215  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.830741882324219  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1112, 64])
m.shape torch.Size([1014, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.833468914031982  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.833468914031982  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.8339524269104  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.875051021575928  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 1014, 64])
m.shape torch.Size([811, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.87740182876587  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.87740182876587  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.87778902053833  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.913373470306396  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 811, 64])
m.shape torch.Size([717, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.915647983551025  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.915647983551025  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.915990352630615  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.94984483718872  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

torch.Size([1, 717, 64])
m.shape torch.Size([9013, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.984267234802246  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.984267234802246  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.988565444946289  GigaBytes
Max Memory Allocated: 9.475512981414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.446659088134766  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 9013, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.379693984985352  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.386469841003418  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.393245697021484  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.386130809783936  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([45470, 40])
input nodes number: 122956
output nodes number: 45470
edges number: 311358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.387217044830322  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031030654907226562 |0.007615804672241211 |0.1377624273300171 |0.0007464885711669922 |0.06442224979400635 |0.006644725799560547 |
----------------------------------------------------------pseudo_mini_loss sum 2.2201950550079346
Total (block generation + training)time/epoch 1.1798985004425049
Training time/epoch 1.1213529109954834
Training time without block to device /epoch 1.106121301651001
Training time without total dataloading part /epoch 0.4125070571899414
load block tensor time/epoch 0.062061309814453125
block to device time/epoch 0.015231609344482422
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  874045
Number of first layer input nodes during this epoch:  320343
block dataloader generation time/epoch 5.563100179036459e-07
for loop block_dataloader item  time:  0.23782038688659668
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10051202774047852  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10051202774047852  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([160332, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10051202774047852  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

m.shape torch.Size([15199, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4170055389404297  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4170055389404297  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.4315004348754883  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5483808517456055  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 15199, 128])
m.shape torch.Size([15605, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5567584037780762  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5567584037780762  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5716404914855957  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.7948718070983887  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 15605, 128])
m.shape torch.Size([13600, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8069620132446289  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8069620132446289  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.820439338684082  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.108586311340332  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 13600, 128])
m.shape torch.Size([11468, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1232728958129883  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1232728958129883  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1357345581054688  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.4614925384521484  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 11468, 128])
m.shape torch.Size([98510, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.689934253692627  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.689934253692627  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.7838807106018066  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.165953159332275  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 98510, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.8907880783081055  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.927595615386963  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.96440315246582  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.926445007324219  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([154382, 64])
input nodes number: 160332
output nodes number: 154382
edges number: 625631
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.965807914733887  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.002615451812744  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.011817455291748  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.011817455291748  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([154382, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.011817455291748  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

m.shape torch.Size([10598, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.21908712387085  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.21908712387085  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.224140644073486  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.26456880569458  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 10598, 64])
m.shape torch.Size([11608, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.267750263214111  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.267750263214111  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.273601055145264  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.357120037078857  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 11608, 64])
m.shape torch.Size([10491, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.362091064453125  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.362091064453125  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.3672194480896  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.478575229644775  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 10491, 64])
m.shape torch.Size([9154, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.485873222351074  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.485873222351074  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.4905571937561035  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.623490333557129  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 9154, 64])
m.shape torch.Size([8089, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.631252288818359  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.631252288818359  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.63521671295166  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.775891304016113  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 8089, 64])
m.shape torch.Size([6783, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.783723831176758  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.783723831176758  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.787433624267578  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.9312849044799805  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 6783, 64])
m.shape torch.Size([5913, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.939348220825195  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.939348220825195  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.942296028137207  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.085308074951172  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 5913, 64])
m.shape torch.Size([5200, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.093976020812988  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.093976020812988  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.096649169921875  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.242839813232422  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 5200, 64])
m.shape torch.Size([4592, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.251437187194824  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.251437187194824  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.254565238952637  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.405384063720703  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 4592, 64])
m.shape torch.Size([50367, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.528397083282471  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.528397083282471  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.552414417266846  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.280654430389404  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 50367, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.100274562835693  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.129551410675049  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.158828258514404  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.128636360168457  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([122795, 64])
input nodes number: 154382
output nodes number: 122795
edges number: 811035
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.160389423370361  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.189666271209717  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.19718885421753  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.19718885421753  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

m.shape torch.Size([6759, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.277945518493652  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.277945518493652  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.282083988189697  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.308641910552979  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 6759, 64])
m.shape torch.Size([5854, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.309206008911133  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.309206008911133  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.311997413635254  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.356807231903076  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 5854, 64])
m.shape torch.Size([4582, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.3590726852417  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.3590726852417  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.361302852630615  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.41243314743042  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 4582, 64])
m.shape torch.Size([3667, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.41458511352539  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.41458511352539  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.41633415222168  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.470369338989258  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 3667, 64])
m.shape torch.Size([3151, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.473391056060791  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.473391056060791  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.474894046783447  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.529874324798584  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 3151, 64])
m.shape torch.Size([2449, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.532735824584961  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.532735824584961  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.533904075622559  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58563232421875  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 2449, 64])
m.shape torch.Size([2009, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58850622177124  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.58850622177124  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.589464664459229  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.638027667999268  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 2009, 64])
m.shape torch.Size([1673, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.640839576721191  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.640839576721191  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.641637802124023  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.68775463104248  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 1673, 64])
m.shape torch.Size([1484, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.69063949584961  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.69063949584961  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.691347122192383  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.737387657165527  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 1484, 64])
m.shape torch.Size([1349, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.740350723266602  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.740350723266602  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.740994453430176  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.787839889526367  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 1349, 64])
m.shape torch.Size([1084, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.790450096130371  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.790450096130371  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.790966987609863  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.832727909088135  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 1084, 64])
m.shape torch.Size([953, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.835281372070312  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.835281372070312  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.835736274719238  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.874368667602539  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 953, 64])
m.shape torch.Size([806, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.876717567443848  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.876717567443848  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.87710189819336  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.912460327148438  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 806, 64])
m.shape torch.Size([719, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.914743423461914  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.914743423461914  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.91508674621582  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.94903564453125  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 719, 64])
m.shape torch.Size([8932, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.981809616088867  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.981809616088867  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.986068725585938  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.441924571990967  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 8932, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.375983238220215  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.382759094238281  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.389534950256348  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.382420063018799  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([45471, 40])
input nodes number: 122795
output nodes number: 45471
edges number: 309507
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.383674144744873  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031220674514770508 |0.007474422454833984 |0.13796401023864746 |0.0007245540618896484 |0.04677534103393555 |0.009924888610839844 |
----------------------------------------------------------pseudo_mini_loss sum 2.14890193939209
for loop block_dataloader item  time:  0.8138246536254883
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10089826583862305  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10089826583862305  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([160208, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.10089826583862305  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

m.shape torch.Size([15102, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.41791868209838867  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.41791868209838867  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.43232107162475586  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5489964485168457  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 15102, 128])
m.shape torch.Size([15660, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5574202537536621  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.5574202537536621  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.572354793548584  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.7963728904724121  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 15660, 128])
m.shape torch.Size([13548, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8084368705749512  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.8084368705749512  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 0.821378231048584  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.107161045074463  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 13548, 128])
m.shape torch.Size([11437, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1217637062072754  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1217637062072754  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.1341729164123535  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.4542360305786133  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 11437, 128])
m.shape torch.Size([98537, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6837129592895508  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.6837129592895508  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 1.7776851654052734  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.160684585571289  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 98537, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.886444091796875  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.9232282638549805  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.960012435913086  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.922078609466553  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([154284, 64])
input nodes number: 160208
output nodes number: 154284
edges number: 625499
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.961394309997559  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 4.998178482055664  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.0073747634887695  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.0073747634887695  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([154284, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.0073747634887695  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

m.shape torch.Size([10501, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.2142767906188965  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.2142767906188965  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.219801425933838  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.259860515594482  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 10501, 64])
m.shape torch.Size([11613, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.263067245483398  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.263067245483398  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.2686052322387695  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.3516693115234375  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 11613, 64])
m.shape torch.Size([10494, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.357441425323486  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.357441425323486  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.362541198730469  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.4733757972717285  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 10494, 64])
m.shape torch.Size([9051, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.480488300323486  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.480488300323486  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.485628604888916  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.617907524108887  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 9051, 64])
m.shape torch.Size([8014, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.625601768493652  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.625601768493652  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.629660606384277  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.769741535186768  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 8014, 64])
m.shape torch.Size([6721, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.777321815490723  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.777321815490723  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.7805681228637695  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.920604705810547  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 6721, 64])
m.shape torch.Size([5871, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.928951740264893  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.928951740264893  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 5.931951522827148  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.073624610900879  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 5871, 64])
m.shape torch.Size([5264, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.082469940185547  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.082469940185547  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.085231781005859  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.23475456237793  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 5264, 64])
m.shape torch.Size([4613, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.2431206703186035  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.2431206703186035  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.245387077331543  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.3970561027526855  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 4613, 64])
m.shape torch.Size([50423, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.520407676696777  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.520407676696777  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 6.544451713562012  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.273038864135742  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 50423, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.092897891998291  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.122119903564453  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.151341915130615  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.121206283569336  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([122565, 64])
input nodes number: 154284
output nodes number: 122565
edges number: 810765
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.152851581573486  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.182073593139648  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.189582824707031  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.189582824707031  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

m.shape torch.Size([6669, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.270558834075928  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.270558834075928  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.275564670562744  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.301005840301514  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 6669, 64])
m.shape torch.Size([5852, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.302551746368408  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.302551746368408  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.305342197418213  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.35039758682251  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 5852, 64])
m.shape torch.Size([4695, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.352081775665283  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.352081775665283  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.354369640350342  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.405056476593018  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 4695, 64])
m.shape torch.Size([3653, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.40721845626831  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.40721845626831  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.408960819244385  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.463276863098145  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 3653, 64])
m.shape torch.Size([3071, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.46618127822876  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.46618127822876  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.46764612197876  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.521268367767334  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 3071, 64])
m.shape torch.Size([2419, 6, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.524104595184326  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.524104595184326  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.525258541107178  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.57504415512085  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 2419, 64])
m.shape torch.Size([2036, 7, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.577971458435059  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.577971458435059  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.57894229888916  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.627903461456299  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 2036, 64])
m.shape torch.Size([1799, 8, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.630956649780273  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.630956649780273  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.631814956665039  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.681783676147461  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 1799, 64])
m.shape torch.Size([1492, 9, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.684656143188477  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.684656143188477  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.685367584228516  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.73092269897461  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 1492, 64])
m.shape torch.Size([1250, 10, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.733640670776367  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.733640670776367  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.734236717224121  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.776680946350098  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 1250, 64])
m.shape torch.Size([1119, 11, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.779409885406494  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.779409885406494  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.779943943023682  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.822988510131836  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 1119, 64])
m.shape torch.Size([984, 12, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.825624942779541  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.825624942779541  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.826094150543213  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.865976810455322  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 984, 64])
m.shape torch.Size([850, 13, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.868459224700928  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.868459224700928  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.8688645362854  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.906153202056885  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 850, 64])
m.shape torch.Size([715, 14, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.908411979675293  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.908411979675293  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.908753395080566  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.942513465881348  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 715, 64])
m.shape torch.Size([8866, 15, 64])
----------------------------------------1
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.975236892700195  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.975236892700195  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------3
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 8.979464530944824  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.433107376098633  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([1, 8866, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.366608142852783  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.37338399887085  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.380159854888916  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.373044967651367  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

torch.Size([45470, 40])
input nodes number: 122565
output nodes number: 45470
edges number: 309678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3992919921875 GB
    Memory Allocated: 9.374297618865967  GigaBytes
Max Memory Allocated: 9.47889232635498  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03134918212890625 |0.0076247453689575195 |0.13733160495758057 |0.0007319450378417969 |0.04656374454498291 |0.009970664978027344 |
----------------------------------------------------------pseudo_mini_loss sum 2.068458318710327
Total (block generation + training)time/epoch 1.1555169423421223
Training time/epoch 1.1066880226135254
Training time without block to device /epoch 1.0914385318756104
Training time without total dataloading part /epoch 0.3792252540588379
load block tensor time/epoch 0.0626983642578125
block to device time/epoch 0.015249490737915039
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  874566
Number of first layer input nodes during this epoch:  320540
