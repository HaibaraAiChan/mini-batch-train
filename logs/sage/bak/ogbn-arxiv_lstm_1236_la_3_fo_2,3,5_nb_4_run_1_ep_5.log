main start at this time 1649564680.7913153
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
for loop block_dataloader item  time:  0.15359711647033691
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1492919921875 GB
    Memory Allocated: 0.061092376708984375  GigaBytes
Max Memory Allocated: 0.061092376708984375  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1492919921875 GB
    Memory Allocated: 0.061092376708984375  GigaBytes
Max Memory Allocated: 0.061092376708984375  GigaBytes

torch.Size([118719, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1492919921875 GB
    Memory Allocated: 0.061092376708984375  GigaBytes
Max Memory Allocated: 0.061092376708984375  GigaBytes

m.shape torch.Size([7513, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3719482421875 GB
    Memory Allocated: 0.16162919998168945  GigaBytes
Max Memory Allocated: 0.1617136001586914  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3719482421875 GB
    Memory Allocated: 0.16162919998168945  GigaBytes
Max Memory Allocated: 0.1617136001586914  GigaBytes

 h.shape torch.Size([1, 7513, 128]), torch.Size([1, 7513, 128])
----------------------------------------3
 Nvidia-smi: 2.3719482421875 GB
    Memory Allocated: 0.1687941551208496  GigaBytes
Max Memory Allocated: 0.1687941551208496  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4403076171875 GB
    Memory Allocated: 0.22611379623413086  GigaBytes
Max Memory Allocated: 0.22969627380371094  GigaBytes

rst.shape  torch.Size([1, 7513, 128])
m.shape torch.Size([92409, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.5321044921875 GB
    Memory Allocated: 0.31065940856933594  GigaBytes
Max Memory Allocated: 0.31296682357788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5321044921875 GB
    Memory Allocated: 0.31065940856933594  GigaBytes
Max Memory Allocated: 0.31296682357788086  GigaBytes

 h.shape torch.Size([1, 92409, 128]), torch.Size([1, 92409, 128])
----------------------------------------3
 Nvidia-smi: 2.6219482421875 GB
    Memory Allocated: 0.40050315856933594  GigaBytes
Max Memory Allocated: 0.40050315856933594  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0477294921875 GB
    Memory Allocated: 1.7275714874267578  GigaBytes
Max Memory Allocated: 1.815699577331543  GigaBytes

rst.shape  torch.Size([1, 92409, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.6357793807983398  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.6596026420593262  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.6834259033203125  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.658857822418213  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

torch.Size([99922, 64])
input nodes number: 118719
output nodes number: 99922
edges number: 192331
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.6843113899230957  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.708134651184082  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7140908241271973  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7140908241271973  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

torch.Size([99922, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7140908241271973  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

m.shape torch.Size([5212, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7627911567687988  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7627911567687988  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

 h.shape torch.Size([1, 5212, 64]), torch.Size([1, 5212, 64])
----------------------------------------3
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7653813362121582  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.786118507385254  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

rst.shape  torch.Size([1, 5212, 64])
m.shape torch.Size([6011, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7875962257385254  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7875962257385254  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

 h.shape torch.Size([1, 6011, 64]), torch.Size([1, 6011, 64])
----------------------------------------3
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.7905526161193848  GigaBytes
Max Memory Allocated: 1.8266501426696777  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.8343348503112793  GigaBytes
Max Memory Allocated: 1.8372011184692383  GigaBytes

rst.shape  torch.Size([1, 6011, 64])
m.shape torch.Size([55116, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.1473388671875 GB
    Memory Allocated: 1.8735556602478027  GigaBytes
Max Memory Allocated: 1.8741717338562012  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1473388671875 GB
    Memory Allocated: 1.8735556602478027  GigaBytes
Max Memory Allocated: 1.8741717338562012  GigaBytes

 h.shape torch.Size([1, 55116, 64]), torch.Size([1, 55116, 64])
----------------------------------------3
 Nvidia-smi: 4.1473388671875 GB
    Memory Allocated: 1.8998370170593262  GigaBytes
Max Memory Allocated: 1.8998370170593262  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7449951171875 GB
    Memory Allocated: 2.4827589988708496  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

rst.shape  torch.Size([1, 55116, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7625732421875 GB
    Memory Allocated: 2.43936824798584  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7625732421875 GB
    Memory Allocated: 2.4551849365234375  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7625732421875 GB
    Memory Allocated: 2.471001625061035  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.7625732421875 GB
    Memory Allocated: 2.454690456390381  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

torch.Size([66339, 64])
input nodes number: 99922
output nodes number: 66339
edges number: 182582
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.7625732421875 GB
    Memory Allocated: 2.471747398376465  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.7625732421875 GB
    Memory Allocated: 2.4875640869140625  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.7801513671875 GB
    Memory Allocated: 2.492262363433838  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7801513671875 GB
    Memory Allocated: 2.492262363433838  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

m.shape torch.Size([3393, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.7801513671875 GB
    Memory Allocated: 2.5147910118103027  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7801513671875 GB
    Memory Allocated: 2.5147910118103027  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

 h.shape torch.Size([1, 3393, 64]), torch.Size([1, 3393, 64])
----------------------------------------3
 Nvidia-smi: 4.7801513671875 GB
    Memory Allocated: 2.516409397125244  GigaBytes
Max Memory Allocated: 2.5221810340881348  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7860107421875 GB
    Memory Allocated: 2.5300188064575195  GigaBytes
Max Memory Allocated: 2.5308279991149902  GigaBytes

rst.shape  torch.Size([1, 3393, 64])
m.shape torch.Size([2936, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.7860107421875 GB
    Memory Allocated: 2.530686855316162  GigaBytes
Max Memory Allocated: 2.5308279991149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7860107421875 GB
    Memory Allocated: 2.530686855316162  GigaBytes
Max Memory Allocated: 2.5308279991149902  GigaBytes

 h.shape torch.Size([1, 2936, 64]), torch.Size([1, 2936, 64])
----------------------------------------3
 Nvidia-smi: 4.7860107421875 GB
    Memory Allocated: 2.5320868492126465  GigaBytes
Max Memory Allocated: 2.5320868492126465  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7918701171875 GB
    Memory Allocated: 2.5533485412597656  GigaBytes
Max Memory Allocated: 2.5548267364501953  GigaBytes

rst.shape  torch.Size([1, 2936, 64])
m.shape torch.Size([2356, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.7918701171875 GB
    Memory Allocated: 2.554454803466797  GigaBytes
Max Memory Allocated: 2.5548267364501953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7918701171875 GB
    Memory Allocated: 2.554454803466797  GigaBytes
Max Memory Allocated: 2.5548267364501953  GigaBytes

 h.shape torch.Size([1, 2356, 64]), torch.Size([1, 2356, 64])
----------------------------------------3
 Nvidia-smi: 4.7918701171875 GB
    Memory Allocated: 2.5555782318115234  GigaBytes
Max Memory Allocated: 2.5555782318115234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7957763671875 GB
    Memory Allocated: 2.5805435180664062  GigaBytes
Max Memory Allocated: 2.5823049545288086  GigaBytes

rst.shape  torch.Size([1, 2356, 64])
m.shape torch.Size([1822, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.7957763671875 GB
    Memory Allocated: 2.5817975997924805  GigaBytes
Max Memory Allocated: 2.5823049545288086  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7957763671875 GB
    Memory Allocated: 2.5817975997924805  GigaBytes
Max Memory Allocated: 2.5823049545288086  GigaBytes

 h.shape torch.Size([1, 1822, 64]), torch.Size([1, 1822, 64])
----------------------------------------3
 Nvidia-smi: 4.7957763671875 GB
    Memory Allocated: 2.5826663970947266  GigaBytes
Max Memory Allocated: 2.5826663970947266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8192138671875 GB
    Memory Allocated: 2.6078853607177734  GigaBytes
Max Memory Allocated: 2.6096229553222656  GigaBytes

rst.shape  torch.Size([1, 1822, 64])
m.shape torch.Size([12229, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.8367919921875 GB
    Memory Allocated: 2.6224851608276367  GigaBytes
Max Memory Allocated: 2.622713088989258  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8367919921875 GB
    Memory Allocated: 2.6224851608276367  GigaBytes
Max Memory Allocated: 2.622713088989258  GigaBytes

 h.shape torch.Size([1, 12229, 64]), torch.Size([1, 12229, 64])
----------------------------------------3
 Nvidia-smi: 4.8367919921875 GB
    Memory Allocated: 2.628316879272461  GigaBytes
Max Memory Allocated: 2.628316879272461  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0828857421875 GB
    Memory Allocated: 2.8388633728027344  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 12229, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0828857421875 GB
    Memory Allocated: 2.820730686187744  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0828857421875 GB
    Memory Allocated: 2.8241186141967773  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0828857421875 GB
    Memory Allocated: 2.8275065422058105  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0828857421875 GB
    Memory Allocated: 2.823948860168457  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

torch.Size([22736, 40])
input nodes number: 66339
output nodes number: 22736
edges number: 84766
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0828857421875 GB
    Memory Allocated: 2.828001022338867  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.044420480728149414 |0.35834407806396484 |0.5400593280792236 |0.00015854835510253906 |0.023404836654663086 |0.007752418518066406 |
----------------------------------------------------------pseudo_mini_loss sum 4.966383457183838
for loop block_dataloader item  time:  1.3551273345947266
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.0669097900390625  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.0669097900390625  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

torch.Size([118510, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.0669097900390625  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

m.shape torch.Size([7327, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.1673574447631836  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.1673574447631836  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 7327, 128]), torch.Size([1, 7327, 128])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.1743450164794922  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.2310166358947754  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 7327, 128])
m.shape torch.Size([92541, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.3157768249511719  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.3157768249511719  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 92541, 128]), torch.Size([1, 92541, 128])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 0.4056205749511719  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7341995239257812  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 92541, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.6424450874328613  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.6662554740905762  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.690065860748291  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.665511131286621  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

torch.Size([99868, 64])
input nodes number: 118510
output nodes number: 99868
edges number: 192409
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.6909499168395996  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7147603034973145  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7207131385803223  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7207131385803223  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

torch.Size([99868, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7207131385803223  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

m.shape torch.Size([5142, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7693490982055664  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7693490982055664  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 5142, 64]), torch.Size([1, 5142, 64])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7718019485473633  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.792548656463623  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 5142, 64])
m.shape torch.Size([5882, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.794044017791748  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.794044017791748  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 5882, 64]), torch.Size([1, 5882, 64])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.7973437309265137  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.8424439430236816  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 5882, 64])
m.shape torch.Size([55236, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.8819465637207031  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.8819465637207031  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 55236, 64]), torch.Size([1, 55236, 64])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 1.9092903137207031  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.4912643432617188  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 55236, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.448753833770752  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.4645514488220215  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.480349063873291  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.464057445526123  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

torch.Size([66260, 64])
input nodes number: 99868
output nodes number: 66260
edges number: 182614
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.4810943603515625  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.496891975402832  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.501300811767578  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.501300811767578  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

m.shape torch.Size([3381, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5247278213500977  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5247278213500977  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 3381, 64]), torch.Size([1, 3381, 64])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5263404846191406  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.540766716003418  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 3381, 64])
m.shape torch.Size([2952, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5415124893188477  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5415124893188477  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 2952, 64]), torch.Size([1, 2952, 64])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5429201126098633  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.564952850341797  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 2952, 64])
m.shape torch.Size([2280, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5660805702209473  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5660805702209473  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 2280, 64]), torch.Size([1, 2280, 64])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5671677589416504  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5922141075134277  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 2280, 64])
m.shape torch.Size([1855, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5935964584350586  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5935964584350586  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 1855, 64]), torch.Size([1, 1855, 64])
----------------------------------------3
 Nvidia-smi: 5.3621826171875 GB
    Memory Allocated: 2.5944814682006836  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.6208343505859375  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

rst.shape  torch.Size([1, 1855, 64])
m.shape torch.Size([12268, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.6354737281799316  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.6354737281799316  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

 h.shape torch.Size([1, 12268, 64]), torch.Size([1, 12268, 64])
----------------------------------------3
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.6413235664367676  GigaBytes
Max Memory Allocated: 2.8534417152404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.8519749641418457  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 12268, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.832932472229004  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.837296485900879  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.840684413909912  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.836150646209717  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

torch.Size([22736, 40])
input nodes number: 66260
output nodes number: 22736
edges number: 84885
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 2.8368144035339355  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03318214416503906 |0.1802682876586914 |0.2972019910812378 |0.0001862049102783203 |0.018271207809448242 |0.006505727767944336 |
----------------------------------------------------------pseudo_mini_loss sum 3.948957681655884
for loop block_dataloader item  time:  1.5837585926055908
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.06705379486083984  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.06705379486083984  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

torch.Size([118637, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.06705379486083984  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

m.shape torch.Size([7291, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.16764163970947266  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.16764163970947266  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 7291, 128]), torch.Size([1, 7291, 128])
----------------------------------------3
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.17459487915039062  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.23022079467773438  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 7291, 128])
m.shape torch.Size([92766, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.3152127265930176  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.3152127265930176  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 92766, 128]), torch.Size([1, 92766, 128])
----------------------------------------3
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 0.4050564765930176  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.7403063774108887  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 92766, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.6492857933044434  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.6731414794921875  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.6969971656799316  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.6723957061767578  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

torch.Size([100057, 64])
input nodes number: 118637
output nodes number: 100057
edges number: 192823
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.6978821754455566  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.7217378616333008  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.7277021408081055  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.7277021408081055  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

torch.Size([100057, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.7277021408081055  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

m.shape torch.Size([5041, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.7766742706298828  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.7766742706298828  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 5041, 64]), torch.Size([1, 5041, 64])
----------------------------------------3
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.7797679901123047  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.8003907203674316  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 5041, 64])
m.shape torch.Size([5963, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.8021211624145508  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.8021211624145508  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 5963, 64]), torch.Size([1, 5963, 64])
----------------------------------------3
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.8058209419250488  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.8495087623596191  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 5963, 64])
m.shape torch.Size([55571, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.8891253471374512  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.8891253471374512  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 55571, 64]), torch.Size([1, 55571, 64])
----------------------------------------3
 Nvidia-smi: 5.3641357421875 GB
    Memory Allocated: 1.9164690971374512  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5011239051818848  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 55571, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.4585680961608887  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.4744410514831543  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.49031400680542  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.473944664001465  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

torch.Size([66575, 64])
input nodes number: 100057
output nodes number: 66575
edges number: 183680
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.491060733795166  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5069336891174316  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5112624168395996  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5112624168395996  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

m.shape torch.Size([3284, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5346240997314453  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5346240997314453  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 3284, 64]), torch.Size([1, 3284, 64])
----------------------------------------3
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5361900329589844  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5502967834472656  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 3284, 64])
m.shape torch.Size([2922, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.551248550415039  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.551248550415039  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 2922, 64]), torch.Size([1, 2922, 64])
----------------------------------------3
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5526418685913086  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5736265182495117  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 2922, 64])
m.shape torch.Size([2313, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5746726989746094  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5746726989746094  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 2313, 64]), torch.Size([1, 2313, 64])
----------------------------------------3
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.5757761001586914  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.601243019104004  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 2313, 64])
m.shape torch.Size([1850, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.6026835441589355  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.6026835441589355  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 1850, 64]), torch.Size([1, 1850, 64])
----------------------------------------3
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.6035656929016113  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.629148006439209  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

rst.shape  torch.Size([1, 1850, 64])
m.shape torch.Size([12367, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.6439108848571777  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.6439108848571777  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

 h.shape torch.Size([1, 12367, 64]), torch.Size([1, 12367, 64])
----------------------------------------3
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.649808406829834  GigaBytes
Max Memory Allocated: 2.8665995597839355  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.8625741004943848  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 12367, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.8439526557922363  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.8473405838012695  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.8507285118103027  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.847170829772949  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

torch.Size([22736, 40])
input nodes number: 66575
output nodes number: 22736
edges number: 85302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5828857421875 GB
    Memory Allocated: 2.847836971282959  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02975908915201823 |0.12089721361796062 |0.2161726156870524 |0.0001942316691080729 |0.018950621287027996 |0.006249189376831055 |
----------------------------------------------------------pseudo_mini_loss sum 3.258896589279175
for loop block_dataloader item  time:  1.8157413005828857
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06713390350341797  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06713390350341797  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

torch.Size([118946, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06713390350341797  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

m.shape torch.Size([7414, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16806650161743164  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16806650161743164  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 7414, 128]), torch.Size([1, 7414, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17513704299926758  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23230314254760742  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 7414, 128])
m.shape torch.Size([92987, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3174471855163574  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3174471855163574  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 92987, 128]), torch.Size([1, 92987, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4072909355163574  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7432284355163574  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 92987, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6524667739868164  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6764044761657715  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7003421783447266  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6756563186645508  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

torch.Size([100401, 64])
input nodes number: 118946
output nodes number: 100401
edges number: 193388
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7012295722961426  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7251672744750977  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.731152057647705  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.731152057647705  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

torch.Size([100401, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.731152057647705  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

m.shape torch.Size([5198, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7802681922912598  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7802681922912598  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 5198, 64]), torch.Size([1, 5198, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.783236026763916  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.803682804107666  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 5198, 64])
m.shape torch.Size([5921, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8053555488586426  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8053555488586426  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 5921, 64]), torch.Size([1, 5921, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8093557357788086  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8537402153015137  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 5921, 64])
m.shape torch.Size([55582, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8934955596923828  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8934955596923828  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 55582, 64]), torch.Size([1, 55582, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9208393096923828  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5055980682373047  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 55582, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4631857872009277  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.47908878326416  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4949917793273926  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4785914421081543  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

torch.Size([66701, 64])
input nodes number: 100401
output nodes number: 66701
edges number: 183786
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4957408905029297  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.511643886566162  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5156197547912598  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5156197547912598  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

m.shape torch.Size([3370, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.538918972015381  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.538918972015381  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 3370, 64]), torch.Size([1, 3370, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5405259132385254  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.554624557495117  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 3370, 64])
m.shape torch.Size([2896, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.555539608001709  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.555539608001709  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 2896, 64]), torch.Size([1, 2896, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5569205284118652  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5791773796081543  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 2896, 64])
m.shape torch.Size([2328, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.580214500427246  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.580214500427246  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 2328, 64]), torch.Size([1, 2328, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.581324577331543  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.606387138366699  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 2328, 64])
m.shape torch.Size([1793, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6079821586608887  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6079821586608887  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 1793, 64]), torch.Size([1, 1793, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.608837604522705  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.634072780609131  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

rst.shape  torch.Size([1, 1793, 64])
m.shape torch.Size([12346, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.648822784423828  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.648822784423828  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

 h.shape torch.Size([1, 12346, 64]), torch.Size([1, 12346, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.654709815979004  GigaBytes
Max Memory Allocated: 2.877316951751709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.867546558380127  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 12346, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8494343757629395  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.853724479675293  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.857112407684326  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8526525497436523  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([22733, 40])
input nodes number: 66701
output nodes number: 22733
edges number: 85048
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.854221820831299  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028098762035369873 |0.0912436842918396 |0.17558735609054565 |0.00019925832748413086 |0.01931208372116089 |0.006338596343994141 |
----------------------------------------------------------pseudo_mini_loss sum 2.8522515296936035
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1140935
Number of first layer input nodes during this epoch:  474812
for loop block_dataloader item  time:  0.12773394584655762
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06794357299804688  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06794357299804688  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([118494, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06794357299804688  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([7410, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16843223571777344  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16843223571777344  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 7410, 128]), torch.Size([1, 7410, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17549896240234375  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23203277587890625  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 7410, 128])
m.shape torch.Size([92507, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31672096252441406  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31672096252441406  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 92507, 128]), torch.Size([1, 92507, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.40656471252441406  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7347545623779297  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 92507, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6430068016052246  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6668291091918945  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6906514167785645  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6660842895507812  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([99917, 64])
input nodes number: 118494
output nodes number: 99917
edges number: 192424
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.691535472869873  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.715357780456543  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7213134765625  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7213134765625  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([99917, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7213134765625  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([5194, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7700457572937012  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7700457572937012  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5194, 64]), torch.Size([1, 5194, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7726283073425293  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7938671112060547  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5194, 64])
m.shape torch.Size([6041, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7954797744750977  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7954797744750977  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 6041, 64]), torch.Size([1, 6041, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7984628677368164  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.842578411102295  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 6041, 64])
m.shape torch.Size([55148, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8818740844726562  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8818740844726562  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 55148, 64]), torch.Size([1, 55148, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9088354110717773  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.491107940673828  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 55148, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.448730945587158  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4645581245422363  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4803853034973145  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4640631675720215  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([66383, 64])
input nodes number: 99917
output nodes number: 66383
edges number: 182720
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.481131076812744  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4969582557678223  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.500915050506592  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.500915050506592  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([3312, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.524312973022461  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.524312973022461  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 3312, 64]), torch.Size([1, 3312, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5258922576904297  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5396175384521484  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 3312, 64])
m.shape torch.Size([2980, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5403642654418945  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5403642654418945  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2980, 64]), torch.Size([1, 2980, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.54178524017334  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.563685417175293  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2980, 64])
m.shape torch.Size([2362, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5647788047790527  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5647788047790527  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2362, 64]), torch.Size([1, 2362, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5659050941467285  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5913634300231934  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2362, 64])
m.shape torch.Size([1799, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5926156044006348  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5926156044006348  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 1799, 64]), torch.Size([1, 1799, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5934739112854004  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.61873197555542  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 1799, 64])
m.shape torch.Size([12283, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6334033012390137  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6334033012390137  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 12283, 64]), torch.Size([1, 12283, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.639260768890381  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8501248359680176  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 12283, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8310904502868652  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8344783782958984  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8378663063049316  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.834308624267578  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([22736, 40])
input nodes number: 66383
output nodes number: 22736
edges number: 84969
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.834071159362793  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02353501319885254 |0.0021910667419433594 |0.11025643348693848 |0.00021958351135253906 |0.013095617294311523 |0.006422758102416992 |
----------------------------------------------------------pseudo_mini_loss sum 2.6163668632507324
for loop block_dataloader item  time:  0.41848182678222656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06708240509033203  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06708240509033203  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([118852, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06708240509033203  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([7346, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1678156852722168  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1678156852722168  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 7346, 128]), torch.Size([1, 7346, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1748213768005371  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23149824142456055  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 7346, 128])
m.shape torch.Size([92856, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31654977798461914  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31654977798461914  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 92856, 128]), torch.Size([1, 92856, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.40639352798461914  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7423310279846191  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 92856, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6506199836730957  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6745100021362305  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6984000205993652  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6737632751464844  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([100202, 64])
input nodes number: 118852
output nodes number: 100202
edges number: 193058
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.699286937713623  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7231769561767578  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7291498184204102  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7291498184204102  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([100202, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7291498184204102  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([5105, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.777961254119873  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.777961254119873  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5105, 64]), torch.Size([1, 5105, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7810754776000977  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.80134916305542  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5105, 64])
m.shape torch.Size([5906, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8030362129211426  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8030362129211426  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5906, 64]), torch.Size([1, 5906, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8074049949645996  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8510098457336426  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5906, 64])
m.shape torch.Size([55378, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.890449047088623  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.890449047088623  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 55378, 64]), torch.Size([1, 55378, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.917792797088623  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.500606060028076  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 55378, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4583497047424316  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4741783142089844  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.490006923675537  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4736833572387695  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([66389, 64])
input nodes number: 100202
output nodes number: 66389
edges number: 183051
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4907546043395996  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5065832138061523  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.51054048538208  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.51054048538208  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([3343, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5338807106018066  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5338807106018066  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 3343, 64]), torch.Size([1, 3343, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.535475254058838  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.549772262573242  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 3343, 64])
m.shape torch.Size([2903, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.550424575805664  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.550424575805664  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2903, 64]), torch.Size([1, 2903, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.551809310913086  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5732192993164062  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2903, 64])
m.shape torch.Size([2372, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5743298530578613  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5743298530578613  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2372, 64]), torch.Size([1, 2372, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.575460910797119  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6008362770080566  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2372, 64])
m.shape torch.Size([1832, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6020750999450684  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6020750999450684  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 1832, 64]), torch.Size([1, 1832, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6029486656188965  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6296229362487793  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 1832, 64])
m.shape torch.Size([12286, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.644289970397949  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.644289970397949  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 12286, 64]), torch.Size([1, 12286, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.650148391723633  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.862578868865967  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 12286, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8436107635498047  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8475050926208496  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.850893020629883  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8468289375305176  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([22736, 40])
input nodes number: 66389
output nodes number: 22736
edges number: 85023
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8474936485290527  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023249506950378418 |0.0022225379943847656 |0.08463108539581299 |0.00021338462829589844 |0.01331186294555664 |0.006615638732910156 |
----------------------------------------------------------pseudo_mini_loss sum 2.4546926021575928
for loop block_dataloader item  time:  0.6496002674102783
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06704902648925781  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06704902648925781  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([118640, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06704902648925781  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([7496, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16768884658813477  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16768884658813477  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 7496, 128]), torch.Size([1, 7496, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17483758926391602  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23202753067016602  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 7496, 128])
m.shape torch.Size([92612, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.316774845123291  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.316774845123291  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 92612, 128]), torch.Size([1, 92612, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.406618595123291  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7360100746154785  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 92612, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.644299030303955  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6681666374206543  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6920342445373535  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6674203872680664  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([100108, 64])
input nodes number: 118640
output nodes number: 100108
edges number: 192720
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6929192543029785  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7167868614196777  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7227540016174316  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7227540016174316  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([100108, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7227540016174316  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([5245, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7716598510742188  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7716598510742188  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5245, 64]), torch.Size([1, 5245, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7743148803710938  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7949090003967285  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5245, 64])
m.shape torch.Size([5856, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7965378761291504  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7965378761291504  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5856, 64]), torch.Size([1, 5856, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7999663352966309  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8443102836608887  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5856, 64])
m.shape torch.Size([55434, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8832650184631348  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8832650184631348  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 55434, 64]), torch.Size([1, 55434, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9106087684631348  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4939560890197754  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 55434, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.451669216156006  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4675326347351074  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.483396053314209  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.467036724090576  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([66535, 64])
input nodes number: 100108
output nodes number: 66535
edges number: 183259
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4841432571411133  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.500006675720215  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.504368305206299  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.504368305206299  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([3379, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5277395248413086  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5277395248413086  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 3379, 64]), torch.Size([1, 3379, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.529351234436035  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5435781478881836  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 3379, 64])
m.shape torch.Size([2878, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.544529914855957  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.544529914855957  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2878, 64]), torch.Size([1, 2878, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5459022521972656  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.568150520324707  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2878, 64])
m.shape torch.Size([2287, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5693373680114746  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5693373680114746  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2287, 64]), torch.Size([1, 2287, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5704283714294434  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5948991775512695  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2287, 64])
m.shape torch.Size([1817, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5962295532226562  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5962295532226562  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 1817, 64]), torch.Size([1, 1817, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5970964431762695  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6227035522460938  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 1817, 64])
m.shape torch.Size([12375, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.637483596801758  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.637483596801758  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 12375, 64]), torch.Size([1, 12375, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6433849334716797  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.856393814086914  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 12375, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8373823165893555  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.841214179992676  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.844602108001709  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8406004905700684  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([22736, 40])
input nodes number: 66535
output nodes number: 22736
edges number: 85139
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.841710090637207  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02313836415608724 |0.0022128423055013022 |0.07624212900797527 |0.00021791458129882812 |0.013381878534952799 |0.006438493728637695 |
----------------------------------------------------------pseudo_mini_loss sum 2.351763963699341
for loop block_dataloader item  time:  0.8810315132141113
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06731700897216797  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06731700897216797  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([118429, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06731700897216797  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([7428, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16781330108642578  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16781330108642578  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 7428, 128]), torch.Size([1, 7428, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1748971939086914  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.2315683364868164  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 7428, 128])
m.shape torch.Size([92462, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3162050247192383  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3162050247192383  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 92462, 128]), torch.Size([1, 92462, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4060487747192383  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7328910827636719  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 92462, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6419405937194824  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6657562255859375  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6895718574523926  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6650118827819824  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([99890, 64])
input nodes number: 118429
output nodes number: 99890
edges number: 192352
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.690455436706543  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.714271068572998  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7202253341674805  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7202253341674805  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([99890, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7202253341674805  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([5191, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7691059112548828  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7691059112548828  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5191, 64]), torch.Size([1, 5191, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.771860122680664  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7927889823913574  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5191, 64])
m.shape torch.Size([6003, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7950239181518555  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7950239181518555  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 6003, 64]), torch.Size([1, 6003, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.797938346862793  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.842257022857666  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 6003, 64])
m.shape torch.Size([55255, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8817243576049805  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8817243576049805  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 55255, 64]), torch.Size([1, 55255, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9090681076049805  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.491061210632324  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 55255, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4483799934387207  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4642229080200195  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4800658226013184  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4637274742126465  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([66449, 64])
input nodes number: 99890
output nodes number: 66449
edges number: 182962
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.48081111907959  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4966540336608887  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5007543563842773  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5007543563842773  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([3394, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.524181365966797  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.524181365966797  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 3394, 64]), torch.Size([1, 3394, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5257997512817383  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5401015281677246  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 3394, 64])
m.shape torch.Size([2945, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5407938957214355  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5407938957214355  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2945, 64]), torch.Size([1, 2945, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.542198657989502  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5641255378723145  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2945, 64])
m.shape torch.Size([2256, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.565208911895752  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.565208911895752  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2256, 64]), torch.Size([1, 2256, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.566284656524658  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5912117958068848  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2256, 64])
m.shape torch.Size([1872, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.592514991760254  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.592514991760254  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 1872, 64]), torch.Size([1, 1872, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.59340763092041  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6192941665649414  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 1872, 64])
m.shape torch.Size([12266, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.633927345275879  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.633927345275879  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 12266, 64]), torch.Size([1, 12266, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6397762298583984  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8503780364990234  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 12266, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8315229415893555  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8349108695983887  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.838298797607422  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8347411155700684  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([22733, 40])
input nodes number: 66449
output nodes number: 22733
edges number: 84870
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8349623680114746  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024222731590270996 |0.0021989941596984863 |0.07055819034576416 |0.00021916627883911133 |0.013461649417877197 |0.006773710250854492 |
----------------------------------------------------------pseudo_mini_loss sum 2.2995190620422363
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1140288
Number of first layer input nodes during this epoch:  474415
block dataloader generation time/epoch 1.1920928955078125e-06
for loop block_dataloader item  time:  0.1638355255126953
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.067047119140625  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.067047119140625  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([118596, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.067047119140625  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([7389, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16753816604614258  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16753816604614258  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 7389, 128]), torch.Size([1, 7389, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17458486557006836  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.2309584617614746  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 7389, 128])
m.shape torch.Size([92572, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3157186508178711  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3157186508178711  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 92572, 128]), torch.Size([1, 92572, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4055624008178711  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7344961166381836  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 92572, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6427888870239258  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6666216850280762  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6904544830322266  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.665876865386963  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([99961, 64])
input nodes number: 118596
output nodes number: 99961
edges number: 192533
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6913394927978516  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.715172290802002  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7211308479309082  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7211308479309082  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([99961, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7211308479309082  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([5155, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7699337005615234  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7699337005615234  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5155, 64]), torch.Size([1, 5155, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7729969024658203  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7934489250183105  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5155, 64])
m.shape torch.Size([5892, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7951173782348633  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7951173782348633  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5892, 64]), torch.Size([1, 5892, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.798649787902832  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8435473442077637  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5892, 64])
m.shape torch.Size([55382, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8825125694274902  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8825125694274902  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 55382, 64]), torch.Size([1, 55382, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9098563194274902  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4927077293395996  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 55382, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4504504203796387  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4662885665893555  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4821267127990723  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4657936096191406  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([66429, 64])
input nodes number: 99961
output nodes number: 66429
edges number: 183085
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.482872486114502  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4987106323242188  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5026893615722656  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5026893615722656  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([3324, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.526081085205078  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.526081085205078  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 3324, 64]), torch.Size([1, 3324, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5276660919189453  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5416789054870605  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 3324, 64])
m.shape torch.Size([2928, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.542670249938965  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.542670249938965  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2928, 64]), torch.Size([1, 2928, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5440664291381836  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5664591789245605  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2928, 64])
m.shape torch.Size([2315, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5675530433654785  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5675530433654785  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2315, 64]), torch.Size([1, 2315, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.568657398223877  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5932531356811523  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2315, 64])
m.shape torch.Size([1776, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5946249961853027  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5946249961853027  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 1776, 64]), torch.Size([1, 1776, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5954718589782715  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6207404136657715  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 1776, 64])
m.shape torch.Size([12393, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6355528831481934  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6355528831481934  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 12393, 64]), torch.Size([1, 12393, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.641462802886963  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8547744750976562  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 12393, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8357248306274414  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8391127586364746  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.842500686645508  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8389430046081543  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([22736, 40])
input nodes number: 66429
output nodes number: 22736
edges number: 85194
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8405442237854004  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02315664291381836 |0.0022144317626953125 |0.05660605430603027 |0.00020456314086914062 |0.01396942138671875 |0.0062749385833740234 |
----------------------------------------------------------pseudo_mini_loss sum 2.214834451675415
for loop block_dataloader item  time:  0.4037160873413086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06805133819580078  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06805133819580078  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([118896, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06805133819580078  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([7381, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16901111602783203  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16901111602783203  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 7381, 128]), torch.Size([1, 7381, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17605018615722656  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.2323627471923828  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 7381, 128])
m.shape torch.Size([93046, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3175787925720215  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3175787925720215  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 93046, 128]), torch.Size([1, 93046, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4074225425720215  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7433600425720215  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 93046, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.652585506439209  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6765294075012207  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7004733085632324  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6757807731628418  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([100427, 64])
input nodes number: 118896
output nodes number: 100427
edges number: 193473
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7013602256774902  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.725304126739502  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.731290340423584  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.731290340423584  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([100427, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.731290340423584  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([5203, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7806587219238281  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7806587219238281  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5203, 64]), torch.Size([1, 5203, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7834463119506836  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8055448532104492  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5203, 64])
m.shape torch.Size([5908, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8072094917297363  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8072094917297363  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 5908, 64]), torch.Size([1, 5908, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.810647964477539  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.854942798614502  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 5908, 64])
m.shape torch.Size([55725, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8941879272460938  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8941879272460938  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 55725, 64]), torch.Size([1, 55725, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9215316772460938  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.507655143737793  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 55725, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4641828536987305  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4801177978515625  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4960527420043945  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4796195030212402  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

torch.Size([66836, 64])
input nodes number: 100427
output nodes number: 66836
edges number: 184194
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.49680233001709  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.512737274169922  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.516721248626709  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.516721248626709  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

m.shape torch.Size([3374, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5400147438049316  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5400147438049316  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 3374, 64]), torch.Size([1, 3374, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.541623592376709  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.555039405822754  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 3374, 64])
m.shape torch.Size([2954, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.55582332611084  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.55582332611084  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2954, 64]), torch.Size([1, 2954, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.557231903076172  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.580698013305664  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2954, 64])
m.shape torch.Size([2270, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5816879272460938  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5816879272460938  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 2270, 64]), torch.Size([1, 2270, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.582770347595215  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6071739196777344  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 2270, 64])
m.shape torch.Size([1780, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6087865829467773  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6087865829467773  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 1780, 64]), torch.Size([1, 1780, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.609635353088379  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6343812942504883  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

rst.shape  torch.Size([1, 1780, 64])
m.shape torch.Size([12358, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6491494178771973  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6491494178771973  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

 h.shape torch.Size([1, 12358, 64]), torch.Size([1, 12358, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6550421714782715  GigaBytes
Max Memory Allocated: 2.8822641372680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.867885112762451  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 12358, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8492517471313477  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.853529930114746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8569178581237793  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8524699211120605  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([22736, 40])
input nodes number: 66836
output nodes number: 22736
edges number: 85002
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8530917167663574  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023099422454833984 |0.0023545026779174805 |0.05660057067871094 |0.0002162456512451172 |0.017525792121887207 |0.006464958190917969 |
----------------------------------------------------------pseudo_mini_loss sum 2.1231679916381836
for loop block_dataloader item  time:  0.6354472637176514
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06804370880126953  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06804370880126953  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([118991, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06804370880126953  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([7499, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1689152717590332  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1689152717590332  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 7499, 128]), torch.Size([1, 7499, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17606687545776367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23327970504760742  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 7499, 128])
m.shape torch.Size([92841, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31824398040771484  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31824398040771484  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 92841, 128]), torch.Size([1, 92841, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.40808773040771484  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7440252304077148  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 92841, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.652310848236084  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6762337684631348  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7001566886901855  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6754860877990723  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([100340, 64])
input nodes number: 118991
output nodes number: 100340
edges number: 193181
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7010445594787598  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7249674797058105  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7309484481811523  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7309484481811523  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([100340, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7309484481811523  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([5211, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7799091339111328  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7799091339111328  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5211, 64]), torch.Size([1, 5211, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.782552719116211  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8038582801818848  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5211, 64])
m.shape torch.Size([5926, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.805189609527588  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.805189609527588  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5926, 64]), torch.Size([1, 5926, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.80851411819458  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.852797508239746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5926, 64])
m.shape torch.Size([55498, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8923206329345703  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8923206329345703  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 55498, 64]), torch.Size([1, 55498, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9196643829345703  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.503622055053711  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 55498, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.461270332336426  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4771575927734375  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.493044853210449  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.47666072845459  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([66635, 64])
input nodes number: 100340
output nodes number: 66635
edges number: 183557
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.493793487548828  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.50968074798584  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.513655185699463  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.513655185699463  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([3354, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5369653701782227  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5369653701782227  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 3354, 64]), torch.Size([1, 3354, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.538564682006836  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5526952743530273  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 3354, 64])
m.shape torch.Size([2860, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5536293983459473  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5536293983459473  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2860, 64]), torch.Size([1, 2860, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.554993152618408  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5763320922851562  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2860, 64])
m.shape torch.Size([2347, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5773940086364746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5773940086364746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2347, 64]), torch.Size([1, 2347, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5785136222839355  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.603818893432617  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2347, 64])
m.shape torch.Size([1924, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.605151653289795  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.605151653289795  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 1924, 64]), torch.Size([1, 1924, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6060690879821777  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.633690357208252  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 1924, 64])
m.shape torch.Size([12251, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6482930183410645  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6482930183410645  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 12251, 64]), torch.Size([1, 12251, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.654135227203369  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8654093742370605  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 12251, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.846853256225586  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.850241184234619  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8536291122436523  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.850071430206299  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([22736, 40])
input nodes number: 66635
output nodes number: 22736
edges number: 85066
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8498477935791016  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023023525873819988 |0.002324660619099935 |0.056891282399495445 |0.0002162456512451172 |0.016235510508219402 |0.0037996768951416016 |
----------------------------------------------------------pseudo_mini_loss sum 2.0701284408569336
for loop block_dataloader item  time:  0.8694446086883545
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06703567504882812  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06703567504882812  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([118537, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06703567504882812  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([7396, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16750860214233398  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16750860214233398  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 7396, 128]), torch.Size([1, 7396, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1745619773864746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.2309889793395996  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 7396, 128])
m.shape torch.Size([92325, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31551027297973633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31551027297973633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 92325, 128]), torch.Size([1, 92325, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.40535402297973633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7305631637573242  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 92325, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.639535903930664  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.66331148147583  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.687087059020996  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6625680923461914  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([99721, 64])
input nodes number: 118537
output nodes number: 99721
edges number: 192046
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.687971591949463  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.711747169494629  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.717691421508789  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.717691421508789  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([99721, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.717691421508789  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([5130, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7663369178771973  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7663369178771973  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5130, 64]), torch.Size([1, 5130, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7693734169006348  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7907752990722656  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5130, 64])
m.shape torch.Size([6022, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7920985221862793  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7920985221862793  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 6022, 64]), torch.Size([1, 6022, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7952098846435547  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8414931297302246  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 6022, 64])
m.shape torch.Size([55089, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8798799514770508  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8798799514770508  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 55089, 64]), torch.Size([1, 55089, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9072237014770508  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.488861083984375  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 55089, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4454050064086914  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.461198329925537  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.476991653442383  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4607043266296387  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([66241, 64])
input nodes number: 99721
output nodes number: 66241
edges number: 182441
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.477735996246338  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4935293197631836  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4979729652404785  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4979729652404785  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([3376, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.521432876586914  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.521432876586914  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 3376, 64]), torch.Size([1, 3376, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.523042678833008  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.537476062774658  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 3376, 64])
m.shape torch.Size([2964, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.538328170776367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.538328170776367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2964, 64]), torch.Size([1, 2964, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5397415161132812  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5621752738952637  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2964, 64])
m.shape torch.Size([2345, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5633058547973633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5633058547973633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2345, 64]), torch.Size([1, 2345, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.564424514770508  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.589982032775879  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2345, 64])
m.shape torch.Size([1840, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.591628074645996  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.591628074645996  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 1840, 64]), torch.Size([1, 1840, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.59250545501709  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6186580657958984  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 1840, 64])
m.shape torch.Size([12208, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6332273483276367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6332273483276367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 12208, 64]), torch.Size([1, 12208, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6390485763549805  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8489537239074707  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 12208, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.829890251159668  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.833278179168701  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8366661071777344  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.833108425140381  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([22733, 40])
input nodes number: 66241
output nodes number: 22733
edges number: 84739
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8337721824645996  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024355292320251465 |0.0023169517517089844 |0.07031291723251343 |0.0002181529998779297 |0.01561206579208374 |0.006446361541748047 |
----------------------------------------------------------pseudo_mini_loss sum 2.0087170600891113
Total (block generation + training)time/epoch 1.0468811988830566
Training time/epoch 1.0467395782470703
Training time without block to device /epoch 1.0374717712402344
Training time without total dataloading part /epoch 0.35101890563964844
load block tensor time/epoch 0.09742116928100586
block to device time/epoch 0.009267807006835938
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1141610
Number of first layer input nodes during this epoch:  475020
block dataloader generation time/epoch 9.5367431640625e-07
for loop block_dataloader item  time:  0.13746356964111328
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06688165664672852  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06688165664672852  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([118447, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06688165664672852  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([7479, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16740083694458008  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16740083694458008  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 7479, 128]), torch.Size([1, 7479, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17453336715698242  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23159360885620117  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 7479, 128])
m.shape torch.Size([92401, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3161478042602539  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3161478042602539  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 92401, 128]), torch.Size([1, 92401, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4059915542602539  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7329683303833008  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 92401, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6411528587341309  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.664966106414795  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.688779354095459  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6642217636108398  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([99880, 64])
input nodes number: 118447
output nodes number: 99880
edges number: 192281
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6896629333496094  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7134761810302734  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7194294929504395  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7194294929504395  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([99880, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7194294929504395  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([5220, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7683062553405762  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7683062553405762  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5220, 64]), torch.Size([1, 5220, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7710261344909668  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7922792434692383  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5220, 64])
m.shape torch.Size([5956, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7944722175598145  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7944722175598145  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5956, 64]), torch.Size([1, 5956, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7974591255187988  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.841479778289795  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5956, 64])
m.shape torch.Size([55295, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8810300827026367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8810300827026367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 55295, 64]), torch.Size([1, 55295, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9083738327026367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4904050827026367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 55295, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4479455947875977  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4637937545776367  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.479641914367676  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4632983207702637  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([66471, 64])
input nodes number: 99880
output nodes number: 66471
edges number: 183017
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4803872108459473  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4962353706359863  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.500197410583496  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.500197410583496  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([3381, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5236215591430664  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5236215591430664  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 3381, 64]), torch.Size([1, 3381, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5252342224121094  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.539508819580078  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 3381, 64])
m.shape torch.Size([2924, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5402116775512695  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5402116775512695  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2924, 64]), torch.Size([1, 2924, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5416059494018555  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.563084602355957  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2924, 64])
m.shape torch.Size([2321, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.564169406890869  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.564169406890869  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2321, 64]), torch.Size([1, 2321, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.565276622772217  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.589931011199951  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2321, 64])
m.shape torch.Size([1839, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5915088653564453  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5915088653564453  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 1839, 64]), torch.Size([1, 1839, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.592386245727539  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.617818832397461  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 1839, 64])
m.shape torch.Size([12271, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6324658393859863  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6324658393859863  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 12271, 64]), torch.Size([1, 12271, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6383414268493652  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.849022388458252  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 12271, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8299813270568848  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.833369255065918  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.836757183074951  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8331995010375977  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([22736, 40])
input nodes number: 66471
output nodes number: 22736
edges number: 84903
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.833864688873291  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021381855010986328 |0.002295970916748047 |0.05674910545349121 |0.00026154518127441406 |0.013945341110229492 |0.004369020462036133 |
----------------------------------------------------------pseudo_mini_loss sum 1.9875812530517578
for loop block_dataloader item  time:  0.3618316650390625
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06703853607177734  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06703853607177734  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([118613, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06703853607177734  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([7528, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1675868034362793  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1675868034362793  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 7528, 128]), torch.Size([1, 7528, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17571592330932617  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23315000534057617  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 7528, 128])
m.shape torch.Size([92460, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3177371025085449  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3177371025085449  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 92460, 128]), torch.Size([1, 92460, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4075808525085449  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7343993186950684  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 92460, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6434946060180664  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6673336029052734  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6911725997924805  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.666588306427002  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([99988, 64])
input nodes number: 118613
output nodes number: 99988
edges number: 192448
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6920576095581055  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7158966064453125  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7218565940856934  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7218565940856934  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([99988, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7218565940856934  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([5219, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.770519733428955  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.770519733428955  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5219, 64]), torch.Size([1, 5219, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.77305269241333  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7943687438964844  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5219, 64])
m.shape torch.Size([5886, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.795882225036621  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.795882225036621  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5886, 64]), torch.Size([1, 5886, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7989745140075684  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8428802490234375  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5886, 64])
m.shape torch.Size([55189, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8823323249816895  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8823323249816895  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 55189, 64]), torch.Size([1, 55189, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9096760749816895  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.491504192352295  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 55189, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4492530822753906  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4650588035583496  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4808645248413086  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.464564800262451  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([66294, 64])
input nodes number: 99988
output nodes number: 66294
edges number: 182558
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4816107749938965  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4974164962768555  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5013680458068848  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5013680458068848  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([3453, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5247817039489746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5247817039489746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 3453, 64]), torch.Size([1, 3453, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.526428699493408  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5408992767333984  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 3453, 64])
m.shape torch.Size([2984, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5416617393493652  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5416617393493652  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2984, 64]), torch.Size([1, 2984, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5430846214294434  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5647635459899902  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2984, 64])
m.shape torch.Size([2249, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5658750534057617  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5658750534057617  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2249, 64]), torch.Size([1, 2249, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5669479370117188  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.590864658355713  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2249, 64])
m.shape torch.Size([1786, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.592154026031494  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.592154026031494  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 1786, 64]), torch.Size([1, 1786, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.593005657196045  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.618804931640625  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 1786, 64])
m.shape torch.Size([12264, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.633456230163574  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.633456230163574  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 12264, 64]), torch.Size([1, 12264, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6393041610717773  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8498754501342773  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 12264, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.830955982208252  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.834343910217285  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8377318382263184  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.834174156188965  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([22736, 40])
input nodes number: 66294
output nodes number: 22736
edges number: 84632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8348379135131836  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021193981170654297 |0.0022794008255004883 |0.054866790771484375 |0.0002332925796508789 |0.013856768608093262 |0.006186246871948242 |
----------------------------------------------------------pseudo_mini_loss sum 1.9297415018081665
for loop block_dataloader item  time:  0.5838918685913086
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06697225570678711  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06697225570678711  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([118623, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06697225570678711  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([7481, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16764450073242188  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16764450073242188  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 7481, 128]), torch.Size([1, 7481, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.17477893829345703  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23185443878173828  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 7481, 128])
m.shape torch.Size([92661, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31665563583374023  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31665563583374023  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 92661, 128]), torch.Size([1, 92661, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.40649938583374023  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7364516258239746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 92661, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6447415351867676  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6686172485351562  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.692492961883545  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6678709983825684  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([100142, 64])
input nodes number: 118623
output nodes number: 100142
edges number: 192803
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.69337797164917  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7172536849975586  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7232227325439453  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7232227325439453  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([100142, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7232227325439453  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([5206, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7722110748291016  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7722110748291016  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5206, 64]), torch.Size([1, 5206, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.774923324584961  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7964491844177246  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5206, 64])
m.shape torch.Size([5916, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.797778606414795  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.797778606414795  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5916, 64]), torch.Size([1, 5916, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8009767532348633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8450307846069336  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5916, 64])
m.shape torch.Size([55475, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8845396041870117  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8845396041870117  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 55475, 64]), torch.Size([1, 55475, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9118833541870117  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4956226348876953  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 55475, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.452855110168457  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.468733310699463  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4846115112304688  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4682369232177734  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([66597, 64])
input nodes number: 100142
output nodes number: 66597
edges number: 183463
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.485358715057373  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.501236915588379  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5055885314941406  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5055885314941406  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([3368, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5289459228515625  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5289459228515625  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 3368, 64]), torch.Size([1, 3368, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5305519104003906  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5447230339050293  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 3368, 64])
m.shape torch.Size([2934, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.545663833618164  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.545663833618164  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2934, 64]), torch.Size([1, 2934, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.547062873840332  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.569840908050537  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2934, 64])
m.shape torch.Size([2345, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5709762573242188  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5709762573242188  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2345, 64]), torch.Size([1, 2345, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5720949172973633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.597395896911621  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2345, 64])
m.shape torch.Size([1855, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5986742973327637  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5986742973327637  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 1855, 64]), torch.Size([1, 1855, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5995593070983887  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.625692367553711  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 1855, 64])
m.shape torch.Size([12234, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.640289783477783  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.640289783477783  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 12234, 64]), torch.Size([1, 12234, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6461234092712402  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8573131561279297  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 12234, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8387460708618164  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8421339988708496  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.845521926879883  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8419642448425293  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([22736, 40])
input nodes number: 66597
output nodes number: 22736
edges number: 84861
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.842630386352539  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021224339803059895 |0.0022699832916259766 |0.054198503494262695 |0.0002247492472330729 |0.013739983240763346 |0.0063822269439697266 |
----------------------------------------------------------pseudo_mini_loss sum 1.873809576034546
for loop block_dataloader item  time:  0.8562319278717041
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06711387634277344  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06711387634277344  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([118896, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06711387634277344  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([7272, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16782188415527344  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16782188415527344  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 7272, 128]), torch.Size([1, 7272, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1747570037841797  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.2302379608154297  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 7272, 128])
m.shape torch.Size([92904, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3153705596923828  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3153705596923828  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 92904, 128]), torch.Size([1, 92904, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4052143096923828  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.740530014038086  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 92904, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6494412422180176  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6733250617980957  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6972088813781738  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6725783348083496  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([100176, 64])
input nodes number: 118896
output nodes number: 100176
edges number: 193080
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6980957984924316  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7219796180725098  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7279505729675293  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7279505729675293  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([100176, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7279505729675293  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([5025, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.776970386505127  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.776970386505127  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5025, 64]), torch.Size([1, 5025, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.780041217803955  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8007802963256836  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5025, 64])
m.shape torch.Size([5950, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8025078773498535  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8025078773498535  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5950, 64]), torch.Size([1, 5950, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.806424617767334  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8504624366760254  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5950, 64])
m.shape torch.Size([55708, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8901348114013672  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8901348114013672  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 55708, 64]), torch.Size([1, 55708, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9174785614013672  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.503438949584961  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 55708, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4604339599609375  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.476332664489746  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4922313690185547  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4758358001708984  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([66683, 64])
input nodes number: 100176
output nodes number: 66683
edges number: 184049
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.492979049682617  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.508877754211426  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.513676643371582  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.513676643371582  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([3226, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5369973182678223  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5369973182678223  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 3226, 64]), torch.Size([1, 3226, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5385355949401855  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5523905754089355  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 3226, 64])
m.shape torch.Size([2864, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.553224563598633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.553224563598633  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2864, 64]), torch.Size([1, 2864, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5545902252197266  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5767698287963867  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2864, 64])
m.shape torch.Size([2362, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5784831047058105  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5784831047058105  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2362, 64]), torch.Size([1, 2362, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5796093940734863  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.605114459991455  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2362, 64])
m.shape torch.Size([1840, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.606360912322998  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.606360912322998  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 1840, 64]), torch.Size([1, 1840, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.607238292694092  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6326823234558105  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 1840, 64])
m.shape torch.Size([12441, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.647538185119629  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.647538185119629  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 12441, 64]), torch.Size([1, 12441, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.653470993041992  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8671469688415527  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 12441, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8481359481811523  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8523354530334473  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8557233810424805  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8513541221618652  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([22733, 40])
input nodes number: 66683
output nodes number: 22733
edges number: 85605
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.852832317352295  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02117931842803955 |0.002260744571685791 |0.0539892315864563 |0.00021922588348388672 |0.01370936632156372 |0.006532907485961914 |
----------------------------------------------------------pseudo_mini_loss sum 1.7951245307922363
Total (block generation + training)time/epoch 1.007886290550232
Training time/epoch 0.968822717666626
Training time without block to device /epoch 0.9597797393798828
Training time without total dataloading part /epoch 0.27820420265197754
load block tensor time/epoch 0.0847172737121582
block to device time/epoch 0.009042978286743164
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1140810
Number of first layer input nodes during this epoch:  474579
block dataloader generation time/epoch 1.0331471761067708e-06
for loop block_dataloader item  time:  0.1132056713104248
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06795835494995117  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06795835494995117  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([118953, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06795835494995117  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([7406, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1690535545349121  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1690535545349121  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 7406, 128]), torch.Size([1, 7406, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1761164665222168  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.2326197624206543  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 7406, 128])
m.shape torch.Size([93156, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3179287910461426  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3179287910461426  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 93156, 128]), torch.Size([1, 93156, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4077725410461426  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7437100410461426  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 93156, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6528687477111816  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.676844596862793  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7008204460144043  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6760950088500977  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([100562, 64])
input nodes number: 118953
output nodes number: 100562
edges number: 193718
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7017078399658203  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7256836891174316  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7316780090332031  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7316780090332031  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([100562, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7316780090332031  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([5163, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7810540199279785  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7810540199279785  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5163, 64]), torch.Size([1, 5163, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7840523719787598  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8043885231018066  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5163, 64])
m.shape torch.Size([5998, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8061070442199707  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8061070442199707  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 5998, 64]), torch.Size([1, 5998, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.809950828552246  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8550200462341309  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 5998, 64])
m.shape torch.Size([55753, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.89471435546875  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.89471435546875  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 55753, 64]), torch.Size([1, 55753, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.92205810546875  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.508448600769043  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 55753, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.46561336517334  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.481566905975342  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4975204467773438  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4810681343078613  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

torch.Size([66914, 64])
input nodes number: 100562
output nodes number: 66914
edges number: 184418
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4982709884643555  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5142245292663574  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.518216609954834  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.518216609954834  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

m.shape torch.Size([3328, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5414671897888184  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5414671897888184  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 3328, 64]), torch.Size([1, 3328, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5430541038513184  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.556853771209717  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 3328, 64])
m.shape torch.Size([2913, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.557621479034424  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.557621479034424  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2913, 64]), torch.Size([1, 2913, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5590109825134277  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.581254005432129  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2913, 64])
m.shape torch.Size([2256, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5822343826293945  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5822343826293945  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 2256, 64]), torch.Size([1, 2256, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.583310127258301  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.608429431915283  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 2256, 64])
m.shape torch.Size([1854, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6099209785461426  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6099209785461426  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 1854, 64]), torch.Size([1, 1854, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.610805034637451  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6367859840393066  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

rst.shape  torch.Size([1, 1854, 64])
m.shape torch.Size([12385, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6515698432922363  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6515698432922363  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

 h.shape torch.Size([1, 12385, 64]), torch.Size([1, 12385, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6574759483337402  GigaBytes
Max Memory Allocated: 2.8826169967651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.870321273803711  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 12385, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8515777587890625  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8549656867980957  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.858353614807129  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8547959327697754  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([22736, 40])
input nodes number: 66914
output nodes number: 22736
edges number: 85263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8546528816223145  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021608591079711914 |0.002277374267578125 |0.05384254455566406 |0.0002193450927734375 |0.012993812561035156 |0.006398677825927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.8145846128463745
for loop block_dataloader item  time:  0.3340904712677002
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.0670309066772461  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.0670309066772461  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([118339, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.0670309066772461  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([7479, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16753673553466797  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16753673553466797  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 7479, 128]), torch.Size([1, 7479, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1746692657470703  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23172950744628906  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 7479, 128])
m.shape torch.Size([92145, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3160395622253418  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.3160395622253418  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 92145, 128]), torch.Size([1, 92145, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.4039158821105957  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7220606803894043  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 92145, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6319732666015625  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6557254791259766  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6794776916503906  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6549830436706543  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([99624, 64])
input nodes number: 118339
output nodes number: 99624
edges number: 191769
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6803607940673828  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7041130065917969  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7100510597229004  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7100510597229004  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([99624, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7100510597229004  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([5205, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7586956024169922  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7586956024169922  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 5205, 64]), torch.Size([1, 5205, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7614154815673828  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7838640213012695  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 5205, 64])
m.shape torch.Size([5891, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7847795486450195  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7847795486450195  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 5891, 64]), torch.Size([1, 5891, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.78826904296875  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8352646827697754  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 5891, 64])
m.shape torch.Size([55090, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8746681213378906  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8746681213378906  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 55090, 64]), torch.Size([1, 55090, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.9020118713378906  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4836502075195312  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 55090, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4400553703308105  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4558353424072266  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4716153144836426  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4553418159484863  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([66186, 64])
input nodes number: 99624
output nodes number: 66186
edges number: 182257
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4723587036132812  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4881386756896973  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.492582321166992  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.492582321166992  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([3431, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.51509428024292  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.51509428024292  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 3431, 64]), torch.Size([1, 3431, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.516730785369873  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5312576293945312  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 3431, 64])
m.shape torch.Size([2942, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.532095432281494  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.532095432281494  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 2942, 64]), torch.Size([1, 2942, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5334982872009277  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.555975914001465  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 2942, 64])
m.shape torch.Size([2326, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5571250915527344  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5571250915527344  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 2326, 64]), torch.Size([1, 2326, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.558234214782715  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5835347175598145  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 2326, 64])
m.shape torch.Size([1813, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5850162506103516  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5850162506103516  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 1813, 64]), torch.Size([1, 1813, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.585881233215332  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6122264862060547  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 1813, 64])
m.shape torch.Size([12224, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.626821517944336  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.626821517944336  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 12224, 64]), torch.Size([1, 12224, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.632650375366211  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8429884910583496  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 12224, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8248820304870605  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8282699584960938  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.831657886505127  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8281002044677734  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([22736, 40])
input nodes number: 66186
output nodes number: 22736
edges number: 84665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.828763484954834  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021628856658935547 |0.0022590160369873047 |0.053563833236694336 |0.00021696090698242188 |0.01311492919921875 |0.006260395050048828 |
----------------------------------------------------------pseudo_mini_loss sum 1.7737648487091064
for loop block_dataloader item  time:  0.5548677444458008
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.0670170783996582  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.0670170783996582  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([118721, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.0670170783996582  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([7350, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16764068603515625  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16764068603515625  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 7350, 128]), torch.Size([1, 7350, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1746501922607422  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.2307262420654297  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 7350, 128])
m.shape torch.Size([92743, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31566810607910156  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31566810607910156  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 92743, 128]), torch.Size([1, 92743, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.40551185607910156  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7414493560791016  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 92743, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6497397422790527  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6736040115356445  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6974682807922363  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6728582382202148  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([100093, 64])
input nodes number: 118721
output nodes number: 100093
edges number: 192836
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6983542442321777  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7222185134887695  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.728184700012207  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.728184700012207  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([100093, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.728184700012207  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([5104, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7771039009094238  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7771039009094238  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 5104, 64]), torch.Size([1, 5104, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.78031587600708  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8006315231323242  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 5104, 64])
m.shape torch.Size([6012, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8023710250854492  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8023710250854492  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 6012, 64]), torch.Size([1, 6012, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8068323135375977  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8505887985229492  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 6012, 64])
m.shape torch.Size([55308, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.889951229095459  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.889951229095459  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 55308, 64]), torch.Size([1, 55308, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.917294979095459  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4994406700134277  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 55308, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4572091102600098  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.473045825958252  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.488882541656494  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.472550868988037  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([66424, 64])
input nodes number: 100093
output nodes number: 66424
edges number: 183052
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4896292686462402  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5054659843444824  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.509425163269043  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.509425163269043  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([3312, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5327820777893066  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5327820777893066  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 3312, 64]), torch.Size([1, 3312, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5343613624572754  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5486035346984863  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 3312, 64])
m.shape torch.Size([2981, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5493149757385254  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5493149757385254  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 2981, 64]), torch.Size([1, 2981, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.550736904144287  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5724072456359863  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 2981, 64])
m.shape torch.Size([2389, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.573491096496582  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.573491096496582  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 2389, 64]), torch.Size([1, 2389, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5746307373046875  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.600337028503418  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 2389, 64])
m.shape torch.Size([1808, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6015625  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6015625  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 1808, 64]), torch.Size([1, 1808, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6024246215820312  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.628986358642578  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 1808, 64])
m.shape torch.Size([12246, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6436100006103516  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6436100006103516  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 12246, 64]), torch.Size([1, 12246, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.649449348449707  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.859745979309082  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 12246, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.840761661529541  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.844149589538574  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8475375175476074  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.843979835510254  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([22736, 40])
input nodes number: 66424
output nodes number: 22736
edges number: 84903
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.844644546508789  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021682024002075195 |0.0022579034169514975 |0.053363800048828125 |0.00021560986836751303 |0.013192097345987955 |0.00636601448059082 |
----------------------------------------------------------pseudo_mini_loss sum 1.731476068496704
for loop block_dataloader item  time:  0.8207273483276367
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06705570220947266  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06705570220947266  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([118774, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.06705570220947266  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([7387, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16884136199951172  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.16884136199951172  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 7387, 128]), torch.Size([1, 7387, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.1758861541748047  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.23224449157714844  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 7387, 128])
m.shape torch.Size([92925, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31734228134155273  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.31734228134155273  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 92925, 128]), torch.Size([1, 92925, 128])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 0.40718603134155273  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7431235313415527  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 92925, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6514105796813965  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6753268241882324  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.6992430686950684  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.67457914352417  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([100312, 64])
input nodes number: 118774
output nodes number: 100312
edges number: 193237
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7001290321350098  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7240452766418457  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7300243377685547  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7300243377685547  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([100312, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7300243377685547  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([5146, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.779238224029541  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.779238224029541  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 5146, 64]), torch.Size([1, 5146, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.7823090553283691  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8026161193847656  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 5146, 64])
m.shape torch.Size([5895, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.804288387298584  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.804288387298584  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 5895, 64]), torch.Size([1, 5895, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.8070998191833496  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.85068941116333  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 5895, 64])
m.shape torch.Size([55571, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.890437126159668  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.890437126159668  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 55571, 64]), torch.Size([1, 55571, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 1.917780876159668  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5024356842041016  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 55571, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4600372314453125  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.475918769836426  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.491800308227539  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.4754223823547363  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([66612, 64])
input nodes number: 100312
output nodes number: 66612
edges number: 183649
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.492548942565918  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5084304809570312  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5124011039733887  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5124011039733887  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

m.shape torch.Size([3357, 1, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.535719871520996  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.535719871520996  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 3357, 64]), torch.Size([1, 3357, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.537321090698242  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.551319122314453  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 3357, 64])
m.shape torch.Size([2870, 2, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5522522926330566  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5522522926330566  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 2870, 64]), torch.Size([1, 2870, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5536208152770996  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.575831890106201  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 2870, 64])
m.shape torch.Size([2306, 3, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.576890468597412  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.576890468597412  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 2306, 64]), torch.Size([1, 2306, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.5779900550842285  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6030802726745605  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 2306, 64])
m.shape torch.Size([1845, 4, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6047120094299316  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6047120094299316  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 1845, 64]), torch.Size([1, 1845, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6055922508239746  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.631107807159424  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 1845, 64])
m.shape torch.Size([12355, 5, 64])
----------------------------------------1
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6458568572998047  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6458568572998047  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

 h.shape torch.Size([1, 12355, 64]), torch.Size([1, 12355, 64])
----------------------------------------3
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.6517486572265625  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8644022941589355  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

rst.shape  torch.Size([1, 12355, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.845442771911621  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8488306999206543  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8522186279296875  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.848660945892334  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

torch.Size([22733, 40])
input nodes number: 66612
output nodes number: 22733
edges number: 85170
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.6375732421875 GB
    Memory Allocated: 2.8493270874023438  GigaBytes
Max Memory Allocated: 2.8850855827331543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021706223487854004 |0.002261519432067871 |0.05389046669006348 |0.00021225214004516602 |0.013278365135192871 |0.006501674652099609 |
----------------------------------------------------------pseudo_mini_loss sum 1.6995917558670044
Total (block generation + training)time/epoch 0.9839735825856527
Training time/epoch 0.9360811710357666
Training time without block to device /epoch 0.9270350933074951
Training time without total dataloading part /epoch 0.27602601051330566
load block tensor time/epoch 0.08682489395141602
block to device time/epoch 0.009046077728271484
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1141514
Number of first layer input nodes during this epoch:  474787
