main start at this time 1649564693.5963566
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
for loop block_dataloader item  time:  0.1082615852355957
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1375732421875 GB
    Memory Allocated: 0.048586368560791016  GigaBytes
Max Memory Allocated: 0.048586368560791016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1375732421875 GB
    Memory Allocated: 0.048586368560791016  GigaBytes
Max Memory Allocated: 0.048586368560791016  GigaBytes

torch.Size([95331, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1375732421875 GB
    Memory Allocated: 0.048586368560791016  GigaBytes
Max Memory Allocated: 0.048586368560791016  GigaBytes

m.shape torch.Size([4310, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.3309326171875 GB
    Memory Allocated: 0.12102985382080078  GigaBytes
Max Memory Allocated: 0.1210784912109375  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3309326171875 GB
    Memory Allocated: 0.12102985382080078  GigaBytes
Max Memory Allocated: 0.1210784912109375  GigaBytes

 h.shape torch.Size([1, 4310, 128]), torch.Size([1, 4310, 128])
----------------------------------------3
 Nvidia-smi: 2.3309326171875 GB
    Memory Allocated: 0.12514019012451172  GigaBytes
Max Memory Allocated: 0.12514019012451172  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3699951171875 GB
    Memory Allocated: 0.15802288055419922  GigaBytes
Max Memory Allocated: 0.1600780487060547  GigaBytes

rst.shape  torch.Size([1, 4310, 128])
m.shape torch.Size([67743, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.4403076171875 GB
    Memory Allocated: 0.22057247161865234  GigaBytes
Max Memory Allocated: 0.22211217880249023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4403076171875 GB
    Memory Allocated: 0.22057247161865234  GigaBytes
Max Memory Allocated: 0.22211217880249023  GigaBytes

 h.shape torch.Size([1, 67743, 128]), torch.Size([1, 67743, 128])
----------------------------------------3
 Nvidia-smi: 2.5067138671875 GB
    Memory Allocated: 0.28697872161865234  GigaBytes
Max Memory Allocated: 0.28697872161865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5574951171875 GB
    Memory Allocated: 1.2614545822143555  GigaBytes
Max Memory Allocated: 1.326059341430664  GigaBytes

rst.shape  torch.Size([1, 67743, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.1945033073425293  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2116823196411133  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2288613319396973  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2111454010009766  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

torch.Size([72053, 64])
input nodes number: 95331
output nodes number: 72053
edges number: 139796
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2295727729797363  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2467517852783203  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2510466575622559  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2510466575622559  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

torch.Size([72053, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2510466575622559  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

m.shape torch.Size([2676, 1, 64])
----------------------------------------1
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2805571556091309  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2805571556091309  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

 h.shape torch.Size([1, 2676, 64]), torch.Size([1, 2676, 64])
----------------------------------------3
 Nvidia-smi: 3.6278076171875 GB
    Memory Allocated: 1.2818331718444824  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6317138671875 GB
    Memory Allocated: 1.292579174041748  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

rst.shape  torch.Size([1, 2676, 64])
m.shape torch.Size([3225, 2, 64])
----------------------------------------1
 Nvidia-smi: 3.6317138671875 GB
    Memory Allocated: 1.2936391830444336  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6317138671875 GB
    Memory Allocated: 1.2936391830444336  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

 h.shape torch.Size([1, 3225, 64]), torch.Size([1, 3225, 64])
----------------------------------------3
 Nvidia-smi: 3.6336669921875 GB
    Memory Allocated: 1.2951774597167969  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6395263671875 GB
    Memory Allocated: 1.3186922073364258  GigaBytes
Max Memory Allocated: 1.3336944580078125  GigaBytes

rst.shape  torch.Size([1, 3225, 64])
m.shape torch.Size([34050, 3, 64])
----------------------------------------1
 Nvidia-smi: 3.6395263671875 GB
    Memory Allocated: 1.3430390357971191  GigaBytes
Max Memory Allocated: 1.3434200286865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6395263671875 GB
    Memory Allocated: 1.3430390357971191  GigaBytes
Max Memory Allocated: 1.3434200286865234  GigaBytes

 h.shape torch.Size([1, 34050, 64]), torch.Size([1, 34050, 64])
----------------------------------------3
 Nvidia-smi: 3.6395263671875 GB
    Memory Allocated: 1.3592753410339355  GigaBytes
Max Memory Allocated: 1.3592753410339355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7232608795166016  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

rst.shape  torch.Size([1, 34050, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.6973905563354492  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7069158554077148  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7169218063354492  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7070984840393066  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

torch.Size([39951, 64])
input nodes number: 72053
output nodes number: 39951
edges number: 111276
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7174596786499023  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.726984977722168  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7302799224853516  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7302799224853516  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

m.shape torch.Size([1654, 1, 64])
----------------------------------------1
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7415528297424316  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7415528297424316  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

 h.shape torch.Size([1, 1654, 64]), torch.Size([1, 1654, 64])
----------------------------------------3
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7423415184020996  GigaBytes
Max Memory Allocated: 1.7476153373718262  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.748868465423584  GigaBytes
Max Memory Allocated: 1.749262809753418  GigaBytes

rst.shape  torch.Size([1, 1654, 64])
m.shape torch.Size([1503, 2, 64])
----------------------------------------1
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7492132186889648  GigaBytes
Max Memory Allocated: 1.749262809753418  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7492132186889648  GigaBytes
Max Memory Allocated: 1.749262809753418  GigaBytes

 h.shape torch.Size([1, 1503, 64]), torch.Size([1, 1503, 64])
----------------------------------------3
 Nvidia-smi: 3.9891357421875 GB
    Memory Allocated: 1.7499303817749023  GigaBytes
Max Memory Allocated: 1.7499303817749023  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9930419921875 GB
    Memory Allocated: 1.7631778717041016  GigaBytes
Max Memory Allocated: 1.7638945579528809  GigaBytes

rst.shape  torch.Size([1, 1503, 64])
m.shape torch.Size([1171, 3, 64])
----------------------------------------1
 Nvidia-smi: 3.9930419921875 GB
    Memory Allocated: 1.7636833190917969  GigaBytes
Max Memory Allocated: 1.7638945579528809  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9930419921875 GB
    Memory Allocated: 1.7636833190917969  GigaBytes
Max Memory Allocated: 1.7638945579528809  GigaBytes

 h.shape torch.Size([1, 1171, 64]), torch.Size([1, 1171, 64])
----------------------------------------3
 Nvidia-smi: 3.9930419921875 GB
    Memory Allocated: 1.764242172241211  GigaBytes
Max Memory Allocated: 1.764242172241211  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9949951171875 GB
    Memory Allocated: 1.7771244049072266  GigaBytes
Max Memory Allocated: 1.7779622077941895  GigaBytes

rst.shape  torch.Size([1, 1171, 64])
m.shape torch.Size([918, 4, 64])
----------------------------------------1
 Nvidia-smi: 3.9949951171875 GB
    Memory Allocated: 1.7777481079101562  GigaBytes
Max Memory Allocated: 1.7779622077941895  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9949951171875 GB
    Memory Allocated: 1.7777481079101562  GigaBytes
Max Memory Allocated: 1.7779622077941895  GigaBytes

 h.shape torch.Size([1, 918, 64]), torch.Size([1, 918, 64])
----------------------------------------3
 Nvidia-smi: 3.9949951171875 GB
    Memory Allocated: 1.7781858444213867  GigaBytes
Max Memory Allocated: 1.7781858444213867  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0106201171875 GB
    Memory Allocated: 1.7908802032470703  GigaBytes
Max Memory Allocated: 1.7917556762695312  GigaBytes

rst.shape  torch.Size([1, 918, 64])
m.shape torch.Size([6122, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.0106201171875 GB
    Memory Allocated: 1.7987957000732422  GigaBytes
Max Memory Allocated: 1.798910140991211  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0106201171875 GB
    Memory Allocated: 1.7987957000732422  GigaBytes
Max Memory Allocated: 1.798910140991211  GigaBytes

 h.shape torch.Size([1, 6122, 64]), torch.Size([1, 6122, 64])
----------------------------------------3
 Nvidia-smi: 4.0106201171875 GB
    Memory Allocated: 1.8017148971557617  GigaBytes
Max Memory Allocated: 1.8017148971557617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1278076171875 GB
    Memory Allocated: 1.9099812507629395  GigaBytes
Max Memory Allocated: 1.9172792434692383  GigaBytes

rst.shape  torch.Size([1, 6122, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1278076171875 GB
    Memory Allocated: 1.9016594886779785  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1278076171875 GB
    Memory Allocated: 1.9033536911010742  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1278076171875 GB
    Memory Allocated: 1.90504789352417  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.1278076171875 GB
    Memory Allocated: 1.903268814086914  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([11368, 40])
input nodes number: 39951
output nodes number: 11368
edges number: 42455
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.1278076171875 GB
    Memory Allocated: 1.9053459167480469  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04472017288208008 |0.36846065521240234 |0.5379936695098877 |0.0001990795135498047 |0.018485307693481445 |0.007745981216430664 |
----------------------------------------------------------pseudo_mini_loss sum 4.9738450050354
for loop block_dataloader item  time:  1.1702191829681396
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.052710533142089844  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.052710533142089844  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([95082, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.052710533142089844  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

m.shape torch.Size([4504, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.12499666213989258  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.12499666213989258  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 4504, 128]), torch.Size([1, 4504, 128])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.12929201126098633  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.16451263427734375  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 4504, 128])
m.shape torch.Size([67393, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.22663593292236328  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.22663593292236328  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 67393, 128]), torch.Size([1, 67393, 128])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 0.2909069061279297  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2549715042114258  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 67393, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.1911053657531738  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.208247184753418  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.225389003753662  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2077112197875977  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([71897, 64])
input nodes number: 95082
output nodes number: 71897
edges number: 139290
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2260985374450684  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2432403564453125  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2475261688232422  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2475261688232422  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([71897, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2475261688232422  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

m.shape torch.Size([2794, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2769198417663574  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2769198417663574  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 2794, 64]), torch.Size([1, 2794, 64])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.278252124786377  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2889103889465332  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 2794, 64])
m.shape torch.Size([3225, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2904276847839355  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2904276847839355  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 3225, 64]), torch.Size([1, 3225, 64])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.2919659614562988  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.3153128623962402  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 3225, 64])
m.shape torch.Size([33820, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.3394899368286133  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.3394899368286133  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 33820, 64]), torch.Size([1, 33820, 64])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.355616569519043  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7199010848999023  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 33820, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.6932477951049805  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7032804489135742  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7127790451049805  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7024493217468262  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([39839, 64])
input nodes number: 71897
output nodes number: 39839
edges number: 110704
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7133159637451172  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7228145599365234  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7252039909362793  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7252039909362793  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

m.shape torch.Size([1739, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.736464500427246  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.736464500427246  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 1739, 64]), torch.Size([1, 1739, 64])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7372941970825195  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7456588745117188  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 1739, 64])
m.shape torch.Size([1433, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7459487915039062  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7459487915039062  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 1433, 64]), torch.Size([1, 1433, 64])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7466325759887695  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7608137130737305  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 1433, 64])
m.shape torch.Size([1185, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7613463401794434  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7613463401794434  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 1185, 64]), torch.Size([1, 1185, 64])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7619118690490723  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7746882438659668  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 1185, 64])
m.shape torch.Size([904, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7752947807312012  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7752947807312012  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 904, 64]), torch.Size([1, 904, 64])
----------------------------------------3
 Nvidia-smi: 4.3289794921875 GB
    Memory Allocated: 1.7757258415222168  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.78822660446167  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 904, 64])
m.shape torch.Size([6107, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7955193519592285  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7955193519592285  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 6107, 64]), torch.Size([1, 6107, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7992501258850098  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.9066166877746582  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 6107, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.8981709480285645  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.8998651504516602  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.9015593528747559  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.8997802734375  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([11368, 40])
input nodes number: 39839
output nodes number: 11368
edges number: 42311
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.9001622200012207  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03136885166168213 |0.18497729301452637 |0.29218459129333496 |0.0002046823501586914 |0.015801191329956055 |0.006163597106933594 |
----------------------------------------------------------pseudo_mini_loss sum 3.992844581604004
for loop block_dataloader item  time:  1.4315423965454102
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.05270671844482422  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.05270671844482422  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([95062, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.05270671844482422  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

m.shape torch.Size([4327, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.12502241134643555  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.12502241134643555  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 4327, 128]), torch.Size([1, 4327, 128])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.1291489601135254  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.16312313079833984  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 4327, 128])
m.shape torch.Size([67599, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.22552728652954102  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.22552728652954102  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 67599, 128]), torch.Size([1, 67599, 128])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.291933536529541  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2647614479064941  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 67599, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.1987323760986328  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.216200351715088  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2333488464355469  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2153449058532715  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([71926, 64])
input nodes number: 95062
output nodes number: 71926
edges number: 139525
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2340583801269531  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.251206874847412  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2554941177368164  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2554941177368164  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([71926, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2554941177368164  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

m.shape torch.Size([2693, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2849164009094238  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2849164009094238  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 2693, 64]), torch.Size([1, 2693, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.286201000213623  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2964749336242676  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 2693, 64])
m.shape torch.Size([3148, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2974004745483398  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2974004745483398  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 3148, 64]), torch.Size([1, 3148, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2989015579223633  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.322084903717041  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 3148, 64])
m.shape torch.Size([33976, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.346395492553711  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.346395492553711  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 33976, 64]), torch.Size([1, 33976, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.3625965118408203  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.727029800415039  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 33976, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7004318237304688  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7104697227478027  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7199630737304688  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7096281051635742  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

torch.Size([39817, 64])
input nodes number: 71926
output nodes number: 39817
edges number: 110917
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7204999923706055  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7299933433532715  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7323760986328125  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7323760986328125  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

m.shape torch.Size([1687, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7436761856079102  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7436761856079102  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 1687, 64]), torch.Size([1, 1687, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.744481086730957  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7515106201171875  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 1687, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7518367767333984  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7518367767333984  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 1481, 64]), torch.Size([1, 1481, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7525434494018555  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7658319473266602  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 1481, 64])
m.shape torch.Size([1108, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7662959098815918  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7662959098815918  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 1108, 64]), torch.Size([1, 1108, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7668242454528809  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7800273895263672  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 1108, 64])
m.shape torch.Size([909, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7806572914123535  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7806572914123535  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 909, 64]), torch.Size([1, 909, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7810912132263184  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.793663501739502  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

rst.shape  torch.Size([1, 909, 64])
m.shape torch.Size([6183, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.8010482788085938  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.8010482788085938  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

 h.shape torch.Size([1, 6183, 64]), torch.Size([1, 6183, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.8047962188720703  GigaBytes
Max Memory Allocated: 1.9175052642822266  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.911618709564209  GigaBytes
Max Memory Allocated: 1.918989658355713  GigaBytes

rst.shape  torch.Size([1, 6183, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.9032130241394043  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.9049072265625  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.9066014289855957  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.9048223495483398  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([11368, 40])
input nodes number: 39817
output nodes number: 11368
edges number: 42524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.9052042961120605  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02693653106689453 |0.12382793426513672 |0.2101754347483317 |0.00020106633504231772 |0.014812469482421875 |0.00644993782043457 |
----------------------------------------------------------pseudo_mini_loss sum 3.2771527767181396
for loop block_dataloader item  time:  1.5945703983306885
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.05262613296508789  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.05262613296508789  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([94903, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.05262613296508789  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

m.shape torch.Size([4280, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.124786376953125  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.124786376953125  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 4280, 128]), torch.Size([1, 4280, 128])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.12886810302734375  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.16152191162109375  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 4280, 128])
m.shape torch.Size([67487, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.22384166717529297  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.22384166717529297  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 67487, 128]), torch.Size([1, 67487, 128])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 0.28820228576660156  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2536115646362305  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 67487, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.1897783279418945  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2072687149047852  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.224379539489746  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2063541412353516  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([71767, 64])
input nodes number: 94903
output nodes number: 71767
edges number: 139254
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2250876426696777  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2421984672546387  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.246476173400879  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.246476173400879  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([71767, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.246476173400879  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

m.shape torch.Size([2673, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2758917808532715  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2758917808532715  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 2673, 64]), torch.Size([1, 2673, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2771668434143066  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.2873644828796387  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 2673, 64])
m.shape torch.Size([3250, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.28834867477417  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.28834867477417  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 3250, 64]), torch.Size([1, 3250, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.28989839553833  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.3131442070007324  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 3250, 64])
m.shape torch.Size([33915, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.337385654449463  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.337385654449463  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 33915, 64]), torch.Size([1, 33915, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.35355806350708  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7179346084594727  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 33915, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.6912989616394043  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7013320922851562  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7108302116394043  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7005000114440918  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([39838, 64])
input nodes number: 71767
output nodes number: 39838
edges number: 110918
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7113661766052246  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7208642959594727  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7232847213745117  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7232847213745117  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

m.shape torch.Size([1694, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7345447540283203  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7345447540283203  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 1694, 64]), torch.Size([1, 1694, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7353525161743164  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.742743968963623  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 1694, 64])
m.shape torch.Size([1471, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7430634498596191  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7430634498596191  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 1471, 64]), torch.Size([1, 1471, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7437653541564941  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7580113410949707  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 1471, 64])
m.shape torch.Size([1172, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7585248947143555  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7585248947143555  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 1172, 64]), torch.Size([1, 1172, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7590837478637695  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7724719047546387  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 1172, 64])
m.shape torch.Size([946, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7731232643127441  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7731232643127441  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 946, 64]), torch.Size([1, 946, 64])
----------------------------------------3
 Nvidia-smi: 4.3309326171875 GB
    Memory Allocated: 1.7735743522644043  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7866559028625488  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 946, 64])
m.shape torch.Size([6085, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7939114570617676  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7939114570617676  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 6085, 64]), torch.Size([1, 6085, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7976036071777344  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9042067527770996  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 6085, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.8957242965698242  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.89741849899292  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.8991127014160156  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.8973336219787598  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([11368, 40])
input nodes number: 39838
output nodes number: 11368
edges number: 42361
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.8977155685424805  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024447739124298096 |0.0932474136352539 |0.1691715121269226 |0.00020396709442138672 |0.014425277709960938 |0.006300687789916992 |
----------------------------------------------------------pseudo_mini_loss sum 2.8827290534973145
for loop block_dataloader item  time:  1.7501847743988037
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05268239974975586  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05268239974975586  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([94995, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05268239974975586  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

m.shape torch.Size([4272, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.1250762939453125  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.1250762939453125  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 4272, 128]), torch.Size([1, 4272, 128])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.129150390625  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.1617431640625  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 4272, 128])
m.shape torch.Size([67731, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.22429943084716797  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.22429943084716797  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 67731, 128]), torch.Size([1, 67731, 128])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.29070568084716797  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2650442123413086  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 67731, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.1989402770996094  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2164344787597656  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2336015701293945  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2155704498291016  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([72003, 64])
input nodes number: 94995
output nodes number: 72003
edges number: 139734
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2343106269836426  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2514777183532715  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2557697296142578  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2557697296142578  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([72003, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2557697296142578  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

m.shape torch.Size([2632, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2853374481201172  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2853374481201172  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 2632, 64]), torch.Size([1, 2632, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2865924835205078  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2966327667236328  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 2632, 64])
m.shape torch.Size([3199, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.297630786895752  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.297630786895752  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 3199, 64]), torch.Size([1, 3199, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.299156665802002  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.3225650787353516  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 3199, 64])
m.shape torch.Size([34174, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.347956657409668  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.347956657409668  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 34174, 64]), torch.Size([1, 34174, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.3642520904541016  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7288742065429688  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 34174, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7023100852966309  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7123031616210938  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7218413352966309  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7115497589111328  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

torch.Size([40005, 64])
input nodes number: 72003
output nodes number: 40005
edges number: 111552
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.722379207611084  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.731917381286621  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7351531982421875  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7351531982421875  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

m.shape torch.Size([1651, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7465100288391113  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7465100288391113  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 1651, 64]), torch.Size([1, 1651, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.747297763824463  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7537355422973633  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 1651, 64])
m.shape torch.Size([1397, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7540287971496582  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7540287971496582  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 1397, 64]), torch.Size([1, 1397, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7546954154968262  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7668719291687012  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 1397, 64])
m.shape torch.Size([1144, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7673826217651367  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7673826217651367  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 1144, 64]), torch.Size([1, 1144, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.767928123474121  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7813715934753418  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 1144, 64])
m.shape torch.Size([953, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.782036304473877  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.782036304473877  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 953, 64]), torch.Size([1, 953, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7824912071228027  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7956719398498535  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

rst.shape  torch.Size([1, 953, 64])
m.shape torch.Size([6223, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.8030953407287598  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.8030953407287598  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

 h.shape torch.Size([1, 6223, 64]), torch.Size([1, 6223, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.8063311576843262  GigaBytes
Max Memory Allocated: 1.919076919555664  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.914125919342041  GigaBytes
Max Memory Allocated: 1.9215445518493652  GigaBytes

rst.shape  torch.Size([1, 6223, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9057040214538574  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9073982238769531  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9090924263000488  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.907313346862793  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([11368, 40])
input nodes number: 40005
output nodes number: 11368
edges number: 42804
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9076967239379883  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02293224334716797 |0.07492375373840332 |0.14451518058776855 |0.00020403861999511718 |0.014720392227172852 |0.0064737796783447266 |
----------------------------------------------------------pseudo_mini_loss sum 2.663259744644165
for loop block_dataloader item  time:  1.9070634841918945
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05277204513549805  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05277204513549805  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([95193, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05277204513549805  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

m.shape torch.Size([4268, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.12506580352783203  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.12506580352783203  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 4268, 128]), torch.Size([1, 4268, 128])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.1291360855102539  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.16170549392700195  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 4268, 128])
m.shape torch.Size([67636, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.22417306900024414  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.22417306900024414  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 67636, 128]), torch.Size([1, 67636, 128])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.29057931900024414  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2638306617736816  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 67636, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.1978235244750977  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2149667739868164  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2321100234985352  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.214430809020996  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([71904, 64])
input nodes number: 95193
output nodes number: 71904
edges number: 139540
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2328205108642578  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2499637603759766  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2542495727539062  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2542495727539062  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([71904, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2542495727539062  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

m.shape torch.Size([2608, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2837395668029785  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2837395668029785  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 2608, 64]), torch.Size([1, 2608, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2849831581115723  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2949318885803223  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 2608, 64])
m.shape torch.Size([3242, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2959074974060059  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2959074974060059  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 3242, 64]), torch.Size([1, 3242, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.2974534034729004  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.321033000946045  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 3242, 64])
m.shape torch.Size([34060, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.3453831672668457  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.3453831672668457  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 34060, 64]), torch.Size([1, 34060, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.3616242408752441  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.726137638092041  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 34060, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.6995363235473633  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.70955228805542  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7190675735473633  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.708754062652588  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([39910, 64])
input nodes number: 71904
output nodes number: 39910
edges number: 111272
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7196044921875  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7291197776794434  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7315077781677246  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7315077781677246  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

m.shape torch.Size([1633, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7427868843078613  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7427868843078613  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 1633, 64]), torch.Size([1, 1633, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7435660362243652  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7505316734313965  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 1633, 64])
m.shape torch.Size([1525, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.750892162322998  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.750892162322998  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 1525, 64]), torch.Size([1, 1525, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.751619815826416  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.765106201171875  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 1525, 64])
m.shape torch.Size([1169, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7656049728393555  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7656049728393555  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 1169, 64]), torch.Size([1, 1169, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7661628723144531  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.779008388519287  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 1169, 64])
m.shape torch.Size([897, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7796120643615723  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7796120643615723  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 897, 64]), torch.Size([1, 897, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7800402641296387  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7924466133117676  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 897, 64])
m.shape torch.Size([6144, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7997856140136719  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.7997856140136719  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 6144, 64]), torch.Size([1, 6144, 64])
----------------------------------------3
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.8034257888793945  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9119648933410645  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 6144, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.903520107269287  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9052143096923828  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9069085121154785  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9051294326782227  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([11368, 40])
input nodes number: 39910
output nodes number: 11368
edges number: 42498
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 1.9055118560791016  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021934111913045246 |0.06269911924997966 |0.1280998388926188 |0.00020734469095865885 |0.014441609382629395 |0.003528594970703125 |
----------------------------------------------------------pseudo_mini_loss sum 2.509206533432007
for loop block_dataloader item  time:  2.057004928588867
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05294609069824219  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05294609069824219  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([95542, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3328857421875 GB
    Memory Allocated: 0.05294609069824219  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

m.shape torch.Size([4385, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12561368942260742  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12561368942260742  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 4385, 128]), torch.Size([1, 4385, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12979555130004883  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16396331787109375  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 4385, 128])
m.shape torch.Size([67891, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22661828994750977  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22661828994750977  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 67891, 128]), torch.Size([1, 67891, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.29302453994750977  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2691941261291504  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 67891, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2028250694274902  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2202653884887695  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.237497329711914  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2195181846618652  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([72276, 64])
input nodes number: 95542
output nodes number: 72276
edges number: 140167
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2382102012634277  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2554421424865723  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2597503662109375  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2597503662109375  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([72276, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2597503662109375  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

m.shape torch.Size([2689, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2893519401550293  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2893519401550293  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 2689, 64]), torch.Size([1, 2689, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2906346321105957  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3008933067321777  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 2689, 64])
m.shape torch.Size([3152, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.30195951461792  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.30195951461792  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 3152, 64]), torch.Size([1, 3152, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3034625053405762  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3266420364379883  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 3152, 64])
m.shape torch.Size([34208, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.352046012878418  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.352046012878418  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 34208, 64]), torch.Size([1, 34208, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3683576583862305  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7330121994018555  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 34208, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7064642906188965  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.716446876525879  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7259955406188965  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.715714454650879  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

torch.Size([40049, 64])
input nodes number: 72276
output nodes number: 40049
edges number: 111617
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7265353202819824  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.736083984375  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7393035888671875  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7393035888671875  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

m.shape torch.Size([1684, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7506074905395508  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7506074905395508  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 1684, 64]), torch.Size([1, 1684, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7514104843139648  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.759462833404541  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 1684, 64])
m.shape torch.Size([1435, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7597670555114746  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7597670555114746  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 1435, 64]), torch.Size([1, 1435, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7604517936706543  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7717761993408203  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 1435, 64])
m.shape torch.Size([1170, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7722969055175781  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7722969055175781  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 1170, 64]), torch.Size([1, 1170, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7728548049926758  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7871942520141602  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 1170, 64])
m.shape torch.Size([918, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.787818431854248  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.787818431854248  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 918, 64]), torch.Size([1, 918, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7882561683654785  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.800950527191162  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

rst.shape  torch.Size([1, 918, 64])
m.shape torch.Size([6161, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8083062171936035  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8083062171936035  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

 h.shape torch.Size([1, 6161, 64]), torch.Size([1, 6161, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8114948272705078  GigaBytes
Max Memory Allocated: 1.921633243560791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9183855056762695  GigaBytes
Max Memory Allocated: 1.9257302284240723  GigaBytes

rst.shape  torch.Size([1, 6161, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9099493026733398  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9116435050964355  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9133377075195312  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9115586280822754  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([11368, 40])
input nodes number: 40049
output nodes number: 11368
edges number: 42541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9119420051574707  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021249192101614817 |0.0539679867880685 |0.11685936791556222 |0.00020956993103027344 |0.014366899217878069 |0.0062580108642578125 |
----------------------------------------------------------pseudo_mini_loss sum 2.3802895545959473
for loop block_dataloader item  time:  2.222303867340088
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05286073684692383  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05286073684692383  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([95373, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05286073684692383  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([4270, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12533187866210938  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 4270, 128]), torch.Size([1, 4270, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12940406799316406  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16199302673339844  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 4270, 128])
m.shape torch.Size([67810, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2246255874633789  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2246255874633789  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 67810, 128]), torch.Size([1, 67810, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2910318374633789  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2662744522094727  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 67810, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2000956535339355  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2172808647155762  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2344660758972168  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2167434692382812  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([72080, 64])
input nodes number: 95373
output nodes number: 72080
edges number: 139890
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.235177993774414  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2523632049560547  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2566595077514648  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2566595077514648  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([72080, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2566595077514648  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([2685, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2862119674682617  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2862119674682617  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 2685, 64]), torch.Size([1, 2685, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2874927520751953  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2977361679077148  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 2685, 64])
m.shape torch.Size([3218, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2986807823181152  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2986807823181152  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 3218, 64]), torch.Size([1, 3218, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.300215244293213  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3236308097839355  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 3218, 64])
m.shape torch.Size([34105, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.348020076751709  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.348020076751709  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 34105, 64]), torch.Size([1, 34105, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3642830848693848  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7288408279418945  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 34105, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7022547721862793  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.712247371673584  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7217860221862793  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7114949226379395  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([40008, 64])
input nodes number: 72080
output nodes number: 40008
edges number: 111436
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7223243713378906  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.731863021850586  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7351312637329102  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7351312637329102  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([1686, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7464261054992676  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7464261054992676  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1686, 64]), torch.Size([1, 1686, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.747230052947998  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7547826766967773  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1686, 64])
m.shape torch.Size([1461, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7550992965698242  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7550992965698242  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1461, 64]), torch.Size([1, 1461, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7557964324951172  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7670116424560547  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1461, 64])
m.shape torch.Size([1158, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7675175666809082  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7675175666809082  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1158, 64]), torch.Size([1, 1158, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7680697441101074  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.781163215637207  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1158, 64])
m.shape torch.Size([875, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.781747817993164  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.781747817993164  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 875, 64]), torch.Size([1, 875, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.78216552734375  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7942676544189453  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 875, 64])
m.shape torch.Size([6185, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8016629219055176  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8016629219055176  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 6185, 64]), torch.Size([1, 6185, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8049311637878418  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.91351318359375  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 6185, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.905116081237793  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9068098068237305  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.908503532409668  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9067249298095703  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([11365, 40])
input nodes number: 40008
output nodes number: 11365
edges number: 42507
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9071078300476074  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020802021026611328 |0.04742026329040527 |0.1080659031867981 |0.00020906329154968262 |0.014264076948165894 |0.006377696990966797 |
----------------------------------------------------------pseudo_mini_loss sum 2.307267427444458
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1656804
Number of first layer input nodes during this epoch:  761481
for loop block_dataloader item  time:  0.12291717529296875
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052805423736572266  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052805423736572266  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([95262, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052805423736572266  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([4333, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12524890899658203  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12524890899658203  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 4333, 128]), torch.Size([1, 4333, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1293811798095703  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1633753776550293  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 4333, 128])
m.shape torch.Size([67721, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2258930206298828  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2258930206298828  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 67721, 128]), torch.Size([1, 67721, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2922992706298828  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2665233612060547  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 67721, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2003698348999023  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2175488471984863  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2347278594970703  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2170119285583496  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([72054, 64])
input nodes number: 95262
output nodes number: 72054
edges number: 139775
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2354388236999512  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2526178359985352  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2569127082824707  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2569127082824707  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([72054, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2569127082824707  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([2679, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.286405086517334  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.286405086517334  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 2679, 64]), torch.Size([1, 2679, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2876830101013184  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2979035377502441  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 2679, 64])
m.shape torch.Size([3308, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.298893928527832  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.298893928527832  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 3308, 64]), torch.Size([1, 3308, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.300471305847168  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.324131965637207  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 3308, 64])
m.shape torch.Size([33970, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3484001159667969  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3484001159667969  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 33970, 64]), torch.Size([1, 33970, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.364598274230957  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7290258407592773  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 33970, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7028651237487793  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7123918533325195  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7219185829162598  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7120938301086426  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([39957, 64])
input nodes number: 72054
output nodes number: 39957
edges number: 111205
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.722456455230713  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7319831848144531  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.735316276550293  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.735316276550293  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([1615, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.746633529663086  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.746633529663086  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1615, 64]), torch.Size([1, 1615, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7474040985107422  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7540206909179688  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1615, 64])
m.shape torch.Size([1499, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7543725967407227  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7543725967407227  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1499, 64]), torch.Size([1, 1499, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7550878524780273  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7670140266418457  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1499, 64])
m.shape torch.Size([1159, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7675118446350098  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7675118446350098  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1159, 64]), torch.Size([1, 1159, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7680649757385254  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7816071510314941  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1159, 64])
m.shape torch.Size([899, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7822151184082031  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7822151184082031  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 899, 64]), torch.Size([1, 899, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.782644271850586  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7950782775878906  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 899, 64])
m.shape torch.Size([6196, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8025550842285156  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8025550842285156  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 6196, 64]), torch.Size([1, 6196, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.806260108947754  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.915766716003418  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 6196, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9066100120544434  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.908304214477539  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9107441902160645  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9089651107788086  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([11368, 40])
input nodes number: 39957
output nodes number: 11368
edges number: 42666
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.909348487854004  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.020064353942871094 |0.0015141963958740234 |0.046148061752319336 |0.00020575523376464844 |0.013639450073242188 |0.006375551223754883 |
----------------------------------------------------------pseudo_mini_loss sum 2.2202651500701904
for loop block_dataloader item  time:  0.2855823040008545
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05260038375854492  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05260038375854492  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([94861, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05260038375854492  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([4347, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12515020370483398  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12515020370483398  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 4347, 128]), torch.Size([1, 4347, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12929582595825195  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16421270370483398  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 4347, 128])
m.shape torch.Size([67263, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22541093826293945  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22541093826293945  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 67263, 128]), torch.Size([1, 67263, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.28955793380737305  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.251762866973877  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 67263, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.1860947608947754  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2031679153442383  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2202410697937012  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.202634334564209  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([71610, 64])
input nodes number: 94861
output nodes number: 71610
edges number: 138873
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2209491729736328  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2380223274230957  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2430438995361328  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2430438995361328  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([71610, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2430438995361328  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([2709, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2723817825317383  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2723817825317383  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 2709, 64]), torch.Size([1, 2709, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2736740112304688  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2840089797973633  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 2709, 64])
m.shape torch.Size([3222, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2850399017333984  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2850399017333984  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 3222, 64]), torch.Size([1, 3222, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.286576271057129  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3105487823486328  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 3222, 64])
m.shape torch.Size([33807, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3347172737121582  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3347172737121582  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 33807, 64]), torch.Size([1, 33807, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3508381843566895  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7151117324829102  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 33807, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.6884565353393555  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.6985135078430176  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7079877853393555  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.6976346969604492  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([39738, 64])
input nodes number: 71610
output nodes number: 39738
edges number: 110574
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7085223197937012  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7185792922973633  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7204546928405762  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7204546928405762  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([1697, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7317028045654297  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7317028045654297  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1697, 64]), torch.Size([1, 1697, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7325124740600586  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7404565811157227  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1697, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7407803535461426  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7407803535461426  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1481, 64]), torch.Size([1, 1481, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7414870262145996  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.752281665802002  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1481, 64])
m.shape torch.Size([1203, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7528162002563477  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7528162002563477  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1203, 64]), torch.Size([1, 1203, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7533903121948242  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7666335105895996  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1203, 64])
m.shape torch.Size([900, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7672319412231445  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7672319412231445  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 900, 64]), torch.Size([1, 900, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7676610946655273  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.780106544494629  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 900, 64])
m.shape torch.Size([6087, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7873754501342773  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7873754501342773  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 6087, 64]), torch.Size([1, 6087, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.790278434753418  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.896533489227295  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 6087, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.887505054473877  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8891992568969727  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8908934593200684  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8891143798828125  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([11368, 40])
input nodes number: 39738
output nodes number: 11368
edges number: 42303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8894953727722168  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018519878387451172 |0.001542806625366211 |0.04603755474090576 |0.00020802021026611328 |0.013624310493469238 |0.006242036819458008 |
----------------------------------------------------------pseudo_mini_loss sum 2.1650872230529785
for loop block_dataloader item  time:  0.4383251667022705
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.0531001091003418  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.0531001091003418  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([95859, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.0531001091003418  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([4252, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12585020065307617  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12585020065307617  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 4252, 128]), torch.Size([1, 4252, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12990522384643555  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16234540939331055  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 4252, 128])
m.shape torch.Size([68104, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2252669334411621  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2252669334411621  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 68104, 128]), torch.Size([1, 68104, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2916731834411621  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.276048183441162  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 68104, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2095999717712402  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.226850986480713  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2441020011901855  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2263116836547852  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([72356, 64])
input nodes number: 95859
output nodes number: 72356
edges number: 140460
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2448172569274902  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.262068271636963  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2663812637329102  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2663812637329102  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([72356, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2663812637329102  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([2619, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2960128784179688  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2960128784179688  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 2619, 64]), torch.Size([1, 2619, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.297262191772461  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3072538375854492  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 2619, 64])
m.shape torch.Size([3155, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3082261085510254  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3082261085510254  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 3155, 64]), torch.Size([1, 3155, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3097310066223145  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.332298755645752  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 3155, 64])
m.shape torch.Size([34294, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.357703685760498  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.357703685760498  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 34294, 64]), torch.Size([1, 34294, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.374056339263916  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.738792896270752  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 34294, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7126903533935547  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.722243309020996  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7317962646484375  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7219443321228027  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

torch.Size([40068, 64])
input nodes number: 72356
output nodes number: 40068
edges number: 111811
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7323365211486816  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.741889476776123  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.745068073272705  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.745068073272705  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

m.shape torch.Size([1658, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7563800811767578  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7563800811767578  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1658, 64]), torch.Size([1, 1658, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7571706771850586  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.764050006866455  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1658, 64])
m.shape torch.Size([1449, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7643675804138184  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7643675804138184  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1449, 64]), torch.Size([1, 1449, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.765058994293213  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7786097526550293  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1449, 64])
m.shape torch.Size([1162, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7791213989257812  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7791213989257812  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 1162, 64]), torch.Size([1, 1162, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7796754837036133  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.794023036956787  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 1162, 64])
m.shape torch.Size([928, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7946586608886719  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7946586608886719  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 928, 64]), torch.Size([1, 928, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7951011657714844  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8079338073730469  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

rst.shape  torch.Size([1, 928, 64])
m.shape torch.Size([6171, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8154950141906738  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8154950141906738  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

 h.shape torch.Size([1, 6171, 64]), torch.Size([1, 6171, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8184380531311035  GigaBytes
Max Memory Allocated: 1.9258174896240234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.92616605758667  GigaBytes
Max Memory Allocated: 1.9335227012634277  GigaBytes

rst.shape  torch.Size([1, 6171, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.917726993560791  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9194211959838867  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9211153984069824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9193363189697266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 40068
output nodes number: 11368
edges number: 42609
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.91972017288208  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0180819829305013 |0.0015532175699869792 |0.04840803146362305 |0.0002105236053466797 |0.01458589235941569 |0.0063593387603759766 |
----------------------------------------------------------pseudo_mini_loss sum 2.0897765159606934
for loop block_dataloader item  time:  0.6036138534545898
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.0527496337890625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.0527496337890625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([94867, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.0527496337890625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4368, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1249547004699707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1249547004699707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4368, 128]), torch.Size([1, 4368, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1291203498840332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16323137283325195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4368, 128])
m.shape torch.Size([67444, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22546815872192383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22546815872192383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67444, 128]), torch.Size([1, 67444, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.28978776931762695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2545819282531738  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67444, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.1907463073730469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2078676223754883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2249889373779297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2073321342468262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71812, 64])
input nodes number: 94867
output nodes number: 71812
edges number: 139256
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2256970405578613  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2428183555603027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2470989227294922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2470989227294922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71812, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2470989227294922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2705, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2764654159545898  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2764654159545898  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2705, 64]), torch.Size([1, 2705, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2777557373046875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2881674766540527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2705, 64])
m.shape torch.Size([3229, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2897906303405762  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2897906303405762  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3229, 64]), torch.Size([1, 3229, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2913308143615723  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3144278526306152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3229, 64])
m.shape torch.Size([33843, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3386211395263672  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3386211395263672  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33843, 64]), torch.Size([1, 33843, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3550729751586914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7193808555603027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33843, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.6932969093322754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7027807235717773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7128281593322754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.703047752380371  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39777, 64])
input nodes number: 71812
output nodes number: 39777
edges number: 110692
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.713364601135254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7228484153747559  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7252583503723145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7252583503723145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1685, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.73652982711792  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.73652982711792  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1685, 64]), torch.Size([1, 1685, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7373337745666504  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7453603744506836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1685, 64])
m.shape torch.Size([1454, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.745673656463623  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.745673656463623  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1454, 64]), torch.Size([1, 1454, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7463669776916504  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.759340763092041  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1454, 64])
m.shape torch.Size([1210, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7598867416381836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7598867416381836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1210, 64]), torch.Size([1, 1210, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7604637145996094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7738122940063477  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1210, 64])
m.shape torch.Size([904, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7744131088256836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7744131088256836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 904, 64]), torch.Size([1, 904, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7748441696166992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7873449325561523  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 904, 64])
m.shape torch.Size([6115, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.795426368713379  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.795426368713379  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6115, 64]), torch.Size([1, 6115, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7983427047729492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9051804542541504  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6115, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.896721363067627  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8984155654907227  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9001097679138184  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8983306884765625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39777
output nodes number: 11368
edges number: 42414
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.898712158203125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018809020519256592 |0.0015543103218078613 |0.04784673452377319 |0.0002110004425048828 |0.014261066913604736 |0.0063114166259765625 |
----------------------------------------------------------pseudo_mini_loss sum 2.0573863983154297
for loop block_dataloader item  time:  0.7703738212585449
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052577972412109375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052577972412109375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([94798, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052577972412109375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4340, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12476634979248047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12476634979248047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4340, 128]), torch.Size([1, 4340, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1289052963256836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16292285919189453  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4340, 128])
m.shape torch.Size([67413, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2251434326171875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2251434326171875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67413, 128]), torch.Size([1, 67413, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.28943347930908203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2537841796875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67413, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.1899933815002441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2071008682250977  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2242083549499512  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2065658569335938  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71753, 64])
input nodes number: 94798
output nodes number: 71753
edges number: 139166
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2249159812927246  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2420234680175781  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2463006973266602  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2463006973266602  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71753, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2463006973266602  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2728, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2757329940795898  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2757329940795898  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2728, 64]), torch.Size([1, 2728, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.277033805847168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.287440299987793  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2728, 64])
m.shape torch.Size([3138, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2883901596069336  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2883901596069336  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3138, 64]), torch.Size([1, 3138, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.289886474609375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.312331199645996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3138, 64])
m.shape torch.Size([33974, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3366427421569824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3366427421569824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33974, 64]), torch.Size([1, 33974, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3528428077697754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7164711952209473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33974, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.6912121772766113  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7007107734680176  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7102093696594238  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.700413703918457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39840, 64])
input nodes number: 71753
output nodes number: 39840
edges number: 110926
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7107453346252441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7202439308166504  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7226676940917969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7226676940917969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1708, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7339696884155273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7339696884155273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1708, 64]), torch.Size([1, 1708, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7347841262817383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.742133617401123  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1708, 64])
m.shape torch.Size([1425, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7424273490905762  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7424273490905762  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1425, 64]), torch.Size([1, 1425, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7431073188781738  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7579255104064941  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1425, 64])
m.shape torch.Size([1156, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7584385871887207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7584385871887207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1156, 64]), torch.Size([1, 1156, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7589898109436035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7725553512573242  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1156, 64])
m.shape torch.Size([912, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.773176670074463  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.773176670074463  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 912, 64]), torch.Size([1, 912, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7736115455627441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7862229347229004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 912, 64])
m.shape torch.Size([6167, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7943353652954102  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7943353652954102  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6167, 64]), torch.Size([1, 6167, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7976665496826172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9064674377441406  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6167, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.89719820022583  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8988924026489258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9005866050720215  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8988075256347656  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39840
output nodes number: 11368
edges number: 42509
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8991894721984863  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01845259666442871 |0.0015602588653564453 |0.048891544342041016 |0.00021610260009765624 |0.013985967636108399 |0.004860877990722656 |
----------------------------------------------------------pseudo_mini_loss sum 1.998673439025879
for loop block_dataloader item  time:  0.9511110782623291
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05289649963378906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05289649963378906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95446, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05289649963378906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4319, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1253361701965332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1253361701965332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4319, 128]), torch.Size([1, 4319, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1294550895690918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16240644454956055  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4319, 128])
m.shape torch.Size([67730, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22493934631347656  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22493934631347656  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67730, 128]), torch.Size([1, 67730, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.29134559631347656  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2656726837158203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67730, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.19952392578125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2167019844055176  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2338800430297852  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2161650657653809  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72049, 64])
input nodes number: 95446
output nodes number: 72049
edges number: 139779
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2345924377441406  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2517704963684082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2560653686523438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2560653686523438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72049, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2560653686523438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2700, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.285614013671875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.285614013671875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2700, 64]), torch.Size([1, 2700, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2869014739990234  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.297201156616211  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2700, 64])
m.shape torch.Size([3191, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2982797622680664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2982797622680664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3191, 64]), torch.Size([1, 3191, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2998018264770508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.322627067565918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3191, 64])
m.shape torch.Size([34108, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3470244407653809  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3470244407653809  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34108, 64]), torch.Size([1, 34108, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.363288402557373  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7271723747253418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34108, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7017264366149902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7112631797790527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7207999229431152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7109651565551758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39999, 64])
input nodes number: 72049
output nodes number: 39999
edges number: 111406
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7213377952575684  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7308745384216309  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7341418266296387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7341418266296387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1671, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7454633712768555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7454633712768555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1671, 64]), torch.Size([1, 1671, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.746260643005371  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7528791427612305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1671, 64])
m.shape torch.Size([1453, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7531952857971191  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7531952857971191  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1453, 64]), torch.Size([1, 1453, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7538886070251465  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7663068771362305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1453, 64])
m.shape torch.Size([1131, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7667951583862305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7667951583862305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1131, 64]), torch.Size([1, 1131, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7673349380493164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7802300453186035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1131, 64])
m.shape torch.Size([905, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7808504104614258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7808504104614258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 905, 64]), torch.Size([1, 905, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7812824249267578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7937994003295898  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 905, 64])
m.shape torch.Size([6208, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8019466400146484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8019466400146484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6208, 64]), torch.Size([1, 6208, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8052139282226562  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9130516052246094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6208, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9039015769958496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9055957794189453  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.907975673675537  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9061965942382812  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39999
output nodes number: 11368
edges number: 42630
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9065794944763184  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01889324188232422 |0.001586635907491048 |0.048459808031717934 |0.00021541118621826172 |0.013887564341227213 |0.006647586822509766 |
----------------------------------------------------------pseudo_mini_loss sum 1.9018676280975342
for loop block_dataloader item  time:  1.1296932697296143
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05268239974975586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05268239974975586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95021, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05268239974975586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4396, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12529325485229492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12529325485229492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4396, 128]), torch.Size([1, 4396, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1294856071472168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16435575485229492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4396, 128])
m.shape torch.Size([67541, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22600603103637695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22600603103637695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67541, 128]), torch.Size([1, 67541, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2904181480407715  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2565999031066895  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67541, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.1916999816894531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2088513374328613  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2260026931762695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2083148956298828  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71937, 64])
input nodes number: 95021
output nodes number: 71937
edges number: 139478
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2267117500305176  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2438631057739258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2487211227416992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2487211227416992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71937, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2487211227416992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2712, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2780938148498535  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2780938148498535  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2712, 64]), torch.Size([1, 2712, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2793869972229004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2897324562072754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2712, 64])
m.shape torch.Size([3200, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2906990051269531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2906990051269531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3200, 64]), torch.Size([1, 3200, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2922248840332031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3151130676269531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3200, 64])
m.shape torch.Size([33867, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3393311500549316  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3393311500549316  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33867, 64]), torch.Size([1, 33867, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.355480670928955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7189068794250488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33867, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.6931772232055664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7026615142822266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7121458053588867  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7023649215698242  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39779, 64])
input nodes number: 71937
output nodes number: 39779
edges number: 110713
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7126832008361816  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7221674919128418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7251100540161133  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7251100540161133  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1719, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7363615036010742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7363615036010742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1719, 64]), torch.Size([1, 1719, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7371816635131836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7448234558105469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1719, 64])
m.shape torch.Size([1455, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.745129108428955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.745129108428955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1455, 64]), torch.Size([1, 1455, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7458233833312988  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7601814270019531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1455, 64])
m.shape torch.Size([1174, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7607007026672363  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7607007026672363  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1174, 64]), torch.Size([1, 1174, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7612605094909668  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7739276885986328  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1174, 64])
m.shape torch.Size([948, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.774580478668213  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.774580478668213  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 948, 64]), torch.Size([1, 948, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7750325202941895  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7881417274475098  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 948, 64])
m.shape torch.Size([6072, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7953805923461914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7953805923461914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6072, 64]), torch.Size([1, 6072, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7990741729736328  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.905421257019043  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6072, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8959970474243164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8986396789550781  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9003338813781738  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.897606372833252  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39779
output nodes number: 11368
edges number: 42303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8989362716674805  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018619741712297713 |0.0016164779663085938 |0.055045059749058316 |0.00021696090698242188 |0.013762099402291434 |0.006316184997558594 |
----------------------------------------------------------pseudo_mini_loss sum 1.9263296127319336
for loop block_dataloader item  time:  1.3418118953704834
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05365419387817383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05365419387817383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95044, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05365419387817383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4286, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1262073516845703  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1262073516845703  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4286, 128]), torch.Size([1, 4286, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.1302947998046875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16353321075439453  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4286, 128])
m.shape torch.Size([67876, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22622108459472656  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22622108459472656  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67876, 128]), torch.Size([1, 67876, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.29262733459472656  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.268625259399414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67876, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2023673057556152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2195720672607422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2367768287658691  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.219034194946289  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72162, 64])
input nodes number: 95044
output nodes number: 72162
edges number: 140038
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2374863624572754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2546911239624023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2589926719665527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2589926719665527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72162, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2589926719665527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2646, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2885265350341797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2885265350341797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2646, 64]), torch.Size([1, 2646, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2897882461547852  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.299881935119629  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2646, 64])
m.shape torch.Size([3280, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3008975982666016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3008975982666016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3280, 64]), torch.Size([1, 3280, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3024616241455078  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3261160850524902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3280, 64])
m.shape torch.Size([34063, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3504595756530762  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3504595756530762  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34063, 64]), torch.Size([1, 34063, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3667025566101074  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7312202453613281  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34063, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.70460844039917  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7146053314208984  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.72413969039917  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7138447761535645  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39989, 64])
input nodes number: 72162
output nodes number: 39989
edges number: 111395
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7246785163879395  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.734212875366211  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7375011444091797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7375011444091797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1675, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7488079071044922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7488079071044922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1675, 64]), torch.Size([1, 1675, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7496070861816406  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7572236061096191  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1675, 64])
m.shape torch.Size([1490, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7575569152832031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7575569152832031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1490, 64]), torch.Size([1, 1490, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7582674026489258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7716283798217773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1490, 64])
m.shape torch.Size([1082, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.772071361541748  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.772071361541748  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1082, 64]), torch.Size([1, 1082, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7725872993469238  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7864584922790527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1082, 64])
m.shape torch.Size([924, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.787109375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.787109375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 924, 64]), torch.Size([1, 924, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7875499725341797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8003273010253906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 924, 64])
m.shape torch.Size([6194, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8077216148376465  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8077216148376465  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6194, 64]), torch.Size([1, 6194, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8106751441955566  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9184966087341309  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6194, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.909714698791504  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9114084243774414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.913102149963379  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9113235473632812  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11365, 40])
input nodes number: 39989
output nodes number: 11365
edges number: 42567
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9107575416564941  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018427908420562744 |0.0016231834888458252 |0.05411991477012634 |0.00021415948867797852 |0.013755261898040771 |0.010767936706542969 |
----------------------------------------------------------pseudo_mini_loss sum 1.8716386556625366
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1656038
Number of first layer input nodes during this epoch:  761158
block dataloader generation time/epoch 9.5367431640625e-07
for loop block_dataloader item  time:  0.07148861885070801
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052747249603271484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052747249603271484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95152, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.052747249603271484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4264, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.124908447265625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.124908447265625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4264, 128]), torch.Size([1, 4264, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12897491455078125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16150665283203125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4264, 128])
m.shape torch.Size([67508, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22385406494140625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22385406494140625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67508, 128]), torch.Size([1, 67508, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.2882347106933594  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2539443969726562  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67508, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.1900911331176758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2075891494750977  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.224700927734375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2066679000854492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71772, 64])
input nodes number: 95152
output nodes number: 71772
edges number: 139280
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2254109382629395  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2425227165222168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2468008995056152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2468008995056152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71772, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2468008995056152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2712, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2762622833251953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2762622833251953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2712, 64]), torch.Size([1, 2712, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2775554656982422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2879009246826172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2712, 64])
m.shape torch.Size([3192, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2888550758361816  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2888550758361816  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3192, 64]), torch.Size([1, 3192, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.290377140045166  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3136982917785645  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3192, 64])
m.shape torch.Size([33986, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3380060195922852  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3380060195922852  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33986, 64]), torch.Size([1, 33986, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3542118072509766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7186546325683594  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33986, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.6920480728149414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.70206880569458  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7115793228149414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.701261043548584  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39890, 64])
input nodes number: 71772
output nodes number: 39890
edges number: 111054
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7121152877807617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.721625804901123  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7240452766418457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7240452766418457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1701, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7353310585021973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7353310585021973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1701, 64]), torch.Size([1, 1701, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.736142635345459  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7439112663269043  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1701, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7442340850830078  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7442340850830078  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1481, 64]), torch.Size([1, 1481, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7449407577514648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7585391998291016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1481, 64])
m.shape torch.Size([1134, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7590227127075195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7590227127075195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1134, 64]), torch.Size([1, 1134, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7595634460449219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.772171974182129  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1134, 64])
m.shape torch.Size([866, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7727537155151367  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7727537155151367  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 866, 64]), torch.Size([1, 866, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7731666564941406  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.785141944885254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 866, 64])
m.shape torch.Size([6186, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7925405502319336  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7925405502319336  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6186, 64]), torch.Size([1, 6186, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7958660125732422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9035940170288086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6186, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8944907188415527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8961849212646484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8978791236877441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8961000442504883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39890
output nodes number: 11368
edges number: 42459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8964829444885254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021201372146606445 |0.0016202926635742188 |0.04845738410949707 |0.0002315044403076172 |0.013693809509277344 |0.006342172622680664 |
----------------------------------------------------------pseudo_mini_loss sum 1.8292537927627563
for loop block_dataloader item  time:  0.2457897663116455
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05273103713989258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05273103713989258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95109, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.05273103713989258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4264, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12486410140991211  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12486410140991211  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4264, 128]), torch.Size([1, 4264, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.12893056869506836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.16146230697631836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4264, 128])
m.shape torch.Size([67480, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22378301620483398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.22378301620483398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67480, 128]), torch.Size([1, 67480, 128])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 0.28813695907592773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.253446102142334  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67480, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.189645767211914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2067508697509766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.223855972290039  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2062163352966309  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71744, 64])
input nodes number: 95109
output nodes number: 71744
edges number: 139224
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2245659828186035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.241671085357666  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2459473609924316  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2459473609924316  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71744, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2459473609924316  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2663, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2754874229431152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2754874229431152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2663, 64]), torch.Size([1, 2663, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2767577171325684  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2876429557800293  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2663, 64])
m.shape torch.Size([3141, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.28861665725708  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.28861665725708  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3141, 64]), torch.Size([1, 3141, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.2901148796081543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3128600120544434  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3141, 64])
m.shape torch.Size([34155, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3382654190063477  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3382654190063477  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34155, 64]), torch.Size([1, 34155, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.3548011779785156  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7194066047668457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34155, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.6933279037475586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.702855110168457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7123823165893555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.70255708694458  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39959, 64])
input nodes number: 71744
output nodes number: 39959
edges number: 111410
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7129178047180176  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.722445011138916  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7248711585998535  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7248711585998535  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1623, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7362060546875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7362060546875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1623, 64]), torch.Size([1, 1623, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7369804382324219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7441926002502441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1623, 64])
m.shape torch.Size([1447, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7445173263549805  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7445173263549805  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1447, 64]), torch.Size([1, 1447, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7452077865600586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7594165802001953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1447, 64])
m.shape torch.Size([1181, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7599430084228516  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7599430084228516  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1181, 64]), torch.Size([1, 1181, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7605066299438477  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7733893394470215  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1181, 64])
m.shape torch.Size([910, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7740025520324707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7740025520324707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 910, 64]), torch.Size([1, 910, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7744364738464355  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.787020206451416  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 910, 64])
m.shape torch.Size([6207, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.795177936553955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.795177936553955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6207, 64]), torch.Size([1, 6207, 64])
----------------------------------------3
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.7987761497497559  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9066214561462402  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6207, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8974461555480957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9000449180603027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.9017391204833984  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8990554809570312  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39959
output nodes number: 11368
edges number: 42735
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3348388671875 GB
    Memory Allocated: 1.8994383811950684  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019791841506958008 |0.001676321029663086 |0.047237277030944824 |0.00021851062774658203 |0.013762712478637695 |0.006563901901245117 |
----------------------------------------------------------pseudo_mini_loss sum 1.8075721263885498
for loop block_dataloader item  time:  0.404254674911499
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.053003787994384766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.053003787994384766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95659, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.053003787994384766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4343, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12573909759521484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12573909759521484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4343, 128]), torch.Size([1, 4343, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1298809051513672  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16425466537475586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4343, 128])
m.shape torch.Size([68000, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2270336151123047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2270336151123047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 68000, 128]), torch.Size([1, 68000, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2934398651123047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2708568572998047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 68000, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2044224739074707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2216706275939941  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2389187812805176  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2211313247680664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72343, 64])
input nodes number: 95659
output nodes number: 72343
edges number: 140343
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2396326065063477  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.256880760192871  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.261192798614502  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.261192798614502  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72343, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.261192798614502  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2665, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2908263206481934  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2908263206481934  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2665, 64]), torch.Size([1, 2665, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.292097568511963  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.30226469039917  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2665, 64])
m.shape torch.Size([3223, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3032336235046387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3032336235046387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3223, 64]), torch.Size([1, 3223, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3047709465026855  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3278250694274902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3223, 64])
m.shape torch.Size([34218, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3532118797302246  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3532118797302246  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34218, 64]), torch.Size([1, 34218, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3695282936096191  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7341923713684082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34218, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.708035945892334  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7175979614257812  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7271599769592285  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.717298984527588  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([40106, 64])
input nodes number: 72343
output nodes number: 40106
edges number: 111765
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7277002334594727  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.73726224899292  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7404770851135254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7404770851135254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1657, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.751784324645996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.751784324645996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1657, 64]), torch.Size([1, 1657, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7525749206542969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.760533332824707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1657, 64])
m.shape torch.Size([1491, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.760871410369873  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.760871410369873  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1491, 64]), torch.Size([1, 1491, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.761582851409912  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7739028930664062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1491, 64])
m.shape torch.Size([1123, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7743759155273438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7743759155273438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1123, 64]), torch.Size([1, 1123, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.774911880493164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7876663208007812  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1123, 64])
m.shape torch.Size([896, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7882795333862305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7882795333862305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 896, 64]), torch.Size([1, 896, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7887067794799805  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8010969161987305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 896, 64])
m.shape torch.Size([6201, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8086376190185547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8086376190185547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6201, 64]), torch.Size([1, 6201, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8122601509094238  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9203457832336426  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6201, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9112067222595215  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9129009246826172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.914595127105713  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.912816047668457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 40106
output nodes number: 11368
edges number: 42597
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9131999015808105  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018797636032104492 |0.0016895135243733723 |0.04710968335469564 |0.0002216498057047526 |0.01368260383605957 |0.00652766227722168 |
----------------------------------------------------------pseudo_mini_loss sum 1.748093605041504
for loop block_dataloader item  time:  0.5635883808135986
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05282258987426758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05282258987426758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95293, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05282258987426758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4347, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12620973587036133  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12620973587036133  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4347, 128]), torch.Size([1, 4347, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1303553581237793  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1643962860107422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4347, 128])
m.shape torch.Size([67836, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22701692581176758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22701692581176758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67836, 128]), torch.Size([1, 67836, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2934231758117676  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.26896333694458  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67836, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.202685832977295  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.219895839691162  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2371058464050293  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.219357967376709  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72183, 64])
input nodes number: 95293
output nodes number: 72183
edges number: 140019
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2378168106079102  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2550268173217773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2593293190002441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2593293190002441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72183, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2593293190002441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2716, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.28889799118042  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.28889799118042  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2716, 64]), torch.Size([1, 2716, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2901930809020996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.300553798675537  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2716, 64])
m.shape torch.Size([3194, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3016667366027832  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3016667366027832  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3194, 64]), torch.Size([1, 3194, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.303189754486084  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3264894485473633  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3194, 64])
m.shape torch.Size([34121, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3508963584899902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3508963584899902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34121, 64]), torch.Size([1, 34121, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3671669960021973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7317399978637695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34121, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7051630020141602  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7151498794555664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7246942520141602  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7144088745117188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([40031, 64])
input nodes number: 72183
output nodes number: 40031
edges number: 111467
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7252330780029297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.735219955444336  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7380380630493164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7380380630493164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1717, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7493138313293457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7493138313293457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1717, 64]), torch.Size([1, 1717, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7501330375671387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7578191757202148  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1717, 64])
m.shape torch.Size([1463, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7581291198730469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7581291198730469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1463, 64]), torch.Size([1, 1463, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7588272094726562  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.769730567932129  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1463, 64])
m.shape torch.Size([1147, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7702279090881348  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7702279090881348  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1147, 64]), torch.Size([1, 1147, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.770775318145752  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7834553718566895  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1147, 64])
m.shape torch.Size([884, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7840514183044434  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7840514183044434  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 884, 64]), torch.Size([1, 884, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.784472942352295  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7966971397399902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 884, 64])
m.shape torch.Size([6157, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.804056167602539  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.804056167602539  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6157, 64]), torch.Size([1, 6157, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.806992530822754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.914494514465332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6157, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.90598726272583  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9076814651489258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9093756675720215  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9075965881347656  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 40031
output nodes number: 11368
edges number: 42405
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.907979965209961  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018282294273376465 |0.0017003417015075684 |0.0471232533454895 |0.0002180933952331543 |0.013576507568359375 |0.006522655487060547 |
----------------------------------------------------------pseudo_mini_loss sum 1.7325160503387451
for loop block_dataloader item  time:  0.7217562198638916
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05290555953979492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05290555953979492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95467, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05290555953979492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4431, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12546443939208984  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12546443939208984  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4431, 128]), torch.Size([1, 4431, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12969017028808594  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16401147842407227  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4431, 128])
m.shape torch.Size([67737, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22649765014648438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22649765014648438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67737, 128]), torch.Size([1, 67737, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2929039001464844  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2673110961914062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67737, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2010464668273926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2182526588439941  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2354588508605957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.217714786529541  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72168, 64])
input nodes number: 95467
output nodes number: 72168
edges number: 139905
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2361712455749512  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2533774375915527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2576789855957031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2576789855957031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72168, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2576789855957031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2758, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.287247657775879  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.287247657775879  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2758, 64]), torch.Size([1, 2758, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2885627746582031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2990837097167969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2758, 64])
m.shape torch.Size([3223, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.300135612487793  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.300135612487793  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3223, 64]), torch.Size([1, 3223, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3016729354858398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3247270584106445  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3223, 64])
m.shape torch.Size([34071, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3490900993347168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3490900993347168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34071, 64]), torch.Size([1, 34071, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3653368949890137  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7291522026062012  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34071, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7036972045898438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7132463455200195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7227954864501953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7129478454589844  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([40052, 64])
input nodes number: 72168
output nodes number: 40052
edges number: 111417
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7233343124389648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7328834533691406  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7357497215270996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7357497215270996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1665, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7470126152038574  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7470126152038574  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1665, 64]), torch.Size([1, 1665, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7478070259094238  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7543797492980957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1665, 64])
m.shape torch.Size([1469, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7547049522399902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7547049522399902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1469, 64]), torch.Size([1, 1469, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7554059028625488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7691473960876465  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1469, 64])
m.shape torch.Size([1198, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7696809768676758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7696809768676758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1198, 64]), torch.Size([1, 1198, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7702522277832031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7833061218261719  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1198, 64])
m.shape torch.Size([980, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.783984661102295  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.783984661102295  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 980, 64]), torch.Size([1, 980, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.784451961517334  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7980036735534668  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 980, 64])
m.shape torch.Size([6056, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.806119441986084  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.806119441986084  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6056, 64]), torch.Size([1, 6056, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8097052574157715  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.915449619293213  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6056, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9069123268127441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9086065292358398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9103007316589355  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9085216522216797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 40052
output nodes number: 11368
edges number: 42397
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.908905029296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018062353134155273 |0.0017046928405761719 |0.04696435928344726 |0.00021643638610839843 |0.012686538696289062 |0.006482601165771484 |
----------------------------------------------------------pseudo_mini_loss sum 1.718551516532898
for loop block_dataloader item  time:  0.9319629669189453
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05282258987426758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05282258987426758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95295, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05282258987426758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4343, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12537813186645508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12537813186645508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4343, 128]), torch.Size([1, 4343, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12951993942260742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16354751586914062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4343, 128])
m.shape torch.Size([67687, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2260279655456543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2260279655456543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67687, 128]), torch.Size([1, 67687, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2924342155456543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2662692070007324  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67687, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2001399993896484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.217313289642334  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2344865798950195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2167763710021973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72030, 64])
input nodes number: 95295
output nodes number: 72030
edges number: 139717
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2351975440979004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.252370834350586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2566642761230469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2566642761230469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72030, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2566642761230469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2724, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2861847877502441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2861847877502441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2724, 64]), torch.Size([1, 2724, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2874836921691895  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.297874927520752  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2724, 64])
m.shape torch.Size([3227, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2990303039550781  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2990303039550781  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3227, 64]), torch.Size([1, 3227, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3005695343017578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3239822387695312  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3227, 64])
m.shape torch.Size([34030, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.348313808441162  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.348313808441162  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34030, 64]), torch.Size([1, 34030, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3645405769348145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7290253639221191  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34030, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7024192810058594  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7124180793762207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7219505310058594  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.711653709411621  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39981, 64])
input nodes number: 72030
output nodes number: 39981
edges number: 111268
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7224884033203125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7324872016906738  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7345890998840332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7345890998840332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1689, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7459230422973633  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7459230422973633  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1689, 64]), torch.Size([1, 1689, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7467288970947266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.753610610961914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1689, 64])
m.shape torch.Size([1391, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.753891944885254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.753891944885254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1391, 64]), torch.Size([1, 1391, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7545557022094727  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.766606330871582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1391, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7671222686767578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7671222686767578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1149, 64]), torch.Size([1, 1149, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7676706314086914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.780076026916504  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1149, 64])
m.shape torch.Size([944, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7807302474975586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7807302474975586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 944, 64]), torch.Size([1, 944, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7811803817749023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.794234275817871  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 944, 64])
m.shape torch.Size([6195, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8016252517700195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8016252517700195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6195, 64]), torch.Size([1, 6195, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.804579734802246  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9137310981750488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6195, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9053072929382324  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9070014953613281  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9086956977844238  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.906916618347168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39981
output nodes number: 11368
edges number: 42669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.907299518585205  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01785723368326823 |0.0017046531041463215 |0.04684110482533773 |0.00021417935689290365 |0.012738704681396484 |0.005919933319091797 |
----------------------------------------------------------pseudo_mini_loss sum 1.686667561531067
for loop block_dataloader item  time:  1.0885303020477295
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0528111457824707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0528111457824707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95283, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0528111457824707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4335, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12504196166992188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12504196166992188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4335, 128]), torch.Size([1, 4335, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12917613983154297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1631770133972168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4335, 128])
m.shape torch.Size([67507, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22548961639404297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22548961639404297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67507, 128]), torch.Size([1, 67507, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2898693084716797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.255711555480957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67507, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.19179105758667  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2089195251464844  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2260479927062988  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2083840370178223  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71842, 64])
input nodes number: 95283
output nodes number: 71842
edges number: 139349
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2267589569091797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2438874244689941  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2481698989868164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2481698989868164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71842, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2481698989868164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2664, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2776398658752441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2776398658752441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2664, 64]), torch.Size([1, 2664, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2789101600646973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2890725135803223  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2664, 64])
m.shape torch.Size([3216, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2901105880737305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2901105880737305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3216, 64]), torch.Size([1, 3216, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2916440963745117  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3146467208862305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3216, 64])
m.shape torch.Size([34013, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3389687538146973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3389687538146973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34013, 64]), torch.Size([1, 34013, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3551878929138184  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7188925743103027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34013, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6935606002807617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7030720710754395  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7125835418701172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7027745246887207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39893, 64])
input nodes number: 71842
output nodes number: 39893
edges number: 111135
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7131199836730957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7226314544677734  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.725034236907959  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.725034236907959  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1674, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7363219261169434  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7363219261169434  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1674, 64]), torch.Size([1, 1674, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7371201515197754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.744753360748291  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1674, 64])
m.shape torch.Size([1464, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7450742721557617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7450742721557617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1464, 64]), torch.Size([1, 1464, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.745772361755371  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7591032981872559  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1464, 64])
m.shape torch.Size([1166, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7596144676208496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7596144676208496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1166, 64]), torch.Size([1, 1166, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7601704597473145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7737236022949219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1166, 64])
m.shape torch.Size([927, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7743573188781738  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7743573188781738  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 927, 64]), torch.Size([1, 927, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7747998237609863  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.787621021270752  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 927, 64])
m.shape torch.Size([6137, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7957382202148438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7957382202148438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6137, 64]), torch.Size([1, 6137, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7994017601013184  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9062957763671875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6137, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.897843837738037  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8995380401611328  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9012322425842285  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8994531631469727  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39893
output nodes number: 11368
edges number: 42493
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8998355865478516  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017771244049072266 |0.001703636986868722 |0.046726771763392856 |0.00021382740565708706 |0.012468644550868444 |0.006296634674072266 |
----------------------------------------------------------pseudo_mini_loss sum 1.6515167951583862
for loop block_dataloader item  time:  1.24247407913208
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0526728630065918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0526728630065918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([94995, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0526728630065918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4350, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12502288818359375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12502288818359375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4350, 128]), torch.Size([1, 4350, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12917137145996094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1632223129272461  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4350, 128])
m.shape torch.Size([67610, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22562599182128906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22562599182128906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67610, 128]), torch.Size([1, 67610, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.29203224182128906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2649860382080078  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67610, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1989240646362305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.216080665588379  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2332372665405273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2155442237854004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71960, 64])
input nodes number: 94995
output nodes number: 71960
edges number: 139570
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2339463233947754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2511029243469238  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.255392074584961  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.255392074584961  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71960, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.255392074584961  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2672, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.284792423248291  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.284792423248291  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2672, 64]), torch.Size([1, 2672, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2860665321350098  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2962594032287598  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2672, 64])
m.shape torch.Size([3230, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.297347068786621  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.297347068786621  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3230, 64]), torch.Size([1, 3230, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2988872528076172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3219900131225586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3230, 64])
m.shape torch.Size([33908, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3462309837341309  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3462309837341309  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33908, 64]), torch.Size([1, 33908, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3623995780944824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7259020805358887  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33908, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7006840705871582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7101755142211914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7196669578552246  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7098784446716309  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39810, 64])
input nodes number: 71960
output nodes number: 39810
edges number: 110856
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7202043533325195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7296957969665527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7320704460144043  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7320704460144043  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1702, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.74330472946167  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.74330472946167  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1702, 64]), torch.Size([1, 1702, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7441163063049316  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7514500617980957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1702, 64])
m.shape torch.Size([1500, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.751781940460205  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.751781940460205  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1500, 64]), torch.Size([1, 1500, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7524971961975098  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7663636207580566  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1500, 64])
m.shape torch.Size([1179, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.766876220703125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.766876220703125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1179, 64]), torch.Size([1, 1179, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7674388885498047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7805414199829102  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1179, 64])
m.shape torch.Size([913, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.781158447265625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.781158447265625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 913, 64]), torch.Size([1, 913, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7815942764282227  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7942218780517578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 913, 64])
m.shape torch.Size([6071, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8023147583007812  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8023147583007812  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6071, 64]), torch.Size([1, 6071, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8056774139404297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9128975868225098  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6071, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9038715362548828  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9055652618408203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9080009460449219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9062223434448242  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11365, 40])
input nodes number: 39810
output nodes number: 11365
edges number: 42246
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9066038131713867  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01764523983001709 |0.0017065107822418213 |0.04664355516433716 |0.0002142190933227539 |0.012531876564025879 |0.00625920295715332 |
----------------------------------------------------------pseudo_mini_loss sum 1.6351648569107056
Total (block generation + training)time/epoch 1.3349452018737793
Training time/epoch 1.3348095417022705
Training time without block to device /epoch 1.321157455444336
Training time without total dataloading part /epoch 0.48137640953063965
load block tensor time/epoch 0.14116191864013672
block to device time/epoch 0.01365208625793457
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1658017
Number of first layer input nodes during this epoch:  762253
block dataloader generation time/epoch 1.1920928955078125e-06
for loop block_dataloader item  time:  0.06946253776550293
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05291414260864258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05291414260864258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95490, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05291414260864258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4304, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12563133239746094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12563133239746094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4304, 128]), torch.Size([1, 4304, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12973594665527344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16257286071777344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4304, 128])
m.shape torch.Size([67639, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22502613067626953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22502613067626953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67639, 128]), torch.Size([1, 67639, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.29143238067626953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2647180557250977  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67639, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1986722946166992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.215825080871582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2329778671264648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2152886390686035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71943, 64])
input nodes number: 95490
output nodes number: 71943
edges number: 139582
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2336907386779785  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2508435249328613  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.255131721496582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.255131721496582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71943, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.255131721496582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2672, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2846689224243164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2846689224243164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2672, 64]), torch.Size([1, 2672, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2859430313110352  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2961359024047852  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2672, 64])
m.shape torch.Size([3208, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2970967292785645  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2970967292785645  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3208, 64]), torch.Size([1, 3208, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.29862642288208  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3220291137695312  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3208, 64])
m.shape torch.Size([34100, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.34641695022583  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.34641695022583  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34100, 64]), torch.Size([1, 34100, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3626770973205566  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7272286415100098  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34100, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.700643539428711  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7106428146362305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.720174789428711  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7098774909973145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39980, 64])
input nodes number: 71943
output nodes number: 39980
edges number: 111388
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7207121849060059  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7302441596984863  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7335152626037598  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7335152626037598  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1636, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7448124885559082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7448124885559082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1636, 64]), torch.Size([1, 1636, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7455925941467285  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.752697467803955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1636, 64])
m.shape torch.Size([1462, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7530264854431152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7530264854431152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1462, 64]), torch.Size([1, 1462, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7537236213684082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7660489082336426  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1462, 64])
m.shape torch.Size([1207, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7665910720825195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7665910720825195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1207, 64]), torch.Size([1, 1207, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.767167091369629  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.782135009765625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1207, 64])
m.shape torch.Size([920, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7827520370483398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7827520370483398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 920, 64]), torch.Size([1, 920, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7831907272338867  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.795912742614746  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 920, 64])
m.shape torch.Size([6143, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8032455444335938  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8032455444335938  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6143, 64]), torch.Size([1, 6143, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.80670166015625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.913243293762207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6143, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.904780387878418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9064745903015137  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9081687927246094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9063897132873535  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39980
output nodes number: 11368
edges number: 42576
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9067730903625488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01689600944519043 |0.0017566680908203125 |0.04680466651916504 |0.0002124309539794922 |0.012741327285766602 |0.006428718566894531 |
----------------------------------------------------------pseudo_mini_loss sum 1.6514664888381958
for loop block_dataloader item  time:  0.22703289985656738
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05281400680541992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05281400680541992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95287, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05281400680541992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4356, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12520170211791992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12520170211791992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4356, 128]), torch.Size([1, 4356, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12935590744018555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16342687606811523  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4356, 128])
m.shape torch.Size([67642, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22585821151733398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22585821151733398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67642, 128]), torch.Size([1, 67642, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.292264461517334  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2655844688415527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67642, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1994848251342773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2169389724731445  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2341046333312988  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2161140441894531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71998, 64])
input nodes number: 95287
output nodes number: 71998
edges number: 139640
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2348155975341797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.251981258392334  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.256272792816162  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.256272792816162  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71998, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.256272792816162  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2725, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2857732772827148  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2857732772827148  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2725, 64]), torch.Size([1, 2725, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2870731353759766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.297469139099121  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2725, 64])
m.shape torch.Size([3289, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.298710823059082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.298710823059082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3289, 64]), torch.Size([1, 3289, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3002796173095703  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3239002227783203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3289, 64])
m.shape torch.Size([33961, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3481659889221191  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3481659889221191  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33961, 64]), torch.Size([1, 33961, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3643603324890137  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.728780746459961  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33961, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7021431922912598  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7121434211730957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7216744422912598  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7113761901855469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39975, 64])
input nodes number: 71998
output nodes number: 39975
edges number: 111186
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7222118377685547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7317428588867188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7350797653198242  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7350797653198242  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1745, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7463440895080566  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7463440895080566  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1745, 64]), torch.Size([1, 1745, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7471766471862793  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7543692588806152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1745, 64])
m.shape torch.Size([1462, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7546720504760742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7546720504760742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1462, 64]), torch.Size([1, 1462, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7553691864013672  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7678375244140625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1462, 64])
m.shape torch.Size([1114, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7683110237121582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7683110237121582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1114, 64]), torch.Size([1, 1114, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7688422203063965  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.782172679901123  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1114, 64])
m.shape torch.Size([919, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.782811164855957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.782811164855957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 919, 64]), torch.Size([1, 919, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.783249855041504  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7959604263305664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 919, 64])
m.shape torch.Size([6128, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8032746315002441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8032746315002441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6128, 64]), torch.Size([1, 6128, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8066115379333496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.913581371307373  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6128, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.905158519744873  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9068527221679688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9085469245910645  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9067678451538086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39975
output nodes number: 11368
edges number: 42327
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9071507453918457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01686227321624756 |0.0017385482788085938 |0.046953797340393066 |0.00021123886108398438 |0.0129624605178833 |0.006191730499267578 |
----------------------------------------------------------pseudo_mini_loss sum 1.5710958242416382
for loop block_dataloader item  time:  0.38622212409973145
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05277061462402344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05277061462402344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95194, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05277061462402344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4378, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12511873245239258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12511873245239258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4378, 128]), torch.Size([1, 4378, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12929391860961914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1634383201599121  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4378, 128])
m.shape torch.Size([67580, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2258000373840332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2258000373840332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67580, 128]), torch.Size([1, 67580, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2902493476867676  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2569966316223145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67580, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1928935050964355  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2103371620178223  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2274932861328125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2095131874084473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71958, 64])
input nodes number: 95194
output nodes number: 71958
edges number: 139538
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2282037734985352  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2453598976135254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2496490478515625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2496490478515625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71958, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2496490478515625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2680, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2791047096252441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2791047096252441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2680, 64]), torch.Size([1, 2680, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2803826332092285  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2906060218811035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2680, 64])
m.shape torch.Size([3148, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2916240692138672  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2916240692138672  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3148, 64]), torch.Size([1, 3148, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2931251525878906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3163189888000488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3148, 64])
m.shape torch.Size([34032, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3406710624694824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3406710624694824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34032, 64]), torch.Size([1, 34032, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3568987846374512  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7213854789733887  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34032, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6948013305664062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.704829216003418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7143325805664062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.704007625579834  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39860, 64])
input nodes number: 71958
output nodes number: 39860
edges number: 111072
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7148699760437012  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7243733406066895  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7276768684387207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7276768684387207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1704, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.738983154296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.738983154296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1704, 64]), torch.Size([1, 1704, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7397956848144531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7471728324890137  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1704, 64])
m.shape torch.Size([1444, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7474770545959473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7474770545959473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1444, 64]), torch.Size([1, 1444, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7481656074523926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7609467506408691  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1444, 64])
m.shape torch.Size([1135, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7614402770996094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7614402770996094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1135, 64]), torch.Size([1, 1135, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7619819641113281  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7745590209960938  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1135, 64])
m.shape torch.Size([878, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7751517295837402  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7751517295837402  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 878, 64]), torch.Size([1, 878, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7755703926086426  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7877116203308105  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 878, 64])
m.shape torch.Size([6207, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.795133113861084  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.795133113861084  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6207, 64]), torch.Size([1, 6207, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7988343238830566  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9066128730773926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6207, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8982338905334473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.899928092956543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9016222953796387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8998432159423828  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39860
output nodes number: 11368
edges number: 42544
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9002251625061035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016878286997477215 |0.0017348925272623699 |0.0470426082611084 |0.0002101262410481771 |0.013173421223958334 |0.006366252899169922 |
----------------------------------------------------------pseudo_mini_loss sum 1.5796945095062256
for loop block_dataloader item  time:  0.5891261100769043
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([94815, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05257368087768555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4284, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12472248077392578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12472248077392578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4284, 128]), torch.Size([1, 4284, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12880802154541016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16149234771728516  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4284, 128])
m.shape torch.Size([67209, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22354507446289062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22354507446289062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67209, 128]), torch.Size([1, 67209, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2876405715942383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2497882843017578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67209, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.184091567993164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2015800476074219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.218625545501709  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.20060396194458  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71493, 64])
input nodes number: 94815
output nodes number: 71493
edges number: 138702
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2193331718444824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2363786697387695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2406425476074219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2406425476074219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71493, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2406425476074219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2713, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2698988914489746  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2698988914489746  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2713, 64]), torch.Size([1, 2713, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.271193027496338  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2817864418029785  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2713, 64])
m.shape torch.Size([3299, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2831745147705078  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2831745147705078  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3299, 64]), torch.Size([1, 3299, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2847480773925781  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.308969497680664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3299, 64])
m.shape torch.Size([33648, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3330020904541016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3330020904541016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33648, 64]), torch.Size([1, 33648, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3490467071533203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7020282745361328  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33648, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.677053451538086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.686509132385254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6959648132324219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.686213493347168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39660, 64])
input nodes number: 71493
output nodes number: 39660
edges number: 110255
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6964988708496094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7059545516967773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7084403038024902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7084403038024902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1749, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7196478843688965  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7196478843688965  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1749, 64]), torch.Size([1, 1749, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.720482349395752  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7289738655090332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1749, 64])
m.shape torch.Size([1540, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7293143272399902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7293143272399902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1540, 64]), torch.Size([1, 1540, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.730048656463623  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7416963577270508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1540, 64])
m.shape torch.Size([1114, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7421512603759766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7421512603759766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1114, 64]), torch.Size([1, 1114, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7426824569702148  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7547359466552734  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1114, 64])
m.shape torch.Size([908, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7553634643554688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7553634643554688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 908, 64]), torch.Size([1, 908, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7557964324951172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7683525085449219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 908, 64])
m.shape torch.Size([6057, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7763843536376953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7763843536376953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6057, 64]), torch.Size([1, 6057, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7798466682434082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.886308193206787  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6057, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8768258094787598  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8787670135498047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8804612159729004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8784351348876953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39660
output nodes number: 11368
edges number: 42088
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8788156509399414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016862928867340088 |0.0017302632331848145 |0.046896398067474365 |0.00020903348922729492 |0.013343274593353271 |0.006338596343994141 |
----------------------------------------------------------pseudo_mini_loss sum 1.5641365051269531
for loop block_dataloader item  time:  0.7459397315979004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052623748779296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052623748779296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([94896, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052623748779296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4302, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12479257583618164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12479257583618164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4302, 128]), torch.Size([1, 4302, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12889528274536133  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16171693801879883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4302, 128])
m.shape torch.Size([67416, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22395849227905273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22395849227905273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67416, 128]), torch.Size([1, 67416, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2882513999938965  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2529654502868652  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67416, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1891894340515137  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2062883377075195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2233872413635254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2057538032531738  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71718, 64])
input nodes number: 94896
output nodes number: 71718
edges number: 139134
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.224095344543457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.241194248199463  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.245469093322754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.245469093322754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71718, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.245469093322754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2704, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.274892807006836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.274892807006836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2704, 64]), torch.Size([1, 2704, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2761821746826172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2864971160888672  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2704, 64])
m.shape torch.Size([3202, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2876834869384766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2876834869384766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3202, 64]), torch.Size([1, 3202, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.289210319519043  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.312112808227539  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3202, 64])
m.shape torch.Size([33933, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.336379051208496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.336379051208496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33933, 64]), torch.Size([1, 33933, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.352560043334961  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7169537544250488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33933, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6908655166625977  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.700364112854004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7098627090454102  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7000670433044434  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39839, 64])
input nodes number: 71718
output nodes number: 39839
edges number: 110907
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7103981971740723  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7198967933654785  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7223291397094727  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7223291397094727  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1673, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7336387634277344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7336387634277344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1673, 64]), torch.Size([1, 1673, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7344369888305664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7420310974121094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1673, 64])
m.shape torch.Size([1447, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7423439025878906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7423439025878906  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1447, 64]), torch.Size([1, 1447, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7430343627929688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7579612731933594  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1447, 64])
m.shape torch.Size([1132, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7584514617919922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7584514617919922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1132, 64]), torch.Size([1, 1132, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7589912414550781  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7719335556030273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1132, 64])
m.shape torch.Size([965, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7726130485534668  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7726130485534668  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 965, 64]), torch.Size([1, 965, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.773073673248291  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7864203453063965  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 965, 64])
m.shape torch.Size([6151, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7945098876953125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7945098876953125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6151, 64]), torch.Size([1, 6151, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7978601455688477  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.907789707183838  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6151, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8993330001831055  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9010272026062012  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9027214050292969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.900942325592041  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39839
output nodes number: 11368
edges number: 42578
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9013242721557617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01684870719909668 |0.0017375946044921875 |0.04679350852966309 |0.00020923614501953126 |0.013357305526733398 |0.006398439407348633 |
----------------------------------------------------------pseudo_mini_loss sum 1.5401593446731567
for loop block_dataloader item  time:  0.9029338359832764
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052774906158447266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052774906158447266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95217, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052774906158447266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4333, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12496137619018555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12496137619018555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4333, 128]), torch.Size([1, 4333, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12909364700317383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1630878448486328  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4333, 128])
m.shape torch.Size([67459, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2253556251525879  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2253556251525879  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67459, 128]), torch.Size([1, 67459, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2896895408630371  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.254936695098877  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67459, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1911039352416992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2082204818725586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.225337028503418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2076854705810547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71792, 64])
input nodes number: 95217
output nodes number: 71792
edges number: 139251
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2260475158691406  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2431640625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2474431991577148  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2474431991577148  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71792, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2474431991577148  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2743, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.276845932006836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.276845932006836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2743, 64]), torch.Size([1, 2743, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2781543731689453  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2890052795410156  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2743, 64])
m.shape torch.Size([3161, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2905898094177246  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2905898094177246  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3161, 64]), torch.Size([1, 3161, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.292097568511963  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.314887523651123  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3161, 64])
m.shape torch.Size([33910, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3391461372375488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3391461372375488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33910, 64]), torch.Size([1, 33910, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3553156852722168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7188220024108887  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33910, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6930699348449707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.703108787536621  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7126011848449707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7022652626037598  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39814, 64])
input nodes number: 71792
output nodes number: 39814
edges number: 110795
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.713137149810791  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7231760025024414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7257843017578125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7257843017578125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7370257377624512  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7370257377624512  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1695, 64]), torch.Size([1, 1695, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7378344535827637  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7460265159606934  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1695, 64])
m.shape torch.Size([1487, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7463536262512207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7463536262512207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1487, 64]), torch.Size([1, 1487, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.747063159942627  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7589993476867676  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1487, 64])
m.shape torch.Size([1213, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7595396041870117  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7595396041870117  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1213, 64]), torch.Size([1, 1213, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7601184844970703  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7738847732543945  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1213, 64])
m.shape torch.Size([890, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7744708061218262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7744708061218262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 890, 64]), torch.Size([1, 890, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.774895191192627  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7872023582458496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 890, 64])
m.shape torch.Size([6083, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7949423789978027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7949423789978027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6083, 64]), torch.Size([1, 6083, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7978434562683105  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9041476249694824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6083, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.895681381225586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8973755836486816  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8990697860717773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8972907066345215  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39814
output nodes number: 11368
edges number: 42283
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8976726531982422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016843795776367188 |0.0017415285110473633 |0.04665780067443848 |0.00020996729532877603 |0.013339996337890625 |0.0063626766204833984 |
----------------------------------------------------------pseudo_mini_loss sum 1.5340765714645386
for loop block_dataloader item  time:  1.0587568283081055
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052931785583496094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052931785583496094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95496, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052931785583496094  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4270, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1256566047668457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1256566047668457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4270, 128]), torch.Size([1, 4270, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1297287940979004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1623063087463379  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4270, 128])
m.shape torch.Size([68062, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22517919540405273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22517919540405273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 68062, 128]), torch.Size([1, 68062, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.29158544540405273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.269711971282959  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 68062, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2032880783081055  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2205333709716797  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.237778663635254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.219994068145752  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72332, 64])
input nodes number: 95496
output nodes number: 72332
edges number: 140394
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2384915351867676  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2557368278503418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2600483894348145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2600483894348145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72332, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2600483894348145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2554, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2897491455078125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2897491455078125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2554, 64]), torch.Size([1, 2554, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2909669876098633  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3012943267822266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2554, 64])
m.shape torch.Size([3226, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3023276329040527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3023276329040527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3226, 64]), torch.Size([1, 3226, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.303865909576416  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3269400596618652  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3226, 64])
m.shape torch.Size([34380, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.352330207824707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.352330207824707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34380, 64]), torch.Size([1, 34380, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3687238693237305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7335424423217773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34380, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.707016944885254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7169733047485352  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.726548194885254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.716292381286621  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([40160, 64])
input nodes number: 72332
output nodes number: 40160
edges number: 112146
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.727088451385498  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7370448112487793  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.739576816558838  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.739576816558838  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1580, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7509589195251465  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7509589195251465  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1580, 64]), torch.Size([1, 1580, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7517123222351074  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7595505714416504  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1580, 64])
m.shape torch.Size([1433, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7598786354064941  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7598786354064941  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1433, 64]), torch.Size([1, 1433, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7605624198913574  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.772672176361084  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1433, 64])
m.shape torch.Size([1155, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7731828689575195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7731828689575195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1155, 64]), torch.Size([1, 1155, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7737340927124023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7879047393798828  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1155, 64])
m.shape torch.Size([939, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7885527610778809  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7885527610778809  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 939, 64]), torch.Size([1, 939, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7890009880065918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.801988124847412  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 939, 64])
m.shape torch.Size([6261, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8094615936279297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8094615936279297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6261, 64]), torch.Size([1, 6261, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8124475479125977  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.921731948852539  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6261, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.912693977355957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9148063659667969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9165005683898926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9143033027648926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 40160
output nodes number: 11368
edges number: 42972
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9151058197021484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01684532846723284 |0.0017398425510951451 |0.046596833637782505 |0.0002094677516392299 |0.013774122510637556 |0.006247758865356445 |
----------------------------------------------------------pseudo_mini_loss sum 1.4812898635864258
for loop block_dataloader item  time:  1.2176363468170166
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05314159393310547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05314159393310547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95081, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05314159393310547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4286, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12553739547729492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12553739547729492  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4286, 128]), torch.Size([1, 4286, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1296248435974121  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1623244285583496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4286, 128])
m.shape torch.Size([67719, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22486257553100586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22486257553100586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67719, 128]), torch.Size([1, 67719, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.29126882553100586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.265470027923584  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67719, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.199364185333252  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.216531753540039  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2336993217468262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2159948348999023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72005, 64])
input nodes number: 95081
output nodes number: 72005
edges number: 139724
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2344088554382324  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2515764236450195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2558684349060059  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2558684349060059  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72005, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2558684349060059  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2630, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2854695320129395  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2854695320129395  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2630, 64]), torch.Size([1, 2630, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2867236137390137  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2974295616149902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2630, 64])
m.shape torch.Size([3197, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2984094619750977  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2984094619750977  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3197, 64]), torch.Size([1, 3197, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2999343872070312  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3228025436401367  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3197, 64])
m.shape torch.Size([34220, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.348196029663086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.348196029663086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34220, 64]), torch.Size([1, 34220, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3645133972167969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7291793823242188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34220, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7026252746582031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7126083374023438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7221565246582031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7118749618530273  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([40047, 64])
input nodes number: 72005
output nodes number: 40047
edges number: 111684
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7226943969726562  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7322425842285156  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7352862358093262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7352862358093262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1646, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7466020584106445  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7466020584106445  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1646, 64]), torch.Size([1, 1646, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7473869323730469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7540435791015625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1646, 64])
m.shape torch.Size([1431, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7543549537658691  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7543549537658691  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1431, 64]), torch.Size([1, 1431, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.755037784576416  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7668094635009766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1431, 64])
m.shape torch.Size([1207, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7673587799072266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7673587799072266  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1207, 64]), torch.Size([1, 1207, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.767934799194336  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.783452033996582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1207, 64])
m.shape torch.Size([901, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.784050464630127  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.784050464630127  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 901, 64]), torch.Size([1, 901, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7844805717468262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7969422340393066  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 901, 64])
m.shape torch.Size([6180, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8043246269226074  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8043246269226074  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6180, 64]), torch.Size([1, 6180, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8072714805603027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9151062965393066  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6180, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9066729545593262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9083666801452637  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9100604057312012  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9082818031311035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11365, 40])
input nodes number: 40047
output nodes number: 11365
edges number: 42633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9082465171813965  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016843080520629883 |0.0017348229885101318 |0.04656538367271423 |0.00020968914031982422 |0.013641595840454102 |0.0064411163330078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.4715017080307007
Total (block generation + training)time/epoch 1.322723627090454
Training time/epoch 1.3104143142700195
Training time without block to device /epoch 1.2965357303619385
Training time without total dataloading part /epoch 0.4897744655609131
load block tensor time/epoch 0.13474464416503906
block to device time/epoch 0.013878583908081055
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1656050
Number of first layer input nodes during this epoch:  761476
block dataloader generation time/epoch 1.1920928955078125e-06
for loop block_dataloader item  time:  0.06842327117919922
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052980899810791016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052980899810791016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95596, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052980899810791016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4414, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1257638931274414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1257638931274414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4414, 128]), torch.Size([1, 4414, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1299734115600586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16423797607421875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4414, 128])
m.shape torch.Size([67977, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2269611358642578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2269611358642578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67977, 128]), torch.Size([1, 67977, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2933673858642578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2705211639404297  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67977, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2040400505065918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2214665412902832  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2387261390686035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2207598686218262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72391, 64])
input nodes number: 95596
output nodes number: 72391
edges number: 140368
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2394394874572754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2566990852355957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2610139846801758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2610139846801758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72391, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2610139846801758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2673, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2908530235290527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2908530235290527  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2673, 64]), torch.Size([1, 2673, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.292128086090088  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.30232572555542  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2673, 64])
m.shape torch.Size([3230, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3033146858215332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3033146858215332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3230, 64]), torch.Size([1, 3230, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3048548698425293  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.328303337097168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3230, 64])
m.shape torch.Size([34474, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3536944389343262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3536944389343262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34474, 64]), torch.Size([1, 34474, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3701329231262207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7350411415100098  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34474, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7085328102111816  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7184371948242188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7280640602111816  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7178587913513184  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([40377, 64])
input nodes number: 72391
output nodes number: 40377
edges number: 112555
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.728604793548584  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7382316589355469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7413244247436523  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7413244247436523  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1633, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7526674270629883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7526674270629883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1633, 64]), torch.Size([1, 1633, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7534465789794922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.761392593383789  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1633, 64])
m.shape torch.Size([1443, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7617130279541016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7617130279541016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1443, 64]), torch.Size([1, 1443, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7624015808105469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7734050750732422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1443, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7739086151123047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7739086151123047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1149, 64]), torch.Size([1, 1149, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7744569778442383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7875185012817383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1149, 64])
m.shape torch.Size([923, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7881522178649902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7881522178649902  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 923, 64]), torch.Size([1, 923, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.78859281539917  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.801358699798584  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 923, 64])
m.shape torch.Size([6220, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8087849617004395  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8087849617004395  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6220, 64]), torch.Size([1, 6220, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.811838150024414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9194560050964355  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6220, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.910712718963623  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9124069213867188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9141011238098145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9123220443725586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 40377
output nodes number: 11368
edges number: 42758
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9127082824707031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016869306564331055 |0.0017900466918945312 |0.0466761589050293 |0.0002086162567138672 |0.016199588775634766 |0.006371974945068359 |
----------------------------------------------------------pseudo_mini_loss sum 1.4801703691482544
for loop block_dataloader item  time:  0.22586679458618164
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05250835418701172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05250835418701172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([94654, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05250835418701172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4361, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12470149993896484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12470149993896484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4361, 128]), torch.Size([1, 4361, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1288604736328125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1629481315612793  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4361, 128])
m.shape torch.Size([67301, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2250518798828125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2250518798828125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67301, 128]), torch.Size([1, 67301, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.28923511505126953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.252523422241211  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67301, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1868600845336914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2043118476867676  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2213973999023438  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.20341157913208  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71662, 64])
input nodes number: 94654
output nodes number: 71662
edges number: 138963
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2221035957336426  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2391891479492188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2434606552124023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2434606552124023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71662, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2434606552124023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2727, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.272925853729248  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.272925853729248  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2727, 64]), torch.Size([1, 2727, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2742266654968262  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.284630298614502  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2727, 64])
m.shape torch.Size([3212, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2856035232543945  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2856035232543945  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3212, 64]), torch.Size([1, 3212, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.287135124206543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3101091384887695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3212, 64])
m.shape torch.Size([33967, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3343982696533203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3343982696533203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33967, 64]), torch.Size([1, 33967, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.350595474243164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7150216102600098  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33967, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6884050369262695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6984219551086426  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7079362869262695  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6976218223571777  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39906, 64])
input nodes number: 71662
output nodes number: 39906
edges number: 111052
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7084712982177734  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7179856300354004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7204313278198242  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7204313278198242  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7317280769348145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7317280769348145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1695, 64]), torch.Size([1, 1695, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.732536792755127  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.740823745727539  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1695, 64])
m.shape torch.Size([1470, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7411422729492188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7411422729492188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1470, 64]), torch.Size([1, 1470, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7418432235717773  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7524805068969727  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1470, 64])
m.shape torch.Size([1107, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7529468536376953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7529468536376953  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1107, 64]), torch.Size([1, 1107, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7534751892089844  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7654733657836914  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1107, 64])
m.shape torch.Size([931, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.766125202178955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.766125202178955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 931, 64]), torch.Size([1, 931, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7665696144104004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7794461250305176  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 931, 64])
m.shape torch.Size([6165, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7868032455444336  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7868032455444336  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6165, 64]), torch.Size([1, 6165, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7898101806640625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8984832763671875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6165, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8893728256225586  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8910670280456543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.89276123046875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8909821510314941  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39906
output nodes number: 11368
edges number: 42505
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.891364574432373  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016832947731018066 |0.0017491579055786133 |0.0670323371887207 |0.0002040863037109375 |0.014774680137634277 |0.00613856315612793 |
----------------------------------------------------------pseudo_mini_loss sum 1.4722598791122437
for loop block_dataloader item  time:  0.4253513813018799
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052608489990234375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052608489990234375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([94874, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052608489990234375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4305, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12477302551269531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12477302551269531  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4305, 128]), torch.Size([1, 4305, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12887859344482422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16172313690185547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4305, 128])
m.shape torch.Size([67300, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22385263442993164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22385263442993164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67300, 128]), torch.Size([1, 67300, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.28803491592407227  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2513108253479004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67300, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.185621738433838  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2031002044677734  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.22017240524292  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.202160358428955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71605, 64])
input nodes number: 94874
output nodes number: 71605
edges number: 138905
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2208805084228516  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.237952709197998  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2422208786010742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2422208786010742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71605, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2422208786010742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2639, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.271538257598877  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.271538257598877  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2639, 64]), torch.Size([1, 2639, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2727971076965332  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.282865047454834  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2639, 64])
m.shape torch.Size([3215, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2838430404663086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2838430404663086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3215, 64]), torch.Size([1, 3215, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2853765487670898  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3088555335998535  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3215, 64])
m.shape torch.Size([33832, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3330435752868652  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3330435752868652  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33832, 64]), torch.Size([1, 33832, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3491759300231934  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7134718894958496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33832, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.6868252754211426  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.696894645690918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7063565254211426  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.695991039276123  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39686, 64])
input nodes number: 71605
output nodes number: 39686
edges number: 110565
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7068910598754883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.716352939605713  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7188119888305664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7188119888305664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.730095386505127  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.730095386505127  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1695, 64]), torch.Size([1, 1695, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7309041023254395  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7378740310668945  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1695, 64])
m.shape torch.Size([1470, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7381925582885742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7381925582885742  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1470, 64]), torch.Size([1, 1470, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7388935089111328  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.750229835510254  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1470, 64])
m.shape torch.Size([1125, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7507095336914062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7507095336914062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1125, 64]), torch.Size([1, 1125, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.751246452331543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7633256912231445  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1125, 64])
m.shape torch.Size([941, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7639827728271484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7639827728271484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 941, 64]), torch.Size([1, 941, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7644319534301758  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7774467468261719  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 941, 64])
m.shape torch.Size([6137, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7847671508789062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7847671508789062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6137, 64]), torch.Size([1, 6137, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.787693977355957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.895895004272461  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6137, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8858609199523926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8875551223754883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.889730453491211  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.887951374053955  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39686
output nodes number: 11368
edges number: 42459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8883323669433594  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016841967900594074 |0.0017316341400146484 |0.05994884173075358 |0.0002044836680094401 |0.014337619145711264 |0.006479978561401367 |
----------------------------------------------------------pseudo_mini_loss sum 1.456283688545227
for loop block_dataloader item  time:  0.5808944702148438
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052817344665527344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052817344665527344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95296, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052817344665527344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4437, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1252918243408203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1252918243408203  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4437, 128]), torch.Size([1, 4437, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12952327728271484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16471624374389648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4437, 128])
m.shape torch.Size([67588, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22705745697021484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22705745697021484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67588, 128]), torch.Size([1, 67588, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.29346370697021484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2661657333374023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67588, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2000398635864258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.217212200164795  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.234384536743164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2166752815246582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72025, 64])
input nodes number: 95296
output nodes number: 72025
edges number: 139613
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.235095500946045  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.252267837524414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.256561279296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.256561279296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72025, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.256561279296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2726, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2860426902770996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2860426902770996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2726, 64]), torch.Size([1, 2726, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2873425483703613  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.297741413116455  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2726, 64])
m.shape torch.Size([3176, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2990846633911133  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2990846633911133  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3176, 64]), torch.Size([1, 3176, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3005990982055664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.323838233947754  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3176, 64])
m.shape torch.Size([34014, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.348170280456543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.348170280456543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34014, 64]), torch.Size([1, 34014, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.364389419555664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7288589477539062  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34014, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7022628784179688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7122774124145508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7217941284179688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.711482048034668  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39916, 64])
input nodes number: 72025
output nodes number: 39916
edges number: 111120
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7223320007324219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7318487167358398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7351608276367188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7351608276367188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1736, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7463927268981934  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7463927268981934  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1736, 64]), torch.Size([1, 1736, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.747220516204834  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7546992301940918  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1736, 64])
m.shape torch.Size([1472, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7550091743469238  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7550091743469238  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1472, 64]), torch.Size([1, 1472, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7557110786437988  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7694721221923828  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1472, 64])
m.shape torch.Size([1201, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.770007610321045  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.770007610321045  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1201, 64]), torch.Size([1, 1201, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.770580768585205  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.783531665802002  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1201, 64])
m.shape torch.Size([872, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7841029167175293  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7841029167175293  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 872, 64]), torch.Size([1, 872, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7845187187194824  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.796576976776123  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 872, 64])
m.shape torch.Size([6087, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8038525581359863  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8038525581359863  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6087, 64]), torch.Size([1, 6087, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.806755542755127  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.911573886871338  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6087, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9031314849853516  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9048256874084473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.906519889831543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.904740810394287  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39916
output nodes number: 11368
edges number: 42206
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.905123233795166  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01685422658920288 |0.001723647117614746 |0.05644279718399048 |0.0002067089080810547 |0.013966679573059082 |0.006304502487182617 |
----------------------------------------------------------pseudo_mini_loss sum 1.463956356048584
for loop block_dataloader item  time:  0.7396159172058105
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0527338981628418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0527338981628418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95123, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.0527338981628418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4306, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12490606307983398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12490606307983398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4306, 128]), torch.Size([1, 4306, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1290125846862793  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1618647575378418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4306, 128])
m.shape torch.Size([67446, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22413301467895508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22413301467895508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67446, 128]), torch.Size([1, 67446, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.288454532623291  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2535405158996582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67446, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1897344589233398  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2072124481201172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2243194580078125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2063064575195312  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71752, 64])
input nodes number: 95123
output nodes number: 71752
edges number: 139198
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.225029468536377  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2421364784240723  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.246413230895996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.246413230895996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71752, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.246413230895996  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2655, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2758569717407227  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2758569717407227  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2655, 64]), torch.Size([1, 2655, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2771234512329102  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.287252426147461  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2655, 64])
m.shape torch.Size([3210, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.288332462310791  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.288332462310791  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3210, 64]), torch.Size([1, 3210, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.289863109588623  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3133001327514648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3210, 64])
m.shape torch.Size([33988, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3376049995422363  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3376049995422363  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33988, 64]), torch.Size([1, 33988, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3538117408752441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7182564735412598  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33988, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.691645622253418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7016749382019043  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.711176872253418  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.700850486755371  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39853, 64])
input nodes number: 71752
output nodes number: 39853
edges number: 111039
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7117128372192383  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.721214771270752  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7236390113830566  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7236390113830566  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1638, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7349333763122559  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7349333763122559  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1638, 64]), torch.Size([1, 1638, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7357144355773926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7435274124145508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1638, 64])
m.shape torch.Size([1457, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7438535690307617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7438535690307617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1457, 64]), torch.Size([1, 1457, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7445487976074219  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.758531093597412  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1457, 64])
m.shape torch.Size([1216, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.759080410003662  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.759080410003662  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1216, 64]), torch.Size([1, 1216, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.759660243988037  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7726421356201172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1216, 64])
m.shape torch.Size([924, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7732610702514648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7732610702514648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 924, 64]), torch.Size([1, 924, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7737016677856445  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7864789962768555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 924, 64])
m.shape torch.Size([6133, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7937989234924316  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7937989234924316  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6133, 64]), torch.Size([1, 6133, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7967238426208496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9034509658813477  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6133, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.894979476928711  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8966736793518066  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8983678817749023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8965888023376465  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39853
output nodes number: 11368
edges number: 42561
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8969707489013672  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01684727668762207 |0.00172576904296875 |0.05440430641174317 |0.0002070903778076172 |0.013862228393554688 |0.006249427795410156 |
----------------------------------------------------------pseudo_mini_loss sum 1.4427056312561035
for loop block_dataloader item  time:  0.8971827030181885
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05274057388305664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05274057388305664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95137, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05274057388305664  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4278, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12506103515625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12506103515625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4278, 128]), torch.Size([1, 4278, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12914085388183594  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16177940368652344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4278, 128])
m.shape torch.Size([67653, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2242584228515625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2242584228515625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67653, 128]), torch.Size([1, 67653, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2906646728515625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2641105651855469  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67653, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1980767250061035  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2155680656433105  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2327179908752441  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2146906852722168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71931, 64])
input nodes number: 95137
output nodes number: 71931
edges number: 139584
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2334280014038086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2505779266357422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2548656463623047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2548656463623047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71931, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2548656463623047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2679, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2842869758605957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2842869758605957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2679, 64]), torch.Size([1, 2679, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.28556489944458  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2957854270935059  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2679, 64])
m.shape torch.Size([3257, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.296769142150879  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.296769142150879  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3257, 64]), torch.Size([1, 3257, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2983226776123047  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3218841552734375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3257, 64])
m.shape torch.Size([33914, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3461227416992188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3461227416992188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 33914, 64]), torch.Size([1, 33914, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3622941970825195  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.726668357849121  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 33914, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7000303268432617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7100605964660645  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7195615768432617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7092342376708984  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39850, 64])
input nodes number: 71931
output nodes number: 39850
edges number: 110935
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7200984954833984  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7295994758605957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.731980800628662  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.731980800628662  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1674, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7432308197021484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7432308197021484  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1674, 64]), torch.Size([1, 1674, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7440290451049805  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7509126663208008  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1674, 64])
m.shape torch.Size([1524, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.75126314163208  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.75126314163208  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1524, 64]), torch.Size([1, 1524, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7519898414611816  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.765326976776123  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1524, 64])
m.shape torch.Size([1173, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.765829086303711  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.765829086303711  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1173, 64]), torch.Size([1, 1173, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7663888931274414  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.780064582824707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1173, 64])
m.shape torch.Size([884, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7806544303894043  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7806544303894043  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 884, 64]), torch.Size([1, 884, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7810759544372559  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7933001518249512  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 884, 64])
m.shape torch.Size([6113, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8006048202514648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8006048202514648  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6113, 64]), torch.Size([1, 6113, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.803964614868164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.911301612854004  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6113, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.902857780456543  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9045519828796387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9062461853027344  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9044671058654785  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39850
output nodes number: 11368
edges number: 42342
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9048490524291992  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016852339108784992 |0.0017268657684326172 |0.053031325340270996 |0.00020742416381835938 |0.01380002498626709 |0.006514310836791992 |
----------------------------------------------------------pseudo_mini_loss sum 1.4057643413543701
for loop block_dataloader item  time:  1.053917646408081
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052706241607666016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052706241607666016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95051, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.052706241607666016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4284, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12504196166992188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12504196166992188  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4284, 128]), torch.Size([1, 4284, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12912750244140625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16181182861328125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4284, 128])
m.shape torch.Size([67661, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22429561614990234  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22429561614990234  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67661, 128]), torch.Size([1, 67661, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.29070186614990234  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2642393112182617  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67661, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.1981916427612305  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2156801223754883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2328333854675293  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.214808464050293  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71945, 64])
input nodes number: 95051
output nodes number: 71945
edges number: 139606
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2335429191589355  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2506961822509766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2549848556518555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2549848556518555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([71945, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2549848556518555  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2613, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.284524917602539  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.284524917602539  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2613, 64]), torch.Size([1, 2613, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.285771369934082  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2957401275634766  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2613, 64])
m.shape torch.Size([3143, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.296715259552002  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.296715259552002  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3143, 64]), torch.Size([1, 3143, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2982144355773926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3214573860168457  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3143, 64])
m.shape torch.Size([34187, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.34686279296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.34686279296875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34187, 64]), torch.Size([1, 34187, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3631649017333984  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7278008460998535  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34187, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7012519836425781  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7112598419189453  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7207832336425781  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.710477352142334  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39943, 64])
input nodes number: 71945
output nodes number: 39943
edges number: 111460
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.721320629119873  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7308440208435059  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7340731620788574  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7340731620788574  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1671, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.745412826538086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.745412826538086  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1671, 64]), torch.Size([1, 1671, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7462100982666016  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7530622482299805  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1671, 64])
m.shape torch.Size([1409, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.75335693359375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.75335693359375  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1409, 64]), torch.Size([1, 1409, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7540292739868164  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7667312622070312  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1409, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7672429084777832  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7672429084777832  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1149, 64]), torch.Size([1, 1149, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7677912712097168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7812352180480957  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1149, 64])
m.shape torch.Size([930, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7818760871887207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7818760871887207  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 930, 64]), torch.Size([1, 930, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7823195457458496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.795179843902588  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 930, 64])
m.shape torch.Size([6209, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8025918006896973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8025918006896973  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6209, 64]), torch.Size([1, 6209, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8058209419250488  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9135432243347168  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6209, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9051260948181152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.906820297241211  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9085144996643066  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9067354202270508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11368, 40])
input nodes number: 39943
output nodes number: 11368
edges number: 42701
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.907118320465088  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0169112001146589 |0.0017290796552385604 |0.0521460941859654 |0.00020956993103027344 |0.013713598251342773 |0.006317138671875 |
----------------------------------------------------------pseudo_mini_loss sum 1.3809657096862793
for loop block_dataloader item  time:  1.2143666744232178
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05286455154418945  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05286455154418945  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([95383, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.05286455154418945  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([4270, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1253337860107422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.1253337860107422  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 4270, 128]), torch.Size([1, 4270, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.12940597534179688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.16199016571044922  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 4270, 128])
m.shape torch.Size([67808, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22462081909179688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.22462081909179688  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 67808, 128]), torch.Size([1, 67808, 128])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 0.2910270690917969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2662467956542969  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 67808, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2000699043273926  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.217254638671875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2344393730163574  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.21671724319458  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72078, 64])
input nodes number: 95383
output nodes number: 72078
edges number: 139886
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2351512908935547  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.252336025238037  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2566323280334473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2566323280334473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([72078, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2566323280334473  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([2691, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2861785888671875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2861785888671875  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 2691, 64]), torch.Size([1, 2691, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2874622344970703  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2977285385131836  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 2691, 64])
m.shape torch.Size([3197, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2986602783203125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.2986602783203125  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 3197, 64]), torch.Size([1, 3197, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.300185203552246  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.323526382446289  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 3197, 64])
m.shape torch.Size([34106, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3479208946228027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3479208946228027  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 34106, 64]), torch.Size([1, 34106, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.3641839027404785  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.72874116897583  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 34106, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7021594047546387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7121553421020508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7216906547546387  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7113966941833496  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([39994, 64])
input nodes number: 72078
output nodes number: 39994
edges number: 111403
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.72222900390625  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.731764316558838  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.735032558441162  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.735032558441162  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

m.shape torch.Size([1686, 1, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7463188171386719  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7463188171386719  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1686, 64]), torch.Size([1, 1686, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7471227645874023  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.75468111038208  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1686, 64])
m.shape torch.Size([1461, 2, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.754997730255127  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.754997730255127  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1461, 64]), torch.Size([1, 1461, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.75569486618042  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.76692533493042  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1461, 64])
m.shape torch.Size([1157, 3, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7674307823181152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7674307823181152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 1157, 64]), torch.Size([1, 1157, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7679829597473145  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7811026573181152  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 1157, 64])
m.shape torch.Size([915, 4, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7817268371582031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7817268371582031  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 915, 64]), torch.Size([1, 915, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7821636199951172  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.7948188781738281  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 915, 64])
m.shape torch.Size([6146, 5, 64])
----------------------------------------1
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8021564483642578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.8021564483642578  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

 h.shape torch.Size([1, 6146, 64]), torch.Size([1, 6146, 64])
----------------------------------------3
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.805424690246582  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9137067794799805  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

rst.shape  torch.Size([1, 6146, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9052705764770508  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9069643020629883  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9086580276489258  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.9068794250488281  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

torch.Size([11365, 40])
input nodes number: 39994
output nodes number: 11365
edges number: 42469
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4637451171875 GB
    Memory Allocated: 1.907261848449707  GigaBytes
Max Memory Allocated: 1.933610439300537  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.016914665699005127 |0.001724153757095337 |0.051431894302368164 |0.0002104043960571289 |0.01366358995437622 |0.0063054561614990234 |
----------------------------------------------------------pseudo_mini_loss sum 1.3999992609024048
Total (block generation + training)time/epoch 1.3177134990692139
Training time/epoch 1.3076093196868896
Training time without block to device /epoch 1.293816089630127
Training time without total dataloading part /epoch 0.5287525653839111
load block tensor time/epoch 0.13531732559204102
block to device time/epoch 0.013793230056762695
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1656028
Number of first layer input nodes during this epoch:  761114
