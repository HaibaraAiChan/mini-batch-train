main start at this time 1649563657.3630047
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
for loop block_dataloader item  time:  0.15173959732055664
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1766357421875 GB
    Memory Allocated: 0.07672977447509766  GigaBytes
Max Memory Allocated: 0.07672977447509766  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1766357421875 GB
    Memory Allocated: 0.07672977447509766  GigaBytes
Max Memory Allocated: 0.07672977447509766  GigaBytes

torch.Size([142581, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1766357421875 GB
    Memory Allocated: 0.07672977447509766  GigaBytes
Max Memory Allocated: 0.07672977447509766  GigaBytes

m.shape torch.Size([7311, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.5535888671875 GB
    Memory Allocated: 0.3307209014892578  GigaBytes
Max Memory Allocated: 0.33360958099365234  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5535888671875 GB
    Memory Allocated: 0.3307209014892578  GigaBytes
Max Memory Allocated: 0.33360958099365234  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.5535888671875 GB
    Memory Allocated: 0.33829307556152344  GigaBytes
Max Memory Allocated: 0.33829307556152344  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6063232421875 GB
    Memory Allocated: 0.3940715789794922  GigaBytes
Max Memory Allocated: 0.39755773544311523  GigaBytes

torch.Size([1, 7311, 128])
m.shape torch.Size([9179, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6258544921875 GB
    Memory Allocated: 0.3993391990661621  GigaBytes
Max Memory Allocated: 0.39954471588134766  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6258544921875 GB
    Memory Allocated: 0.3993391990661621  GigaBytes
Max Memory Allocated: 0.39954471588134766  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.6258544921875 GB
    Memory Allocated: 0.4080929756164551  GigaBytes
Max Memory Allocated: 0.4080929756164551  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7703857421875 GB
    Memory Allocated: 0.539823055267334  GigaBytes
Max Memory Allocated: 0.548576831817627  GigaBytes

torch.Size([1, 9179, 128])
m.shape torch.Size([9031, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.7840576171875 GB
    Memory Allocated: 0.5491180419921875  GigaBytes
Max Memory Allocated: 0.5494213104248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7840576171875 GB
    Memory Allocated: 0.5491180419921875  GigaBytes
Max Memory Allocated: 0.5494213104248047  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.7840576171875 GB
    Memory Allocated: 0.5577306747436523  GigaBytes
Max Memory Allocated: 0.5577306747436523  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9949951171875 GB
    Memory Allocated: 0.7505254745483398  GigaBytes
Max Memory Allocated: 0.7641973495483398  GigaBytes

torch.Size([1, 9031, 128])
m.shape torch.Size([8385, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.0125732421875 GB
    Memory Allocated: 0.7622122764587402  GigaBytes
Max Memory Allocated: 0.7641973495483398  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0125732421875 GB
    Memory Allocated: 0.7622122764587402  GigaBytes
Max Memory Allocated: 0.7641973495483398  GigaBytes

----------------------------------------3
 Nvidia-smi: 3.0125732421875 GB
    Memory Allocated: 0.7705168724060059  GigaBytes
Max Memory Allocated: 0.7705168724060059  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2801513671875 GB
    Memory Allocated: 1.0024170875549316  GigaBytes
Max Memory Allocated: 1.0184102058410645  GigaBytes

torch.Size([1, 8385, 128])
m.shape torch.Size([84370, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4813232421875 GB
    Memory Allocated: 1.1995906829833984  GigaBytes
Max Memory Allocated: 1.2047138214111328  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4813232421875 GB
    Memory Allocated: 1.1995906829833984  GigaBytes
Max Memory Allocated: 1.2047138214111328  GigaBytes

----------------------------------------3
 Nvidia-smi: 3.5633544921875 GB
    Memory Allocated: 1.2816219329833984  GigaBytes
Max Memory Allocated: 1.2816219329833984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.187654495239258  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

torch.Size([1, 84370, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 3.957737922668457  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 3.9859371185302734  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.01413631439209  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 3.985055446624756  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

torch.Size([118276, 64])
input nodes number: 142581
output nodes number: 118276
edges number: 508152
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.015323638916016  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.043522834777832  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.050572872161865  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.050572872161865  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

torch.Size([118276, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.050572872161865  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

m.shape torch.Size([3037, 1, 64])
----------------------------------------1
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.154742240905762  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6883544921875 GB
    Memory Allocated: 4.154742240905762  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.6903076171875 GB
    Memory Allocated: 4.156190872192383  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6942138671875 GB
    Memory Allocated: 4.169325828552246  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

torch.Size([1, 3037, 64])
m.shape torch.Size([3836, 2, 64])
----------------------------------------1
 Nvidia-smi: 6.6942138671875 GB
    Memory Allocated: 4.170682430267334  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6942138671875 GB
    Memory Allocated: 4.170682430267334  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.6961669921875 GB
    Memory Allocated: 4.172511577606201  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7020263671875 GB
    Memory Allocated: 4.201315402984619  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

torch.Size([1, 3836, 64])
m.shape torch.Size([3748, 3, 64])
----------------------------------------1
 Nvidia-smi: 6.7020263671875 GB
    Memory Allocated: 4.203165531158447  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7020263671875 GB
    Memory Allocated: 4.203165531158447  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.7020263671875 GB
    Memory Allocated: 4.204952716827393  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7098388671875 GB
    Memory Allocated: 4.244786739349365  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

torch.Size([1, 3748, 64])
m.shape torch.Size([3585, 4, 64])
----------------------------------------1
 Nvidia-smi: 6.7098388671875 GB
    Memory Allocated: 4.247419357299805  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7098388671875 GB
    Memory Allocated: 4.247419357299805  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.7117919921875 GB
    Memory Allocated: 4.249129295349121  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7215576171875 GB
    Memory Allocated: 4.299398422241211  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

torch.Size([1, 3585, 64])
m.shape torch.Size([3451, 5, 64])
----------------------------------------1
 Nvidia-smi: 6.7215576171875 GB
    Memory Allocated: 4.302786350250244  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7215576171875 GB
    Memory Allocated: 4.302786350250244  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.7215576171875 GB
    Memory Allocated: 4.304432392120361  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7332763671875 GB
    Memory Allocated: 4.363675594329834  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

torch.Size([1, 3451, 64])
m.shape torch.Size([3046, 6, 64])
----------------------------------------1
 Nvidia-smi: 6.7332763671875 GB
    Memory Allocated: 4.367346286773682  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7332763671875 GB
    Memory Allocated: 4.367346286773682  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.7352294921875 GB
    Memory Allocated: 4.368798732757568  GigaBytes
Max Memory Allocated: 4.388826370239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7489013671875 GB
    Memory Allocated: 4.431572437286377  GigaBytes
Max Memory Allocated: 4.435929775238037  GigaBytes

torch.Size([1, 3046, 64])
m.shape torch.Size([2716, 7, 64])
----------------------------------------1
 Nvidia-smi: 6.7489013671875 GB
    Memory Allocated: 4.435521125793457  GigaBytes
Max Memory Allocated: 4.435929775238037  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7489013671875 GB
    Memory Allocated: 4.435521125793457  GigaBytes
Max Memory Allocated: 4.435929775238037  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.7489013671875 GB
    Memory Allocated: 4.436816215515137  GigaBytes
Max Memory Allocated: 4.436816215515137  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7781982421875 GB
    Memory Allocated: 4.501570701599121  GigaBytes
Max Memory Allocated: 4.506103515625  GigaBytes

torch.Size([1, 2716, 64])
m.shape torch.Size([2568, 8, 64])
----------------------------------------1
 Nvidia-smi: 6.7781982421875 GB
    Memory Allocated: 4.505974292755127  GigaBytes
Max Memory Allocated: 4.506103515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7781982421875 GB
    Memory Allocated: 4.505974292755127  GigaBytes
Max Memory Allocated: 4.506103515625  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.7801513671875 GB
    Memory Allocated: 4.507198810577393  GigaBytes
Max Memory Allocated: 4.507198810577393  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8699951171875 GB
    Memory Allocated: 4.576996326446533  GigaBytes
Max Memory Allocated: 4.581894397735596  GigaBytes

torch.Size([1, 2568, 64])
m.shape torch.Size([2307, 9, 64])
----------------------------------------1
 Nvidia-smi: 6.8699951171875 GB
    Memory Allocated: 4.581489562988281  GigaBytes
Max Memory Allocated: 4.581894397735596  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8699951171875 GB
    Memory Allocated: 4.581489562988281  GigaBytes
Max Memory Allocated: 4.581894397735596  GigaBytes

----------------------------------------3
 Nvidia-smi: 6.8699951171875 GB
    Memory Allocated: 4.582590103149414  GigaBytes
Max Memory Allocated: 4.582590103149414  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9403076171875 GB
    Memory Allocated: 4.65377140045166  GigaBytes
Max Memory Allocated: 4.658721923828125  GigaBytes

torch.Size([1, 2307, 64])
m.shape torch.Size([27952, 10, 64])
----------------------------------------1
 Nvidia-smi: 7.0086669921875 GB
    Memory Allocated: 4.721958160400391  GigaBytes
Max Memory Allocated: 4.723090171813965  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0086669921875 GB
    Memory Allocated: 4.721958160400391  GigaBytes
Max Memory Allocated: 4.723090171813965  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.0086669921875 GB
    Memory Allocated: 4.735286712646484  GigaBytes
Max Memory Allocated: 4.735286712646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.702213287353516  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([1, 27952, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.6097540855407715  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.623164176940918  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.6365742683410645  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.622745037078857  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([56246, 64])
input nodes number: 118276
output nodes number: 56246
edges number: 411663
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.637456893920898  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.650866985321045  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.654219627380371  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.654219627380371  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

m.shape torch.Size([1654, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.674065113067627  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.674065113067627  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.674853801727295  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.681186199188232  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([1, 1654, 64])
m.shape torch.Size([1503, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.681530952453613  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.681530952453613  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.682248115539551  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.693909645080566  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([1, 1503, 64])
m.shape torch.Size([1171, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.694415092468262  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.694415092468262  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.694973945617676  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.707832336425781  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([1, 1171, 64])
m.shape torch.Size([918, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.708456039428711  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.708456039428711  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1121826171875 GB
    Memory Allocated: 5.708893775939941  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1219482421875 GB
    Memory Allocated: 5.721588134765625  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([1, 918, 64])
m.shape torch.Size([741, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.1219482421875 GB
    Memory Allocated: 5.722280502319336  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1219482421875 GB
    Memory Allocated: 5.722280502319336  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1219482421875 GB
    Memory Allocated: 5.722634315490723  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1375732421875 GB
    Memory Allocated: 5.735357284545898  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([1, 741, 64])
m.shape torch.Size([608, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.1375732421875 GB
    Memory Allocated: 5.736077308654785  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1375732421875 GB
    Memory Allocated: 5.736077308654785  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1375732421875 GB
    Memory Allocated: 5.736367225646973  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1512451171875 GB
    Memory Allocated: 5.748833656311035  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([1, 608, 64])
m.shape torch.Size([515, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.1512451171875 GB
    Memory Allocated: 5.749575614929199  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1512451171875 GB
    Memory Allocated: 5.749575614929199  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1512451171875 GB
    Memory Allocated: 5.749821662902832  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1629638671875 GB
    Memory Allocated: 5.762104034423828  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

torch.Size([1, 515, 64])
m.shape torch.Size([435, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.1629638671875 GB
    Memory Allocated: 5.762836933135986  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1629638671875 GB
    Memory Allocated: 5.762836933135986  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1629638671875 GB
    Memory Allocated: 5.763044834136963  GigaBytes
Max Memory Allocated: 5.768856048583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1746826171875 GB
    Memory Allocated: 5.774872303009033  GigaBytes
Max Memory Allocated: 5.775701999664307  GigaBytes

torch.Size([1, 435, 64])
m.shape torch.Size([384, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.1746826171875 GB
    Memory Allocated: 5.775618076324463  GigaBytes
Max Memory Allocated: 5.775701999664307  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1746826171875 GB
    Memory Allocated: 5.775618076324463  GigaBytes
Max Memory Allocated: 5.775701999664307  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1746826171875 GB
    Memory Allocated: 5.775801181793213  GigaBytes
Max Memory Allocated: 5.775801181793213  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1864013671875 GB
    Memory Allocated: 5.787519931793213  GigaBytes
Max Memory Allocated: 5.788343906402588  GigaBytes

torch.Size([1, 384, 64])
m.shape torch.Size([308, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.1864013671875 GB
    Memory Allocated: 5.788186073303223  GigaBytes
Max Memory Allocated: 5.788343906402588  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1864013671875 GB
    Memory Allocated: 5.788186073303223  GigaBytes
Max Memory Allocated: 5.788343906402588  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1864013671875 GB
    Memory Allocated: 5.788332939147949  GigaBytes
Max Memory Allocated: 5.788343906402588  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1981201171875 GB
    Memory Allocated: 5.798760414123535  GigaBytes
Max Memory Allocated: 5.799494743347168  GigaBytes

torch.Size([1, 308, 64])
m.shape torch.Size([276, 11, 64])
----------------------------------------1
 Nvidia-smi: 8.1981201171875 GB
    Memory Allocated: 5.799433708190918  GigaBytes
Max Memory Allocated: 5.799494743347168  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1981201171875 GB
    Memory Allocated: 5.799433708190918  GigaBytes
Max Memory Allocated: 5.799494743347168  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.1981201171875 GB
    Memory Allocated: 5.799565315246582  GigaBytes
Max Memory Allocated: 5.799565315246582  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2078857421875 GB
    Memory Allocated: 5.809830665588379  GigaBytes
Max Memory Allocated: 5.810554504394531  GigaBytes

torch.Size([1, 276, 64])
m.shape torch.Size([251, 12, 64])
----------------------------------------1
 Nvidia-smi: 8.2078857421875 GB
    Memory Allocated: 5.8105058670043945  GigaBytes
Max Memory Allocated: 5.810554504394531  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2078857421875 GB
    Memory Allocated: 5.8105058670043945  GigaBytes
Max Memory Allocated: 5.810554504394531  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.2078857421875 GB
    Memory Allocated: 5.810626029968262  GigaBytes
Max Memory Allocated: 5.810626029968262  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2196044921875 GB
    Memory Allocated: 5.820805549621582  GigaBytes
Max Memory Allocated: 5.821523666381836  GigaBytes

torch.Size([1, 251, 64])
m.shape torch.Size([225, 13, 64])
----------------------------------------1
 Nvidia-smi: 8.2196044921875 GB
    Memory Allocated: 5.821465015411377  GigaBytes
Max Memory Allocated: 5.821523666381836  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2196044921875 GB
    Memory Allocated: 5.821465015411377  GigaBytes
Max Memory Allocated: 5.821523666381836  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.2196044921875 GB
    Memory Allocated: 5.821572780609131  GigaBytes
Max Memory Allocated: 5.821572780609131  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2313232421875 GB
    Memory Allocated: 5.83144998550415  GigaBytes
Max Memory Allocated: 5.832147598266602  GigaBytes

torch.Size([1, 225, 64])
m.shape torch.Size([180, 14, 64])
----------------------------------------1
 Nvidia-smi: 8.2313232421875 GB
    Memory Allocated: 5.8320159912109375  GigaBytes
Max Memory Allocated: 5.832147598266602  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2313232421875 GB
    Memory Allocated: 5.8320159912109375  GigaBytes
Max Memory Allocated: 5.832147598266602  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.2313232421875 GB
    Memory Allocated: 5.832101821899414  GigaBytes
Max Memory Allocated: 5.832147598266602  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2391357421875 GB
    Memory Allocated: 5.840599060058594  GigaBytes
Max Memory Allocated: 5.84119987487793  GigaBytes

torch.Size([1, 180, 64])
m.shape torch.Size([2199, 15, 64])
----------------------------------------1
 Nvidia-smi: 8.2391357421875 GB
    Memory Allocated: 5.848666667938232  GigaBytes
Max Memory Allocated: 5.848789691925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2391357421875 GB
    Memory Allocated: 5.848666667938232  GigaBytes
Max Memory Allocated: 5.848789691925049  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.2391357421875 GB
    Memory Allocated: 5.849715709686279  GigaBytes
Max Memory Allocated: 5.849715709686279  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2606201171875 GB
    Memory Allocated: 5.962117671966553  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2199, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.2606201171875 GB
    Memory Allocated: 5.945651054382324  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.2606201171875 GB
    Memory Allocated: 5.9473676681518555  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.2606201171875 GB
    Memory Allocated: 5.949297904968262  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.2606201171875 GB
    Memory Allocated: 5.94749641418457  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([11368, 40])
input nodes number: 56246
output nodes number: 11368
edges number: 77297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.2606201171875 GB
    Memory Allocated: 5.949717044830322  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05449938774108887 |0.35294580459594727 |0.6384115219116211 |0.00025534629821777344 |0.06314373016357422 |0.007984638214111328 |
----------------------------------------------------------pseudo_mini_loss sum 4.98357629776001
for loop block_dataloader item  time:  1.4105584621429443
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.08095693588256836  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.08095693588256836  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([142388, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.08095693588256836  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

m.shape torch.Size([7339, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.3348836898803711  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.3348836898803711  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.34188270568847656  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.39795541763305664  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 7339, 128])
m.shape torch.Size([9208, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.40323734283447266  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.40323734283447266  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.4120187759399414  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.5438470840454102  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 9208, 128])
m.shape torch.Size([9042, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.5523910522460938  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.5523910522460938  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.5614252090454102  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.7547998428344727  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 9042, 128])
m.shape torch.Size([8365, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.7661113739013672  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.7661113739013672  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.7747435569763184  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 1.0060906410217285  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 8365, 128])
m.shape torch.Size([84035, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 1.2032737731933594  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 1.2032737731933594  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 1.2853050231933594  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.181753158569336  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 84035, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 3.9523277282714844  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 3.9804587364196777  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.008589744567871  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 3.979579448699951  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([117989, 64])
input nodes number: 142388
output nodes number: 117989
edges number: 506516
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.0100626945495605  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.038193702697754  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.045226573944092  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.045226573944092  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([117989, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.045226573944092  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

m.shape torch.Size([3136, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.148564338684082  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.148564338684082  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.150059700012207  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.163148403167725  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3136, 64])
m.shape torch.Size([3848, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.164841651916504  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.164841651916504  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.1666765213012695  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.195562362670898  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3848, 64])
m.shape torch.Size([3853, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.198307514190674  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.198307514190674  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.200145244598389  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.24193000793457  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3853, 64])
m.shape torch.Size([3578, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.244694232940674  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.244694232940674  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.246400356292725  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.296698093414307  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3578, 64])
m.shape torch.Size([3503, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.300151824951172  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.300151824951172  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.301822662353516  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.3619585037231445  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3503, 64])
m.shape torch.Size([2980, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.3655195236206055  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.3655195236206055  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.366940498352051  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.428042411804199  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2980, 64])
m.shape torch.Size([2667, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.431922435760498  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.431922435760498  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.433194637298584  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.497498512268066  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2667, 64])
m.shape torch.Size([2448, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.501677513122559  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.501677513122559  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.50284481048584  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.571656227111816  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2448, 64])
m.shape torch.Size([2245, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.576040744781494  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.576040744781494  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.577111721038818  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.646219730377197  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2245, 64])
m.shape torch.Size([27724, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.713849067687988  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.713849067687988  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 4.727068901062012  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.693368434906006  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 27724, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.601827621459961  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.615174770355225  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.628521919250488  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.614757537841797  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([55982, 64])
input nodes number: 117989
output nodes number: 55982
edges number: 407796
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.629402160644531  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.642749309539795  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.6460862159729  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.6460862159729  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

m.shape torch.Size([1739, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.665713787078857  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.665713787078857  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.666543483734131  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.673532962799072  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 1739, 64])
m.shape torch.Size([1433, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.67382287979126  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.67382287979126  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.674506664276123  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.686300754547119  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 1433, 64])
m.shape torch.Size([1185, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.686833381652832  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.686833381652832  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.687398910522461  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.704878807067871  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 1185, 64])
m.shape torch.Size([904, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.7054853439331055  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.7054853439331055  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.705916404724121  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.718417167663574  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 904, 64])
m.shape torch.Size([834, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.719326496124268  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.719326496124268  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.719724178314209  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.7340407371521  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 834, 64])
m.shape torch.Size([612, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.734745025634766  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.734745025634766  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.735036849975586  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.747585296630859  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 612, 64])
m.shape torch.Size([519, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.748332977294922  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.748332977294922  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.7485809326171875  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.760958671569824  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 519, 64])
m.shape torch.Size([425, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.76167106628418  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.76167106628418  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.761874198913574  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.773429870605469  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 425, 64])
m.shape torch.Size([352, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.774107456207275  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.774107456207275  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.774275302886963  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.785017490386963  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 352, 64])
m.shape torch.Size([346, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.785784721374512  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.785784721374512  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.78594970703125  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.797663688659668  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 346, 64])
m.shape torch.Size([241, 11, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.798233509063721  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.798233509063721  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.798348903656006  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.807318210601807  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 241, 64])
m.shape torch.Size([234, 12, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.807950973510742  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.807950973510742  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.808062553405762  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.817546844482422  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 234, 64])
m.shape torch.Size([209, 13, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.818159580230713  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.818159580230713  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.8182597160339355  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.82743501663208  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 209, 64])
m.shape torch.Size([166, 14, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.827956676483154  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.827956676483154  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.828035831451416  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.835872173309326  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 166, 64])
m.shape torch.Size([2169, 15, 64])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.843832492828369  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.843832492828369  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.84486722946167  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.954823970794678  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2169, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.938597202301025  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.940422534942627  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.9422478675842285  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.940337657928467  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([11368, 40])
input nodes number: 55982
output nodes number: 11368
edges number: 76314
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 5.940948486328125  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03672337532043457 |0.17840576171875 |0.43752527236938477 |0.0005993843078613281 |0.05492556095123291 |0.0064678192138671875 |
----------------------------------------------------------pseudo_mini_loss sum 3.907571792602539
for loop block_dataloader item  time:  1.8690359592437744
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.08111333847045898  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.08111333847045898  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([142585, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.08111333847045898  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

m.shape torch.Size([7291, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.3350200653076172  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.3350200653076172  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.34197330474853516  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.397794246673584  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 7291, 128])
m.shape torch.Size([9101, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.4029970169067383  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.4029970169067383  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.41167640686035156  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.5434026718139648  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 9101, 128])
m.shape torch.Size([8978, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.5519061088562012  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.5519061088562012  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.5609807968139648  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.7545595169067383  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 8978, 128])
m.shape torch.Size([8306, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.7656669616699219  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.7656669616699219  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 0.7743625640869141  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 1.0040779113769531  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 8306, 128])
m.shape torch.Size([84323, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 1.201289176940918  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 1.201289176940918  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.4656982421875 GB
    Memory Allocated: 1.283320426940918  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.187331199645996  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 84323, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.9576902389526367  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.985823631286621  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.0139570236206055  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.9849443435668945  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([117999, 64])
input nodes number: 142585
output nodes number: 117999
edges number: 507266
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.015233993530273  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.043367385864258  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.050400733947754  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.050400733947754  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([117999, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.050400733947754  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

m.shape torch.Size([3110, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.154892444610596  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.154892444610596  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.156375408172607  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.169960975646973  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3110, 64])
m.shape torch.Size([3735, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.171056270599365  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.171056270599365  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.172837734222412  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.200314998626709  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3735, 64])
m.shape torch.Size([3733, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.202178001403809  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.202178001403809  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.203958511352539  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.243900775909424  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3733, 64])
m.shape torch.Size([3626, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.24657678604126  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.24657678604126  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.248305797576904  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.298447132110596  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3626, 64])
m.shape torch.Size([3380, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.301738262176514  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.301738262176514  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.30334997177124  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.361562252044678  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3380, 64])
m.shape torch.Size([3049, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.3652544021606445  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.3652544021606445  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.366708755493164  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.430366039276123  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 3049, 64])
m.shape torch.Size([2760, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.434389114379883  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.434389114379883  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.435705184936523  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.501508712768555  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2760, 64])
m.shape torch.Size([2562, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.505890369415283  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.505890369415283  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.5071120262146  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.576998233795166  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2562, 64])
m.shape torch.Size([2262, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.581393241882324  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.581393241882324  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.58247184753418  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.652754306793213  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 2262, 64])
m.shape torch.Size([28017, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.721100330352783  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.721100330352783  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.734460353851318  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.702666759490967  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 28017, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.610151290893555  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.623558521270752  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.636965751647949  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.623139381408691  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([56234, 64])
input nodes number: 117999
output nodes number: 56234
edges number: 411821
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.637845993041992  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.6512532234191895  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.655545234680176  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.655545234680176  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

m.shape torch.Size([1687, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.675551891326904  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.675551891326904  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.676356792449951  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.683048725128174  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 1687, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.683374881744385  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.683374881744385  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.684081554412842  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.695925712585449  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 1481, 64])
m.shape torch.Size([1108, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.696389675140381  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.696389675140381  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.69691801071167  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.71017599105835  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 1108, 64])
m.shape torch.Size([909, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.710805892944336  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.710805892944336  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.711239814758301  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.723812103271484  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 909, 64])
m.shape torch.Size([731, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.724494457244873  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.724494457244873  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.724843502044678  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7373948097229  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 731, 64])
m.shape torch.Size([627, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.738145351409912  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.738145351409912  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.738444805145264  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7513041496276855  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 627, 64])
m.shape torch.Size([509, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.752030849456787  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.752030849456787  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.752274036407471  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.764413356781006  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 509, 64])
m.shape torch.Size([437, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.765151500701904  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.765151500701904  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.765360355377197  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.777242183685303  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 437, 64])
m.shape torch.Size([395, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.778012275695801  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.778012275695801  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.778201103210449  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.790260314941406  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 395, 64])
m.shape torch.Size([327, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.790970325469971  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.790970325469971  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.791126728057861  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.8022027015686035  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 327, 64])
m.shape torch.Size([260, 11, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.802827835083008  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.802827835083008  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.802951812744141  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.8126220703125  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 260, 64])
m.shape torch.Size([242, 12, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.813274383544922  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.813274383544922  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.813389778137207  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.823198318481445  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 242, 64])
m.shape torch.Size([209, 13, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.8238091468811035  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.8238091468811035  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.823909282684326  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.833084583282471  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 209, 64])
m.shape torch.Size([171, 14, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.83362340927124  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.83362340927124  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.833705425262451  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.841784954071045  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

torch.Size([1, 171, 64])
m.shape torch.Size([2275, 15, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.85013484954834  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.85013484954834  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.85122013092041  GigaBytes
Max Memory Allocated: 5.969982147216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.967344760894775  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2275, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.950711250305176  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.952446937561035  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.954185485839844  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.952364921569824  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([11368, 40])
input nodes number: 56234
output nodes number: 11368
edges number: 77910
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.952779293060303  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03367002805074056 |0.12045613924662273 |0.3328794638315837 |0.0006187756856282552 |0.057955662409464516 |0.006551980972290039 |
----------------------------------------------------------pseudo_mini_loss sum 3.150831937789917
for loop block_dataloader item  time:  2.2219576835632324
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.08100461959838867  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.08100461959838867  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([142235, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.08100461959838867  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

m.shape torch.Size([7268, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.3348960876464844  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.3348960876464844  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.341827392578125  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.39727783203125  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 7268, 128])
m.shape torch.Size([9157, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.4025449752807617  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.4025449752807617  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.41127777099609375  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.5431699752807617  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 9157, 128])
m.shape torch.Size([9034, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.5516142845153809  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.5516142845153809  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.5605721473693848  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.7543959617614746  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 9034, 128])
m.shape torch.Size([8383, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.7657303810119629  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.7657303810119629  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.7743825912475586  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 1.0071587562561035  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 8383, 128])
m.shape torch.Size([84096, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 1.2043333053588867  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 1.2043333053588867  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 1.2863645553588867  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.184557914733887  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 84096, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.954705238342285  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.9828238487243652  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.010942459106445  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.981945037841797  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([117938, 64])
input nodes number: 142235
output nodes number: 117938
edges number: 506696
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.012423992156982  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.0405426025390625  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.047572612762451  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.047572612762451  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([117938, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.047572612762451  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

m.shape torch.Size([3066, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.151595592498779  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.151595592498779  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.15305757522583  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.166340351104736  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3066, 64])
m.shape torch.Size([3872, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.167646884918213  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.167646884918213  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.169493198394775  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.199282646179199  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3872, 64])
m.shape torch.Size([3896, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.201988697052002  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.201988697052002  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.203846454620361  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.245108604431152  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3896, 64])
m.shape torch.Size([3702, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.247832298278809  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.247832298278809  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.249597549438477  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.300835609436035  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3702, 64])
m.shape torch.Size([3372, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.304098606109619  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.304098606109619  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.30570650100708  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.364063739776611  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3372, 64])
m.shape torch.Size([2977, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.36765193939209  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.36765193939209  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.369071960449219  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.430439472198486  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2977, 64])
m.shape torch.Size([2688, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.434355735778809  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.434355735778809  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.435637474060059  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.499876976013184  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2688, 64])
m.shape torch.Size([2500, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.504153728485107  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.504153728485107  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.505345821380615  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.574435710906982  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2500, 64])
m.shape torch.Size([2254, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.578827381134033  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.578827381134033  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.579902172088623  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.649682998657227  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2254, 64])
m.shape torch.Size([27986, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.717994213104248  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.717994213104248  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.731338977813721  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.698650360107422  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 27986, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.6063618659973145  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.6206254959106445  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.63405179977417  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.619368553161621  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([56313, 64])
input nodes number: 117938
output nodes number: 56313
edges number: 410990
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.63409423828125  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.64835786819458  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.650877475738525  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.650877475738525  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

m.shape torch.Size([1694, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.670632362365723  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.670632362365723  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.671440124511719  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.678177833557129  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 1694, 64])
m.shape torch.Size([1471, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.678497314453125  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.678497314453125  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.67919921875  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.690834045410156  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 1471, 64])
m.shape torch.Size([1172, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.691347599029541  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.691347599029541  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.691906452178955  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.709214687347412  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 1172, 64])
m.shape torch.Size([946, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.709866046905518  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.709866046905518  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.710317134857178  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.723398685455322  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 946, 64])
m.shape torch.Size([780, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.724132061004639  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.724132061004639  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.724503993988037  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.737893581390381  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 780, 64])
m.shape torch.Size([611, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.738609313964844  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.738609313964844  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.738901138305664  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.751432418823242  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 611, 64])
m.shape torch.Size([475, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.75210428237915  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.75210428237915  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.752331256866455  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.763659954071045  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 475, 64])
m.shape torch.Size([434, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.764400482177734  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.764400482177734  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7646074295043945  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.776403427124023  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 434, 64])
m.shape torch.Size([341, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.777054786682129  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.777054786682129  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.777217864990234  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.787629127502441  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 341, 64])
m.shape torch.Size([350, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.788408279418945  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.788408279418945  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.788575172424316  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.800424575805664  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 350, 64])
m.shape torch.Size([284, 11, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.801109313964844  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.801109313964844  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.801244735717773  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.811807632446289  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 284, 64])
m.shape torch.Size([233, 12, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.812427520751953  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.812427520751953  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.812539100646973  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.821989059448242  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 233, 64])
m.shape torch.Size([191, 13, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.822544097900391  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.822544097900391  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.822635650634766  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.831021308898926  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 191, 64])
m.shape torch.Size([175, 14, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.831578254699707  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.831578254699707  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.831662178039551  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.839930534362793  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 175, 64])
m.shape torch.Size([2211, 15, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.84816837310791  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.84816837310791  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.8492231369018555  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.961932182312012  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2211, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.945560455322266  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.947269439697266  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.948978424072266  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.9471845626831055  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([11368, 40])
input nodes number: 56313
output nodes number: 11368
edges number: 76886
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.947662353515625  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.032202959060668945 |0.09153562784194946 |0.2810667157173157 |0.0006497502326965332 |0.05523186922073364 |0.0070421695709228516 |
----------------------------------------------------------pseudo_mini_loss sum 2.7817137241363525
for loop block_dataloader item  time:  2.581526517868042
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.08100652694702148  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.08100652694702148  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([142497, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.08100652694702148  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

m.shape torch.Size([7264, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.33491086959838867  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.33491086959838867  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.34183835983276367  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.39751768112182617  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 7264, 128])
m.shape torch.Size([9243, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.40286874771118164  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.40286874771118164  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.4116835594177246  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.5439057350158691  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 9243, 128])
m.shape torch.Size([9033, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.5526690483093262  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.5526690483093262  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.5613808631896973  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.7547402381896973  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 9033, 128])
m.shape torch.Size([8409, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.7661228179931641  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.7661228179931641  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 0.7747888565063477  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 1.0073528289794922  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 8409, 128])
m.shape torch.Size([84242, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 1.204514980316162  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 1.204514980316162  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 1.286546230316162  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.188394069671631  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 84242, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.9585962295532227  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.9867753982543945  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.014954566955566  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 3.9858946800231934  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([118191, 64])
input nodes number: 142497
output nodes number: 118191
edges number: 507695
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.016386032104492  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.044565200805664  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.051609992980957  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.051609992980957  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([118191, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.051609992980957  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

m.shape torch.Size([3017, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.155932426452637  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.155932426452637  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.157371520996094  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.170515060424805  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3017, 64])
m.shape torch.Size([3803, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.171753883361816  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.171753883361816  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.173567771911621  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.202231407165527  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3803, 64])
m.shape torch.Size([3930, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.2042236328125  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.2042236328125  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.206097602844238  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.247405529022217  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3930, 64])
m.shape torch.Size([3736, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.250143051147461  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.250143051147461  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.251924514770508  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.3044867515563965  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3736, 64])
m.shape torch.Size([3499, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.307898044586182  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.307898044586182  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.309566974639893  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.36963415145874  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3499, 64])
m.shape torch.Size([3129, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.373415946960449  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.373415946960449  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.374908447265625  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.439068794250488  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 3129, 64])
m.shape torch.Size([2726, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.443014621734619  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.443014621734619  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.444314479827881  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.510599136352539  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2726, 64])
m.shape torch.Size([2543, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.514951229095459  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.514951229095459  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.516164302825928  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.585546016693115  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2543, 64])
m.shape torch.Size([2336, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.590108871459961  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.590108871459961  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.591222763061523  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.662991523742676  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 2336, 64])
m.shape torch.Size([27858, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.7310590744018555  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.7310590744018555  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 4.744342803955078  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.710776329040527  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 27858, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.618176460266113  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.6316657066345215  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.64515495300293  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.631243705749512  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([56577, 64])
input nodes number: 118191
output nodes number: 56577
edges number: 412656
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.646036624908447  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.6595258712768555  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.662898540496826  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.662898540496826  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

m.shape torch.Size([1651, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.682913780212402  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.682913780212402  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.683701515197754  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.690123558044434  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 1651, 64])
m.shape torch.Size([1397, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.6904168128967285  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.6904168128967285  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.6910834312438965  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.70147180557251  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 1397, 64])
m.shape torch.Size([1144, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.701982498168945  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.701982498168945  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.70252799987793  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.717217922210693  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 1144, 64])
m.shape torch.Size([953, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7178826332092285  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7178826332092285  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.718337535858154  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.731518268585205  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 953, 64])
m.shape torch.Size([770, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.732237815856934  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.732237815856934  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.73260498046875  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.745822906494141  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 770, 64])
m.shape torch.Size([646, 6, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7465925216674805  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7465925216674805  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.74690055847168  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.760146141052246  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 646, 64])
m.shape torch.Size([499, 7, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7608513832092285  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.7608513832092285  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.76108980178833  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.772990703582764  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 499, 64])
m.shape torch.Size([442, 8, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.773741245269775  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.773741245269775  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.773952007293701  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.785965442657471  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 442, 64])
m.shape torch.Size([386, 9, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.786714553833008  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.786714553833008  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.786898612976074  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.798678398132324  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 386, 64])
m.shape torch.Size([322, 10, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.799378395080566  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.799378395080566  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.799531936645508  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.810433387756348  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 322, 64])
m.shape torch.Size([298, 11, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.811162948608398  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.811162948608398  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.811305046081543  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.822388648986816  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 298, 64])
m.shape torch.Size([250, 12, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.823055267333984  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.823055267333984  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.823174476623535  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.833307266235352  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 250, 64])
m.shape torch.Size([196, 13, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.833874225616455  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.833874225616455  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.833967685699463  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.842566013336182  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 196, 64])
m.shape torch.Size([187, 14, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.843163013458252  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.843163013458252  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.843252658843994  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.852087497711182  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

torch.Size([1, 187, 64])
m.shape torch.Size([2227, 15, 64])
----------------------------------------1
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.860256195068359  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.860256195068359  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6668701171875 GB
    Memory Allocated: 5.861318588256836  GigaBytes
Max Memory Allocated: 5.975481033325195  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 5.975386619567871  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 2227, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 5.958749294281006  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 5.960458278656006  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 5.962167263031006  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 5.960373401641846  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([11368, 40])
input nodes number: 56577
output nodes number: 11368
edges number: 77987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 5.960880279541016  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03189697265625 |0.07420454025268555 |0.24984493255615234 |0.0006674766540527344 |0.0565760612487793 |0.006356477737426758 |
----------------------------------------------------------pseudo_mini_loss sum 2.58587384223938
for loop block_dataloader item  time:  2.941744565963745
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.08102846145629883  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.08102846145629883  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([142575, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.08102846145629883  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

m.shape torch.Size([7261, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.33533334732055664  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.33533334732055664  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.3422579765319824  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.3979215621948242  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 7261, 128])
m.shape torch.Size([9243, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.4032740592956543  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.4032740592956543  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.41208887100219727  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.5445036888122559  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 9243, 128])
m.shape torch.Size([9038, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.5532670021057129  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.5532670021057129  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.561978816986084  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.755579948425293  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 9038, 128])
m.shape torch.Size([8336, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.7668304443359375  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.7668304443359375  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 0.7754545211791992  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6727294921875 GB
    Memory Allocated: 1.0059995651245117  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 8336, 128])
m.shape torch.Size([84527, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.8758544921875 GB
    Memory Allocated: 1.2035527229309082  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8758544921875 GB
    Memory Allocated: 1.2035527229309082  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 8.8758544921875 GB
    Memory Allocated: 1.2855839729309082  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.209412097930908  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 84527, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9789628982543945  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.007193088531494  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.035423278808594  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.00631046295166  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([118405, 64])
input nodes number: 142575
output nodes number: 118405
edges number: 508840
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.037021160125732  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.065251350402832  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0723090171813965  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0723090171813965  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([118405, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0723090171813965  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

m.shape torch.Size([3001, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.178131103515625  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.178131103515625  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.179562568664551  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.192338466644287  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 3001, 64])
m.shape torch.Size([3923, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.193583011627197  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.193583011627197  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195454120635986  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.224538803100586  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 3923, 64])
m.shape torch.Size([3774, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.227319240570068  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.227319240570068  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.229118824005127  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2701921463012695  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 3774, 64])
m.shape torch.Size([3648, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2728800773620605  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2728800773620605  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2746195793151855  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3250651359558105  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 3648, 64])
m.shape torch.Size([3416, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.328394889831543  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.328394889831543  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.330023765563965  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.388663291931152  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 3416, 64])
m.shape torch.Size([3001, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.392276287078857  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.392276287078857  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.393707752227783  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.456004619598389  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 3001, 64])
m.shape torch.Size([2833, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.460165023803711  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.460165023803711  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.461516380310059  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5309553146362305  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 2833, 64])
m.shape torch.Size([2620, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535433292388916  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535433292388916  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.536682605743408  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.608867645263672  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 2620, 64])
m.shape torch.Size([2274, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.613275051116943  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.613275051116943  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.614359378814697  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.6848530769348145  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 2274, 64])
m.shape torch.Size([28175, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.753621578216553  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.753621578216553  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.767056941986084  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.735865116119385  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 28175, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.641985893249512  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.655496120452881  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.66900634765625  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.655073642730713  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([56665, 64])
input nodes number: 118405
output nodes number: 56665
edges number: 414854
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6698899269104  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6834001541137695  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6867780685424805  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6867780685424805  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

m.shape torch.Size([1633, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706677436828613  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706677436828613  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707456588745117  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.71405029296875  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 1633, 64])
m.shape torch.Size([1525, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714410781860352  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714410781860352  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7151384353637695  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727392196655273  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 1525, 64])
m.shape torch.Size([1169, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727890968322754  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727890968322754  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.728448867797852  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.747193336486816  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 1169, 64])
m.shape torch.Size([897, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.747797012329102  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.747797012329102  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.748225212097168  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.760631561279297  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 897, 64])
m.shape torch.Size([791, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.761390209197998  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.761390209197998  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.761767864227295  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775349140167236  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 791, 64])
m.shape torch.Size([533, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775946617126465  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775946617126465  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776201248168945  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78713321685791  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 533, 64])
m.shape torch.Size([545, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787944316864014  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787944316864014  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788204669952393  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801202297210693  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 545, 64])
m.shape torch.Size([450, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801957607269287  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801957607269287  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8021721839904785  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814403057098389  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 450, 64])
m.shape torch.Size([357, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815086364746094  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815086364746094  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8152570724487305  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8261566162109375  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 357, 64])
m.shape torch.Size([340, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826907634735107  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826907634735107  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8270697593688965  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.83858060836792  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 340, 64])
m.shape torch.Size([258, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.839197635650635  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.839197635650635  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.839320659637451  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.848916530609131  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 258, 64])
m.shape torch.Size([231, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.849536895751953  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.849536895751953  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.849647521972656  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859016418457031  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 231, 64])
m.shape torch.Size([218, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859658241271973  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859658241271973  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859762191772461  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869325637817383  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 218, 64])
m.shape torch.Size([192, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869934558868408  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869934558868408  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.870026111602783  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.879089832305908  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

torch.Size([1, 192, 64])
m.shape torch.Size([2229, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.887265205383301  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.887265205383301  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.888328552246094  GigaBytes
Max Memory Allocated: 5.983351230621338  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 6.003006935119629  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2229, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.986475944519043  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.988463878631592  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.990504741668701  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.988431930541992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56665
output nodes number: 11368
edges number: 77526
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.989218235015869  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031222303708394367 |0.06262417634328206 |0.2293694814046224 |0.0006805658340454102 |0.05712616443634033 |0.006578207015991211 |
----------------------------------------------------------pseudo_mini_loss sum 2.4953744411468506
for loop block_dataloader item  time:  3.2978196144104004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08128929138183594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08128929138183594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142552, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08128929138183594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7436, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33535289764404297  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33535289764404297  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34244441986083984  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39917659759521484  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7436, 128])
m.shape torch.Size([9129, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40433692932128906  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40433692932128906  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4130430221557617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.545769214630127  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9129, 128])
m.shape torch.Size([9082, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5542421340942383  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5542421340942383  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5632801055908203  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7569398880004883  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9082, 128])
m.shape torch.Size([8394, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7683639526367188  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7683639526367188  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7769527435302734  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0091018676757812  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8394, 128])
m.shape torch.Size([84332, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2062711715698242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2062711715698242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2883024215698242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.192444801330566  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84332, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.963092803955078  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9913153648376465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.019537925720215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9904332160949707  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118373, 64])
input nodes number: 142552
output nodes number: 118373
edges number: 508176
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0207977294921875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.049020290374756  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0560760498046875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0560760498046875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118373, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0560760498046875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3141, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.160610198974609  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.160610198974609  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.162108421325684  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174553871154785  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3141, 64])
m.shape torch.Size([3779, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175663471221924  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175663471221924  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.177465915679932  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.206105709075928  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3779, 64])
m.shape torch.Size([3887, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.208812713623047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.208812713623047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.210666656494141  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.252353191375732  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3887, 64])
m.shape torch.Size([3691, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.255057334899902  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.255057334899902  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.256817817687988  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307890892028809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3691, 64])
m.shape torch.Size([3422, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.311217784881592  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.311217784881592  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.312849521636963  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.371592044830322  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3422, 64])
m.shape torch.Size([3063, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.375295162200928  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.375295162200928  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.376756191253662  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.440148830413818  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3063, 64])
m.shape torch.Size([2780, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4442033767700195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4442033767700195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.445528984069824  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.514310836791992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2780, 64])
m.shape torch.Size([2520, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.518604755401611  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.518604755401611  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.519806385040283  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.58921480178833  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2520, 64])
m.shape torch.Size([2308, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.593721389770508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.593721389770508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.594821929931641  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.665256500244141  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2308, 64])
m.shape torch.Size([28017, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.733599662780762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.733599662780762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.746959686279297  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715064525604248  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 28017, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.622331142425537  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.635827541351318  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6493239402771  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.635405540466309  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56608, 64])
input nodes number: 118373
output nodes number: 56608
edges number: 413174
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.650207042694092  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.663703441619873  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.667077541351318  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.667077541351318  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1684, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686978816986084  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686978816986084  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687781810760498  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694515705108643  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1684, 64])
m.shape torch.Size([1435, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694819927215576  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694819927215576  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695504665374756  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7067036628723145  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1435, 64])
m.shape torch.Size([1170, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707224369049072  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707224369049072  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.70778226852417  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721216678619385  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1170, 64])
m.shape torch.Size([918, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721840858459473  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721840858459473  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722278594970703  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734972953796387  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 918, 64])
m.shape torch.Size([750, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.735676288604736  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.735676288604736  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.736033916473389  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.748908519744873  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 750, 64])
m.shape torch.Size([638, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.74967098236084  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.74967098236084  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749975204467773  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763056755065918  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 638, 64])
m.shape torch.Size([484, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763737678527832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763737678527832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763968467712402  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775507926940918  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 484, 64])
m.shape torch.Size([439, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776256084442139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776256084442139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776465892791748  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788402080535889  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 439, 64])
m.shape torch.Size([399, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789180755615234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789180755615234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789371490478516  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801552772521973  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 399, 64])
m.shape torch.Size([304, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8022050857543945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8022050857543945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802350044250488  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8126420974731445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 304, 64])
m.shape torch.Size([309, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813405990600586  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813405990600586  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813553810119629  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825052261352539  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 309, 64])
m.shape torch.Size([241, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825689792633057  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825689792633057  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825805187225342  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8355793952941895  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 241, 64])
m.shape torch.Size([215, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836209297180176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836209297180176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836312294006348  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.84575080871582  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 215, 64])
m.shape torch.Size([171, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.846288204193115  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.846288204193115  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.846370220184326  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.85444974899292  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 171, 64])
m.shape torch.Size([2211, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862563610076904  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862563610076904  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.86361837387085  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.976913928985596  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2211, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.960398197174072  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.962320804595947  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.964274883270264  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9622673988342285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56608
output nodes number: 11368
edges number: 77490
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.962708950042725  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03072939600263323 |0.05438542366027832 |0.2137408937726702 |0.0006887572152273995 |0.05556971686226981 |0.006369113922119141 |
----------------------------------------------------------pseudo_mini_loss sum 2.3713538646698
for loop block_dataloader item  time:  3.7098228931427
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08125829696655273  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08125829696655273  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142812, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08125829696655273  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7350, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3371310234069824  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3371310234069824  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34414052963256836  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.400270938873291  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7350, 128])
m.shape torch.Size([9077, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4054226875305176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4054226875305176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4140791893005371  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5460476875305176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9077, 128])
m.shape torch.Size([9025, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5543646812438965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5543646812438965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5635514259338379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7573246955871582  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9025, 128])
m.shape torch.Size([8354, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7685909271240234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7685909271240234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7772421836853027  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0092449188232422  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8354, 128])
m.shape torch.Size([84861, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2083864212036133  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2083864212036133  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2904176712036133  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.214245796203613  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84861, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.982545852661133  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.010838508605957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.039131164550781  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.00995397567749  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118667, 64])
input nodes number: 142812
output nodes number: 118667
edges number: 510300
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.040738105773926  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.06903076171875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076104164123535  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076104164123535  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118667, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076104164123535  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3111, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.181853294372559  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.181853294372559  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.183337211608887  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.19603157043457  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3111, 64])
m.shape torch.Size([3826, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198018550872803  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198018550872803  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.199842929840088  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.228506088256836  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3826, 64])
m.shape torch.Size([3878, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.231277942657471  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.231277942657471  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.233127117156982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.274538040161133  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3878, 64])
m.shape torch.Size([3609, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.277318477630615  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.277318477630615  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2790398597717285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.329765319824219  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3609, 64])
m.shape torch.Size([3482, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.33318567276001  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.33318567276001  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.334846019744873  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.394618511199951  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3482, 64])
m.shape torch.Size([2965, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.398162364959717  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.398162364959717  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.399576663970947  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.460574626922607  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2965, 64])
m.shape torch.Size([2755, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.464609622955322  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.464609622955322  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.46592378616333  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.531611919403076  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2755, 64])
m.shape torch.Size([2466, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535805702209473  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535805702209473  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.536981582641602  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.605868339538574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2466, 64])
m.shape torch.Size([2308, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.610387802124023  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.610387802124023  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.611488342285156  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.682790756225586  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2308, 64])
m.shape torch.Size([28366, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.751984119415283  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.751984119415283  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.765510082244873  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734608173370361  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 28366, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.640702247619629  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.654236316680908  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6677703857421875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.653813362121582  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56766, 64])
input nodes number: 118667
output nodes number: 56766
edges number: 415478
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.668655872344971  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682619571685791  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.685573577880859  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.685573577880859  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1686, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.705544948577881  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.705544948577881  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706348896026611  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7128729820251465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1686, 64])
m.shape torch.Size([1461, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.713189601898193  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.713189601898193  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.713886737823486  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.725734710693359  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1461, 64])
m.shape torch.Size([1158, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726240634918213  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726240634918213  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726792812347412  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.743525505065918  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1158, 64])
m.shape torch.Size([875, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744110107421875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744110107421875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744527816772461  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.756629943847656  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 875, 64])
m.shape torch.Size([825, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.757447242736816  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.757447242736816  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.757841110229492  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.772006034851074  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 825, 64])
m.shape torch.Size([593, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.772684097290039  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.772684097290039  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.772967338562012  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.785129547119141  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 593, 64])
m.shape torch.Size([499, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.785847187042236  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.785847187042236  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.786085605621338  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7979865074157715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 499, 64])
m.shape torch.Size([410, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7986741065979  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7986741065979  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.798869609832764  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.810013294219971  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 410, 64])
m.shape torch.Size([362, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81071662902832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81071662902832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81088924407959  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.82193660736084  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 362, 64])
m.shape torch.Size([302, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8225932121276855  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8225932121276855  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822737216949463  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832961559295654  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 302, 64])
m.shape torch.Size([277, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833639144897461  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833639144897461  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833771705627441  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844079971313477  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 277, 64])
m.shape torch.Size([255, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844766139984131  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844766139984131  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844888210296631  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.85522985458374  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 255, 64])
m.shape torch.Size([193, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.855786323547363  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.855786323547363  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.855878829956055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864352226257324  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 193, 64])
m.shape torch.Size([192, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864966869354248  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864966869354248  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865058422088623  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.874122142791748  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 192, 64])
m.shape torch.Size([2277, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.882474422454834  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.882474422454834  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.883560657501221  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.999593257904053  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2277, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9829936027526855  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.984902381896973  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.98659610748291  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.984602451324463  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11365, 40])
input nodes number: 56766
output nodes number: 11365
edges number: 77775
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.984881401062012  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030753999948501587 |0.048233091831207275 |0.20285198092460632 |0.0006933510303497314 |0.056053489446640015 |0.006390810012817383 |
----------------------------------------------------------pseudo_mini_loss sum 2.2926089763641357
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2537454
Number of first layer input nodes during this epoch:  1140225
for loop block_dataloader item  time:  0.1431264877319336
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08194303512573242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08194303512573242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([143045, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08194303512573242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7346, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3367280960083008  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3367280960083008  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3437337875366211  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3998432159423828  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7346, 128])
m.shape torch.Size([9221, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4051342010498047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4051342010498047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4139280319213867  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5458354949951172  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9221, 128])
m.shape torch.Size([9053, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5546197891235352  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5546197891235352  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5633945465087891  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7567539215087891  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9053, 128])
m.shape torch.Size([8383, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7681155204772949  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7681155204772949  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.776740550994873  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0085854530334473  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8383, 128])
m.shape torch.Size([84651, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2064118385314941  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2064118385314941  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2884430885314941  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.212271213531494  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84651, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.98190975189209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.010199069976807  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.038488388061523  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.009315013885498  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118654, 64])
input nodes number: 143045
output nodes number: 118654
edges number: 509734
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.039790630340576  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.068079948425293  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.075152397155762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.075152397155762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118654, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.075152397155762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3108, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.179774761199951  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.179774761199951  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1812567710876465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.194070339202881  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3108, 64])
m.shape torch.Size([3938, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195332050323486  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195332050323486  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.19720983505249  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.22709321975708  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3938, 64])
m.shape torch.Size([3905, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.22978401184082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.22978401184082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.231646537780762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.273251056671143  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3905, 64])
m.shape torch.Size([3617, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.275877475738525  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.275877475738525  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.277602672576904  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.327621936798096  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3617, 64])
m.shape torch.Size([3499, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.331061363220215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.331061363220215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.332730293273926  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.392797470092773  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3499, 64])
m.shape torch.Size([2990, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.396374225616455  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.396374225616455  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.397799968719482  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.459618091583252  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2990, 64])
m.shape torch.Size([2763, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.463661193847656  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.463661193847656  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.46497917175293  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5313191413879395  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2763, 64])
m.shape torch.Size([2564, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535703659057617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535703659057617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.53692626953125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.60661506652832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2564, 64])
m.shape torch.Size([2306, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.611106872558594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.611106872558594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.61220645904541  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.684271335601807  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2306, 64])
m.shape torch.Size([28017, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7526068687438965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7526068687438965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.765966892242432  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734950542449951  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 28017, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.641388893127441  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.654909133911133  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.668429374694824  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.654486179351807  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56707, 64])
input nodes number: 118654
output nodes number: 56707
edges number: 413379
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.669314384460449  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682834625244141  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687000751495361  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687000751495361  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1615, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7069807052612305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7069807052612305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707751274108887  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714024066925049  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1615, 64])
m.shape torch.Size([1499, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714375972747803  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714375972747803  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715091228485107  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726769924163818  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1499, 64])
m.shape torch.Size([1159, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727267742156982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727267742156982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727820873260498  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.743852615356445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1159, 64])
m.shape torch.Size([899, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744460582733154  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744460582733154  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744889736175537  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.757323741912842  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 899, 64])
m.shape torch.Size([828, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.75822639465332  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.75822639465332  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7586212158203125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.772834777832031  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 828, 64])
m.shape torch.Size([594, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7735137939453125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7735137939453125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.773797035217285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.785976409912109  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 594, 64])
m.shape torch.Size([504, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.786702632904053  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.786702632904053  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.786942958831787  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.798959255218506  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 504, 64])
m.shape torch.Size([439, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7997026443481445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7997026443481445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.799912452697754  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8118486404418945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 439, 64])
m.shape torch.Size([347, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.812511920928955  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.812511920928955  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81267786026001  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823272228240967  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 347, 64])
m.shape torch.Size([309, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823949337005615  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823949337005615  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824097156524658  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834563732147217  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 309, 64])
m.shape torch.Size([275, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.83523416519165  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.83523416519165  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8353657722473145  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.84559965133667  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 275, 64])
m.shape torch.Size([231, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.846215724945068  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.846215724945068  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8463263511657715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8556952476501465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 231, 64])
m.shape torch.Size([205, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.856295585632324  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.856295585632324  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.856393814086914  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.86539363861084  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 205, 64])
m.shape torch.Size([189, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865995407104492  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865995407104492  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.866086006164551  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8750152587890625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 189, 64])
m.shape torch.Size([2275, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.883360862731934  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.883360862731934  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.884446144104004  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 6.0012311935424805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2275, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.984606742858887  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.986438751220703  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.988382339477539  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9864654541015625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56707
output nodes number: 11368
edges number: 77876
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.987111568450928  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03538942337036133 |0.004474639892578125 |0.12032604217529297 |0.0007090568542480469 |0.046564579010009766 |0.0066680908203125 |
----------------------------------------------------------pseudo_mini_loss sum 2.197870969772339
for loop block_dataloader item  time:  0.5486423969268799
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0810847282409668  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0810847282409668  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142343, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0810847282409668  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7326, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33500099182128906  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33500099182128906  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34198760986328125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3979921340942383  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7326, 128])
m.shape torch.Size([9165, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40323925018310547  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40323925018310547  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41197967529296875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.543766975402832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9165, 128])
m.shape torch.Size([8967, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5522241592407227  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5522241592407227  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.561345100402832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7548017501831055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8967, 128])
m.shape torch.Size([8313, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.765906810760498  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.765906810760498  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7746214866638184  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.004530429840088  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8313, 128])
m.shape torch.Size([84111, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2017383575439453  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2017383575439453  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2837696075439453  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.182392120361328  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84111, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9530253410339355  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.981130599975586  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.009235858917236  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.980252265930176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([117882, 64])
input nodes number: 142343
output nodes number: 117882
edges number: 506364
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.010704517364502  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.038809776306152  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.045836448669434  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.045836448669434  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([117882, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.045836448669434  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3084, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.149630546569824  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.149630546569824  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.151101112365723  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.164585113525391  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3084, 64])
m.shape torch.Size([3869, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.165885925292969  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.165885925292969  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.167731285095215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.196672439575195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3869, 64])
m.shape torch.Size([3825, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1995110511779785  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1995110511779785  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.201335430145264  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.242276191711426  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3825, 64])
m.shape torch.Size([3618, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.244922637939453  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.244922637939453  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.246647834777832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.29667854309082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3618, 64])
m.shape torch.Size([3471, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.300083637237549  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.300083637237549  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.30173921585083  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.361325740814209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3471, 64])
m.shape torch.Size([3018, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.364950180053711  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.364950180053711  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.366389274597168  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.429399490356445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3018, 64])
m.shape torch.Size([2739, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.433394432067871  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.433394432067871  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.434700965881348  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.500958442687988  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2739, 64])
m.shape torch.Size([2483, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.505189418792725  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.505189418792725  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.506373882293701  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.575092315673828  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2483, 64])
m.shape torch.Size([2245, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.579468250274658  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.579468250274658  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.580539226531982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.650654315948486  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2245, 64])
m.shape torch.Size([27802, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.718475818634033  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.718475818634033  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7317328453063965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.698355674743652  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 27802, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.606428623199463  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.619816780090332  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.633204936981201  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.61939811706543  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56154, 64])
input nodes number: 117882
output nodes number: 56154
edges number: 409494
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.634084224700928  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.647472381591797  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.651674747467041  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.651674747467041  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1697, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.671342372894287  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.671342372894287  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.672152042388916  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.678812503814697  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1697, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.679136276245117  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.679136276245117  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.679842948913574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.691708564758301  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1481, 64])
m.shape torch.Size([1203, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6922430992126465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6922430992126465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.692817211151123  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708933353424072  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1203, 64])
m.shape torch.Size([900, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709531784057617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709531784057617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7099609375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722406387329102  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 900, 64])
m.shape torch.Size([787, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7231597900390625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7231597900390625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723535537719727  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.737048149108887  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 787, 64])
m.shape torch.Size([601, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7377471923828125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7377471923828125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738034248352051  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.750360488891602  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 601, 64])
m.shape torch.Size([521, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7511138916015625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7511138916015625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7513628005981445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763788223266602  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 521, 64])
m.shape torch.Size([424, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764497756958008  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764497756958008  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764699935913086  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776224136352539  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 424, 64])
m.shape torch.Size([341, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7768778800964355  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7768778800964355  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777040958404541  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787452220916748  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 341, 64])
m.shape torch.Size([345, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788218975067139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788218975067139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788383960723877  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800069332122803  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 345, 64])
m.shape torch.Size([277, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800736427307129  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800736427307129  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800868988037109  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8111772537231445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 277, 64])
m.shape torch.Size([251, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811851978302002  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811851978302002  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811972141265869  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8221516609191895  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 251, 64])
m.shape torch.Size([209, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822760105133057  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822760105133057  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822860240936279  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832035541534424  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 209, 64])
m.shape torch.Size([188, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832633018493652  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832633018493652  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8327226638793945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841597557067871  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 188, 64])
m.shape torch.Size([2143, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.849538326263428  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.849538326263428  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850560665130615  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.959171772003174  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2143, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.942900657653809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.944622993469238  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.946345329284668  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.944538116455078  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56154
output nodes number: 11368
edges number: 76520
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.944931983947754  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03614377975463867 |0.004547238349914551 |0.11937117576599121 |0.0007145404815673828 |0.045873284339904785 |0.006795406341552734 |
----------------------------------------------------------pseudo_mini_loss sum 2.1162402629852295
for loop block_dataloader item  time:  0.9038424491882324
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08105707168579102  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08105707168579102  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142924, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08105707168579102  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7355, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3369407653808594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3369407653808594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34395503997802734  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40011167526245117  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7355, 128])
m.shape torch.Size([9264, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4054393768310547  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4054393768310547  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4142742156982422  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5467967987060547  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9264, 128])
m.shape torch.Size([9113, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5555400848388672  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5555400848388672  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.564302921295166  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7575182914733887  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9113, 128])
m.shape torch.Size([8418, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7692289352416992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7692289352416992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7778806686401367  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0118842124938965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8418, 128])
m.shape torch.Size([84724, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2098679542541504  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2098679542541504  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2918992042541504  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.21572732925415  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84724, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.984379291534424  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.012721061706543  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.041062831878662  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.011835098266602  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118874, 64])
input nodes number: 142924
output nodes number: 118874
edges number: 510514
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.042191028594971  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.07053279876709  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.077618598937988  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.077618598937988  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118874, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.077618598937988  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3050, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.183292865753174  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.183292865753174  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.184747219085693  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1972503662109375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3050, 64])
m.shape torch.Size([3784, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198407173156738  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198407173156738  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.200211524963379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.229630947113037  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3784, 64])
m.shape torch.Size([3901, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.232291221618652  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.232291221618652  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.234151840209961  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.275815010070801  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3901, 64])
m.shape torch.Size([3626, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.278450965881348  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.278450965881348  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.280179977416992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.330321311950684  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3626, 64])
m.shape torch.Size([3516, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.333779335021973  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.333779335021973  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.335455894470215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3958821296691895  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3516, 64])
m.shape torch.Size([3076, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3995819091796875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3995819091796875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.40104866027832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.464582443237305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3076, 64])
m.shape torch.Size([2736, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.468558311462402  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.468558311462402  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.469862937927246  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535407066345215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2736, 64])
m.shape torch.Size([2526, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5397233963012695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5397233963012695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.540927886962891  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.61029052734375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2526, 64])
m.shape torch.Size([2352, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.614892959594727  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.614892959594727  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.61601448059082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.688486099243164  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2352, 64])
m.shape torch.Size([28193, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.757383823394775  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.757383823394775  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.770827770233154  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739704608917236  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 28193, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.645841121673584  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.659373760223389  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.672906398773193  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6589508056640625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56760, 64])
input nodes number: 118874
output nodes number: 56760
edges number: 415319
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.673793315887451  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687325954437256  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.691155910491943  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.691155910491943  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1658, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711063861846924  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711063861846924  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711854457855225  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.718204021453857  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1658, 64])
m.shape torch.Size([1449, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.718521595001221  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.718521595001221  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.719213008880615  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.730410575866699  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1449, 64])
m.shape torch.Size([1162, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.730922222137451  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.730922222137451  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.731476306915283  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.746548652648926  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1162, 64])
m.shape torch.Size([928, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7471842765808105  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7471842765808105  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.747626781463623  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7604594230651855  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 928, 64])
m.shape torch.Size([768, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7611823081970215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7611823081970215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7615485191345215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7747321128845215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 768, 64])
m.shape torch.Size([601, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775435924530029  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775435924530029  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775722980499268  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788049221038818  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 601, 64])
m.shape torch.Size([527, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78881311416626  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78881311416626  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789064884185791  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801633358001709  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 527, 64])
m.shape torch.Size([440, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802372932434082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802372932434082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802582740783691  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814541816711426  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 440, 64])
m.shape torch.Size([393, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815307140350342  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815307140350342  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815495014190674  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.827493190765381  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 393, 64])
m.shape torch.Size([329, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8282084465026855  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8282084465026855  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.828365802764893  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8395094871521  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 329, 64])
m.shape torch.Size([270, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.840161323547363  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.840161323547363  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.840290069580078  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850332260131836  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 270, 64])
m.shape torch.Size([238, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850970268249512  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850970268249512  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.851083755493164  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.860730171203613  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 238, 64])
m.shape torch.Size([214, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861357688903809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861357688903809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861459732055664  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.870847702026367  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 214, 64])
m.shape torch.Size([168, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.87137508392334  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.87137508392334  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.871455192565918  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.879385948181152  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 168, 64])
m.shape torch.Size([2223, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.887545108795166  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.887545108795166  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.88860559463501  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 6.001143932342529  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2223, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.984612464904785  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.986329078674316  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.988190650939941  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.98638916015625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56760
output nodes number: 11368
edges number: 77541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.986891269683838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03240243593851725 |0.004661401112874349 |0.1203460693359375 |0.0007141431172688802 |0.04702123006184896 |0.006580829620361328 |
----------------------------------------------------------pseudo_mini_loss sum 2.0596871376037598
for loop block_dataloader item  time:  1.2499091625213623
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142729, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7394, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3354301452636719  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3354301452636719  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3424816131591797  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3988933563232422  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7394, 128])
m.shape torch.Size([9217, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4041576385498047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4041576385498047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4129476547241211  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5458998680114746  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9217, 128])
m.shape torch.Size([9085, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5546879768371582  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5546879768371582  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.563413143157959  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7570223808288574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9085, 128])
m.shape torch.Size([8376, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7684164047241211  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7684164047241211  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7769923210144043  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.008643627166748  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8376, 128])
m.shape torch.Size([84468, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2060370445251465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2060370445251465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2880682945251465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.19690465927124  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84468, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.966538906097412  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9948010444641113  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0230631828308105  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.993917465209961  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118540, 64])
input nodes number: 142729
output nodes number: 118540
edges number: 508927
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.024586200714111  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0528483390808105  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0599141120910645  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0599141120910645  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118540, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0599141120910645  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3117, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.164296627044678  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.164296627044678  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.165783405303955  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.178342342376709  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3117, 64])
m.shape torch.Size([3845, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.17960786819458  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.17960786819458  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.181441783905029  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.211318016052246  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3845, 64])
m.shape torch.Size([3895, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.214014053344727  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.214014053344727  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.215871810913086  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2567338943481445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3895, 64])
m.shape torch.Size([3657, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.259469509124756  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.259469509124756  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.261213779449463  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.312045574188232  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3657, 64])
m.shape torch.Size([3428, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.315387725830078  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.315387725830078  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.317022323608398  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.37586784362793  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3428, 64])
m.shape torch.Size([3021, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.379507541656494  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.379507541656494  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.380948543548584  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.443502902984619  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3021, 64])
m.shape torch.Size([2717, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4474592208862305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4474592208862305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.448755264282227  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.514418601989746  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2717, 64])
m.shape torch.Size([2530, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.518747329711914  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.518747329711914  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.519953727722168  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.589405059814453  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2530, 64])
m.shape torch.Size([2291, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5938720703125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5938720703125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.594964981079102  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.665005683898926  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2291, 64])
m.shape torch.Size([28003, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.733316898345947  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.733316898345947  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.746670246124268  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714860439300537  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 28003, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.621338367462158  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.634809970855713  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.648281574249268  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6343889236450195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56504, 64])
input nodes number: 118540
output nodes number: 56504
edges number: 412294
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.649166107177734  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.662637710571289  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.666919231414795  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.666919231414795  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1685, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686832427978516  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686832427978516  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687636375427246  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694303512573242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1685, 64])
m.shape torch.Size([1454, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694616794586182  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694616794586182  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695310115814209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706284999847412  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1454, 64])
m.shape torch.Size([1210, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706830978393555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706830978393555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7074079513549805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723811149597168  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1210, 64])
m.shape torch.Size([904, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724411964416504  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724411964416504  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7248430252075195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.737343788146973  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 904, 64])
m.shape torch.Size([749, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738049507141113  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738049507141113  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738407135009766  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751267433166504  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 749, 64])
m.shape torch.Size([606, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751982688903809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751982688903809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.75227165222168  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764697074890137  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 606, 64])
m.shape torch.Size([492, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76539945602417  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76539945602417  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765634059906006  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777364253997803  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 492, 64])
m.shape torch.Size([425, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778083324432373  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778083324432373  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778286457061768  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789842128753662  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 425, 64])
m.shape torch.Size([368, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790555000305176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790555000305176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7907304763793945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8019609451293945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 368, 64])
m.shape torch.Size([327, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802677631378174  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802677631378174  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8028340339660645  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813910007476807  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 327, 64])
m.shape torch.Size([242, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814486503601074  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814486503601074  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814601898193359  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823602676391602  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 242, 64])
m.shape torch.Size([264, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824324131011963  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824324131011963  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8244500160217285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835150241851807  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 264, 64])
m.shape torch.Size([200, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835726737976074  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835726737976074  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835822105407715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844595909118652  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 200, 64])
m.shape torch.Size([171, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.845137119293213  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.845137119293213  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.845219135284424  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853298664093018  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 171, 64])
m.shape torch.Size([2271, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861633777618408  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861633777618408  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862717151641846  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.977511882781982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2271, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.960970878601074  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.962708473205566  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.964637756347656  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.962815284729004  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56504
output nodes number: 11368
edges number: 77535
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.963342189788818  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030616044998168945 |0.004627227783203125 |0.12104970216751099 |0.0007094740867614746 |0.04680156707763672 |0.006653308868408203 |
----------------------------------------------------------pseudo_mini_loss sum 2.0105695724487305
for loop block_dataloader item  time:  1.654162883758545
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142508, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08101701736450195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7326, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3349428176879883  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3349428176879883  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34192943572998047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3979339599609375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7326, 128])
m.shape torch.Size([9038, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4030599594116211  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4030599594116211  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4116792678833008  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5433454513549805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9038, 128])
m.shape torch.Size([9023, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.551943302154541  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.551943302154541  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5609235763549805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7546224594116211  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9023, 128])
m.shape torch.Size([8344, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.765866756439209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.765866756439209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7745161056518555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0052824020385742  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8344, 128])
m.shape torch.Size([84288, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2024755477905273  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2024755477905273  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2845067977905273  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.188193321228027  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84288, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9585342407226562  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9866724014282227  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.014810562133789  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.985792636871338  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118019, 64])
input nodes number: 142508
output nodes number: 118019
edges number: 507287
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0161542892456055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.044292449951172  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.051327228546143  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.051327228546143  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118019, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.051327228546143  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3110, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.155457973480225  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.155457973480225  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.156940937042236  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1703314781188965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3110, 64])
m.shape torch.Size([3761, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1714396476745605  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1714396476745605  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.173233509063721  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.200313091278076  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3761, 64])
m.shape torch.Size([3873, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.202273368835449  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.202273368835449  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.204120635986328  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.245368003845215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3873, 64])
m.shape torch.Size([3647, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2486677169799805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2486677169799805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2504072189331055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.300841331481934  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3647, 64])
m.shape torch.Size([3405, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3041582107543945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3041582107543945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.305782318115234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.364331245422363  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3405, 64])
m.shape torch.Size([3074, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.368054389953613  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.368054389953613  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.36952018737793  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.432549476623535  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3074, 64])
m.shape torch.Size([2721, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.436500072479248  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.436500072479248  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.437798023223877  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.503525257110596  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2721, 64])
m.shape torch.Size([2489, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.507772445678711  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.507772445678711  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.508959770202637  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.577800750732422  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2489, 64])
m.shape torch.Size([2317, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.582334518432617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.582334518432617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.583439826965332  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.65485954284668  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2317, 64])
m.shape torch.Size([27889, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.722940444946289  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.722940444946289  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.736239433288574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.70241641998291  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 27889, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.61013650894165  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.623556137084961  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6369757652282715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.623136520385742  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56286, 64])
input nodes number: 118019
output nodes number: 56286
edges number: 411010
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.637856483459473  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.651276111602783  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6553192138671875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6553192138671875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1708, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675217628479004  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675217628479004  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.676032066345215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682616233825684  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1708, 64])
m.shape torch.Size([1425, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682909965515137  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682909965515137  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.683589935302734  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694666385650635  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1425, 64])
m.shape torch.Size([1156, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695179462432861  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695179462432861  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695730686187744  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709755897521973  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1156, 64])
m.shape torch.Size([912, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710377216339111  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710377216339111  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710812091827393  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723423480987549  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 912, 64])
m.shape torch.Size([772, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724155426025391  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724155426025391  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724523544311523  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.737775802612305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 772, 64])
m.shape torch.Size([622, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738509654998779  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738509654998779  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738806247711182  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751559734344482  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 622, 64])
m.shape torch.Size([482, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752241134643555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752241134643555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752470970153809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763962745666504  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 482, 64])
m.shape torch.Size([448, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764729022979736  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764729022979736  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764942646026611  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777119159698486  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 448, 64])
m.shape torch.Size([377, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7778472900390625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7778472900390625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778027534484863  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78953742980957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 377, 64])
m.shape torch.Size([326, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790248870849609  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790248870849609  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790404319763184  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801441192626953  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 326, 64])
m.shape torch.Size([296, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802164077758789  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802164077758789  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802305221557617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813314437866211  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 296, 64])
m.shape torch.Size([230, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813922882080078  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813922882080078  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814032554626465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823354721069336  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 230, 64])
m.shape torch.Size([226, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.82402229309082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.82402229309082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824130058288574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834044456481934  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 226, 64])
m.shape torch.Size([206, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834700107574463  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834700107574463  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834798336029053  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844522953033447  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 206, 64])
m.shape torch.Size([2182, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8525214195251465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8525214195251465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853561878204346  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.963850498199463  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2182, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.947351932525635  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9491424560546875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.95095157623291  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.949076175689697  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56286
output nodes number: 11368
edges number: 77445
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.949633598327637  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029557085037231444 |0.004644775390625 |0.12076377868652344 |0.0007077217102050781 |0.04674463272094727 |0.006478786468505859 |
----------------------------------------------------------pseudo_mini_loss sum 1.9570292234420776
for loop block_dataloader item  time:  1.9898221492767334
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08109283447265625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08109283447265625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142510, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08109283447265625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7273, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33499860763549805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33499860763549805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3419346809387207  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3976612091064453  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7273, 128])
m.shape torch.Size([9173, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4029412269592285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4029412269592285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41168928146362305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5434842109680176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9173, 128])
m.shape torch.Size([9080, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5520992279052734  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5520992279052734  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5610623359680176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7545037269592285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9080, 128])
m.shape torch.Size([8364, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7658677101135254  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7658677101135254  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7744450569152832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0057644844055176  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8364, 128])
m.shape torch.Size([84255, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2029480934143066  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2029480934143066  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2849793434143066  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1877217292785645  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84255, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.957960605621338  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.986128807067871  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.014297008514404  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.98524808883667  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118145, 64])
input nodes number: 142510
output nodes number: 118145
edges number: 507590
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0157036781311035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.043871879577637  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.050914287567139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.050914287567139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118145, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.050914287567139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3115, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.155623912811279  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.155623912811279  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.15710973739624  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.170505523681641  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3115, 64])
m.shape torch.Size([3819, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.171640872955322  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.171640872955322  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.173462390899658  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2021989822387695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3819, 64])
m.shape torch.Size([3835, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.204952239990234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.204952239990234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.206781387329102  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.248403549194336  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3835, 64])
m.shape torch.Size([3710, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.251177787780762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.251177787780762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.252946853637695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.304369926452637  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3710, 64])
m.shape torch.Size([3348, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307601451873779  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307601451873779  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.309197902679443  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.367417812347412  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3348, 64])
m.shape torch.Size([2973, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.371005535125732  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.371005535125732  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3724236488342285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.433414459228516  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2973, 64])
m.shape torch.Size([2699, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.437351226806641  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.437351226806641  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438638687133789  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.502991676330566  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2699, 64])
m.shape torch.Size([2551, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.507365703582764  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.507365703582764  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.508582592010498  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.578233242034912  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2551, 64])
m.shape torch.Size([2229, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.582557678222656  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.582557678222656  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.583621025085449  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.6530866622924805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2229, 64])
m.shape torch.Size([28244, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.721998691558838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.721998691558838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.735466480255127  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7045369148254395  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 28244, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.61163854598999  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.625114917755127  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.638591289520264  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.624693393707275  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56523, 64])
input nodes number: 118145
output nodes number: 56523
edges number: 413478
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.639472961425781  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.652949333190918  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.656318664550781  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.656318664550781  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1671, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.676323890686035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.676323890686035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.677121162414551  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.683590888977051  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1671, 64])
m.shape torch.Size([1453, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6839070320129395  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6839070320129395  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684600353240967  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695096492767334  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1453, 64])
m.shape torch.Size([1131, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695584774017334  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695584774017334  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.69612455368042  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710574150085449  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1131, 64])
m.shape torch.Size([905, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7111945152282715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7111945152282715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7116265296936035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7241435050964355  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 905, 64])
m.shape torch.Size([787, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724895477294922  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724895477294922  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.725271224975586  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738783836364746  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 787, 64])
m.shape torch.Size([595, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739473819732666  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739473819732666  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739758014678955  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7519612312316895  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 595, 64])
m.shape torch.Size([491, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752664566040039  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752664566040039  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752899169921875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764609336853027  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 491, 64])
m.shape torch.Size([452, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765381336212158  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765381336212158  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765596866607666  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777882099151611  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 452, 64])
m.shape torch.Size([387, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778631210327148  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778631210327148  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778816223144531  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790631294250488  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 387, 64])
m.shape torch.Size([346, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7913899421691895  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7913899421691895  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.791554927825928  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803268909454346  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 346, 64])
m.shape torch.Size([277, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803936004638672  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803936004638672  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.804068565368652  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8143768310546875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 277, 64])
m.shape torch.Size([250, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8150482177734375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8150482177734375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815167427062988  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825300216674805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 250, 64])
m.shape torch.Size([199, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8258771896362305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8258771896362305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825972557067871  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834709167480469  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 199, 64])
m.shape torch.Size([172, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835253715515137  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835253715515137  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835335731506348  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8434553146362305  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 172, 64])
m.shape torch.Size([2252, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.851719856262207  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.851719856262207  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8527936935424805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.968348979949951  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2252, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.951719284057617  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.953472137451172  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.955240249633789  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.953402519226074  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56523
output nodes number: 11368
edges number: 77913
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.953871250152588  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028747161229451496 |0.0046463410059611005 |0.1204375425974528 |0.0007036129633585612 |0.046657284100850425 |0.006346464157104492 |
----------------------------------------------------------pseudo_mini_loss sum 1.8768950700759888
for loop block_dataloader item  time:  2.3239710330963135
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08100557327270508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08100557327270508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142027, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08100557327270508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7308, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3337888717651367  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3337888717651367  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3407583236694336  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3968229293823242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7308, 128])
m.shape torch.Size([9017, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40193748474121094  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40193748474121094  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4105367660522461  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5421829223632812  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9017, 128])
m.shape torch.Size([8873, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5505762100219727  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5505762100219727  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5597610473632812  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7534999847412109  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8873, 128])
m.shape torch.Size([8203, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7642607688903809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7642607688903809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7730574607849121  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.9999241828918457  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8203, 128])
m.shape torch.Size([84189, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.1971845626831055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.1971845626831055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2792158126831055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.180069923400879  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84189, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9509148597717285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9789505004882812  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.006986141204834  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.978074073791504  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([117590, 64])
input nodes number: 142027
output nodes number: 117590
edges number: 505718
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.008098602294922  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.036134243011475  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.043143272399902  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.043143272399902  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([117590, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.043143272399902  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3088, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1468048095703125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1468048095703125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.148277282714844  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.162878036499023  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3088, 64])
m.shape torch.Size([3809, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.164069175720215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.164069175720215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.165885925292969  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.194993495941162  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3809, 64])
m.shape torch.Size([3809, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.196895122528076  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.196895122528076  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.19871187210083  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2396440505981445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3809, 64])
m.shape torch.Size([3645, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.242320537567139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.242320537567139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.244059085845947  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2944655418396  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3645, 64])
m.shape torch.Size([3403, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2977800369262695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2977800369262695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.299403190612793  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3580322265625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3403, 64])
m.shape torch.Size([2960, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3615875244140625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3615875244140625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.362998962402344  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.424028396606445  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2960, 64])
m.shape torch.Size([2760, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.428072929382324  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.428072929382324  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.429388999938965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.495192527770996  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2760, 64])
m.shape torch.Size([2506, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.49946403503418  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.49946403503418  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.500658988952637  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.570229530334473  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2506, 64])
m.shape torch.Size([2288, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.574695110321045  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.574695110321045  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.575786113739014  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.646308422088623  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2288, 64])
m.shape torch.Size([27850, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.714237689971924  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.714237689971924  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.727517604827881  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694393157958984  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 27850, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.602338790893555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.615718364715576  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.629097938537598  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.615300178527832  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56118, 64])
input nodes number: 117590
output nodes number: 56118
edges number: 409948
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.629975318908691  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.643354892730713  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.647424221038818  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.647424221038818  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1719, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.667135238647461  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.667135238647461  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.66795539855957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.674643516540527  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1719, 64])
m.shape torch.Size([1455, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6749491691589355  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6749491691589355  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675643444061279  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686864852905273  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1455, 64])
m.shape torch.Size([1174, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687384128570557  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687384128570557  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687943935394287  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703272342681885  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1174, 64])
m.shape torch.Size([948, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703925132751465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703925132751465  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.704377174377441  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717486381530762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 948, 64])
m.shape torch.Size([768, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.718204498291016  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.718204498291016  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.718570709228516  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.731754302978516  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 768, 64])
m.shape torch.Size([614, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.732477188110352  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.732477188110352  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.732769966125488  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.745359420776367  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 614, 64])
m.shape torch.Size([509, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.746089458465576  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.746089458465576  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.74633264541626  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.758471965789795  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 509, 64])
m.shape torch.Size([421, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.759178638458252  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.759178638458252  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.759379863739014  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.770826816558838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 421, 64])
m.shape torch.Size([378, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7715630531311035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7715630531311035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.771743297576904  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.783278942108154  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 378, 64])
m.shape torch.Size([292, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.783906936645508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.783906936645508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784046173095703  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79393196105957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 292, 64])
m.shape torch.Size([263, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79457426071167  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79457426071167  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7947001457214355  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.804487705230713  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 263, 64])
m.shape torch.Size([258, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8051862716674805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8051862716674805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.805309295654297  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815766334533691  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 258, 64])
m.shape torch.Size([192, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816318511962891  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816318511962891  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816410064697266  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824832916259766  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 192, 64])
m.shape torch.Size([177, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825396537780762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825396537780762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825481414794922  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833844184875488  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 177, 64])
m.shape torch.Size([2200, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841926097869873  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841926097869873  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.84297513961792  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.954692840576172  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2200, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.938373565673828  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.940305709838867  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.942237854003906  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.940220832824707  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56118
output nodes number: 11368
edges number: 76683
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.940903186798096  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02817647797720773 |0.004653487886701312 |0.12009988512311663 |0.0007004056658063616 |0.046783311026436944 |0.0065460205078125 |
----------------------------------------------------------pseudo_mini_loss sum 1.894700527191162
for loop block_dataloader item  time:  2.6569931507110596
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08124399185180664  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08124399185180664  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142649, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08124399185180664  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7251, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33562374114990234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33562374114990234  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34253883361816406  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3981499671936035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7251, 128])
m.shape torch.Size([9186, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40345287322998047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40345287322998047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4122133255004883  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5440778732299805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9186, 128])
m.shape torch.Size([9066, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5526094436645508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5526094436645508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5614843368530273  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.755244255065918  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9066, 128])
m.shape torch.Size([8312, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7664890289306641  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7664890289306641  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7750616073608398  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0049428939819336  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8312, 128])
m.shape torch.Size([84588, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.202652931213379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.202652931213379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.284684181213379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.208512306213379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84588, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9777755737304688  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.00600528717041  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.034235000610352  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.005122661590576  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118403, 64])
input nodes number: 142649
output nodes number: 118403
edges number: 509009
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.035687446594238  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.06391716003418  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.070974826812744  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.070974826812744  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118403, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.070974826812744  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3024, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175908088684082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175908088684082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.177350044250488  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.19021463394165  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3024, 64])
m.shape torch.Size([3886, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.191404819488525  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.191404819488525  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.193257808685303  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.222567558288574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3886, 64])
m.shape torch.Size([3788, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.225403308868408  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.225403308868408  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.227209568023682  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2681474685668945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3788, 64])
m.shape torch.Size([3664, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.270847797393799  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.270847797393799  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.272594928741455  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.32420539855957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3664, 64])
m.shape torch.Size([3435, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.327555179595947  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.327555179595947  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.329193592071533  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.388162136077881  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3435, 64])
m.shape torch.Size([3079, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.391885280609131  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.391885280609131  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3933539390563965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.45758056640625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3079, 64])
m.shape torch.Size([2785, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.461639881134033  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.461639881134033  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.462968349456787  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.531732082366943  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2785, 64])
m.shape torch.Size([2561, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.536105632781982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.536105632781982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.537327289581299  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.6070733070373535  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2561, 64])
m.shape torch.Size([2310, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.611574172973633  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.611574172973633  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.612675666809082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.684504985809326  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2310, 64])
m.shape torch.Size([28042, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.752901077270508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.752901077270508  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.76627254486084  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734286308288574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 28042, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.641585350036621  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.655073642730713  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.668561935424805  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.654652118682861  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56574, 64])
input nodes number: 118403
output nodes number: 56574
edges number: 413658
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.669445514678955  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682933807373047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686305999755859  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686305999755859  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1675, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706251621246338  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706251621246338  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707050800323486  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.713821887969971  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1675, 64])
m.shape torch.Size([1490, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714155197143555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714155197143555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714865684509277  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727410316467285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1490, 64])
m.shape torch.Size([1082, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727853298187256  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727853298187256  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.728369235992432  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.745063304901123  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1082, 64])
m.shape torch.Size([924, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.74571418762207  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.74571418762207  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.74615478515625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.758932113647461  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 924, 64])
m.shape torch.Size([763, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.759650230407715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.759650230407715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.760014533996582  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.773115158081055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 763, 64])
m.shape torch.Size([635, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.77386999130249  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.77386999130249  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.774173259735107  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787196636199951  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 635, 64])
m.shape torch.Size([519, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787938594818115  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787938594818115  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788186550140381  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800564289093018  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 519, 64])
m.shape torch.Size([423, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801272392272949  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801272392272949  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801474571228027  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.812975883483887  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 423, 64])
m.shape torch.Size([385, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813727378845215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813727378845215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813911437988281  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825665473937988  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 385, 64])
m.shape torch.Size([325, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8263726234436035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8263726234436035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826528072357178  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837536334991455  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 325, 64])
m.shape torch.Size([303, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.838278770446777  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.838278770446777  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.838423728942871  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.849699020385742  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 303, 64])
m.shape torch.Size([215, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850261211395264  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850261211395264  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8503642082214355  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859084606170654  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 215, 64])
m.shape torch.Size([211, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859707832336426  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859707832336426  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859808921813965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869071960449219  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 211, 64])
m.shape torch.Size([163, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869582653045654  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869582653045654  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8696608543396  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8773627281188965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 163, 64])
m.shape torch.Size([2252, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.885629177093506  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.885629177093506  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.886703014373779  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 6.001132011413574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2252, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.984560489654541  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.986424922943115  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.988556385040283  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.986607074737549  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11365, 40])
input nodes number: 56574
output nodes number: 11365
edges number: 77672
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.987045764923096  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027753591537475586 |0.004677474498748779 |0.11990523338317871 |0.0007005631923675537 |0.04651749134063721 |0.006566286087036133 |
----------------------------------------------------------pseudo_mini_loss sum 1.8356149196624756
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2538468
Number of first layer input nodes during this epoch:  1140735
block dataloader generation time/epoch 7.152557373046875e-07
for loop block_dataloader item  time:  0.11608624458312988
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08114290237426758  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08114290237426758  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142756, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08114290237426758  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7305, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33506155014038086  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33506155014038086  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3420281410217285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3979225158691406  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7305, 128])
m.shape torch.Size([9167, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4031815528869629  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4031815528869629  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.411923885345459  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5437130928039551  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9167, 128])
m.shape torch.Size([9101, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.552361011505127  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.552361011505127  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5612912178039551  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7547440528869629  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9101, 128])
m.shape torch.Size([8409, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7662239074707031  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7662239074707031  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7747926712036133  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0073566436767578  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8409, 128])
m.shape torch.Size([84108, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2045187950134277  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2045187950134277  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2865500450134277  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.185086727142334  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84108, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.955453395843506  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9836082458496094  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.011763095855713  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9827280044555664  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118090, 64])
input nodes number: 142756
output nodes number: 118090
edges number: 507118
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.01322078704834  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.041375637054443  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.048414707183838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.048414707183838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118090, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.048414707183838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3106, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.152404308319092  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.152404308319092  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.153885364532471  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.167054176330566  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3106, 64])
m.shape torch.Size([3816, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.169127941131592  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.169127941131592  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.170947551727295  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.199674129486084  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3816, 64])
m.shape torch.Size([3843, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.202342987060547  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.202342987060547  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.20417594909668  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2458391189575195  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3843, 64])
m.shape torch.Size([3631, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.248523235321045  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.248523235321045  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.250255107879639  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.300556659698486  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3631, 64])
m.shape torch.Size([3427, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.303904056549072  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.303904056549072  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.305538654327393  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.364369869232178  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3427, 64])
m.shape torch.Size([3089, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.368109703063965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.368109703063965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3695831298828125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4340386390686035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3089, 64])
m.shape torch.Size([2738, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438014507293701  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438014507293701  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.439320087432861  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.505166053771973  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2738, 64])
m.shape torch.Size([2514, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.509458541870117  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.509458541870117  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.51065731048584  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.580081939697266  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2514, 64])
m.shape torch.Size([2221, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584397792816162  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584397792816162  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5854573249816895  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.654277324676514  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2221, 64])
m.shape torch.Size([27948, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.722463130950928  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.722463130950928  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.735789775848389  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7022294998168945  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 27948, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.609899520874023  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.623330593109131  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.636761665344238  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.622910499572754  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56333, 64])
input nodes number: 118090
output nodes number: 56333
edges number: 411207
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.637642860412598  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.651073932647705  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6544318199157715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6544318199157715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1701, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.674333572387695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.674333572387695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675145149230957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.681768417358398  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1701, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682091236114502  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682091236114502  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682797908782959  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694080829620361  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1481, 64])
m.shape torch.Size([1134, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694564342498779  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694564342498779  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695105075836182  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711170673370361  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1134, 64])
m.shape torch.Size([866, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711752414703369  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711752414703369  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.712165355682373  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724140644073486  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 866, 64])
m.shape torch.Size([774, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724885940551758  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724885940551758  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.725255012512207  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738541603088379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 774, 64])
m.shape torch.Size([665, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739338397979736  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739338397979736  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7396559715271  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753294467926025  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 665, 64])
m.shape torch.Size([501, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753998279571533  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753998279571533  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.754237651824951  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.766186237335205  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 501, 64])
m.shape torch.Size([411, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.766875267028809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.766875267028809  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.767071723937988  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778246879577637  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 411, 64])
m.shape torch.Size([344, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778910160064697  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778910160064697  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.779074192047119  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789572238922119  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 344, 64])
m.shape torch.Size([329, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790299415588379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790299415588379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790456771850586  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801600456237793  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 329, 64])
m.shape torch.Size([299, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.80233097076416  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.80233097076416  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802474021911621  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813600540161133  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 299, 64])
m.shape torch.Size([235, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814222812652588  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814222812652588  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814335346221924  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823866367340088  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 235, 64])
m.shape torch.Size([220, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8245134353637695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8245134353637695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824618339538574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8342695236206055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 220, 64])
m.shape torch.Size([188, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834864616394043  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834864616394043  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834954261779785  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.843829154968262  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 188, 64])
m.shape torch.Size([2220, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8519721031188965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8519721031188965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853030681610107  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.967065334320068  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2220, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.950551509857178  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.952407360076904  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9543776512146  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.952436923980713  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56333
output nodes number: 11368
edges number: 77471
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.952933311462402  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02469658851623535 |0.004872322082519531 |0.11861562728881836 |0.0007100105285644531 |0.045218467712402344 |0.006349325180053711 |
----------------------------------------------------------pseudo_mini_loss sum 1.8022960424423218
for loop block_dataloader item  time:  0.45320773124694824
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08114099502563477  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08114099502563477  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142116, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08114099502563477  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7268, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3350248336791992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3350248336791992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34195613861083984  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3976564407348633  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7268, 128])
m.shape torch.Size([9056, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40282726287841797  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40282726287841797  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41146373748779297  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.543147087097168  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9056, 128])
m.shape torch.Size([9026, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5517406463623047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5517406463623047  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.560725212097168  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.754389762878418  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9026, 128])
m.shape torch.Size([8379, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7657051086425781  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7657051086425781  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7743668556213379  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.006101131439209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8379, 128])
m.shape torch.Size([84032, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.203277587890625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.203277587890625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.285308837890625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.181671142578125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84032, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.952322006225586  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.980398654937744  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.008475303649902  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.979520797729492  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([117761, 64])
input nodes number: 142116
output nodes number: 117761
edges number: 506134
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.009950160980225  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.038026809692383  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.045046329498291  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.045046329498291  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([117761, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.045046329498291  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3070, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1494927406311035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1494927406311035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.150956630706787  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1642584800720215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3070, 64])
m.shape torch.Size([3777, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.165414333343506  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.165414333343506  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.167215824127197  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195650577545166  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3777, 64])
m.shape torch.Size([3848, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.197699069976807  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.197699069976807  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.199533939361572  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.241458892822266  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3848, 64])
m.shape torch.Size([3705, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.24420166015625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.24420166015625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.245968818664551  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.297269821166992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3705, 64])
m.shape torch.Size([3525, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.30072021484375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.30072021484375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.302401542663574  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3629150390625  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3525, 64])
m.shape torch.Size([3032, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.366547584533691  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.366547584533691  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.367993354797363  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.430161476135254  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3032, 64])
m.shape torch.Size([2748, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.434168338775635  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.434168338775635  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.435478687286377  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.501200199127197  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2748, 64])
m.shape torch.Size([2557, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.505574703216553  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.505574703216553  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.506794452667236  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.576404094696045  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2557, 64])
m.shape torch.Size([2307, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.580899715423584  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.580899715423584  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.582000255584717  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.652409076690674  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2307, 64])
m.shape torch.Size([27940, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7206549644470215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7206549644470215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.733977794647217  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.701155662536621  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 27940, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6085205078125  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.621993541717529  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.635466575622559  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.621572494506836  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56509, 64])
input nodes number: 117761
output nodes number: 56509
edges number: 412660
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.636345386505127  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.650715351104736  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.653186798095703  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.653186798095703  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1623, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.673186779022217  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.673186779022217  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.673961162567139  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.680287837982178  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1623, 64])
m.shape torch.Size([1447, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.680612564086914  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.680612564086914  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.681303024291992  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.693367004394531  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1447, 64])
m.shape torch.Size([1181, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6938934326171875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6938934326171875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694457054138184  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710679531097412  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1181, 64])
m.shape torch.Size([910, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711292743682861  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711292743682861  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711726665496826  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724310398101807  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 910, 64])
m.shape torch.Size([807, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.725086212158203  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.725086212158203  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.725471496582031  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739327430725098  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 807, 64])
m.shape torch.Size([586, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739999294281006  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739999294281006  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.740278720855713  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752294063568115  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 586, 64])
m.shape torch.Size([500, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753015041351318  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753015041351318  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.75325345993042  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765174388885498  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 500, 64])
m.shape torch.Size([451, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765942573547363  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765942573547363  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.766158103942871  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778420448303223  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 451, 64])
m.shape torch.Size([395, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.779187202453613  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.779187202453613  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.779376029968262  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.791435241699219  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 395, 64])
m.shape torch.Size([324, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.792137622833252  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.792137622833252  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79229211807251  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8032612800598145  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 324, 64])
m.shape torch.Size([274, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803925514221191  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803925514221191  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.804056167602539  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814247131347656  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 274, 64])
m.shape torch.Size([243, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81489896774292  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81489896774292  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8150153160095215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824870586395264  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 243, 64])
m.shape torch.Size([191, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825423240661621  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825423240661621  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825514793395996  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833900451660156  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 191, 64])
m.shape torch.Size([162, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834412574768066  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834412574768066  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834489822387695  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842137336730957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 162, 64])
m.shape torch.Size([2274, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850485324859619  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850485324859619  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.851569652557373  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9672064781188965  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2274, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.950565338134766  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.952396392822266  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.954227447509766  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9523115158081055  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([11368, 40])
input nodes number: 56509
output nodes number: 11368
edges number: 77945
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.952792644500732  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024880170822143555 |0.004758954048156738 |0.12102961540222168 |0.0007172822952270508 |0.0454561710357666 |0.006285667419433594 |
----------------------------------------------------------pseudo_mini_loss sum 1.7860833406448364
for loop block_dataloader item  time:  0.8560559749603271
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08116769790649414  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08116769790649414  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([142912, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08116769790649414  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([7423, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3359642028808594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3359642028808594  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34304332733154297  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3996763229370117  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 7423, 128])
m.shape torch.Size([9181, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4048924446105957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4048924446105957  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4136481285095215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5463557243347168  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9181, 128])
m.shape torch.Size([9016, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5548086166381836  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5548086166381836  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5636978149414062  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7575960159301758  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 9016, 128])
m.shape torch.Size([8376, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7688913345336914  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7688913345336914  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7775659561157227  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0101327896118164  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 8376, 128])
m.shape torch.Size([84669, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.208005428314209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.208005428314209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.290036678314209  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2132487297058105  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 84669, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9825453758239746  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.010837554931641  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.039129734039307  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.009953022003174  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118665, 64])
input nodes number: 142912
output nodes number: 118665
edges number: 509682
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.040389060974121  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.068681240081787  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.075754642486572  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.075754642486572  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([118665, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.075754642486572  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([3061, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1814494132995605  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1814494132995605  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1829094886779785  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195280075073242  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3061, 64])
m.shape torch.Size([3836, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.196436405181885  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.196436405181885  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198265552520752  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.227645397186279  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3836, 64])
m.shape torch.Size([3938, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.230374336242676  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.230374336242676  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.23225212097168  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.274072170257568  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3938, 64])
m.shape torch.Size([3642, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.276797294616699  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.276797294616699  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.278533935546875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.329388618469238  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3642, 64])
m.shape torch.Size([3408, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.332710266113281  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.332710266113281  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3343353271484375  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.393084526062012  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3408, 64])
m.shape torch.Size([3089, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.396829128265381  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.396829128265381  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3983025550842285  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.462360382080078  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 3089, 64])
m.shape torch.Size([2844, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.466518878936768  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.466518878936768  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.467875003814697  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.53677225112915  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2844, 64])
m.shape torch.Size([2613, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.541234016418457  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.541234016418457  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.54248046875  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.6135053634643555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2613, 64])
m.shape torch.Size([2305, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.617983341217041  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.617983341217041  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.619082927703857  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.689477443695068  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 2305, 64])
m.shape torch.Size([28169, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7582526206970215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7582526206970215  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7716851234436035  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7404704093933105  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 28169, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.646165370941162  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.659732818603516  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.673300266265869  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.659308433532715  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([56905, 64])
input nodes number: 118665
output nodes number: 56905
edges number: 415936
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.674185752868652  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687753200531006  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.691775321960449  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.691775321960449  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

m.shape torch.Size([1657, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711796760559082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711796760559082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.712587356567383  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.718975067138672  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1657, 64])
m.shape torch.Size([1491, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.719313144683838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.719313144683838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.720024585723877  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.731508731842041  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1491, 64])
m.shape torch.Size([1123, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7319817543029785  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7319817543029785  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.732517719268799  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.748897075653076  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 1123, 64])
m.shape torch.Size([896, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749510288238525  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749510288238525  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749937534332275  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.762327671051025  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 896, 64])
m.shape torch.Size([755, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763042449951172  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763042449951172  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763402938842773  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776366233825684  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 755, 64])
m.shape torch.Size([592, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777059555053711  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777059555053711  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777341842651367  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789480209350586  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 592, 64])
m.shape torch.Size([531, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790253639221191  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790253639221191  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7905073165893555  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803171157836914  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 531, 64])
m.shape torch.Size([449, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803927898406982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803927898406982  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.804142475128174  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81635046005249  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 449, 64])
m.shape torch.Size([385, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.817095756530762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.817095756530762  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.817279815673828  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.829033851623535  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 385, 64])
m.shape torch.Size([315, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.829716682434082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.829716682434082  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.829867362976074  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.840537071228027  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 315, 64])
m.shape torch.Size([300, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841273307800293  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841273307800293  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841416358947754  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.852574348449707  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 300, 64])
m.shape torch.Size([213, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853131294250488  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853131294250488  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853233337402344  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861872673034668  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 213, 64])
m.shape torch.Size([212, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862499713897705  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862499713897705  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862600803375244  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.871901035308838  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 212, 64])
m.shape torch.Size([185, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.872487545013428  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.872487545013428  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8725762367248535  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.881316661834717  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

torch.Size([1, 185, 64])
m.shape torch.Size([2264, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.889622211456299  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.889622211456299  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.890701770782471  GigaBytes
Max Memory Allocated: 6.010978698730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 6.00697660446167  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2264, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.990324974060059  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.992105484008789  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.994193077087402  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.992327690124512  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56905
output nodes number: 11368
edges number: 78005
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.992786407470703  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02693454424540202 |0.005212704340616862 |0.12037102381388347 |0.0007304350535074869 |0.050385077794392906 |0.006669044494628906 |
----------------------------------------------------------pseudo_mini_loss sum 1.721880316734314
for loop block_dataloader item  time:  1.2099051475524902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08108186721801758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08108186721801758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142436, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08108186721801758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7272, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33518075942993164  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33518075942993164  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3421158790588379  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39783716201782227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7272, 128])
m.shape torch.Size([9038, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40298891067504883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40298891067504883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4116082191467285  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5436139106750488  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9038, 128])
m.shape torch.Size([9038, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5518937110900879  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5518937110900879  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5611920356750488  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7548909187316895  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9038, 128])
m.shape torch.Size([8426, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7663130760192871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7663130760192871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7749800682067871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0088896751403809  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8426, 128])
m.shape torch.Size([84451, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2062187194824219  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2062187194824219  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2882499694824219  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.196599960327148  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84451, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.966233253479004  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9944205284118652  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.022607803344727  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.993539333343506  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118225, 64])
input nodes number: 142436
output nodes number: 118225
edges number: 508421
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.024115562438965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.052302837371826  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.05935001373291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.05935001373291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118225, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.05935001373291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3049, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.164200305938721  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.164200305938721  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.16565465927124  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1783061027526855  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3049, 64])
m.shape torch.Size([3828, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.180389881134033  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.180389881134033  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.182215213775635  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2107977867126465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3828, 64])
m.shape torch.Size([3770, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2134294509887695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2134294509887695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.215227127075195  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2554426193237305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3770, 64])
m.shape torch.Size([3613, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.258111476898193  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.258111476898193  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2598347663879395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.309855937957764  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3613, 64])
m.shape torch.Size([3421, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3132004737854  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3132004737854  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3148322105407715  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.373560428619385  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3421, 64])
m.shape torch.Size([3054, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3772501945495605  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3772501945495605  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.378706455230713  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4419379234313965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3054, 64])
m.shape torch.Size([2791, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.446013927459717  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.446013927459717  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.44734525680542  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.516251564025879  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2791, 64])
m.shape torch.Size([2578, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.520657062530518  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.520657062530518  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.521886348724365  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.591955661773682  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2578, 64])
m.shape torch.Size([2312, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.596457481384277  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.596457481384277  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.597559928894043  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.668889999389648  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2312, 64])
m.shape torch.Size([28050, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.737327575683594  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.737327575683594  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.750702857971191  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.719028949737549  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 28050, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.625647068023682  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6391096115112305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.652572154998779  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.638688564300537  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56466, 64])
input nodes number: 118225
output nodes number: 56466
edges number: 413365
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.653454303741455  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.666916847229004  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.67028284072876  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.67028284072876  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1717, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.690083026885986  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.690083026885986  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.690902233123779  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.697892665863037  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1717, 64])
m.shape torch.Size([1463, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.698202610015869  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.698202610015869  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6989006996154785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710382461547852  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1463, 64])
m.shape torch.Size([1147, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710879802703857  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710879802703857  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.711427211761475  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7285919189453125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1147, 64])
m.shape torch.Size([884, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.729187965393066  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.729187965393066  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.729609489440918  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741833686828613  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 884, 64])
m.shape torch.Size([780, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742581844329834  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742581844329834  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742953777313232  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.756343364715576  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 780, 64])
m.shape torch.Size([598, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.757040023803711  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.757040023803711  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.757325172424316  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769586563110352  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 598, 64])
m.shape torch.Size([543, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.770379066467285  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.770379066467285  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.770638465881348  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.783588409423828  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 543, 64])
m.shape torch.Size([446, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784336090087891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784336090087891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784548759460449  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.796670913696289  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 446, 64])
m.shape torch.Size([378, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.797401428222656  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.797401428222656  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.797581672668457  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.809117317199707  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 378, 64])
m.shape torch.Size([321, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.809816837310791  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.809816837310791  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.809970378875732  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.82084321975708  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 321, 64])
m.shape torch.Size([271, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.821499824523926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.821499824523926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.821629524230957  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831714630126953  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 271, 64])
m.shape torch.Size([242, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832364082336426  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832364082336426  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832479476928711  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842288017272949  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 242, 64])
m.shape torch.Size([211, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842905044555664  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842905044555664  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.843006134033203  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.852269172668457  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 211, 64])
m.shape torch.Size([172, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.852810859680176  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.852810859680176  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.852892875671387  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8610124588012695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 172, 64])
m.shape torch.Size([2195, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869067192077637  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869067192077637  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.870114326477051  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.982903003692627  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2195, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.966496467590332  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.968465805053711  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.970160007476807  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.968105792999268  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56466
output nodes number: 11368
edges number: 77050
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9688005447387695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027495920658111572 |0.005201518535614014 |0.12002581357955933 |0.0007235407829284668 |0.04940706491470337 |0.006682157516479492 |
----------------------------------------------------------pseudo_mini_loss sum 1.6965315341949463
for loop block_dataloader item  time:  1.5526788234710693
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08127641677856445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08127641677856445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142693, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08127641677856445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7389, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33554553985595703  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33554553985595703  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3425922393798828  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39896583557128906  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7389, 128])
m.shape torch.Size([9103, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40412378311157227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40412378311157227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41280508041381836  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5445332527160645  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9103, 128])
m.shape torch.Size([9111, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5530104637145996  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5530104637145996  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5621113777160645  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7556824684143066  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9111, 128])
m.shape torch.Size([8352, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7670679092407227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7670679092407227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7753872871398926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0063748359680176  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8352, 128])
m.shape torch.Size([84461, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2037630081176758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2037630081176758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2857942581176758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.194430351257324  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84461, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9643893241882324  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.992621898651123  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.020854473114014  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.991739273071289  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118416, 64])
input nodes number: 142693
output nodes number: 118416
edges number: 508641
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.022141456604004  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0503740310668945  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.057432174682617  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.057432174682617  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118416, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.057432174682617  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3171, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.162245750427246  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.162245750427246  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.163758277893066  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.176877021789551  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3171, 64])
m.shape torch.Size([3843, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.178028583526611  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.178028583526611  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.179861545562744  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.210447788238525  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3843, 64])
m.shape torch.Size([3869, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.21262788772583  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.21262788772583  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.214473247528076  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.255215167999268  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3869, 64])
m.shape torch.Size([3771, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2580060958862305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2580060958862305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.259804725646973  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.311982154846191  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3771, 64])
m.shape torch.Size([3500, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.315385818481445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.315385818481445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.317054748535156  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.37713623046875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3500, 64])
m.shape torch.Size([2980, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.380698204040527  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.380698204040527  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.382119178771973  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.443221092224121  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2980, 64])
m.shape torch.Size([2758, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4472575187683105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4472575187683105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.448572635650635  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5152587890625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2758, 64])
m.shape torch.Size([2569, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.519654750823975  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.519654750823975  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.520880222320557  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.590768337249756  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2569, 64])
m.shape torch.Size([2274, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.595187664031982  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.595187664031982  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.596271991729736  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.6663336753845215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2274, 64])
m.shape torch.Size([28036, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7347235679626465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7347235679626465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.748092174530029  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716426372528076  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 28036, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.622954845428467  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.636490345001221  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.650025844573975  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.636066913604736  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56771, 64])
input nodes number: 118416
output nodes number: 56771
edges number: 413612
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.650909423828125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.664444923400879  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6678290367126465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6678290367126465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1665, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687687873840332  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687687873840332  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.688482284545898  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695014953613281  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1665, 64])
m.shape torch.Size([1469, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695340156555176  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695340156555176  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696041107177734  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707971096038818  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1469, 64])
m.shape torch.Size([1198, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708504676818848  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708504676818848  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709075927734375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723378658294678  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1198, 64])
m.shape torch.Size([980, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724057197570801  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724057197570801  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72452449798584  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738076210021973  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 980, 64])
m.shape torch.Size([764, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738781929016113  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738781929016113  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7391462326049805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752261161804199  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 764, 64])
m.shape torch.Size([560, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752905368804932  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752905368804932  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753172397613525  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764654636383057  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 560, 64])
m.shape torch.Size([480, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765347480773926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765347480773926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765576362609863  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777020454406738  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 480, 64])
m.shape torch.Size([404, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777700901031494  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777700901031494  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777893543243408  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78887414932251  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 404, 64])
m.shape torch.Size([383, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789625644683838  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789625644683838  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789808750152588  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801501750946045  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 383, 64])
m.shape torch.Size([324, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802206993103027  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802206993103027  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802361488342285  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81333065032959  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 324, 64])
m.shape torch.Size([239, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813900470733643  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813900470733643  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814014911651611  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822909832000732  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 239, 64])
m.shape torch.Size([269, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823646545410156  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823646545410156  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823775291442871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.834684371948242  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 269, 64])
m.shape torch.Size([204, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835272312164307  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835272312164307  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.83536958694458  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844318866729736  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 204, 64])
m.shape torch.Size([188, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8449177742004395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8449177742004395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.845007419586182  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853882312774658  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 188, 64])
m.shape torch.Size([2241, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.86210298538208  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.86210298538208  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8631720542907715  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9793701171875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2241, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.962884902954102  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.964579105377197  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.966273307800293  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.964494228363037  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56771
output nodes number: 11368
edges number: 77332
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.964727401733398  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02723374366760254 |0.0051838397979736325 |0.1221994400024414 |0.0007298469543457031 |0.04840092658996582 |0.006669044494628906 |
----------------------------------------------------------pseudo_mini_loss sum 1.673521637916565
for loop block_dataloader item  time:  1.9175922870635986
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08136224746704102  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08136224746704102  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142843, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08136224746704102  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7411, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33583831787109375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33583831787109375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34290599822998047  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3994474411010742  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7411, 128])
m.shape torch.Size([9235, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4047207832336426  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4047207832336426  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4135279655456543  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5456357002258301  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9235, 128])
m.shape torch.Size([9041, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5544066429138184  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5544066429138184  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5631413459777832  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7565007209777832  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9041, 128])
m.shape torch.Size([8362, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7678050994873047  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7678050994873047  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7764372825622559  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0077013969421387  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8362, 128])
m.shape torch.Size([84517, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2052183151245117  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2052183151245117  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2872495651245117  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.211077690124512  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84517, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9809436798095703  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.009212017059326  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.037480354309082  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.008328437805176  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118566, 64])
input nodes number: 142843
output nodes number: 118566
edges number: 509037
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.038970947265625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.067239284515381  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.074306488037109  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.074306488037109  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118566, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.074306488037109  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3103, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.180046558380127  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.180046558380127  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1815266609191895  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.194581985473633  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3103, 64])
m.shape torch.Size([3872, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195816516876221  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195816516876221  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.197662830352783  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.226686954498291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3872, 64])
m.shape torch.Size([3792, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2286601066589355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2286601066589355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.230468273162842  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.270247936248779  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3792, 64])
m.shape torch.Size([3656, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.273035049438477  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.273035049438477  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.274778366088867  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.325334548950195  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3656, 64])
m.shape torch.Size([3452, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.328706741333008  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.328706741333008  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.330352783203125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.389610290527344  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3452, 64])
m.shape torch.Size([3088, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.393342971801758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.393342971801758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.394815444946289  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.458425521850586  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3088, 64])
m.shape torch.Size([2732, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.462391376495361  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.462391376495361  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.463694095611572  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.528830051422119  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2732, 64])
m.shape torch.Size([2548, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.533190727233887  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.533190727233887  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.534405708312988  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.604061126708984  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2548, 64])
m.shape torch.Size([2278, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.608494758605957  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.608494758605957  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.609580993652344  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.680025100708008  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2278, 64])
m.shape torch.Size([28108, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.748594760894775  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.748594760894775  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.761997699737549  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.730677127838135  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 28108, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6366777420043945  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.650179386138916  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6636810302734375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.649757385253906  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56629, 64])
input nodes number: 118566
output nodes number: 56629
edges number: 413725
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.664565563201904  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.678067207336426  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.681442737579346  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.681442737579346  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1689, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.701386451721191  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.701386451721191  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.702192306518555  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708690643310547  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1689, 64])
m.shape torch.Size([1391, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708971977233887  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708971977233887  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7096357345581055  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721261024475098  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1391, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721776962280273  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721776962280273  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722325325012207  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.739013195037842  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1149, 64])
m.shape torch.Size([944, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7396674156188965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7396674156188965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.74011754989624  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753171443939209  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 944, 64])
m.shape torch.Size([778, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753902912139893  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753902912139893  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.754273891448975  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.767629146575928  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 778, 64])
m.shape torch.Size([649, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768401145935059  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768401145935059  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768711090087891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.782021522521973  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 649, 64])
m.shape torch.Size([469, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.782674312591553  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.782674312591553  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.782898426055908  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794084072113037  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 469, 64])
m.shape torch.Size([453, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794863224029541  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794863224029541  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795079708099365  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807396411895752  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 453, 64])
m.shape torch.Size([384, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.808137893676758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.808137893676758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.808320999145508  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.820039749145508  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 384, 64])
m.shape torch.Size([339, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.820781707763672  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.820781707763672  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.820943832397461  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832426071166992  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 339, 64])
m.shape torch.Size([275, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833089351654053  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833089351654053  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833220958709717  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.843454837799072  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 275, 64])
m.shape torch.Size([244, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844109058380127  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844109058380127  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8442254066467285  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854115009307861  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 244, 64])
m.shape torch.Size([208, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854722023010254  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854722023010254  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.85482120513916  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.863945960998535  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 208, 64])
m.shape torch.Size([173, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864491939544678  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864491939544678  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864574909210205  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.872748851776123  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 173, 64])
m.shape torch.Size([2223, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.880906581878662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.880906581878662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.881967067718506  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.995441913604736  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2223, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.978882789611816  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.980744361877441  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.982661247253418  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.980714797973633  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56629
output nodes number: 11368
edges number: 77655
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.981389045715332  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026236414909362793 |0.005104462305704753 |0.12380842367808025 |0.0007315874099731445 |0.04808656374613444 |0.006788492202758789 |
----------------------------------------------------------pseudo_mini_loss sum 1.6615322828292847
for loop block_dataloader item  time:  2.2661795616149902
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08113336563110352  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08113336563110352  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142650, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08113336563110352  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7333, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33507204055786133  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33507204055786133  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34206533432006836  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39810657501220703  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7333, 128])
m.shape torch.Size([9169, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4033541679382324  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4033541679382324  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41209840774536133  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5438895225524902  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9169, 128])
m.shape torch.Size([9045, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5524563789367676  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5524563789367676  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5614676475524902  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7549166679382324  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9045, 128])
m.shape torch.Size([8235, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7659845352172852  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7659845352172852  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7745504379272461  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0023021697998047  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8235, 128])
m.shape torch.Size([84453, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.1997270584106445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.1997270584106445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2817583084106445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1901655197143555  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84453, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.960339069366455  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9885287284851074  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.01671838760376  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.987647533416748  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118235, 64])
input nodes number: 142650
output nodes number: 118235
edges number: 508011
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.018163204193115  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.046352863311768  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.05340051651001  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.05340051651001  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118235, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.05340051651001  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3063, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.157217979431152  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.157217979431152  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.158679008483887  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.172431468963623  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3063, 64])
m.shape torch.Size([3853, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1736297607421875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1736297607421875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175467491149902  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2044148445129395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3853, 64])
m.shape torch.Size([3832, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.20632266998291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.20632266998291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2081499099731445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.248772144317627  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3832, 64])
m.shape torch.Size([3669, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.251467227935791  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.251467227935791  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2532172203063965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.303955554962158  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3669, 64])
m.shape torch.Size([3438, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307307243347168  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307307243347168  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.30894660949707  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.367963790893555  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3438, 64])
m.shape torch.Size([2963, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.371515274047852  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.371515274047852  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.372928619384766  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4346208572387695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2963, 64])
m.shape torch.Size([2718, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438592433929443  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438592433929443  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4398884773254395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.504814624786377  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2718, 64])
m.shape torch.Size([2577, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.509235858917236  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.509235858917236  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.510465145111084  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.580636501312256  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2577, 64])
m.shape torch.Size([2219, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584932804107666  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584932804107666  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.585991382598877  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.655320644378662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2219, 64])
m.shape torch.Size([27821, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7231950759887695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7231950759887695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.736461639404297  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7030744552612305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 27821, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.611087322235107  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.624475479125977  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.637863636016846  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.624056816101074  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56153, 64])
input nodes number: 118235
output nodes number: 56153
edges number: 409732
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6387457847595215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.652133941650391  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.655481338500977  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.655481338500977  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1674, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675282955169678  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675282955169678  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.67608118057251  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682572841644287  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1674, 64])
m.shape torch.Size([1464, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682893753051758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682893753051758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.683591842651367  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696231842041016  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1464, 64])
m.shape torch.Size([1166, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696743011474609  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696743011474609  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.697299003601074  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.71343994140625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1166, 64])
m.shape torch.Size([927, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714073657989502  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714073657989502  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7145161628723145  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72733736038208  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 927, 64])
m.shape torch.Size([816, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.728119373321533  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.728119373321533  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.728508472442627  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742516040802002  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 816, 64])
m.shape torch.Size([601, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.743208408355713  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.743208408355713  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.743495464324951  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755821704864502  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 601, 64])
m.shape torch.Size([508, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.756552696228027  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.756552696228027  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7567949295043945  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768906593322754  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 508, 64])
m.shape torch.Size([430, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769631385803223  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769631385803223  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76983642578125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781523704528809  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 430, 64])
m.shape torch.Size([358, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7822136878967285  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7822136878967285  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.782384395599365  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.793309688568115  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 358, 64])
m.shape torch.Size([318, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79400634765625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79400634765625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794157981872559  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.804924011230469  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 318, 64])
m.shape torch.Size([270, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.805578708648682  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.805578708648682  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8057074546813965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815749645233154  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 270, 64])
m.shape torch.Size([227, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816355228424072  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816355228424072  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816463947296143  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8256707191467285  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 227, 64])
m.shape torch.Size([223, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826329708099365  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826329708099365  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826436519622803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836225986480713  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 223, 64])
m.shape torch.Size([182, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836799144744873  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836799144744873  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836885929107666  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.84547758102417  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 182, 64])
m.shape torch.Size([2204, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853562831878662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853562831878662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854613780975342  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.966829776763916  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2204, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.950411319732666  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.95237398147583  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.954434871673584  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.95238733291626  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56153
output nodes number: 11368
edges number: 77093
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.952991962432861  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026246752057756697 |0.0050253186907087055 |0.12337534768240792 |0.0007308891841343471 |0.04781120164053781 |0.0065119266510009766 |
----------------------------------------------------------pseudo_mini_loss sum 1.6087714433670044
for loop block_dataloader item  time:  2.6749062538146973
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08156204223632812  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08156204223632812  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142511, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08156204223632812  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7317, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33548498153686523  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33548498153686523  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34246301651000977  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.398287296295166  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7317, 128])
m.shape torch.Size([9216, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40358734130859375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40358734130859375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41237640380859375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5442123413085938  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9216, 128])
m.shape torch.Size([9023, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5527253150939941  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5527253150939941  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5615143775939941  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7554259300231934  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9023, 128])
m.shape torch.Size([8303, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7665920257568359  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7665920257568359  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7752218246459961  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0048542022705078  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8303, 128])
m.shape torch.Size([84249, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2020668983459473  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2020668983459473  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2840981483459473  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.186668872833252  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84249, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9566707611083984  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.984829902648926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.012989044189453  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.983949661254883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118108, 64])
input nodes number: 142511
output nodes number: 118108
edges number: 507275
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.014407157897949  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.042566299438477  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0496063232421875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0496063232421875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118108, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0496063232421875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3066, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.153604030609131  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.153604030609131  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.155066013336182  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.167873382568359  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3066, 64])
m.shape torch.Size([3870, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.169854640960693  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.169854640960693  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1717000007629395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.199403285980225  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3870, 64])
m.shape torch.Size([3881, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.201343536376953  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.201343536376953  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.203194618225098  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.245356559753418  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3881, 64])
m.shape torch.Size([3599, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2479705810546875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2479705810546875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.249687194824219  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.299457550048828  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3599, 64])
m.shape torch.Size([3451, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.302842140197754  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.302842140197754  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.304488182067871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.363731384277344  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3451, 64])
m.shape torch.Size([2984, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.367310523986816  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.367310523986816  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3687334060668945  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.430377006530762  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2984, 64])
m.shape torch.Size([2777, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.434445381164551  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.434445381164551  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.435770034790039  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.502847671508789  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2777, 64])
m.shape torch.Size([2494, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.507091045379639  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.507091045379639  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.508280277252197  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.577229976654053  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2494, 64])
m.shape torch.Size([2293, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.581709861755371  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.581709861755371  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.582803726196289  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.653663635253906  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2293, 64])
m.shape torch.Size([27819, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.721540451049805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.721540451049805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.734806060791016  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.700628280639648  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 27819, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.608543395996094  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.621950626373291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.635357856750488  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6215314865112305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56234, 64])
input nodes number: 118108
output nodes number: 56234
edges number: 410222
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.636239051818848  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.649646282196045  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.652998447418213  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.652998447418213  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1702, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.672695636749268  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.672695636749268  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.673507213592529  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.680354595184326  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1702, 64])
m.shape torch.Size([1500, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6806864738464355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6806864738464355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.68140172958374  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.693621635437012  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1500, 64])
m.shape torch.Size([1179, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.69413423538208  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.69413423538208  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.69469690322876  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709335803985596  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1179, 64])
m.shape torch.Size([913, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7099528312683105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7099528312683105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.710388660430908  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723016262054443  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 913, 64])
m.shape torch.Size([748, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723718166351318  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723718166351318  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.724074840545654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.736915111541748  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 748, 64])
m.shape torch.Size([617, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73764705657959  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73764705657959  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.737941741943359  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.750596046447754  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 617, 64])
m.shape torch.Size([513, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7513322830200195  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7513322830200195  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751577377319336  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763812065124512  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 513, 64])
m.shape torch.Size([428, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76453161239624  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76453161239624  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764735698699951  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776368618011475  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 428, 64])
m.shape torch.Size([349, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777039527893066  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777039527893066  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7772064208984375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7878618240356445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 349, 64])
m.shape torch.Size([329, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78858757019043  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78858757019043  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788744926452637  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.799888610839844  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 329, 64])
m.shape torch.Size([275, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800554275512695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800554275512695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800685882568359  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.810919761657715  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 275, 64])
m.shape torch.Size([264, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811633110046387  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811633110046387  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811758995056152  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8224592208862305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 264, 64])
m.shape torch.Size([187, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822994232177734  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822994232177734  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.823083877563477  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831294059753418  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 187, 64])
m.shape torch.Size([184, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831882953643799  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831882953643799  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831970691680908  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.840656757354736  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 184, 64])
m.shape torch.Size([2177, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.848642349243164  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.848642349243164  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8496809005737305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.960925102233887  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2177, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9446187019348145  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.946369647979736  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.948369026184082  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.946533203125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11365, 40])
input nodes number: 56234
output nodes number: 11365
edges number: 76634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9468255043029785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02615031599998474 |0.005101680755615234 |0.12306144833564758 |0.0007281005382537842 |0.04787755012512207 |0.0066394805908203125 |
----------------------------------------------------------pseudo_mini_loss sum 1.6077418327331543
Total (block generation + training)time/epoch 2.915771961212158
Training time/epoch 2.9156548976898193
Training time without block to device /epoch 2.8748414516448975
Training time without total dataloading part /epoch 1.3799762725830078
load block tensor time/epoch 0.20920252799987793
block to device time/epoch 0.040813446044921875
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2538983
Number of first layer input nodes during this epoch:  1140917
block dataloader generation time/epoch 5.960464477539062e-07
for loop block_dataloader item  time:  0.1094205379486084
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08105707168579102  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08105707168579102  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([143076, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08105707168579102  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7397, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3350338935852051  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3350338935852051  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3426017761230469  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3990364074707031  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7397, 128])
m.shape torch.Size([9289, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40436792373657227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40436792373657227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4132266044616699  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5461068153381348  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9289, 128])
m.shape torch.Size([9263, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5549283027648926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5549283027648926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.563774585723877  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.758120059967041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9263, 128])
m.shape torch.Size([8334, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7695989608764648  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7695989608764648  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7781791687011719  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0108413696289062  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8334, 128])
m.shape torch.Size([84147, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2080392837524414  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2080392837524414  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2900705337524414  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.189723014831543  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84147, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.959923267364502  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9881591796875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.016395092010498  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.987276554107666  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118430, 64])
input nodes number: 143076
output nodes number: 118430
edges number: 507835
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0175580978393555  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0457940101623535  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.052853107452393  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.052853107452393  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118430, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.052853107452393  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3072, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.156514644622803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.156514644622803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.157979488372803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.170398712158203  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3072, 64])
m.shape torch.Size([3867, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1715874671936035  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1715874671936035  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.173431873321533  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.202657699584961  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3867, 64])
m.shape torch.Size([3912, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.204621315002441  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.204621315002441  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.206486701965332  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.247525215148926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3912, 64])
m.shape torch.Size([3664, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.250411033630371  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.250411033630371  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.252158164978027  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.303038597106934  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3664, 64])
m.shape torch.Size([3475, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3064374923706055  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3064374923706055  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3080949783325195  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.36775016784668  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3475, 64])
m.shape torch.Size([3028, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3713884353637695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3713884353637695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.372832298278809  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.435924530029297  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3028, 64])
m.shape torch.Size([2716, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.440437316894531  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.440437316894531  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.441732406616211  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.506551742553711  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2716, 64])
m.shape torch.Size([2539, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.510898590087891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.510898590087891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.512109756469727  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5815887451171875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2539, 64])
m.shape torch.Size([2297, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.586066722869873  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.586066722869873  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.587162494659424  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.657735347747803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2297, 64])
m.shape torch.Size([27654, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.725180149078369  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.725180149078369  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.738366603851318  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7033233642578125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 27654, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.611499309539795  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.624904155731201  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.638309001922607  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.624485015869141  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56224, 64])
input nodes number: 118430
output nodes number: 56224
edges number: 409278
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.639192581176758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.652597427368164  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.655948638916016  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.655948638916016  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1636, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6757073402404785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6757073402404785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.676487445831299  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682839870452881  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1636, 64])
m.shape torch.Size([1462, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.683168888092041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.683168888092041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.683866024017334  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694593906402588  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1462, 64])
m.shape torch.Size([1207, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695136070251465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695136070251465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695712089538574  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7123308181762695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1207, 64])
m.shape torch.Size([920, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.712947845458984  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.712947845458984  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.713386535644531  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726108551025391  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 920, 64])
m.shape torch.Size([808, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7268829345703125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7268829345703125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727268218994141  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741138458251953  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 808, 64])
m.shape torch.Size([614, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741851806640625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741851806640625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742144584655762  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.754734039306641  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 614, 64])
m.shape torch.Size([505, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755457401275635  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755457401275635  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7556986808776855  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76774263381958  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 505, 64])
m.shape torch.Size([451, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768509387969971  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768509387969971  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7687249183654785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78098726272583  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 451, 64])
m.shape torch.Size([367, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781692028045654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781692028045654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781867504119873  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79307222366333  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 367, 64])
m.shape torch.Size([325, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.793783664703369  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.793783664703369  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.793939113616943  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.804947376251221  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 325, 64])
m.shape torch.Size([270, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.805600166320801  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.805600166320801  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.805728912353516  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815771102905273  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 270, 64])
m.shape torch.Size([234, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816397190093994  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816397190093994  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816508769989014  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825993061065674  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 234, 64])
m.shape torch.Size([221, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826643943786621  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826643943786621  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826749801635742  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836451530456543  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 221, 64])
m.shape torch.Size([195, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837069988250732  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837069988250732  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.83716344833374  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.846375942230225  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 195, 64])
m.shape torch.Size([2153, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854269981384277  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854269981384277  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.855297088623047  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.964226245880127  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2153, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.947851181030273  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.949665069580078  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.951478958129883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.949580192565918  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56224
output nodes number: 11368
edges number: 76957
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9501471519470215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056205034255981445 |0.01052236557006836 |0.12082099914550781 |0.0007097721099853516 |0.046273231506347656 |0.006642818450927734 |
----------------------------------------------------------pseudo_mini_loss sum 1.6143423318862915
for loop block_dataloader item  time:  0.4967365264892578
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110952377319336  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110952377319336  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142406, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110952377319336  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7342, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33504676818847656  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33504676818847656  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34204864501953125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39813709259033203  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7342, 128])
m.shape torch.Size([9121, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4033346176147461  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4033346176147461  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4120330810546875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5437784194946289  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9121, 128])
m.shape torch.Size([8972, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5522637367248535  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5522637367248535  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5613565444946289  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7548971176147461  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8972, 128])
m.shape torch.Size([8382, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7661409378051758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7661409378051758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7748813629150391  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0066986083984375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8382, 128])
m.shape torch.Size([84312, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.203873634338379  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.203873634338379  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.285904884338379  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.190278053283691  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84312, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9605374336242676  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.988701820373535  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.016866207122803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.987821578979492  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118129, 64])
input nodes number: 142406
output nodes number: 118129
edges number: 507588
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.018164157867432  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.046328544616699  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.053369998931885  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.053369998931885  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118129, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.053369998931885  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3104, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.157989978790283  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.157989978790283  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.159470081329346  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.17268705368042  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3104, 64])
m.shape torch.Size([3920, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174731731414795  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174731731414795  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.176600933074951  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.205789566040039  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3920, 64])
m.shape torch.Size([3745, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.20848274230957  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.20848274230957  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.210268974304199  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.250388145446777  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3745, 64])
m.shape torch.Size([3632, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.253147125244141  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.253147125244141  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.254878997802734  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3053436279296875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3632, 64])
m.shape torch.Size([3365, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.308614730834961  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.308614730834961  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.310219764709473  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.368539810180664  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3365, 64])
m.shape torch.Size([3087, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.372291564941406  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.372291564941406  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3737640380859375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.437063217163086  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3087, 64])
m.shape torch.Size([2677, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.441277980804443  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.441277980804443  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.442554950714111  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.506383419036865  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2677, 64])
m.shape torch.Size([2517, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.510695934295654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.510695934295654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.51189661026001  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.581454753875732  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2517, 64])
m.shape torch.Size([2274, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.585886478424072  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.585886478424072  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.586970806121826  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.65643835067749  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2274, 64])
m.shape torch.Size([28200, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.725231647491455  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.725231647491455  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.738678455352783  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706905841827393  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 28200, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6140360832214355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.627511978149414  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.640987873077393  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6270904541015625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56521, 64])
input nodes number: 118129
output nodes number: 56521
edges number: 413395
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.641869068145752  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.655991077423096  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.658714294433594  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.658714294433594  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1745, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.678553104400635  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.678553104400635  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.679385662078857  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686248302459717  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1745, 64])
m.shape torch.Size([1462, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686551094055176  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686551094055176  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687248229980469  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6987104415893555  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1462, 64])
m.shape torch.Size([1114, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.699183940887451  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.699183940887451  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6997151374816895  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.713418483734131  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1114, 64])
m.shape torch.Size([919, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714056968688965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714056968688965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714495658874512  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727206230163574  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 919, 64])
m.shape torch.Size([789, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727957248687744  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727957248687744  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.728333950042725  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741880893707275  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 789, 64])
m.shape torch.Size([595, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742570400238037  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742570400238037  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742854595184326  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7550578117370605  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 595, 64])
m.shape torch.Size([532, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755831718444824  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755831718444824  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.756085395812988  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768769264221191  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 532, 64])
m.shape torch.Size([394, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769417762756348  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769417762756348  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76960563659668  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7803144454956055  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 394, 64])
m.shape torch.Size([353, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781002044677734  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781002044677734  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781170845031738  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.791948318481445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 353, 64])
m.shape torch.Size([328, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.792670726776123  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.792670726776123  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.792827129364014  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803931713104248  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 328, 64])
m.shape torch.Size([286, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.804627418518066  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.804627418518066  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8047637939453125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815401077270508  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 286, 64])
m.shape torch.Size([224, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815993785858154  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815993785858154  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.816100597381592  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825179576873779  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 224, 64])
m.shape torch.Size([211, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825800895690918  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825800895690918  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825901985168457  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835165023803711  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 211, 64])
m.shape torch.Size([185, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835751533508301  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835751533508301  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835840225219727  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.84458065032959  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 185, 64])
m.shape torch.Size([2231, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.85276460647583  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.85276460647583  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8538289070129395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.967921257019043  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2231, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.951475620269775  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.953304767608643  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.955172061920166  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.953258037567139  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56521
output nodes number: 11368
edges number: 77167
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.953779697418213  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043114304542541504 |0.0076721906661987305 |0.12101709842681885 |0.0007344484329223633 |0.04583477973937988 |0.0068051815032958984 |
----------------------------------------------------------pseudo_mini_loss sum 1.5360755920410156
for loop block_dataloader item  time:  0.8416571617126465
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110475540161133  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110475540161133  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142434, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110475540161133  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7339, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3350372314453125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3350372314453125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34203624725341797  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39810895919799805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7339, 128])
m.shape torch.Size([9202, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4033851623535156  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4033851623535156  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41216087341308594  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5439834594726562  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9202, 128])
m.shape torch.Size([9077, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5525803565979004  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5525803565979004  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5615615844726562  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7549476623535156  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9077, 128])
m.shape torch.Size([8325, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.766232967376709  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.766232967376709  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7747960090637207  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0050368309020996  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8325, 128])
m.shape torch.Size([84151, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2022390365600586  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2022390365600586  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2842702865600586  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.184037208557129  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84151, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9544711112976074  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9826269149780273  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.010782718658447  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9817466735839844  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118094, 64])
input nodes number: 142434
output nodes number: 118094
edges number: 507029
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.012225151062012  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.040380954742432  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.047420024871826  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.047420024871826  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118094, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.047420024871826  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3070, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.151490211486816  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.151490211486816  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1529541015625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.166360378265381  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3070, 64])
m.shape torch.Size([3701, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.167507171630859  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.167507171630859  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.169272422790527  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.197159290313721  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3701, 64])
m.shape torch.Size([3831, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.199102878570557  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.199102878570557  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.200930118560791  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2416486740112305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3831, 64])
m.shape torch.Size([3666, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.244340896606445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.244340896606445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.246088981628418  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.296783447265625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3666, 64])
m.shape torch.Size([3470, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.300175666809082  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.300175666809082  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.301830291748047  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.361396789550781  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3470, 64])
m.shape torch.Size([3032, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.365042686462402  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.365042686462402  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.366488456726074  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.429673194885254  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3032, 64])
m.shape torch.Size([2794, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4337592124938965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4337592124938965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.435091495513916  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.504128932952881  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2794, 64])
m.shape torch.Size([2588, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.508553504943848  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.508553504943848  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.509787559509277  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5801286697387695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2588, 64])
m.shape torch.Size([2293, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584586143493652  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584586143493652  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.58568000793457  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.656781196594238  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2293, 64])
m.shape torch.Size([27803, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.724703788757324  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.724703788757324  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.737961769104004  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703711032867432  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 27803, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.611423969268799  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6248345375061035  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.638245105743408  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.624415397644043  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56248, 64])
input nodes number: 118094
output nodes number: 56248
edges number: 411100
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.639126300811768  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.652536869049072  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.656692028045654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.656692028045654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1704, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.676546096801758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.676546096801758  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.677358627319336  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.683885097503662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1704, 64])
m.shape torch.Size([1444, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684189319610596  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684189319610596  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684877872467041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696346759796143  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1444, 64])
m.shape torch.Size([1135, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696840286254883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696840286254883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.697381973266602  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.713043212890625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1135, 64])
m.shape torch.Size([878, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7136359214782715  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7136359214782715  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714054584503174  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726195812225342  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 878, 64])
m.shape torch.Size([794, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726963043212891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726963043212891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.727341651916504  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.740971565246582  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 794, 64])
m.shape torch.Size([639, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741724967956543  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741724967956543  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742030143737793  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755135536193848  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 639, 64])
m.shape torch.Size([521, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755879878997803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755879878997803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.756128787994385  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768554210662842  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 521, 64])
m.shape torch.Size([441, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7692975997924805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7692975997924805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769508361816406  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781498908996582  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 441, 64])
m.shape torch.Size([412, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7823052406311035  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7823052406311035  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.782501697540283  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795074939727783  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 412, 64])
m.shape torch.Size([328, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795783519744873  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795783519744873  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795939922332764  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807044506072998  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 328, 64])
m.shape torch.Size([249, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807640075683594  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807640075683594  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8077592849731445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.817026138305664  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 249, 64])
m.shape torch.Size([222, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81762170791626  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81762170791626  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.817727565765381  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826725482940674  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 222, 64])
m.shape torch.Size([223, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.827385902404785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.827385902404785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.827492713928223  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837282180786133  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 223, 64])
m.shape torch.Size([166, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8378005027771  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8378005027771  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837879657745361  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8457159996032715  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 166, 64])
m.shape torch.Size([2212, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853834629058838  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853834629058838  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854889392852783  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.967704772949219  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2212, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.951239585876465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.952939033508301  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.954638481140137  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.952854156494141  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56248
output nodes number: 11368
edges number: 77282
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.95322847366333  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03741884231567383 |0.006574312845865886 |0.12112037340799968 |0.0007290840148925781 |0.045709848403930664 |0.006621599197387695 |
----------------------------------------------------------pseudo_mini_loss sum 1.535581350326538
for loop block_dataloader item  time:  1.180079460144043
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0809168815612793  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0809168815612793  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142242, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0809168815612793  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7283, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3332490921020508  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3332490921020508  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3401947021484375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39575958251953125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7283, 128])
m.shape torch.Size([9163, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40102529525756836  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40102529525756836  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40976381301879883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5416502952575684  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9163, 128])
m.shape torch.Size([8919, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5499386787414551  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5499386787414551  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5588793754577637  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7530379295349121  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8919, 128])
m.shape torch.Size([8260, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7639732360839844  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7639732360839844  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7727313041687012  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0021171569824219  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8260, 128])
m.shape torch.Size([83882, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.1981687545776367  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.1981687545776367  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2781648635864258  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.158024787902832  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 83882, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.930583953857422  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9586000442504883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9866161346435547  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.957724094390869  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([117507, 64])
input nodes number: 142242
output nodes number: 117507
edges number: 504816
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9877986907958984  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.015814781188965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0228190422058105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0228190422058105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([117507, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0228190422058105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3115, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.125612735748291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.125612735748291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.127098560333252  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.140876770019531  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3115, 64])
m.shape torch.Size([3856, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.142179012298584  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.142179012298584  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.144017696380615  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1721930503845215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3856, 64])
m.shape torch.Size([3794, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174090385437012  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174090385437012  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175899505615234  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.217250347137451  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3794, 64])
m.shape torch.Size([3563, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.219850063323975  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.219850063323975  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2215495109558105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.270822048187256  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3563, 64])
m.shape torch.Size([3408, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.274162292480469  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.274162292480469  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.275787353515625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3343505859375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3408, 64])
m.shape torch.Size([2965, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.337912082672119  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.337912082672119  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.33932638168335  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.400853157043457  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2965, 64])
m.shape torch.Size([2717, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.404822826385498  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.404822826385498  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.406118869781494  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.471052169799805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2717, 64])
m.shape torch.Size([2538, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.475396633148193  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.475396633148193  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.476606845855713  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5465006828308105  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2538, 64])
m.shape torch.Size([2255, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.550886154174805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.550886154174805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.551961898803711  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.621158599853516  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2255, 64])
m.shape torch.Size([27538, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.688352584838867  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.688352584838867  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.701483726501465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.634744644165039  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 27538, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.543556213378906  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.556848049163818  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.5701398849487305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.556432247161865  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([55749, 64])
input nodes number: 117507
output nodes number: 55749
edges number: 406289
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.571016788482666  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.584308624267578  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.587631702423096  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.587631702423096  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1749, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.608120918273926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.608120918273926  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.608955383300781  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.615915298461914  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1749, 64])
m.shape torch.Size([1540, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.616255760192871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.616255760192871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.616990089416504  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.629527568817139  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1540, 64])
m.shape torch.Size([1114, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6299824714660645  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6299824714660645  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.630513668060303  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.642371654510498  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1114, 64])
m.shape torch.Size([908, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.642999172210693  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.642999172210693  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.643432140350342  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6559882164001465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 908, 64])
m.shape torch.Size([744, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.656686782836914  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.656686782836914  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.657041549682617  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.66981315612793  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 744, 64])
m.shape torch.Size([634, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.670571327209473  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.670571327209473  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.670873641967773  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.683873176574707  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 634, 64])
m.shape torch.Size([470, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684531211853027  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684531211853027  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684755325317383  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695960998535156  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 470, 64])
m.shape torch.Size([448, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696730136871338  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696730136871338  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696943759918213  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709120273590088  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 448, 64])
m.shape torch.Size([359, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709808349609375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709808349609375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709980010986328  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.720940589904785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 359, 64])
m.shape torch.Size([323, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721649169921875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721649169921875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721803665161133  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.732744216918945  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 323, 64])
m.shape torch.Size([286, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73344087600708  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73344087600708  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.733577251434326  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7442145347595215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 286, 64])
m.shape torch.Size([243, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744863510131836  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744863510131836  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7449798583984375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.75483512878418  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 243, 64])
m.shape torch.Size([190, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.75538444519043  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.75538444519043  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755475044250488  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763810157775879  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 190, 64])
m.shape torch.Size([171, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7643537521362305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7643537521362305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764435768127441  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.772515296936035  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 171, 64])
m.shape torch.Size([2189, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780907154083252  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780907154083252  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781951427459717  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8942341804504395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2189, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.877144813537598  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.878968238830566  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.880662441253662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.878754138946533  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 55749
output nodes number: 11368
edges number: 76423
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.879378795623779  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03435945510864258 |0.006022155284881592 |0.12035828828811646 |0.0007243752479553223 |0.04533594846725464 |0.006817340850830078 |
----------------------------------------------------------pseudo_mini_loss sum 1.5199382305145264
for loop block_dataloader item  time:  1.5086092948913574
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08112573623657227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08112573623657227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142480, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08112573623657227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7267, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33513879776000977  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33513879776000977  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.342069149017334  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3977642059326172  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7267, 128])
m.shape torch.Size([9143, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4030184745788574  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4030184745788574  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41173791885375977  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5436434745788574  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9143, 128])
m.shape torch.Size([9057, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.552100658416748  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.552100658416748  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.561098575592041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7548432350158691  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9057, 128])
m.shape torch.Size([8280, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7660140991210938  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7660140991210938  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7745842933654785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0035805702209473  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8280, 128])
m.shape torch.Size([84481, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2010507583618164  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2010507583618164  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2830820083618164  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.206910133361816  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84481, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9764246940612793  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.004612445831299  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.032800197601318  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0037312507629395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118228, 64])
input nodes number: 142480
output nodes number: 118228
edges number: 508249
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.034507751464844  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.062695503234863  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.069742679595947  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.069742679595947  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118228, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.069742679595947  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3109, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174605369567871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174605369567871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.176088333129883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.189089298248291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3109, 64])
m.shape torch.Size([3814, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.190299034118652  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.190299034118652  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.192117691040039  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.220004081726074  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3814, 64])
m.shape torch.Size([3835, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.221923828125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.221923828125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.223752975463867  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.265618324279785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3835, 64])
m.shape torch.Size([3652, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.268295764923096  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.268295764923096  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2700371742248535  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.32053804397583  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3652, 64])
m.shape torch.Size([3431, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.323885917663574  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.323885917663574  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.325522422790527  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.384422302246094  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3431, 64])
m.shape torch.Size([2972, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.387988567352295  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.387988567352295  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.389405727386475  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.451016902923584  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2972, 64])
m.shape torch.Size([2744, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.455031394958496  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.455031394958496  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4563398361206055  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.521775722503662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2744, 64])
m.shape torch.Size([2563, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.526163101196289  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.526163101196289  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.527385711669922  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5972137451171875  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2563, 64])
m.shape torch.Size([2244, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.601568222045898  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.601568222045898  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.602638244628906  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.6725568771362305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2244, 64])
m.shape torch.Size([28121, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.741184711456299  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.741184711456299  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.754594326019287  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723231792449951  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 28121, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6304426193237305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.643909931182861  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.657377243041992  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.643488883972168  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56485, 64])
input nodes number: 118228
output nodes number: 56485
edges number: 412955
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.658259391784668  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.671726703643799  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675093650817871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675093650817871  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1673, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6950578689575195  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6950578689575195  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695856094360352  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7027435302734375  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1673, 64])
m.shape torch.Size([1447, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703056335449219  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703056335449219  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703746795654297  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716089248657227  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1447, 64])
m.shape torch.Size([1132, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716579437255859  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716579437255859  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717119216918945  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7308430671691895  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1132, 64])
m.shape torch.Size([965, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.731522560119629  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.731522560119629  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.731983184814453  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.745329856872559  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 965, 64])
m.shape torch.Size([767, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.746042728424072  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.746042728424072  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.746408939361572  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.759578227996826  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 767, 64])
m.shape torch.Size([588, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.760262966156006  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.760262966156006  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.760543346405029  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.772599697113037  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 588, 64])
m.shape torch.Size([519, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.773353099822998  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.773353099822998  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.773601055145264  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7859787940979  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 519, 64])
m.shape torch.Size([441, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.786722660064697  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.786722660064697  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.786933422088623  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.798923969268799  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 441, 64])
m.shape torch.Size([349, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.799591541290283  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.799591541290283  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.799758434295654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.810413837432861  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 349, 64])
m.shape torch.Size([319, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81111478805542  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81111478805542  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811267375946045  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822072505950928  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 319, 64])
m.shape torch.Size([274, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822737693786621  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822737693786621  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822868347167969  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833059310913086  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 274, 64])
m.shape torch.Size([256, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833749294281006  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833749294281006  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833871364593506  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844247341156006  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 256, 64])
m.shape torch.Size([198, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.84481954574585  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.84481954574585  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844913959503174  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.853600025177002  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 198, 64])
m.shape torch.Size([184, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854186534881592  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854186534881592  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854274272918701  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862960338592529  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 184, 64])
m.shape torch.Size([2256, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.871236801147461  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.871236801147461  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.872312545776367  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.988067626953125  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2256, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.97147798538208  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9732890129089355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.974983215332031  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.973087310791016  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56485
output nodes number: 11368
edges number: 77754
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.973580837249756  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03264088630676269 |0.005692005157470703 |0.12029709815979003 |0.0007211208343505859 |0.045347976684570315 |0.0065708160400390625 |
----------------------------------------------------------pseudo_mini_loss sum 1.4821680784225464
for loop block_dataloader item  time:  1.841651439666748
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110666275024414  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110666275024414  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142642, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08110666275024414  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7303, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33513593673706055  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33513593673706055  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3421006202697754  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39798450469970703  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7303, 128])
m.shape torch.Size([9181, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4032578468322754  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4032578468322754  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41201353073120117  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5438828468322754  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9181, 128])
m.shape torch.Size([9029, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5523543357849121  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5523543357849121  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5612435340881348  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7551045417785645  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9029, 128])
m.shape torch.Size([8362, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7663917541503906  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7663917541503906  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7750411033630371  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0072593688964844  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8362, 128])
m.shape torch.Size([84408, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2045164108276367  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2045164108276367  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2865476608276367  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.193667411804199  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84408, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.963374614715576  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9915757179260254  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.019776821136475  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.990694046020508  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118283, 64])
input nodes number: 142642
output nodes number: 118283
edges number: 508240
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0208916664123535  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.049092769622803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.056143283843994  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.056143283843994  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118283, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.056143283843994  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([3112, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.160621166229248  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.160621166229248  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.162105083465576  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174903869628906  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3112, 64])
m.shape torch.Size([3789, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1760993003845215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1760993003845215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.177906513214111  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.206489562988281  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3789, 64])
m.shape torch.Size([3878, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.209254741668701  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.209254741668701  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.211103916168213  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.252946376800537  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3878, 64])
m.shape torch.Size([3564, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.255710124969482  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.255710124969482  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.257409572601318  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3074259757995605  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3564, 64])
m.shape torch.Size([3418, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.310778617858887  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.310778617858887  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.312408447265625  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.371082305908203  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3418, 64])
m.shape torch.Size([3025, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.374730110168457  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.374730110168457  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.37617301940918  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438897132873535  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3025, 64])
m.shape torch.Size([2755, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.442917823791504  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.442917823791504  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.444231986999512  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.510726451873779  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2755, 64])
m.shape torch.Size([2480, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.514947414398193  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.514947414398193  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.516129970550537  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584928035736084  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2480, 64])
m.shape torch.Size([2328, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.589488506317139  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.589488506317139  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5905985832214355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.662402629852295  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2328, 64])
m.shape torch.Size([28059, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.730910778045654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.730910778045654  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.744290828704834  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.712676525115967  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 28059, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.620030879974365  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.633819103240967  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.647267818450928  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.633059024810791  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([56408, 64])
input nodes number: 118283
output nodes number: 56408
edges number: 412487
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.647810935974121  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.661599159240723  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.664621829986572  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.664621829986572  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684506893157959  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684506893157959  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6853156089782715  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.691819667816162  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1695, 64])
m.shape torch.Size([1487, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6921467781066895  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6921467781066895  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.692856311798096  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.705099582672119  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1487, 64])
m.shape torch.Size([1213, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.705639839172363  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.705639839172363  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.706218719482422  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722163200378418  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1213, 64])
m.shape torch.Size([890, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72274923324585  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72274923324585  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72317361831665  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.735480785369873  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 890, 64])
m.shape torch.Size([728, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73616361618042  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73616361618042  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.736510753631592  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749007701873779  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 728, 64])
m.shape torch.Size([592, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7497076988220215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7497076988220215  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749989986419678  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7621283531188965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 592, 64])
m.shape torch.Size([489, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.762829303741455  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.762829303741455  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763062953948975  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.774725437164307  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 489, 64])
m.shape torch.Size([422, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7754387855529785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7754387855529785  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.77564001083374  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787109851837158  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 422, 64])
m.shape torch.Size([401, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787897109985352  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.787897109985352  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788088798522949  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800331115722656  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 401, 64])
m.shape torch.Size([285, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800936222076416  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.800936222076416  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801072597503662  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.810726642608643  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 285, 64])
m.shape torch.Size([263, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811370372772217  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811370372772217  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.811496257781982  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.82128381729126  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 263, 64])
m.shape torch.Size([244, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.821940898895264  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.821940898895264  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.822057247161865  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831946849822998  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 244, 64])
m.shape torch.Size([217, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832582950592041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832582950592041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832686901092529  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842213153839111  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 217, 64])
m.shape torch.Size([179, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842777729034424  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842777729034424  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8428635597229  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.851320743560791  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 179, 64])
m.shape torch.Size([2263, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.85962438583374  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.85962438583374  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.860703945159912  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.975094318389893  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2263, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.958583831787109  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.960278034210205  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.961972236633301  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.960193157196045  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([11368, 40])
input nodes number: 56408
output nodes number: 11368
edges number: 77411
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9605817794799805  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031733155250549316 |0.005492011706034343 |0.119956374168396 |0.0007171233495076498 |0.04561924934387207 |0.006661653518676758 |
----------------------------------------------------------pseudo_mini_loss sum 1.4961202144622803
for loop block_dataloader item  time:  2.24737811088562
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08131742477416992  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08131742477416992  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([142608, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08131742477416992  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([7323, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33788394927978516  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33788394927978516  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34548425674438477  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4014730453491211  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 7323, 128])
m.shape torch.Size([9126, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40668439865112305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40668439865112305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4153876304626465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.547309398651123  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 9126, 128])
m.shape torch.Size([8992, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5560126304626465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5560126304626465  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5645880699157715  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7578835487365723  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8992, 128])
m.shape torch.Size([8407, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7696309089660645  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7696309089660645  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7779273986816406  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0104360580444336  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 8407, 128])
m.shape torch.Size([84764, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2085204124450684  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2085204124450684  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2905516624450684  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.214379787445068  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 84764, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.982971668243408  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.011250972747803  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.039530277252197  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.010366916656494  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118612, 64])
input nodes number: 142608
output nodes number: 118612
edges number: 509999
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.04079532623291  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.069074630737305  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076536178588867  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076536178588867  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([118612, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076536178588867  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([2943, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.182616233825684  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.182616233825684  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.184020042419434  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1973161697387695  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2943, 64])
m.shape torch.Size([3856, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198563098907471  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198563098907471  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.200401782989502  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.230035305023193  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3856, 64])
m.shape torch.Size([3879, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.232509136199951  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.232509136199951  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.234359264373779  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.27505350112915  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3879, 64])
m.shape torch.Size([3722, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.277789115905762  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.277789115905762  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.279563903808594  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.331032752990723  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3722, 64])
m.shape torch.Size([3483, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.334427833557129  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.334427833557129  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.336089134216309  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.396754264831543  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3483, 64])
m.shape torch.Size([3071, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.400454044342041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.400454044342041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.401918888092041  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.465384483337402  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 3071, 64])
m.shape torch.Size([2778, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.469433307647705  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.469433307647705  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.470757961273193  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.537538051605225  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2778, 64])
m.shape torch.Size([2550, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.541891574859619  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.541891574859619  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.543107509613037  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.612568378448486  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2550, 64])
m.shape torch.Size([2334, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.617125511169434  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.617125511169434  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.61823844909668  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.689985752105713  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 2334, 64])
m.shape torch.Size([28516, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7595415115356445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7595415115356445  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.773138999938965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.743247032165527  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 28516, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.648869037628174  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.662490367889404  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.676111698150635  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.662064552307129  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([57132, 64])
input nodes number: 118612
output nodes number: 57132
edges number: 419033
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.67699670791626  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.69061803817749  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694023609161377  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694023609161377  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

m.shape torch.Size([1580, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.71424674987793  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.71424674987793  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715000152587891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721136093139648  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1580, 64])
m.shape torch.Size([1433, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721464157104492  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721464157104492  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7221479415893555  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.733469486236572  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1433, 64])
m.shape torch.Size([1155, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.733980178833008  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.733980178833008  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734531402587891  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751094818115234  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 1155, 64])
m.shape torch.Size([939, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751742839813232  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751742839813232  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752191066741943  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765178203582764  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 939, 64])
m.shape torch.Size([820, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765970230102539  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765970230102539  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.766361236572266  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780437469482422  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 820, 64])
m.shape torch.Size([589, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781111240386963  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781111240386963  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.781392574310303  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.793472766876221  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 589, 64])
m.shape torch.Size([491, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794177532196045  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794177532196045  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794412136077881  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.806122303009033  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 491, 64])
m.shape torch.Size([428, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.806847095489502  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.806847095489502  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807051181793213  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.818684101104736  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 428, 64])
m.shape torch.Size([350, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819356918334961  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819356918334961  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819523811340332  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.830204963684082  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 350, 64])
m.shape torch.Size([339, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8309550285339355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8309550285339355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831117153167725  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842599391937256  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 339, 64])
m.shape torch.Size([283, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8432841300964355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8432841300964355  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.843419551849365  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8539509773254395  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 283, 64])
m.shape torch.Size([246, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854609489440918  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854609489440918  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854726791381836  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864697456359863  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 246, 64])
m.shape torch.Size([206, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865297317504883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865297317504883  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865395545959473  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.874432563781738  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 206, 64])
m.shape torch.Size([180, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.875003337860107  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.875003337860107  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.875089168548584  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.883586406707764  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

torch.Size([1, 180, 64])
m.shape torch.Size([2329, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8921332359313965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8921332359313965  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.89324426651001  GigaBytes
Max Memory Allocated: 6.015073299407959  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 6.013018608093262  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2329, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.996137619018555  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.99783182144165  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.999526023864746  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.99774694442749  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11368, 40])
input nodes number: 57132
output nodes number: 11368
edges number: 78900
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.998257637023926  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030807971954345703 |0.005337715148925781 |0.1197404180254255 |0.0007129056113106864 |0.04747574669974191 |0.0065457820892333984 |
----------------------------------------------------------pseudo_mini_loss sum 1.4534019231796265
for loop block_dataloader item  time:  2.5999016761779785
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0809783935546875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0809783935546875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([142543, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.0809783935546875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7305, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3349018096923828  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3349018096923828  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34186840057373047  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3977627754211426  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7305, 128])
m.shape torch.Size([9141, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4029970169067383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4029970169067383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4117145538330078  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5436220169067383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9141, 128])
m.shape torch.Size([9036, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5520462989807129  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5520462989807129  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5610499382019043  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7548527717590332  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9036, 128])
m.shape torch.Size([8319, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7660679817199707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7660679817199707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7746868133544922  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0047616958618164  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8319, 128])
m.shape torch.Size([84373, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2019667625427246  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2019667625427246  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2839980125427246  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1901164054870605  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 84373, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.959963321685791  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.988138198852539  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.016313076019287  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.987257480621338  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118174, 64])
input nodes number: 142543
output nodes number: 118174
edges number: 507836
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0174946784973145  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0456695556640625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.052713394165039  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.052713394165039  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118174, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.052713394165039  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3063, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.157073020935059  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.157073020935059  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.158534049987793  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.172006130218506  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3063, 64])
m.shape torch.Size([3808, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1736016273498535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1736016273498535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175417423248291  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.203543663024902  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3808, 64])
m.shape torch.Size([3908, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.20551872253418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.20551872253418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2073822021484375  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.249624252319336  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3908, 64])
m.shape torch.Size([3630, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.252262592315674  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.252262592315674  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.253993511199951  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.304190158843994  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3630, 64])
m.shape torch.Size([3490, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307615280151367  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307615280151367  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.309279441833496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.369189262390137  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3490, 64])
m.shape torch.Size([3088, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.372912883758545  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.372912883758545  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.374385356903076  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438090801239014  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3088, 64])
m.shape torch.Size([2761, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4421067237854  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4421067237854  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.443423748016357  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5102739334106445  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2761, 64])
m.shape torch.Size([2597, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.514723777770996  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.514723777770996  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.515962600708008  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.586552619934082  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2597, 64])
m.shape torch.Size([2260, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5909342765808105  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5909342765808105  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.59201192855835  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.6618971824646  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2260, 64])
m.shape torch.Size([27817, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.729752063751221  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.729752063751221  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.743016719818115  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.709629058837891  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 27817, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.617276668548584  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.630728721618652  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.644180774688721  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.630308151245117  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([56422, 64])
input nodes number: 118174
output nodes number: 56422
edges number: 411514
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.645062446594238  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.658514499664307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.661877632141113  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.661877632141113  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1646, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6817216873168945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6817216873168945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682506561279297  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.689157962799072  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1646, 64])
m.shape torch.Size([1431, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.689469337463379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.689469337463379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.690152168273926  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.701698303222656  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1431, 64])
m.shape torch.Size([1207, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.702247619628906  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.702247619628906  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.702823638916016  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715753555297852  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1207, 64])
m.shape torch.Size([901, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7163519859313965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7163519859313965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716782093048096  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.729243755340576  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 901, 64])
m.shape torch.Size([772, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.729978084564209  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.729978084564209  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.730346202850342  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.743598461151123  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 772, 64])
m.shape torch.Size([617, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744324684143066  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744324684143066  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744619369506836  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7572736740112305  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 617, 64])
m.shape torch.Size([518, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7580180168151855  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7580180168151855  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.758265018463135  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.770615100860596  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 518, 64])
m.shape torch.Size([447, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.771370887756348  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.771370887756348  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.771584510803223  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.783738136291504  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 447, 64])
m.shape torch.Size([385, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784483909606934  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784483909606934  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78466796875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.796422004699707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 385, 64])
m.shape torch.Size([352, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7971954345703125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7971954345703125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79736328125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8092803955078125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 352, 64])
m.shape torch.Size([292, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.809986591339111  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.809986591339111  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.810125827789307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.820986270904541  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 292, 64])
m.shape torch.Size([268, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.821707725524902  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.821707725524902  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.821835517883301  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.832697868347168  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 268, 64])
m.shape torch.Size([190, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8332414627075195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8332414627075195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.833332061767578  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841667175292969  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 190, 64])
m.shape torch.Size([174, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842221260070801  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842221260070801  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.842304229736328  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.850518226623535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 174, 64])
m.shape torch.Size([2165, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.858573913574219  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.858573913574219  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.859606742858887  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.969668865203857  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2165, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.95320987701416  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.954920768737793  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.956782341003418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.954986572265625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11365, 40])
input nodes number: 56422
output nodes number: 11365
edges number: 77291
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.955508708953857  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03085547685623169 |0.005248606204986572 |0.11972582340240479 |0.0007160604000091553 |0.047232598066329956 |0.0063974857330322266 |
----------------------------------------------------------pseudo_mini_loss sum 1.4345390796661377
Total (block generation + training)time/epoch 2.880132555961609
Training time/epoch 2.8444254398345947
Training time without block to device /epoch 2.802436590194702
Training time without total dataloading part /epoch 1.3477933406829834
load block tensor time/epoch 0.24684381484985352
block to device time/epoch 0.04198884963989258
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2537077
Number of first layer input nodes during this epoch:  1140431
block dataloader generation time/epoch 6.357828776041666e-07
for loop block_dataloader item  time:  0.1315593719482422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08106851577758789  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08106851577758789  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([143023, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08106851577758789  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7402, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33697938919067383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33697938919067383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3440384864807129  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4005112648010254  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7402, 128])
m.shape torch.Size([9242, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4057955741882324  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4057955741882324  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.414609432220459  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.547645092010498  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9242, 128])
m.shape torch.Size([9076, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5564093589782715  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5564093589782715  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5650944709777832  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.758720874786377  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9076, 128])
m.shape torch.Size([8446, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.770235538482666  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.770235538482666  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7788577079772949  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0133461952209473  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8446, 128])
m.shape torch.Size([84770, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2114262580871582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2114262580871582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2934575080871582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.217285633087158  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 84770, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9857630729675293  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.014119625091553  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.042476177215576  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.013233184814453  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118936, 64])
input nodes number: 143023
output nodes number: 118936
edges number: 510748
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.043945789337158  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.072302341461182  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0793914794921875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0793914794921875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118936, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0793914794921875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3096, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.185354232788086  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.185354232788086  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.186830520629883  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.199709892272949  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3096, 64])
m.shape torch.Size([3899, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.200933456420898  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.200933456420898  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.202793121337891  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.233407497406006  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3899, 64])
m.shape torch.Size([3880, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.235511302947998  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.235511302947998  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.237361431121826  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.278064250946045  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3880, 64])
m.shape torch.Size([3658, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.280777931213379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.280777931213379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.282522201538086  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.33310604095459  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3658, 64])
m.shape torch.Size([3529, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.336572647094727  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.336572647094727  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.338255882263184  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.398911476135254  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3529, 64])
m.shape torch.Size([3040, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.402554512023926  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.402554512023926  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.404004096984863  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.467022895812988  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3040, 64])
m.shape torch.Size([2742, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.471017360687256  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.471017360687256  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.472324848175049  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.537876605987549  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2742, 64])
m.shape torch.Size([2604, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.54234504699707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.54234504699707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.543586730957031  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.614362716674805  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2604, 64])
m.shape torch.Size([2348, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.618937969207764  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.618937969207764  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.620057582855225  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.69186544418335  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2348, 64])
m.shape torch.Size([28358, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.76105260848999  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.76105260848999  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.7745747566223145  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744080066680908  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 28358, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.649964332580566  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.663590908050537  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.677217483520508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6631646156311035  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([57154, 64])
input nodes number: 118936
output nodes number: 57154
edges number: 417789
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.678104877471924  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6919264793396  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695138454437256  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695138454437256  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1633, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715127944946289  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715127944946289  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715907096862793  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7222371101379395  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1633, 64])
m.shape torch.Size([1443, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722557544708252  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722557544708252  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723246097564697  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7341084480285645  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1443, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734611988067627  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734611988067627  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7351603507995605  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.750125408172607  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1149, 64])
m.shape torch.Size([923, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.750759124755859  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.750759124755859  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751199722290039  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763965606689453  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 923, 64])
m.shape torch.Size([833, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76479434967041  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76479434967041  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765192031860352  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.779494285583496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 833, 64])
m.shape torch.Size([574, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780142307281494  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780142307281494  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780416011810303  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.792185306549072  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 574, 64])
m.shape torch.Size([518, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.792940139770508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.792940139770508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.793187141418457  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.805537223815918  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 518, 64])
m.shape torch.Size([428, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.80625581741333  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.80625581741333  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.806459903717041  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8180928230285645  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 428, 64])
m.shape torch.Size([393, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81886100769043  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81886100769043  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819048881530762  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831047058105469  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 393, 64])
m.shape torch.Size([341, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831791877746582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831791877746582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8319549560546875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.843504905700684  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 341, 64])
m.shape torch.Size([275, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844167709350586  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844167709350586  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.84429931640625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8545331954956055  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 275, 64])
m.shape torch.Size([242, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.855181694030762  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.855181694030762  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.855297088623047  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865105628967285  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 242, 64])
m.shape torch.Size([194, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865668296813965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865668296813965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865760803222656  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.874271392822266  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 194, 64])
m.shape torch.Size([154, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.874755382537842  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.874755382537842  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.874828815460205  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.88209867477417  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 154, 64])
m.shape torch.Size([2268, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8904266357421875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8904266357421875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.891508102416992  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 6.00747013092041  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2268, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.990843296051025  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.992705345153809  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.994580268859863  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.99263334274292  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11368, 40])
input nodes number: 57154
output nodes number: 11368
edges number: 77891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.993295669555664  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02757549285888672 |0.004931211471557617 |0.12345242500305176 |0.0007765293121337891 |0.04667377471923828 |0.0068700313568115234 |
----------------------------------------------------------pseudo_mini_loss sum 1.4478158950805664
for loop block_dataloader item  time:  0.486067533493042
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08115291595458984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08115291595458984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([142472, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08115291595458984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7388, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.335115909576416  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.335115909576416  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3421616554260254  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3985276222229004  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7388, 128])
m.shape torch.Size([9075, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4036593437194824  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4036593437194824  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41231393814086914  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5442843437194824  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9075, 128])
m.shape torch.Size([8915, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5524411201477051  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5524411201477051  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5616335868835449  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7557196617126465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8915, 128])
m.shape torch.Size([8371, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7668609619140625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7668609619140625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7756776809692383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0079689025878906  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8371, 128])
m.shape torch.Size([84452, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2053265571594238  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2053265571594238  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2873578071594238  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195736408233643  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 84452, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9653124809265137  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9934940338134766  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0216755867004395  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9926133155822754  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118201, 64])
input nodes number: 142472
output nodes number: 118201
edges number: 508027
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.023077964782715  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.051259517669678  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.058305263519287  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.058305263519287  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118201, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.058305263519287  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3110, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.162630558013916  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.162630558013916  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.164113521575928  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.177234172821045  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3110, 64])
m.shape torch.Size([3804, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.179231643676758  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.179231643676758  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1810455322265625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.209618091583252  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3804, 64])
m.shape torch.Size([3807, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2123613357543945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2123613357543945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.214177131652832  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2546586990356445  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3807, 64])
m.shape torch.Size([3649, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.257424831390381  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.257424831390381  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.259165287017822  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.309966564178467  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3649, 64])
m.shape torch.Size([3333, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.313194274902344  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.313194274902344  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.314784049987793  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.372920989990234  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3333, 64])
m.shape torch.Size([3023, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.376585960388184  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.376585960388184  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.37802791595459  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.440215587615967  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3023, 64])
m.shape torch.Size([2787, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.444291591644287  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.444291591644287  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.445621013641357  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.514839172363281  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2787, 64])
m.shape torch.Size([2496, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5190839767456055  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5190839767456055  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5202741622924805  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5895795822143555  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2496, 64])
m.shape torch.Size([2263, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.593992710113525  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.593992710113525  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.595072269439697  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.664504528045654  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2263, 64])
m.shape torch.Size([28062, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.733001232147217  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.733001232147217  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.746382236480713  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7147932052612305  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 28062, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.622245788574219  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.636033535003662  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6494646072387695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.635256767272949  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([56334, 64])
input nodes number: 118201
output nodes number: 56334
edges number: 412002
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.649989604949951  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6637773513793945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.667412757873535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.667412757873535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687313079833984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.687313079833984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.688121795654297  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694943904876709  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1695, 64])
m.shape torch.Size([1470, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695262432098389  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695262432098389  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695963382720947  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707449436187744  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1470, 64])
m.shape torch.Size([1107, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707915782928467  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707915782928467  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708444118499756  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722578525543213  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1107, 64])
m.shape torch.Size([931, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723230361938477  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723230361938477  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.723674774169922  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.736551284790039  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 931, 64])
m.shape torch.Size([789, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73729944229126  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73729944229126  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73767614364624  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751223087310791  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 789, 64])
m.shape torch.Size([622, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751952648162842  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751952648162842  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752249240875244  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765002727508545  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 622, 64])
m.shape torch.Size([506, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765725612640381  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765725612640381  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.765966892242432  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778030872344971  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 506, 64])
m.shape torch.Size([426, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778748512268066  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778748512268066  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.778951644897461  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790530204772949  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 426, 64])
m.shape torch.Size([359, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.791223526000977  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.791223526000977  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.79139518737793  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802355766296387  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 359, 64])
m.shape torch.Size([326, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.80307149887085  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.80307149887085  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803226947784424  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814263820648193  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 326, 64])
m.shape torch.Size([264, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8149003982543945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8149003982543945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.81502628326416  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824845314025879  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 264, 64])
m.shape torch.Size([244, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825502395629883  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825502395629883  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825618743896484  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.835508346557617  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 244, 64])
m.shape torch.Size([199, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836086750030518  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836086750030518  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836182117462158  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.844918727874756  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 199, 64])
m.shape torch.Size([191, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.845528602600098  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.845528602600098  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.845620155334473  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.854643821716309  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 191, 64])
m.shape torch.Size([2239, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862938404083252  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862938404083252  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864006519317627  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9781599044799805  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2239, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.961641311645508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9635210037231445  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.96521520614624  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.963250637054443  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11368, 40])
input nodes number: 56334
output nodes number: 11368
edges number: 77476
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.963773250579834  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02659440040588379 |0.004633069038391113 |0.12112903594970703 |0.0007339715957641602 |0.04719209671020508 |0.006392955780029297 |
----------------------------------------------------------pseudo_mini_loss sum 1.4349642992019653
for loop block_dataloader item  time:  0.8226616382598877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08113241195678711  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08113241195678711  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([142590, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08113241195678711  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7446, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33512067794799805  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33512067794799805  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.342221736907959  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3990302085876465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7446, 128])
m.shape torch.Size([9246, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4042973518371582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4042973518371582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4131150245666504  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5453963279724121  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9246, 128])
m.shape torch.Size([9153, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5541567802429199  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5541567802429199  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5629301071166992  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7562007904052734  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9153, 128])
m.shape torch.Size([8430, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7679152488708496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7679152488708496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.776618480682373  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0109176635742188  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8430, 128])
m.shape torch.Size([83936, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.207016944885254  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.207016944885254  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.287064552307129  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.168778419494629  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 83936, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.941256523132324  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.969440460205078  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.997624397277832  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9685592651367188  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118211, 64])
input nodes number: 142590
output nodes number: 118211
edges number: 506797
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.998779773712158  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.026963710784912  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.03400993347168  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.03400993347168  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118211, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.03400993347168  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3058, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.138041019439697  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.138041019439697  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.139499187469482  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.15226411819458  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3058, 64])
m.shape torch.Size([3882, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.153489112854004  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.153489112854004  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.155340194702148  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.184860706329346  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3882, 64])
m.shape torch.Size([3866, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.187474250793457  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.187474250793457  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.18931770324707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.231100082397461  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3866, 64])
m.shape torch.Size([3670, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.233788013458252  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.233788013458252  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.235538005828857  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.286287784576416  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3670, 64])
m.shape torch.Size([3480, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.289690971374512  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.289690971374512  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.291350364685059  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.351088523864746  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3480, 64])
m.shape torch.Size([3070, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.354787826538086  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.354787826538086  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3562517166137695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.419218063354492  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3070, 64])
m.shape torch.Size([2753, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.423224925994873  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.423224925994873  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4245381355285645  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.49077844619751  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2753, 64])
m.shape torch.Size([2589, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.495214462280273  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.495214462280273  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4964494705200195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.566925525665283  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2589, 64])
m.shape torch.Size([2313, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.571426868438721  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.571426868438721  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.572530269622803  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.643807888031006  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2313, 64])
m.shape torch.Size([27475, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.710808753967285  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.710808753967285  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.723910331726074  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.654965400695801  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 27475, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.563361644744873  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.5767502784729  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.590138912200928  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.576331615447998  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([56156, 64])
input nodes number: 118211
output nodes number: 56156
edges number: 408470
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.5910210609436035  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.604409694671631  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.607757091522217  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.607757091522217  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.627535820007324  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.627535820007324  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.628344535827637  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.635481834411621  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1695, 64])
m.shape torch.Size([1470, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.635800361633301  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.635800361633301  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.636501312255859  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.647359848022461  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1470, 64])
m.shape torch.Size([1125, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.647839546203613  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.647839546203613  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.64837646484375  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.660794258117676  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1125, 64])
m.shape torch.Size([941, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.66145133972168  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.66145133972168  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.661900520324707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.674915313720703  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 941, 64])
m.shape torch.Size([774, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675642490386963  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.675642490386963  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.676011562347412  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.689298152923584  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 774, 64])
m.shape torch.Size([636, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.690052032470703  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.690052032470703  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.69035530090332  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703395843505859  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 636, 64])
m.shape torch.Size([516, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.704132556915283  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.704132556915283  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.704378604888916  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716681003570557  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 516, 64])
m.shape torch.Size([416, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717376232147217  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717376232147217  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717574596405029  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.728881359100342  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 416, 64])
m.shape torch.Size([361, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.729581356048584  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.729581356048584  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7297539710998535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7407755851745605  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 361, 64])
m.shape torch.Size([359, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741572380065918  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741572380065918  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741744041442871  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.753903388977051  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 359, 64])
m.shape torch.Size([275, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.754561901092529  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.754561901092529  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.754693508148193  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.764927387237549  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 275, 64])
m.shape torch.Size([232, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7655463218688965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7655463218688965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7656569480896  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775060176849365  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 232, 64])
m.shape torch.Size([195, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775628566741943  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775628566741943  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775722026824951  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.78428316116333  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 195, 64])
m.shape torch.Size([200, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7849249839782715  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7849249839782715  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.785020351409912  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794461727142334  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 200, 64])
m.shape torch.Size([2173, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802919864654541  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802919864654541  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.803956508636475  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.915647983551025  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2173, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.89926290512085  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.90098237991333  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.902878284454346  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.901073932647705  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11368, 40])
input nodes number: 56156
output nodes number: 11368
edges number: 76978
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.901417255401611  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026203234990437824 |0.00448918342590332 |0.14104731877644858 |0.0007706483205159506 |0.04719845453898112 |0.006806373596191406 |
----------------------------------------------------------pseudo_mini_loss sum 1.4132174253463745
for loop block_dataloader item  time:  1.2201991081237793
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08135747909545898  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08135747909545898  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([142789, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08135747909545898  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7497, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3362083435058594  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3362083435058594  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34335803985595703  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4005556106567383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7497, 128])
m.shape torch.Size([9059, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40562009811401367  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40562009811401367  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4142594337463379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5462450981140137  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9059, 128])
m.shape torch.Size([9094, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5546350479125977  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5546350479125977  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5638232231140137  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7574653625488281  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9094, 128])
m.shape torch.Size([8424, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7689638137817383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7689638137817383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7772836685180664  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0102624893188477  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8424, 128])
m.shape torch.Size([84624, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2080049514770508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2080049514770508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2900362014770508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.213864326477051  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 84624, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.983518600463867  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0118184089660645  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.040118217468262  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.010933876037598  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118698, 64])
input nodes number: 142789
output nodes number: 118698
edges number: 509713
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0413103103637695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.069610118865967  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076685428619385  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076685428619385  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118698, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.076685428619385  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3104, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.182638645172119  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.182638645172119  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.184118747711182  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.197285175323486  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3104, 64])
m.shape torch.Size([3767, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198397636413574  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.198397636413574  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.200194358825684  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.228610515594482  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3767, 64])
m.shape torch.Size([3880, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.231262683868408  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.231262683868408  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.233112812042236  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.275086879730225  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3880, 64])
m.shape torch.Size([3662, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.277853965759277  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.277853965759277  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.279600143432617  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.330239295959473  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3662, 64])
m.shape torch.Size([3487, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.333653450012207  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.333653450012207  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3353166580200195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.395730972290039  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3487, 64])
m.shape torch.Size([3057, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.399409294128418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.399409294128418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.400867462158203  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.4637227058410645  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3057, 64])
m.shape torch.Size([2728, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.467689037322998  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.467689037322998  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.468989849090576  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.534635066986084  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2728, 64])
m.shape torch.Size([2531, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.538963317871094  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.538963317871094  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.540170669555664  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.609409332275391  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2531, 64])
m.shape torch.Size([2298, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.613891124725342  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.613891124725342  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.614986896514893  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.685523986816406  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2298, 64])
m.shape torch.Size([28107, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.754082679748535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.754082679748535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.767485618591309  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.736034393310547  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 28107, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.641353130340576  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.654852867126465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6683526039123535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.654430866241455  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([56621, 64])
input nodes number: 118698
output nodes number: 56621
edges number: 413799
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.669238090515137  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.682737827301025  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686112880706787  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.686112880706787  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1736, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.705946445465088  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.705946445465088  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7067742347717285  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714270114898682  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1736, 64])
m.shape torch.Size([1472, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714580059051514  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.714580059051514  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715281963348389  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.726345539093018  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1472, 64])
m.shape torch.Size([1201, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72688102722168  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72688102722168  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72745418548584  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.741724014282227  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1201, 64])
m.shape torch.Size([872, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742295265197754  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742295265197754  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.742711067199707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.754769325256348  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 872, 64])
m.shape torch.Size([755, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755489826202393  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755489826202393  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.755850315093994  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.768813610076904  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 755, 64])
m.shape torch.Size([617, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769543647766113  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769543647766113  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.769838333129883  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.782492637634277  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 617, 64])
m.shape torch.Size([469, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.783153057098389  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.783153057098389  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.783377170562744  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794562816619873  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 469, 64])
m.shape torch.Size([403, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795243740081787  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795243740081787  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795436382293701  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.806394100189209  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 403, 64])
m.shape torch.Size([371, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807119369506836  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807119369506836  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8072967529296875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8186235427856445  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 371, 64])
m.shape torch.Size([323, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819329261779785  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819329261779785  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819483757019043  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8304243087768555  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 323, 64])
m.shape torch.Size([270, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831077575683594  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831077575683594  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.831206321716309  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841248512268066  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 270, 64])
m.shape torch.Size([235, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8418779373168945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8418779373168945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8419904708862305  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8515214920043945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 235, 64])
m.shape torch.Size([218, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8521623611450195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8521623611450195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.852266311645508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.86182975769043  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 218, 64])
m.shape torch.Size([174, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862377166748047  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862377166748047  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.862460136413574  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.870674133300781  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 174, 64])
m.shape torch.Size([2252, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8789381980896  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8789381980896  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.880012035369873  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.995870113372803  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2252, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.979994297027588  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.981993198394775  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.984032154083252  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.981948375701904  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11368, 40])
input nodes number: 56621
output nodes number: 11368
edges number: 77164
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.982734680175781  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026970863342285156 |0.004518330097198486 |0.1362370252609253 |0.0007511377334594727 |0.04735654592514038 |0.006756782531738281 |
----------------------------------------------------------pseudo_mini_loss sum 1.4213380813598633
for loop block_dataloader item  time:  1.5585849285125732
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08128786087036133  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08128786087036133  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([142695, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08128786087036133  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7269, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33559083938598633  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.33559083938598633  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34252309799194336  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39818286895751953  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7269, 128])
m.shape torch.Size([9135, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4034285545349121  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4034285545349121  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4121403694152832  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5440535545349121  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9135, 128])
m.shape torch.Size([9174, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5526666641235352  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5526666641235352  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5616316795349121  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.755126953125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9174, 128])
m.shape torch.Size([8296, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7664957046508789  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7664957046508789  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7747888565063477  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.004227638244629  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8296, 128])
m.shape torch.Size([84518, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2017784118652344  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2017784118652344  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2838096618652344  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.207637786865234  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 84518, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9775218963623047  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.005748748779297  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.033975601196289  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.004866600036621  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118392, 64])
input nodes number: 142695
output nodes number: 118392
edges number: 508835
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.035312652587891  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.063539505004883  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.070596218109131  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.070596218109131  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118392, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.070596218109131  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3083, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174691200256348  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.174691200256348  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.176161766052246  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.189108371734619  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3083, 64])
m.shape torch.Size([3863, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1911301612854  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1911301612854  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.192972660064697  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.220747470855713  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3863, 64])
m.shape torch.Size([3892, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2226972579956055  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2226972579956055  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.224553108215332  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.267299652099609  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3892, 64])
m.shape torch.Size([3608, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.269920349121094  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.269920349121094  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.271640777587891  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.321533203125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3608, 64])
m.shape torch.Size([3499, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.32497501373291  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.32497501373291  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.326643943786621  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.386711120605469  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3499, 64])
m.shape torch.Size([3014, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.390323162078857  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.390323162078857  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.391760349273682  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.453559398651123  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3014, 64])
m.shape torch.Size([2672, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.45743989944458  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.45743989944458  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.458714008331299  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.523016452789307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2672, 64])
m.shape torch.Size([2527, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.527349948883057  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.527349948883057  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.528555393218994  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.597998142242432  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2527, 64])
m.shape torch.Size([2251, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.602376937866211  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.602376937866211  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.603450775146484  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.673351287841797  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2251, 64])
m.shape torch.Size([27956, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.741549968719482  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.741549968719482  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.754880428314209  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721969127655029  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 27956, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.629637241363525  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.643075942993164  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.656514644622803  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.642655849456787  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([56365, 64])
input nodes number: 118392
output nodes number: 56365
edges number: 411235
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.657397747039795  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.670836448669434  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.674953937530518  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.674953937530518  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1638, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694758892059326  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.694758892059326  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695539951324463  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.702061653137207  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1638, 64])
m.shape torch.Size([1457, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.702387809753418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.702387809753418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.703083038330078  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.715642929077148  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1457, 64])
m.shape torch.Size([1216, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716192245483398  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716192245483398  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.716772079467773  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.733537673950195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1216, 64])
m.shape torch.Size([924, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734156608581543  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734156608581543  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.734597206115723  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.747374534606934  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 924, 64])
m.shape torch.Size([824, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.748209476470947  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.748209476470947  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.748602390289307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.762747287750244  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 824, 64])
m.shape torch.Size([582, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763409614562988  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763409614562988  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7636871337890625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.775620460510254  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 582, 64])
m.shape torch.Size([493, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776330471038818  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776330471038818  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776566028594971  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.788323879241943  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 493, 64])
m.shape torch.Size([433, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789058208465576  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789058208465576  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789265155792236  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8010382652282715  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 433, 64])
m.shape torch.Size([380, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801775932312012  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801775932312012  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801957130432129  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.813553810119629  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 380, 64])
m.shape torch.Size([307, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814218044281006  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814218044281006  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814364910125732  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.824763774871826  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 307, 64])
m.shape torch.Size([296, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825490951538086  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825490951538086  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825632095336914  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.836641311645508  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 296, 64])
m.shape torch.Size([237, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837270259857178  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837270259857178  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.83738374710083  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.846995830535889  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 237, 64])
m.shape torch.Size([210, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8476104736328125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8476104736328125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.847710609436035  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8569231033325195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 210, 64])
m.shape torch.Size([156, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.857410430908203  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.857410430908203  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.857484817504883  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.864849090576172  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 156, 64])
m.shape torch.Size([2215, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.872981548309326  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.872981548309326  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.874038219451904  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.986997127532959  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2215, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.970562934875488  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.972538948059082  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.974233150482178  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.972172260284424  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11368, 40])
input nodes number: 56365
output nodes number: 11368
edges number: 77152
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.972654342651367  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02668461799621582 |0.004501533508300781 |0.13263211250305176 |0.0007429122924804688 |0.047166872024536136 |0.006598949432373047 |
----------------------------------------------------------pseudo_mini_loss sum 1.3827298879623413
for loop block_dataloader item  time:  1.897603988647461
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08126401901245117  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08126401901245117  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([142544, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08126401901245117  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7285, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3351778984069824  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3351778984069824  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34212541580200195  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3978919982910156  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7285, 128])
m.shape torch.Size([9183, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40317583084106445  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.40317583084106445  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41193342208862305  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5437378883361816  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9183, 128])
m.shape torch.Size([9005, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5522408485412598  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5522408485412598  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5613160133361816  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7547383308410645  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9005, 128])
m.shape torch.Size([8274, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7658233642578125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7658233642578125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7744650840759277  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0032954216003418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8274, 128])
m.shape torch.Size([84448, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2006897926330566  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2006897926330566  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2827210426330566  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.190985202789307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 84448, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9611425399780273  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9893226623535156  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.017502784729004  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9884419441223145  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118195, 64])
input nodes number: 142544
output nodes number: 118195
edges number: 508002
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.018956184387207  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.047136306762695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0541815757751465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0541815757751465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118195, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0541815757751465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3037, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1586456298828125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.1586456298828125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.160094261169434  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.173741817474365  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3037, 64])
m.shape torch.Size([3913, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175854206085205  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175854206085205  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.177720546722412  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.206362724304199  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3913, 64])
m.shape torch.Size([3848, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.208268165588379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.208268165588379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2101030349731445  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.250860691070557  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3848, 64])
m.shape torch.Size([3565, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.253449440002441  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.253449440002441  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.255149841308594  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.304450035095215  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3565, 64])
m.shape torch.Size([3275, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307626247406006  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.307626247406006  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.309188365936279  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.366993427276611  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3275, 64])
m.shape torch.Size([3026, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.370676517486572  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.370676517486572  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.372119426727295  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.434225559234619  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3026, 64])
m.shape torch.Size([2696, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438144207000732  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.438144207000732  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.439429759979248  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.504624843597412  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2696, 64])
m.shape torch.Size([2533, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.508964538574219  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.508964538574219  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5101728439331055  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.5797576904296875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2533, 64])
m.shape torch.Size([2282, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584203243255615  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.584203243255615  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.585291385650635  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.655209064483643  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2282, 64])
m.shape torch.Size([28081, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.72373628616333  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.72373628616333  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.73712682723999  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.705585956573486  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 28081, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.61309289932251  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.626780986785889  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.640193462371826  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.626086235046387  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([56256, 64])
input nodes number: 118195
output nodes number: 56256
edges number: 411682
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.640799522399902  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.654487609863281  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.657565116882324  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.657565116882324  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1674, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.677443981170654  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.677443981170654  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.678242206573486  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.684939384460449  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1674, 64])
m.shape torch.Size([1524, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6852898597717285  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6852898597717285  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.68601655960083  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6982221603393555  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1524, 64])
m.shape torch.Size([1173, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.698724269866943  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.698724269866943  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.699284076690674  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717401027679443  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1173, 64])
m.shape torch.Size([884, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717990875244141  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717990875244141  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.718412399291992  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7306365966796875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 884, 64])
m.shape torch.Size([743, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.731339931488037  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.731339931488037  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73169469833374  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.744451999664307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 743, 64])
m.shape torch.Size([590, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.745145320892334  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.745145320892334  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.745426654815674  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.757524013519287  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 590, 64])
m.shape torch.Size([487, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7582221031188965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7582221031188965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7584547996521  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.770069599151611  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 487, 64])
m.shape torch.Size([463, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.770864009857178  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.770864009857178  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.771085262298584  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7836737632751465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 463, 64])
m.shape torch.Size([371, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784384727478027  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784384727478027  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.784562110900879  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.795888900756836  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 371, 64])
m.shape torch.Size([305, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.796550273895264  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.796550273895264  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.796696186065674  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807027339935303  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 305, 64])
m.shape torch.Size([266, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807673931121826  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807673931121826  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807800769805908  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.817694187164307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 266, 64])
m.shape torch.Size([258, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.818392276763916  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.818392276763916  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.818515300750732  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.828972339630127  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 258, 64])
m.shape torch.Size([204, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.829563140869141  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.829563140869141  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.829660415649414  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.83860969543457  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 204, 64])
m.shape torch.Size([191, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.839218616485596  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.839218616485596  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.839310169219971  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.848333835601807  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 191, 64])
m.shape torch.Size([2235, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.856773376464844  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.856773376464844  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.857839584350586  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.972370147705078  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2235, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.955867767333984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.957745552062988  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.959866523742676  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.957903861999512  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11368, 40])
input nodes number: 56256
output nodes number: 11368
edges number: 77407
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.958309650421143  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026395479838053387 |0.004596273104349772 |0.1304048697153727 |0.0007394552230834961 |0.047194719314575195 |0.00659942626953125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3747402429580688
for loop block_dataloader item  time:  2.237107276916504
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08118581771850586  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08118581771850586  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([142480, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08118581771850586  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7253, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3350844383239746  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3350844383239746  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34200143814086914  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.39762306213378906  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7253, 128])
m.shape torch.Size([9172, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4029116630554199  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4029116630554199  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.41165876388549805  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5434527397155762  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9172, 128])
m.shape torch.Size([8957, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5518922805786133  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5518922805786133  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5610308647155762  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7544741630554199  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8957, 128])
m.shape torch.Size([8400, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7657308578491211  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7657308578491211  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7745013236999512  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0068163871765137  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8400, 128])
m.shape torch.Size([84378, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2039837837219238  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2039837837219238  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2860150337219238  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.192276477813721  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 84378, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.962404727935791  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9905762672424316  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.018747806549072  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.9896955490112305  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118160, 64])
input nodes number: 142480
output nodes number: 118160
edges number: 507958
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0199198722839355  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.048091411590576  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.055134296417236  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.055134296417236  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118160, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.055134296417236  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3025, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.160713195800781  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.160713195800781  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.162156105041504  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.175357341766357  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3025, 64])
m.shape torch.Size([3791, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.176644802093506  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.176644802093506  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.178452968597412  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.20698356628418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3791, 64])
m.shape torch.Size([3770, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.208992958068848  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.208992958068848  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.210790634155273  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2510528564453125  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3770, 64])
m.shape torch.Size([3699, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2537922859191895  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2537922859191895  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.255556583404541  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3067097663879395  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3699, 64])
m.shape torch.Size([3454, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3100738525390625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3100738525390625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.311720848083496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3720903396606445  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3454, 64])
m.shape torch.Size([3003, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.375697135925293  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.375697135925293  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.377129554748535  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.43890380859375  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3003, 64])
m.shape torch.Size([2806, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.443545818328857  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.443545818328857  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.444883823394775  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.514181613922119  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2806, 64])
m.shape torch.Size([2564, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.518556118011475  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.518556118011475  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.519778728485107  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.589467525482178  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2564, 64])
m.shape torch.Size([2339, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.594032287597656  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.594032287597656  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.595148086547852  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.667531490325928  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2339, 64])
m.shape torch.Size([28069, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.735986709594727  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.735986709594727  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.749371528625488  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.717641830444336  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 28069, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.623349189758301  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.636824607849121  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.650300025939941  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6364030838012695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([56520, 64])
input nodes number: 118160
output nodes number: 56520
edges number: 413896
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.651181697845459  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.664657115936279  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.668025970458984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.668025970458984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1671, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.68803596496582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.68803596496582  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.688833236694336  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.695431709289551  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1671, 64])
m.shape torch.Size([1409, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.69572639465332  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.69572639465332  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.696398735046387  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707431316375732  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1409, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707942962646484  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.707942962646484  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708491325378418  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721198081970215  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1149, 64])
m.shape torch.Size([930, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72183895111084  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.72183895111084  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722282409667969  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.735142707824707  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 930, 64])
m.shape torch.Size([735, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.735825061798096  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.735825061798096  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.736176013946533  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.748795986175537  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 735, 64])
m.shape torch.Size([625, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749542713165283  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749542713165283  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.749841213226318  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.762659549713135  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 625, 64])
m.shape torch.Size([533, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763428211212158  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763428211212158  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.763682842254639  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.776394367218018  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 533, 64])
m.shape torch.Size([451, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777154445648193  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777154445648193  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.777369976043701  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.789632320404053  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 451, 64])
m.shape torch.Size([361, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790323734283447  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790323734283447  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.790496349334717  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.801517963409424  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 361, 64])
m.shape torch.Size([348, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802287578582764  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802287578582764  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.802453517913818  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814235210418701  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 348, 64])
m.shape torch.Size([285, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814923286437988  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.814923286437988  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.815059661865234  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.825665473937988  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 285, 64])
m.shape torch.Size([252, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826341152191162  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826341152191162  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.826461315155029  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.83667516708374  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 252, 64])
m.shape torch.Size([232, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837357044219971  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837357044219971  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.837467670440674  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.847645282745361  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 232, 64])
m.shape torch.Size([186, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.848230361938477  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.848230361938477  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.848319053649902  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.857099533081055  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 186, 64])
m.shape torch.Size([2201, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865172863006592  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.865172863006592  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.866222858428955  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.979918003082275  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2201, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.9632954597473145  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.965086460113525  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.966911315917969  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.965035438537598  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11368, 40])
input nodes number: 56520
output nodes number: 11368
edges number: 77943
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.965455055236816  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0275881290435791 |0.00467092650277274 |0.12890590940202987 |0.0007365090506417411 |0.04700756072998047 |0.006639957427978516 |
----------------------------------------------------------pseudo_mini_loss sum 1.3538838624954224
for loop block_dataloader item  time:  2.5947670936584473
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08108663558959961  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08108663558959961  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([142658, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.08108663558959961  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([7304, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3355240821838379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3355240821838379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.34248971939086914  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.3985428810119629  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 7304, 128])
m.shape torch.Size([9091, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4037299156188965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4037299156188965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.4123997688293457  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5443549156188965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9091, 128])
m.shape torch.Size([9032, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5527019500732422  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5527019500732422  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.5618486404418945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.755615234375  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 9032, 128])
m.shape torch.Size([8355, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7668933868408203  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7668933868408203  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 0.7755351066589355  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.0075740814208984  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 8355, 128])
m.shape torch.Size([84614, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2053256034851074  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2053256034851074  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 1.2873568534851074  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.211184978485107  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 84614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 3.980649948120117  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.008877754211426  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.037105560302734  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.00799560546875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118396, 64])
input nodes number: 142658
output nodes number: 118396
edges number: 509072
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.038496017456055  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.066723823547363  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0737810134887695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0737810134887695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([118396, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.0737810134887695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([3073, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.178110599517822  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.178110599517822  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.179576396942139  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.192342281341553  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3073, 64])
m.shape torch.Size([3802, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.194108009338379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.194108009338379  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.195920944213867  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2245097160339355  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3802, 64])
m.shape torch.Size([3899, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.227285861968994  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.227285861968994  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.229145526885986  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.2709431648254395  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3899, 64])
m.shape torch.Size([3662, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.273717880249023  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.273717880249023  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.275464057922363  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.326618194580078  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3662, 64])
m.shape torch.Size([3423, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.329953670501709  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.329953670501709  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3315863609313965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.3903489112854  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3423, 64])
m.shape torch.Size([3064, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.394052982330322  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.394052982330322  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.395514011383057  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.458912372589111  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 3064, 64])
m.shape torch.Size([2775, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.462958335876465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.462958335876465  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.464282035827637  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.531287670135498  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2775, 64])
m.shape torch.Size([2514, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535571098327637  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.535571098327637  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.536769866943359  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.605836868286133  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2514, 64])
m.shape torch.Size([2231, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.610174655914307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.610174655914307  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.611238956451416  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.680714130401611  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2231, 64])
m.shape torch.Size([27966, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.748941898345947  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.748941898345947  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 4.762277126312256  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.728729724884033  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 27966, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.63627290725708  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.649722099304199  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.663171291351318  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.649301528930664  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([56409, 64])
input nodes number: 118396
output nodes number: 56409
edges number: 411797
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.6640543937683105  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.67750358581543  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.680866241455078  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.680866241455078  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

m.shape torch.Size([1686, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.700692176818848  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.700692176818848  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.701496124267578  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.70802116394043  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1686, 64])
m.shape torch.Size([1461, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708337783813477  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.708337783813477  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7090349197387695  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.721523284912109  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1461, 64])
m.shape torch.Size([1157, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722028732299805  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722028732299805  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.722580909729004  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738103866577148  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 1157, 64])
m.shape torch.Size([915, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738728046417236  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.738728046417236  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.73916482925415  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.751820087432861  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 915, 64])
m.shape torch.Size([769, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752547740936279  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752547740936279  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.752914905548096  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.76611852645874  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 769, 64])
m.shape torch.Size([622, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.766852855682373  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.766852855682373  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.767149448394775  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.779902935028076  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 622, 64])
m.shape torch.Size([523, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780655384063721  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780655384063721  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.780905246734619  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.7933783531188965  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 523, 64])
m.shape torch.Size([452, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794142723083496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794142723083496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.794358253479004  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.806643486022949  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 452, 64])
m.shape torch.Size([380, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807376861572266  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807376861572266  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.807558059692383  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819154739379883  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 380, 64])
m.shape torch.Size([290, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819777488708496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819777488708496  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.819915771484375  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.829733848571777  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 290, 64])
m.shape torch.Size([272, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.830400466918945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.830400466918945  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.830530166625977  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.840646743774414  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 272, 64])
m.shape torch.Size([237, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841281414031982  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841281414031982  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.841394901275635  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.851006984710693  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 237, 64])
m.shape torch.Size([204, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.851602554321289  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.851602554321289  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8516998291015625  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.860649108886719  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 204, 64])
m.shape torch.Size([182, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861227035522461  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861227035522461  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.861313819885254  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.869905471801758  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 182, 64])
m.shape torch.Size([2215, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8780317306518555  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.8780317306518555  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.879088401794434  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.992129802703857  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([1, 2215, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.975686073303223  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.977468490600586  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.979162216186523  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.977294921875  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

torch.Size([11365, 40])
input nodes number: 56409
output nodes number: 11365
edges number: 77174
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.0789794921875 GB
    Memory Allocated: 5.977791786193848  GigaBytes
Max Memory Allocated: 6.021347999572754  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027415186166763306 |0.004659682512283325 |0.1354743242263794 |0.0007440447807312012 |0.046809643507003784 |0.005085468292236328 |
----------------------------------------------------------pseudo_mini_loss sum 1.3499592542648315
Total (block generation + training)time/epoch 2.884969154993693
Training time/epoch 2.8945767879486084
Training time without block to device /epoch 2.857299327850342
Training time without total dataloading part /epoch 1.4693095684051514
load block tensor time/epoch 0.21932148933410645
block to device time/epoch 0.0372774600982666
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2540255
Number of first layer input nodes during this epoch:  1141251
