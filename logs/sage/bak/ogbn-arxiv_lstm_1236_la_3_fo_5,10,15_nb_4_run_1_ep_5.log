main start at this time 1649563639.9863157
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
for loop block_dataloader item  time:  0.22926735877990723
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1844482421875 GB
    Memory Allocated: 0.08419418334960938  GigaBytes
Max Memory Allocated: 0.08419418334960938  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1844482421875 GB
    Memory Allocated: 0.08419418334960938  GigaBytes
Max Memory Allocated: 0.08419418334960938  GigaBytes

torch.Size([153406, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1844482421875 GB
    Memory Allocated: 0.08419418334960938  GigaBytes
Max Memory Allocated: 0.08419418334960938  GigaBytes

m.shape torch.Size([11186, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.5926513671875 GB
    Memory Allocated: 0.37643909454345703  GigaBytes
Max Memory Allocated: 0.37828493118286133  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5926513671875 GB
    Memory Allocated: 0.37643909454345703  GigaBytes
Max Memory Allocated: 0.37828493118286133  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.5926513671875 GB
    Memory Allocated: 0.38710689544677734  GigaBytes
Max Memory Allocated: 0.38710689544677734  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6981201171875 GB
    Memory Allocated: 0.47289562225341797  GigaBytes
Max Memory Allocated: 0.4782295227050781  GigaBytes

torch.Size([1, 11186, 128])
m.shape torch.Size([12805, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.6981201171875 GB
    Memory Allocated: 0.47977352142333984  GigaBytes
Max Memory Allocated: 0.4800605773925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6981201171875 GB
    Memory Allocated: 0.47977352142333984  GigaBytes
Max Memory Allocated: 0.4800605773925781  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.6981201171875 GB
    Memory Allocated: 0.4919853210449219  GigaBytes
Max Memory Allocated: 0.4919853210449219  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9090576171875 GB
    Memory Allocated: 0.680964469909668  GigaBytes
Max Memory Allocated: 0.69317626953125  GigaBytes

torch.Size([1, 12805, 128])
m.shape torch.Size([11805, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.9266357421875 GB
    Memory Allocated: 0.692436695098877  GigaBytes
Max Memory Allocated: 0.69317626953125  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9266357421875 GB
    Memory Allocated: 0.692436695098877  GigaBytes
Max Memory Allocated: 0.69317626953125  GigaBytes

----------------------------------------3
 Nvidia-smi: 2.9266357421875 GB
    Memory Allocated: 0.7041716575622559  GigaBytes
Max Memory Allocated: 0.7041716575622559  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1942138671875 GB
    Memory Allocated: 0.960141658782959  GigaBytes
Max Memory Allocated: 0.977719783782959  GigaBytes

torch.Size([1, 11805, 128])
m.shape torch.Size([10331, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2156982421875 GB
    Memory Allocated: 0.974217414855957  GigaBytes
Max Memory Allocated: 0.977719783782959  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2156982421875 GB
    Memory Allocated: 0.974217414855957  GigaBytes
Max Memory Allocated: 0.977719783782959  GigaBytes

----------------------------------------3
 Nvidia-smi: 3.2156982421875 GB
    Memory Allocated: 0.9847726821899414  GigaBytes
Max Memory Allocated: 0.9847726821899414  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5535888671875 GB
    Memory Allocated: 1.2704925537109375  GigaBytes
Max Memory Allocated: 1.2901973724365234  GigaBytes

torch.Size([1, 10331, 128])
m.shape torch.Size([93542, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7781982421875 GB
    Memory Allocated: 1.4885878562927246  GigaBytes
Max Memory Allocated: 1.4938969612121582  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7781982421875 GB
    Memory Allocated: 1.4885878562927246  GigaBytes
Max Memory Allocated: 1.4938969612121582  GigaBytes

----------------------------------------3
 Nvidia-smi: 3.8680419921875 GB
    Memory Allocated: 1.5784316062927246  GigaBytes
Max Memory Allocated: 1.5784316062927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.793752193450928  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

torch.Size([1, 93542, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.535335063934326  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.568634986877441  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.601934909820557  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.56756591796875  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

torch.Size([139669, 64])
input nodes number: 153406
output nodes number: 139669
edges number: 581245
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.603206157684326  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.636506080627441  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.64483118057251  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.64483118057251  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

torch.Size([139669, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.64483118057251  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

m.shape torch.Size([5892, 1, 64])
----------------------------------------1
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.800559997558594  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.800559997558594  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.804029941558838  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.828492164611816  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

torch.Size([1, 5892, 64])
m.shape torch.Size([7049, 2, 64])
----------------------------------------1
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.830347537994385  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.830347537994385  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.833906650543213  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.885385990142822  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

torch.Size([1, 7049, 64])
m.shape torch.Size([6697, 3, 64])
----------------------------------------1
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.889090061187744  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.889090061187744  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.892649173736572  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.964355945587158  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

torch.Size([1, 6697, 64])
m.shape torch.Size([6081, 4, 64])
----------------------------------------1
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.968739986419678  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.968739986419678  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 4.971895694732666  GigaBytes
Max Memory Allocated: 5.016773700714111  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 5.057607173919678  GigaBytes
Max Memory Allocated: 5.063406467437744  GigaBytes

torch.Size([1, 6081, 64])
m.shape torch.Size([5722, 5, 64])
----------------------------------------1
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 5.063620090484619  GigaBytes
Max Memory Allocated: 5.063726902008057  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 5.063620090484619  GigaBytes
Max Memory Allocated: 5.063726902008057  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.3270263671875 GB
    Memory Allocated: 5.066349983215332  GigaBytes
Max Memory Allocated: 5.066349983215332  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4051513671875 GB
    Memory Allocated: 5.165870666503906  GigaBytes
Max Memory Allocated: 5.172691822052002  GigaBytes

torch.Size([1, 5722, 64])
m.shape torch.Size([4851, 6, 64])
----------------------------------------1
 Nvidia-smi: 7.4051513671875 GB
    Memory Allocated: 5.1716628074646  GigaBytes
Max Memory Allocated: 5.172691822052002  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4051513671875 GB
    Memory Allocated: 5.1716628074646  GigaBytes
Max Memory Allocated: 5.172691822052002  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.4051513671875 GB
    Memory Allocated: 5.174203395843506  GigaBytes
Max Memory Allocated: 5.174203395843506  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5028076171875 GB
    Memory Allocated: 5.27531099319458  GigaBytes
Max Memory Allocated: 5.28225040435791  GigaBytes

torch.Size([1, 4851, 64])
m.shape torch.Size([4314, 7, 64])
----------------------------------------1
 Nvidia-smi: 7.5047607421875 GB
    Memory Allocated: 5.281461715698242  GigaBytes
Max Memory Allocated: 5.28225040435791  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5047607421875 GB
    Memory Allocated: 5.281461715698242  GigaBytes
Max Memory Allocated: 5.28225040435791  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.5047607421875 GB
    Memory Allocated: 5.283792972564697  GigaBytes
Max Memory Allocated: 5.283792972564697  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6219482421875 GB
    Memory Allocated: 5.38723611831665  GigaBytes
Max Memory Allocated: 5.394435882568359  GigaBytes

torch.Size([1, 4314, 64])
m.shape torch.Size([3894, 8, 64])
----------------------------------------1
 Nvidia-smi: 7.6219482421875 GB
    Memory Allocated: 5.393867015838623  GigaBytes
Max Memory Allocated: 5.394435882568359  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6219482421875 GB
    Memory Allocated: 5.393867015838623  GigaBytes
Max Memory Allocated: 5.394435882568359  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.6239013671875 GB
    Memory Allocated: 5.395723819732666  GigaBytes
Max Memory Allocated: 5.395723819732666  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7391357421875 GB
    Memory Allocated: 5.506377696990967  GigaBytes
Max Memory Allocated: 5.513804912567139  GigaBytes

torch.Size([1, 3894, 64])
m.shape torch.Size([3523, 9, 64])
----------------------------------------1
 Nvidia-smi: 7.7391357421875 GB
    Memory Allocated: 5.513245582580566  GigaBytes
Max Memory Allocated: 5.513804912567139  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7391357421875 GB
    Memory Allocated: 5.513245582580566  GigaBytes
Max Memory Allocated: 5.513804912567139  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.7391357421875 GB
    Memory Allocated: 5.514925956726074  GigaBytes
Max Memory Allocated: 5.514925956726074  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8758544921875 GB
    Memory Allocated: 5.622444152832031  GigaBytes
Max Memory Allocated: 5.630003929138184  GigaBytes

torch.Size([1, 3523, 64])
m.shape torch.Size([39461, 10, 64])
----------------------------------------1
 Nvidia-smi: 7.9715576171875 GB
    Memory Allocated: 5.718626499176025  GigaBytes
Max Memory Allocated: 5.720518589019775  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9715576171875 GB
    Memory Allocated: 5.718626499176025  GigaBytes
Max Memory Allocated: 5.720518589019775  GigaBytes

----------------------------------------3
 Nvidia-smi: 7.9715576171875 GB
    Memory Allocated: 5.738157749176025  GigaBytes
Max Memory Allocated: 5.738157749176025  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4539794921875 GB
    Memory Allocated: 7.081989765167236  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

torch.Size([1, 39461, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 6.945066452026367  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 6.965924263000488  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 6.986782073974609  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 6.965272426605225  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

torch.Size([87484, 64])
input nodes number: 139669
output nodes number: 87484
edges number: 609788
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 6.988100051879883  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 7.008957862854004  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 7.014172554016113  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 7.014172554016113  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

m.shape torch.Size([3393, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 7.0536370277404785  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 7.0536370277404785  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.4559326171875 GB
    Memory Allocated: 7.05525541305542  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4617919921875 GB
    Memory Allocated: 7.068785190582275  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

torch.Size([1, 3393, 64])
m.shape torch.Size([2936, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.4617919921875 GB
    Memory Allocated: 7.069449424743652  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4617919921875 GB
    Memory Allocated: 7.069449424743652  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.4617919921875 GB
    Memory Allocated: 7.070849418640137  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4676513671875 GB
    Memory Allocated: 7.092201232910156  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

torch.Size([1, 2936, 64])
m.shape torch.Size([2356, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.4676513671875 GB
    Memory Allocated: 7.093333721160889  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4676513671875 GB
    Memory Allocated: 7.093333721160889  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.4676513671875 GB
    Memory Allocated: 7.094457149505615  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4715576171875 GB
    Memory Allocated: 7.121362686157227  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

torch.Size([1, 2356, 64])
m.shape torch.Size([1822, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.4715576171875 GB
    Memory Allocated: 7.1226348876953125  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4715576171875 GB
    Memory Allocated: 7.1226348876953125  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.4715576171875 GB
    Memory Allocated: 7.123503684997559  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4754638671875 GB
    Memory Allocated: 7.149378299713135  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

torch.Size([1, 1822, 64])
m.shape torch.Size([1575, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.4754638671875 GB
    Memory Allocated: 7.150880813598633  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4754638671875 GB
    Memory Allocated: 7.150880813598633  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.4754638671875 GB
    Memory Allocated: 7.151632308959961  GigaBytes
Max Memory Allocated: 7.176072120666504  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4793701171875 GB
    Memory Allocated: 7.178885459899902  GigaBytes
Max Memory Allocated: 7.180763244628906  GigaBytes

torch.Size([1, 1575, 64])
m.shape torch.Size([1220, 6, 64])
----------------------------------------1
 Nvidia-smi: 9.4793701171875 GB
    Memory Allocated: 7.180309772491455  GigaBytes
Max Memory Allocated: 7.180763244628906  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4793701171875 GB
    Memory Allocated: 7.180309772491455  GigaBytes
Max Memory Allocated: 7.180763244628906  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.4793701171875 GB
    Memory Allocated: 7.180891513824463  GigaBytes
Max Memory Allocated: 7.180891513824463  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4832763671875 GB
    Memory Allocated: 7.210630416870117  GigaBytes
Max Memory Allocated: 7.212375640869141  GigaBytes

torch.Size([1, 1220, 64])
m.shape torch.Size([1034, 7, 64])
----------------------------------------1
 Nvidia-smi: 9.4832763671875 GB
    Memory Allocated: 7.2121195793151855  GigaBytes
Max Memory Allocated: 7.212375640869141  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4832763671875 GB
    Memory Allocated: 7.2121195793151855  GigaBytes
Max Memory Allocated: 7.212375640869141  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.4832763671875 GB
    Memory Allocated: 7.212612628936768  GigaBytes
Max Memory Allocated: 7.212612628936768  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4832763671875 GB
    Memory Allocated: 7.242478370666504  GigaBytes
Max Memory Allocated: 7.244204044342041  GigaBytes

torch.Size([1, 1034, 64])
m.shape torch.Size([860, 8, 64])
----------------------------------------1
 Nvidia-smi: 9.4832763671875 GB
    Memory Allocated: 7.243923664093018  GigaBytes
Max Memory Allocated: 7.244204044342041  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4832763671875 GB
    Memory Allocated: 7.243923664093018  GigaBytes
Max Memory Allocated: 7.244204044342041  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.4832763671875 GB
    Memory Allocated: 7.244333744049072  GigaBytes
Max Memory Allocated: 7.244333744049072  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5086669921875 GB
    Memory Allocated: 7.2677083015441895  GigaBytes
Max Memory Allocated: 7.269348621368408  GigaBytes

torch.Size([1, 860, 64])
m.shape torch.Size([736, 9, 64])
----------------------------------------1
 Nvidia-smi: 9.5086669921875 GB
    Memory Allocated: 7.269132137298584  GigaBytes
Max Memory Allocated: 7.269348621368408  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5086669921875 GB
    Memory Allocated: 7.269132137298584  GigaBytes
Max Memory Allocated: 7.269348621368408  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.5086669921875 GB
    Memory Allocated: 7.2694830894470215  GigaBytes
Max Memory Allocated: 7.2694830894470215  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5340576171875 GB
    Memory Allocated: 7.2919440269470215  GigaBytes
Max Memory Allocated: 7.29352331161499  GigaBytes

torch.Size([1, 736, 64])
m.shape torch.Size([654, 10, 64])
----------------------------------------1
 Nvidia-smi: 9.5340576171875 GB
    Memory Allocated: 7.293376922607422  GigaBytes
Max Memory Allocated: 7.29352331161499  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5340576171875 GB
    Memory Allocated: 7.293376922607422  GigaBytes
Max Memory Allocated: 7.29352331161499  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.5340576171875 GB
    Memory Allocated: 7.293688774108887  GigaBytes
Max Memory Allocated: 7.293688774108887  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5555419921875 GB
    Memory Allocated: 7.315830230712891  GigaBytes
Max Memory Allocated: 7.317389488220215  GigaBytes

torch.Size([1, 654, 64])
m.shape torch.Size([517, 11, 64])
----------------------------------------1
 Nvidia-smi: 9.5555419921875 GB
    Memory Allocated: 7.317146301269531  GigaBytes
Max Memory Allocated: 7.317389488220215  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5555419921875 GB
    Memory Allocated: 7.317146301269531  GigaBytes
Max Memory Allocated: 7.317389488220215  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.5555419921875 GB
    Memory Allocated: 7.3173933029174805  GigaBytes
Max Memory Allocated: 7.3173933029174805  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5750732421875 GB
    Memory Allocated: 7.336627960205078  GigaBytes
Max Memory Allocated: 7.338078022003174  GigaBytes

torch.Size([1, 517, 64])
m.shape torch.Size([485, 12, 64])
----------------------------------------1
 Nvidia-smi: 9.5750732421875 GB
    Memory Allocated: 7.337997913360596  GigaBytes
Max Memory Allocated: 7.338078022003174  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5750732421875 GB
    Memory Allocated: 7.337997913360596  GigaBytes
Max Memory Allocated: 7.338078022003174  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.5750732421875 GB
    Memory Allocated: 7.338229656219482  GigaBytes
Max Memory Allocated: 7.338229656219482  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5946044921875 GB
    Memory Allocated: 7.357893466949463  GigaBytes
Max Memory Allocated: 7.359281063079834  GigaBytes

torch.Size([1, 485, 64])
m.shape torch.Size([434, 13, 64])
----------------------------------------1
 Nvidia-smi: 9.5946044921875 GB
    Memory Allocated: 7.359165191650391  GigaBytes
Max Memory Allocated: 7.359281063079834  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5946044921875 GB
    Memory Allocated: 7.359165191650391  GigaBytes
Max Memory Allocated: 7.359281063079834  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.5946044921875 GB
    Memory Allocated: 7.359372138977051  GigaBytes
Max Memory Allocated: 7.359372138977051  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6141357421875 GB
    Memory Allocated: 7.378411293029785  GigaBytes
Max Memory Allocated: 7.379756450653076  GigaBytes

torch.Size([1, 434, 64])
m.shape torch.Size([346, 14, 64])
----------------------------------------1
 Nvidia-smi: 9.6141357421875 GB
    Memory Allocated: 7.3794989585876465  GigaBytes
Max Memory Allocated: 7.379756450653076  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6141357421875 GB
    Memory Allocated: 7.3794989585876465  GigaBytes
Max Memory Allocated: 7.379756450653076  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.6141357421875 GB
    Memory Allocated: 7.379663944244385  GigaBytes
Max Memory Allocated: 7.379756450653076  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6297607421875 GB
    Memory Allocated: 7.395997524261475  GigaBytes
Max Memory Allocated: 7.397152423858643  GigaBytes

torch.Size([1, 346, 64])
m.shape torch.Size([4368, 15, 64])
----------------------------------------1
 Nvidia-smi: 9.6297607421875 GB
    Memory Allocated: 7.41202449798584  GigaBytes
Max Memory Allocated: 7.41226863861084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6297607421875 GB
    Memory Allocated: 7.41202449798584  GigaBytes
Max Memory Allocated: 7.41226863861084  GigaBytes

----------------------------------------3
 Nvidia-smi: 9.6297607421875 GB
    Memory Allocated: 7.414107322692871  GigaBytes
Max Memory Allocated: 7.414107322692871  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.8797607421875 GB
    Memory Allocated: 7.643704414367676  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 4368, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.8797607421875 GB
    Memory Allocated: 7.610237121582031  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.8797607421875 GB
    Memory Allocated: 7.6136250495910645  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.8797607421875 GB
    Memory Allocated: 7.617053508758545  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.8797607421875 GB
    Memory Allocated: 7.613495826721191  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([22736, 40])
input nodes number: 87484
output nodes number: 22736
edges number: 153611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8797607421875 GB
    Memory Allocated: 7.617705345153809  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046192169189453125 |0.35491108894348145 |0.6631996631622314 |0.000232696533203125 |0.07529640197753906 |0.011698007583618164 |
----------------------------------------------------------pseudo_mini_loss sum 4.962723255157471
for loop block_dataloader item  time:  1.6860697269439697
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.09005594253540039  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.09005594253540039  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([153179, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.09005594253540039  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

m.shape torch.Size([11109, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.3823719024658203  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.3823719024658203  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.39296627044677734  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.4786081314086914  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 11109, 128])
m.shape torch.Size([12677, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.4854006767272949  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.4854006767272949  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.49749040603637695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.6788363456726074  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 12677, 128])
m.shape torch.Size([11729, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.6895699501037598  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.6895699501037598  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.7012076377868652  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.9475822448730469  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 11729, 128])
m.shape torch.Size([10350, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.9617304801940918  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.9617304801940918  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 0.9722585678100586  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 1.2585039138793945  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 10350, 128])
m.shape torch.Size([93635, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 1.4768118858337402  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 1.4768118858337402  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 1.5666556358337402  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.784636974334717  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 93635, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.526041030883789  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.559300422668457  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.592559814453125  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.558210372924805  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([139500, 64])
input nodes number: 153179
output nodes number: 139500
edges number: 581225
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.593748092651367  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.627007484436035  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.635353088378906  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.635353088378906  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([139500, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.635353088378906  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

m.shape torch.Size([5884, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.791539669036865  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.791539669036865  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.7950263023376465  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.819650650024414  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 5884, 64])
m.shape torch.Size([6947, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.821861267089844  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.821861267089844  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.825347900390625  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.875794887542725  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 6947, 64])
m.shape torch.Size([6720, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.8790082931518555  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.8790082931518555  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.8826003074646  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.95461368560791  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 6720, 64])
m.shape torch.Size([6217, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.959125995635986  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.959125995635986  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 4.962129592895508  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.049204349517822  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 6217, 64])
m.shape torch.Size([5584, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.054586887359619  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.054586887359619  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.057349681854248  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.157547473907471  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 5584, 64])
m.shape torch.Size([4865, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.162500858306885  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.162500858306885  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.164923191070557  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.270084857940674  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 4865, 64])
m.shape torch.Size([4362, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.2772722244262695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.2772722244262695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.279399871826172  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.384063720703125  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 4362, 64])
m.shape torch.Size([3931, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.390703201293945  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.390703201293945  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.392578125  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.502948760986328  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 3931, 64])
m.shape torch.Size([3478, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.509707927703857  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.509707927703857  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.511366367340088  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.617506504058838  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 3478, 64])
m.shape torch.Size([39659, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.714186668395996  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.714186668395996  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 5.733098030090332  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.082594871520996  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 39659, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 6.944425582885742  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 6.965322494506836  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 6.98621940612793  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 6.964669227600098  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([87647, 64])
input nodes number: 139500
output nodes number: 87647
edges number: 611790
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 6.987313270568848  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.008210182189941  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.013434410095215  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.013434410095215  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

m.shape torch.Size([3381, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.053184986114502  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.053184986114502  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.054797649383545  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.068926811218262  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 3381, 64])
m.shape torch.Size([2952, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.069647312164307  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.069647312164307  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.071054935455322  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.092682361602783  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 2952, 64])
m.shape torch.Size([2280, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.093772888183594  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.093772888183594  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.094860076904297  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.121868133544922  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 2280, 64])
m.shape torch.Size([1855, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.123255729675293  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.123255729675293  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.124140739440918  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.150157928466797  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 1855, 64])
m.shape torch.Size([1511, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.151573657989502  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.151573657989502  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.152294635772705  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.17891263961792  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 1511, 64])
m.shape torch.Size([1238, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.1803789138793945  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.1803789138793945  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.18096923828125  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.207386016845703  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 1238, 64])
m.shape torch.Size([984, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.208784580230713  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.208784580230713  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.209253787994385  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.2327141761779785  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 984, 64])
m.shape torch.Size([871, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.234192848205566  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.234192848205566  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.2346086502075195  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.258286476135254  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 871, 64])
m.shape torch.Size([736, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.259707450866699  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.259707450866699  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.260058403015137  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.282519340515137  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 736, 64])
m.shape torch.Size([677, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.284008502960205  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.284008502960205  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.284331798553467  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.307257175445557  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 677, 64])
m.shape torch.Size([544, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.308567047119141  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.308567047119141  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.308826446533203  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.329059600830078  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 544, 64])
m.shape torch.Size([475, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.330350875854492  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.330350875854492  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.330577850341797  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.349836349487305  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 475, 64])
m.shape torch.Size([400, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.3510026931762695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.3510026931762695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2547607421875 GB
    Memory Allocated: 7.351193428039551  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2606201171875 GB
    Memory Allocated: 7.368741035461426  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 400, 64])
m.shape torch.Size([346, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.2606201171875 GB
    Memory Allocated: 7.369858264923096  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2606201171875 GB
    Memory Allocated: 7.369858264923096  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2606201171875 GB
    Memory Allocated: 7.370023250579834  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.386356830596924  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 346, 64])
m.shape torch.Size([4486, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.4028191566467285  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.4028191566467285  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.405004978179932  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.634772300720215  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 4486, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.60263204574585  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.606019973754883  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.609407901763916  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.6058502197265625  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([22736, 40])
input nodes number: 87647
output nodes number: 22736
edges number: 154796
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2762451171875 GB
    Memory Allocated: 7.606673240661621  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03485453128814697 |0.1799013614654541 |0.402401328086853 |0.0004329681396484375 |0.07324028015136719 |0.008620023727416992 |
----------------------------------------------------------pseudo_mini_loss sum 3.843395471572876
for loop block_dataloader item  time:  2.1276466846466064
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.09007883071899414  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.09007883071899414  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([153185, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.09007883071899414  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

m.shape torch.Size([11082, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.38237762451171875  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.38237762451171875  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.3929462432861328  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.47853660583496094  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 11082, 128])
m.shape torch.Size([12806, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.48546504974365234  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.48546504974365234  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.4985809326171875  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.6875629425048828  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 12806, 128])
m.shape torch.Size([11765, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.6982865333557129  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.6982865333557129  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.7095065116882324  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.9563460350036621  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 11765, 128])
m.shape torch.Size([10310, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.9704008102416992  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.9704008102416992  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.981295108795166  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 1.2664341926574707  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 10310, 128])
m.shape torch.Size([93628, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 1.4847445487976074  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 1.4847445487976074  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 1.5745882987976074  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.792369365692139  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 93628, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.533851146697998  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.567132472991943  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.600413799285889  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.565958023071289  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([139591, 64])
input nodes number: 153185
output nodes number: 139591
edges number: 581369
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.601521015167236  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.634802341461182  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.643122673034668  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.643122673034668  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([139591, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.643122673034668  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

m.shape torch.Size([5726, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.799407958984375  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.799407958984375  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.802952766418457  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.827403545379639  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 5726, 64])
m.shape torch.Size([7025, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.8290839195251465  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.8290839195251465  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.832723140716553  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.883838176727295  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 7025, 64])
m.shape torch.Size([6815, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.887455463409424  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.887455463409424  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.89109468460083  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.963846683502197  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 6815, 64])
m.shape torch.Size([6240, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.9685139656066895  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.9685139656066895  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 4.9716715812683105  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.059739112854004  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 6240, 64])
m.shape torch.Size([5658, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.065207481384277  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.065207481384277  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.068044185638428  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.168398380279541  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 5658, 64])
m.shape torch.Size([4968, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.174378395080566  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.174378395080566  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.176802635192871  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.2824225425720215  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 4968, 64])
m.shape torch.Size([4365, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.2891526222229  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.2891526222229  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.291305065155029  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.397026062011719  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 4365, 64])
m.shape torch.Size([4009, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.403072834014893  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.403072834014893  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.404984951019287  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.516332149505615  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 4009, 64])
m.shape torch.Size([3536, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.523200988769531  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.523200988769531  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.5248870849609375  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.6327972412109375  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 3536, 64])
m.shape torch.Size([39599, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.729316234588623  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.729316234588623  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 5.748847484588623  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.096627712249756  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 39599, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 6.959101676940918  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 6.980068683624268  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.001035690307617  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 6.979413032531738  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([87941, 64])
input nodes number: 139591
output nodes number: 87941
edges number: 613720
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.00222110748291  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.02318811416626  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.028429985046387  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.028429985046387  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

m.shape torch.Size([3284, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.068331718444824  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.068331718444824  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.069897651672363  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.083318710327148  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 3284, 64])
m.shape torch.Size([2922, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.08420467376709  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.08420467376709  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.085597991943359  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.107176780700684  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 2922, 64])
m.shape torch.Size([2313, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.108210563659668  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.108210563659668  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.10931396484375  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.135568141937256  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 2313, 64])
m.shape torch.Size([1850, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.1368913650512695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.1368913650512695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.137773513793945  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.163700103759766  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 1850, 64])
m.shape torch.Size([1561, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.165178298950195  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.165178298950195  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.165923118591309  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.192820072174072  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 1561, 64])
m.shape torch.Size([1179, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.194187164306641  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.194187164306641  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.19474983215332  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.222045421600342  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 1179, 64])
m.shape torch.Size([1044, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.2235612869262695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.2235612869262695  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.224059104919434  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.252115249633789  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 1044, 64])
m.shape torch.Size([892, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.2536211013793945  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.2536211013793945  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.254046440124512  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.278290748596191  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 892, 64])
m.shape torch.Size([743, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.279722690582275  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.279722690582275  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.2800774574279785  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.3027567863464355  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 743, 64])
m.shape torch.Size([662, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.3042073249816895  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.3042073249816895  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.30452299118042  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.326935291290283  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 662, 64])
m.shape torch.Size([556, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.328281402587891  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.328281402587891  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.328546524047852  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.349225997924805  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 556, 64])
m.shape torch.Size([481, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.350512981414795  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.350512981414795  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.350742816925049  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.37024450302124  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 481, 64])
m.shape torch.Size([414, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.3714680671691895  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.3714680671691895  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.3716654777526855  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.389827251434326  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 414, 64])
m.shape torch.Size([379, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.391033172607422  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.391033172607422  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.391214370727539  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.409112930297852  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

torch.Size([1, 379, 64])
m.shape torch.Size([4456, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.425456523895264  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.425456523895264  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.427692890167236  GigaBytes
Max Memory Allocated: 7.659329414367676  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.653376579284668  GigaBytes
Max Memory Allocated: 7.669312477111816  GigaBytes

torch.Size([1, 4456, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.6209588050842285  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.624346733093262  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.627734661102295  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.624176979064941  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([22736, 40])
input nodes number: 87941
output nodes number: 22736
edges number: 155513
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 7.625002384185791  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03219413757324219 |0.12158711751302083 |0.3151286443074544 |0.0005220572153727213 |0.07242806752522786 |0.009402751922607422 |
----------------------------------------------------------pseudo_mini_loss sum 3.1409759521484375
for loop block_dataloader item  time:  2.5708916187286377
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.09032583236694336  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.09032583236694336  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([153625, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4227294921875 GB
    Memory Allocated: 0.09032583236694336  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

m.shape torch.Size([11201, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.3834829330444336  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.3834829330444336  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.3941650390625  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.4799823760986328  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 11201, 128])
m.shape torch.Size([12679, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.48673295974731445  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.48673295974731445  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.49967479705810547  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.6810493469238281  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 12679, 128])
m.shape torch.Size([11860, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.6919693946838379  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.6919693946838379  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.703279972076416  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.9590682983398438  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 11860, 128])
m.shape torch.Size([10351, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.9731559753417969  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.9731559753417969  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 0.9841523170471191  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 1.2704253196716309  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 10351, 128])
m.shape torch.Size([93862, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 1.4900989532470703  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 1.4900989532470703  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 1.5799427032470703  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.81431770324707  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 93862, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.5555925369262695  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.58896017074585  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.62232780456543  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.587589263916016  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([139953, 64])
input nodes number: 153625
output nodes number: 139953
edges number: 582853
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.623372554779053  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.656740188598633  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.6650824546813965  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.6650824546813965  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([139953, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.6650824546813965  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

m.shape torch.Size([5924, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.822055339813232  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.822055339813232  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.825538158416748  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.849548816680908  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 5924, 64])
m.shape torch.Size([6952, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.851653099060059  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.851653099060059  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.855135917663574  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.9062180519104  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 6952, 64])
m.shape torch.Size([6804, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.909969806671143  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.909969806671143  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.913886070251465  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.987319469451904  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 6804, 64])
m.shape torch.Size([6159, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.991926670074463  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.991926670074463  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 4.995028495788574  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.084081172943115  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 6159, 64])
m.shape torch.Size([5618, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.089077472686768  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.089077472686768  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.091865062713623  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.192070960998535  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 5618, 64])
m.shape torch.Size([4875, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.19792366027832  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.19792366027832  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.20031213760376  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.3047776222229  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 4875, 64])
m.shape torch.Size([4364, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.310192584991455  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.310192584991455  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.312342166900635  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.421480655670166  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 4364, 64])
m.shape torch.Size([3954, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.428999900817871  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.428999900817871  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.430885314941406  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.541062355041504  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 3954, 64])
m.shape torch.Size([3547, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.547968864440918  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.547968864440918  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.549660682678223  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.65791130065918  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 3547, 64])
m.shape torch.Size([40096, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.75575590133667  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.75575590133667  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 5.77528715133667  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.16035795211792  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 40096, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.0218305587768555  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.042881488800049  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.063932418823242  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.0422234535217285  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([88293, 64])
input nodes number: 139953
output nodes number: 88293
edges number: 617279
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.064998626708984  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.086049556732178  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.091312408447266  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.091312408447266  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

m.shape torch.Size([3370, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.131176948547363  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.131176948547363  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.132783889770508  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.145895004272461  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 3370, 64])
m.shape torch.Size([2896, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.146533012390137  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.146533012390137  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.147913932800293  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.16933536529541  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 2896, 64])
m.shape torch.Size([2328, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.170438766479492  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.170438766479492  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.171548843383789  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.197756767272949  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 2328, 64])
m.shape torch.Size([1793, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.1989970207214355  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.1989970207214355  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.199852466583252  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.225745677947998  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 1793, 64])
m.shape torch.Size([1575, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.227254867553711  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.227254867553711  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.228006362915039  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.255673408508301  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 1575, 64])
m.shape torch.Size([1231, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.257113933563232  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.257113933563232  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.257701396942139  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.283405303955078  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 1231, 64])
m.shape torch.Size([983, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.284803867340088  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.284803867340088  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.28527307510376  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.308713436126709  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 983, 64])
m.shape torch.Size([849, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.310149192810059  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.310149192810059  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.310554504394531  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.333634376525879  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 849, 64])
m.shape torch.Size([761, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.335116386413574  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.335116386413574  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.335479736328125  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.358708381652832  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 761, 64])
m.shape torch.Size([606, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.360016822814941  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.360016822814941  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.3603057861328125  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.38082218170166  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 606, 64])
m.shape torch.Size([586, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.382262706756592  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.382262706756592  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.382542133331299  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.404337406158447  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 586, 64])
m.shape torch.Size([496, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.405661106109619  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.405661106109619  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.405897617340088  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.426001071929932  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 496, 64])
m.shape torch.Size([408, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.427186965942383  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.427186965942383  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.42738151550293  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.445280075073242  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 408, 64])
m.shape torch.Size([363, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.446432590484619  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.446432590484619  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7020263671875 GB
    Memory Allocated: 7.446606159210205  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.463749408721924  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

torch.Size([1, 363, 64])
m.shape torch.Size([4488, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.480214595794678  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.480214595794678  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.482510089874268  GigaBytes
Max Memory Allocated: 7.669427871704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.710249423980713  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4488, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.677144527435303  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.681315898895264  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.684703826904297  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.680362701416016  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22733, 40])
input nodes number: 88293
output nodes number: 22733
edges number: 155265
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.681973934173584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030030906200408936 |0.09246689081192017 |0.2717090845108032 |0.0005764961242675781 |0.07156890630722046 |0.01270437240600586 |
----------------------------------------------------------pseudo_mini_loss sum 2.7671971321105957
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1523473
Number of first layer input nodes during this epoch:  613395
for loop block_dataloader item  time:  0.22428655624389648
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.0909585952758789  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.0909585952758789  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153421, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.0909585952758789  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11115, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.3831624984741211  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.3831624984741211  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.39376258850097656  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.4794158935546875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11115, 128])
m.shape torch.Size([12706, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.4862332344055176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.4862332344055176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.499269962310791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6810307502746582  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12706, 128])
m.shape torch.Size([11720, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6917376518249512  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6917376518249512  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.7029147148132324  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9488101005554199  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11720, 128])
m.shape torch.Size([10324, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9629130363464355  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9629130363464355  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9738016128540039  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.2593278884887695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10324, 128])
m.shape torch.Size([93715, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.4778389930725098  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.4778389930725098  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.5676827430725098  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.80205774307251  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93715, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.543552875518799  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.576831340789795  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.610109806060791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.575769424438477  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139580, 64])
input nodes number: 153421
output nodes number: 139580
edges number: 581558
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.611266613006592  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.644545078277588  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.652864933013916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.652864933013916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139580, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.652864933013916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5893, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.809044361114502  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.809044361114502  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.8126301765441895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.837428569793701  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5893, 64])
m.shape torch.Size([7040, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.839171886444092  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.839171886444092  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.842757701873779  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.893798351287842  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 7040, 64])
m.shape torch.Size([6740, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.897456169128418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.897456169128418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.900856018066406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.972922325134277  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6740, 64])
m.shape torch.Size([6155, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.977602481842041  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.977602481842041  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.980758190155029  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.0683417320251465  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6155, 64])
m.shape torch.Size([5731, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.074425220489502  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.074425220489502  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.077158451080322  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.1771464347839355  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5731, 64])
m.shape torch.Size([4880, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.183231830596924  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.183231830596924  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.1855926513671875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.2905120849609375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4880, 64])
m.shape torch.Size([4323, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.297470569610596  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.297470569610596  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.299637317657471  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.4041619300842285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4323, 64])
m.shape torch.Size([3865, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.410604000091553  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.410604000091553  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.412447452545166  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.517837047576904  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3865, 64])
m.shape torch.Size([3502, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.524664878845215  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.524664878845215  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.526334762573242  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.633207321166992  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3502, 64])
m.shape torch.Size([39683, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.730024337768555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.730024337768555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.749555587768555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.099739074707031  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39683, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.962521076202393  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.983457088470459  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.004393100738525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.982802391052246  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([87812, 64])
input nodes number: 139580
output nodes number: 87812
edges number: 612277
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.005485534667969  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.026421546936035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.032593727111816  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.032593727111816  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3312, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.072229385375977  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.072229385375977  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.073808670043945  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.087203025817871  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3312, 64])
m.shape torch.Size([2980, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.087925910949707  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.087925910949707  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.089346885681152  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.111454963684082  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2980, 64])
m.shape torch.Size([2362, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.112590312957764  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.112590312957764  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.1137166023254395  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.140814304351807  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2362, 64])
m.shape torch.Size([1799, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.1420979499816895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.1420979499816895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.142956256866455  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.168313026428223  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1799, 64])
m.shape torch.Size([1615, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.169869899749756  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.169869899749756  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.170640468597412  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.198570728302002  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1615, 64])
m.shape torch.Size([1195, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.199948787689209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.199948787689209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.20051908493042  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.226320743560791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1195, 64])
m.shape torch.Size([1025, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.227800369262695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.227800369262695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.228289604187012  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.256841659545898  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1025, 64])
m.shape torch.Size([863, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.258294582366943  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.258294582366943  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.258706569671631  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.282166957855225  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 863, 64])
m.shape torch.Size([688, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.283483505249023  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.283483505249023  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.283811569213867  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.304807662963867  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 688, 64])
m.shape torch.Size([654, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3062520027160645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3062520027160645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.306563854217529  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.328705310821533  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 654, 64])
m.shape torch.Size([552, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.330042362213135  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.330042362213135  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.330305576324463  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.350836277008057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 552, 64])
m.shape torch.Size([482, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3521270751953125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3521270751953125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.352356910705566  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.371892929077148  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 482, 64])
m.shape torch.Size([414, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.373101711273193  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.373101711273193  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3732991218566895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.39146089553833  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 414, 64])
m.shape torch.Size([377, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.392660140991211  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.392660140991211  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.392840385437012  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.41064453125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 377, 64])
m.shape torch.Size([4418, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.426848411560059  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.426848411560059  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.429112434387207  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.65315055847168  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4418, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.620862007141113  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.6242499351501465  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.62763786315918  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.624080181121826  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 87812
output nodes number: 22736
edges number: 154396
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.624121189117432  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023459434509277344 |0.004984617233276367 |0.14000535011291504 |0.0006852149963378906 |0.04624366760253906 |0.00874471664428711 |
----------------------------------------------------------pseudo_mini_loss sum 2.551215648651123
for loop block_dataloader item  time:  0.6967272758483887
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.09024620056152344  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.09024620056152344  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153514, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.09024620056152344  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11136, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.3833622932434082  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.3833622932434082  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.3939824104309082  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.4796757698059082  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11136, 128])
m.shape torch.Size([12776, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.48654985427856445  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.48654985427856445  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.4995999336242676  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6823620796203613  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12776, 128])
m.shape torch.Size([11798, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6931471824645996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6931471824645996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.7043986320495605  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9603419303894043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11798, 128])
m.shape torch.Size([10364, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9744839668273926  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9744839668273926  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.985419750213623  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.27205228805542  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10364, 128])
m.shape torch.Size([93758, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.4906468391418457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.4906468391418457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.5804905891418457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.814865589141846  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93758, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.556154727935791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.589493274688721  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.62283182144165  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.58787202835083  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139832, 64])
input nodes number: 153514
output nodes number: 139832
edges number: 582328
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.623608589172363  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.656947135925293  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.665281772613525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.665281772613525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139832, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.665281772613525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5840, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.821770191192627  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.821770191192627  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.8252034187316895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.8491435050964355  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5840, 64])
m.shape torch.Size([6979, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.850869178771973  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.850869178771973  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.854302406311035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.905893325805664  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6979, 64])
m.shape torch.Size([6794, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.90963888168335  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.90963888168335  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.912975311279297  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.9849653244018555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6794, 64])
m.shape torch.Size([6226, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.989623546600342  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.989623546600342  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.992727756500244  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.08150053024292  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6226, 64])
m.shape torch.Size([5670, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.086986541748047  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.086986541748047  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.08991813659668  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.190410614013672  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5670, 64])
m.shape torch.Size([4889, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.1962714195251465  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.1962714195251465  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.198725700378418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.303377151489258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4889, 64])
m.shape torch.Size([4335, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.3105974197387695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.3105974197387695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.312665939331055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.421642780303955  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4335, 64])
m.shape torch.Size([3953, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.428384780883789  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.428384780883789  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.430270195007324  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.541125297546387  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3953, 64])
m.shape torch.Size([3525, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.547983169555664  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.547983169555664  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.549664497375488  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.657243728637695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3525, 64])
m.shape torch.Size([39795, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.75507116317749  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.75507116317749  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.774047374725342  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.127435207366943  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39795, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.988732814788818  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.010217189788818  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.0311994552612305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.009058952331543  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([88006, 64])
input nodes number: 139832
output nodes number: 88006
edges number: 614412
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.03231143951416  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.053293704986572  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.058539390563965  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.058539390563965  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3343, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.098348140716553  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.098348140716553  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.099942684173584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.113290309906006  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3343, 64])
m.shape torch.Size([2903, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.114010334014893  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.114010334014893  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.1153950691223145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.136385440826416  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2903, 64])
m.shape torch.Size([2372, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.137463092803955  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.137463092803955  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.138594150543213  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.165780544281006  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2372, 64])
m.shape torch.Size([1832, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.167457580566406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.167457580566406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.168331146240234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.1944804191589355  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1832, 64])
m.shape torch.Size([1517, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.196160316467285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.196160316467285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.1968841552734375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.224014759063721  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1517, 64])
m.shape torch.Size([1207, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.225433826446533  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.225433826446533  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.226009845733643  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.250977039337158  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1207, 64])
m.shape torch.Size([1019, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.252443313598633  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.252443313598633  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.2529296875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.277228355407715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1019, 64])
m.shape torch.Size([865, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.278687000274658  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.278687000274658  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.279099941253662  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.302614688873291  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 865, 64])
m.shape torch.Size([761, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.304092884063721  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.304092884063721  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3044562339782715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3276848793029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 761, 64])
m.shape torch.Size([656, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.329116344451904  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.329116344451904  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3294291496276855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.351638317108154  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 656, 64])
m.shape torch.Size([512, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3528666496276855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3528666496276855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3531107902526855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3721537590026855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 512, 64])
m.shape torch.Size([502, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.373513221740723  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.373513221740723  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.373752593994141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.394099235534668  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 502, 64])
m.shape torch.Size([414, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.395303249359131  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.395303249359131  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.395500659942627  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.413662433624268  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 414, 64])
m.shape torch.Size([339, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.414731025695801  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.414731025695801  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.41489315032959  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.430903434753418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 339, 64])
m.shape torch.Size([4494, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.447396755218506  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.447396755218506  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.449618816375732  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.677994251251221  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4494, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.644935607910156  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.6483235359191895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.651711463928223  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.648153781890869  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 88006
output nodes number: 22736
edges number: 155076
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.648979663848877  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023455023765563965 |0.005086064338684082 |0.1430342197418213 |0.0007495880126953125 |0.04559445381164551 |0.009132862091064453 |
----------------------------------------------------------pseudo_mini_loss sum 2.440721273422241
for loop block_dataloader item  time:  1.185354471206665
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.0901784896850586  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.0901784896850586  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153410, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.0901784896850586  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11108, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.38237953186035156  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.38237953186035156  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.3929729461669922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.47861289978027344  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11108, 128])
m.shape torch.Size([12611, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.48534297943115234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.48534297943115234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.49834108352661133  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6787428855895996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12611, 128])
m.shape torch.Size([11770, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6895666122436523  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.6895666122436523  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.7007913589477539  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9477357864379883  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11770, 128])
m.shape torch.Size([10378, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9619178771972656  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9619178771972656  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 0.9728269577026367  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.2598466873168945  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10378, 128])
m.shape torch.Size([93633, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.4781365394592285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.4781365394592285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 1.5679802894592285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.785904407501221  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93633, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.527334213256836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.560593605041504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.593852996826172  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.559526443481445  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139500, 64])
input nodes number: 153410
output nodes number: 139500
edges number: 581317
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.59519100189209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.628450393676758  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.636765480041504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.636765480041504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139500, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.636765480041504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5917, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.792751789093018  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.792751789093018  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.795930862426758  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.820310115814209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5917, 64])
m.shape torch.Size([6889, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.822081089019775  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.822081089019775  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.825460910797119  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.875019550323486  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6889, 64])
m.shape torch.Size([6774, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.878777980804443  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.878777980804443  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.882157802581787  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.954291820526123  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6774, 64])
m.shape torch.Size([6196, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.959129333496094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.959129333496094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 4.962221622467041  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.050584316253662  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6196, 64])
m.shape torch.Size([5601, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.056702136993408  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.056702136993408  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.059376239776611  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.159027576446533  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5601, 64])
m.shape torch.Size([4939, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.164143085479736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.164143085479736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.166633129119873  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.27276086807251  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4939, 64])
m.shape torch.Size([4301, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.278985977172852  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.278985977172852  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.281144142150879  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.38485860824585  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4301, 64])
m.shape torch.Size([3941, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.391513824462891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.391513824462891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.393393516540527  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.503521919250488  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3941, 64])
m.shape torch.Size([3538, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.511075496673584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.511075496673584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.512762546539307  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.620733737945557  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3538, 64])
m.shape torch.Size([39690, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.717642784118652  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.717642784118652  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 5.736568450927734  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.086952209472656  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39690, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.948318004608154  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.969802379608154  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.990732192993164  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.968593597412109  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([87786, 64])
input nodes number: 139500
output nodes number: 87786
edges number: 612817
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 6.99180793762207  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.01273775100708  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.017970561981201  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.017970561981201  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3379, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.057857513427734  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.057857513427734  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.059469223022461  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.073083400726318  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3379, 64])
m.shape torch.Size([2878, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.073797702789307  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.073797702789307  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.075170040130615  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.097194194793701  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2878, 64])
m.shape torch.Size([2287, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.098249435424805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.098249435424805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.099340438842773  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.126316547393799  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2287, 64])
m.shape torch.Size([1817, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.1276631355285645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.1276631355285645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.128530025482178  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.154740333557129  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1817, 64])
m.shape torch.Size([1559, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.156223773956299  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.156223773956299  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.156967639923096  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.184063911437988  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1559, 64])
m.shape torch.Size([1217, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.185487747192383  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.185487747192383  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.186068534851074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.211935043334961  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1217, 64])
m.shape torch.Size([973, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.213319778442383  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.213319778442383  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.213784217834473  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.23698616027832  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 973, 64])
m.shape torch.Size([900, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.238524436950684  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.238524436950684  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.238953590393066  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.263415336608887  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 900, 64])
m.shape torch.Size([764, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.264891624450684  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.264891624450684  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.265255928039551  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.288571357727051  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 764, 64])
m.shape torch.Size([672, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.290041446685791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.290041446685791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.2903618812561035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.313112735748291  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 672, 64])
m.shape torch.Size([573, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.314502716064453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.314502716064453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.314776420593262  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.336093902587891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 573, 64])
m.shape torch.Size([480, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.33737325668335  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.33737325668335  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.337602138519287  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.357057094573975  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 480, 64])
m.shape torch.Size([425, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.358302116394043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.358302116394043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3585052490234375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.3771562576293945  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 425, 64])
m.shape torch.Size([378, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.378355979919434  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.378355979919434  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7039794921875 GB
    Memory Allocated: 7.378536224365234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7059326171875 GB
    Memory Allocated: 7.396380424499512  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 378, 64])
m.shape torch.Size([4434, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4126434326171875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4126434326171875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.414836883544922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.643001079559326  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4434, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.610541343688965  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.613929271697998  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.617317199707031  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.613759517669678  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 87786
output nodes number: 22736
edges number: 155358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.614583492279053  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02559208869934082 |0.005114237467447917 |0.14298160870869955 |0.0007585684458414713 |0.045809268951416016 |0.008926630020141602 |
----------------------------------------------------------pseudo_mini_loss sum 2.329083204269409
for loop block_dataloader item  time:  1.7030327320098877
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09007835388183594  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09007835388183594  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153212, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09007835388183594  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11189, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38228416442871094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38228416442871094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39295482635498047  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.47874927520751953  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11189, 128])
m.shape torch.Size([12664, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4854912757873535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4854912757873535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.49843740463256836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6795973777770996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12664, 128])
m.shape torch.Size([11715, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6903171539306641  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6903171539306641  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7014894485473633  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9475812911987305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11715, 128])
m.shape torch.Size([10299, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9616389274597168  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9616389274597168  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9725604057312012  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2573952674865723  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10299, 128])
m.shape torch.Size([93586, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4756107330322266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4756107330322266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5654544830322266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.782033920288086  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93586, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.523420810699463  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.556669235229492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.5899176597595215  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.555630207061768  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139453, 64])
input nodes number: 153212
output nodes number: 139453
edges number: 580788
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.591104984283447  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.624353408813477  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.632665634155273  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.632665634155273  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139453, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.632665634155273  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5814, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.788985252380371  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.788985252380371  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.79188346862793  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.816191673278809  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5814, 64])
m.shape torch.Size([7029, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.817903995513916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.817903995513916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.821585178375244  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.872848987579346  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 7029, 64])
m.shape torch.Size([6672, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.875956058502197  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.875956058502197  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.879637241363525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.95179557800293  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6672, 64])
m.shape torch.Size([6212, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.95574951171875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.95574951171875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.959500789642334  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.047879219055176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6212, 64])
m.shape torch.Size([5656, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.054014205932617  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.054014205932617  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.057131290435791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.157484531402588  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5656, 64])
m.shape torch.Size([4940, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.163424015045166  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.163424015045166  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.165788173675537  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.270614147186279  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4940, 64])
m.shape torch.Size([4369, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.276947498321533  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.276947498321533  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.279133319854736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.386114597320557  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4369, 64])
m.shape torch.Size([3982, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.392905235290527  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.392905235290527  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.394804000854492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.505316734313965  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3982, 64])
m.shape torch.Size([3503, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.512119293212891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.512119293212891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.513790130615234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.620697975158691  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3503, 64])
m.shape torch.Size([39699, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.717746257781982  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.717746257781982  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.736720561981201  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.087361812591553  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39699, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.949240684509277  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.970191955566406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.991143226623535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.969536781311035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([87876, 64])
input nodes number: 139453
output nodes number: 87876
edges number: 613612
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.992197513580322  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.013148784637451  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0183868408203125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0183868408203125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3394, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.058032512664795  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.058032512664795  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.059650897979736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.07318639755249  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3394, 64])
m.shape torch.Size([2945, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.073902606964111  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.073902606964111  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.075307369232178  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.096561908721924  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2945, 64])
m.shape torch.Size([2256, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.097733974456787  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.097733974456787  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.098809719085693  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1244988441467285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2256, 64])
m.shape torch.Size([1872, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.125857353210449  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.125857353210449  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1267499923706055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.153049468994141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1872, 64])
m.shape torch.Size([1531, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.154485702514648  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.154485702514648  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.155216217041016  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1823320388793945  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1531, 64])
m.shape torch.Size([1249, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.184033393859863  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.184033393859863  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.184629440307617  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.210448265075684  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1249, 64])
m.shape torch.Size([1028, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.211919784545898  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.211919784545898  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.212409973144531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.239406108856201  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1028, 64])
m.shape torch.Size([844, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.240821361541748  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.240821361541748  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2412238121032715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.264163494110107  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 844, 64])
m.shape torch.Size([763, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.265651226043701  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.265651226043701  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.266015529632568  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.289305210113525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 763, 64])
m.shape torch.Size([617, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.290640354156494  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.290640354156494  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.290935039520264  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.311829090118408  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 617, 64])
m.shape torch.Size([566, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.313212871551514  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.313212871551514  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.313482761383057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.334534168243408  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 566, 64])
m.shape torch.Size([473, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.335794925689697  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.335794925689697  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3360209465026855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.355198383331299  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 473, 64])
m.shape torch.Size([403, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3563737869262695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3563737869262695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.356566429138184  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3742523193359375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 403, 64])
m.shape torch.Size([340, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.375359058380127  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.375359058380127  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.375521183013916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.391571521759033  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 340, 64])
m.shape torch.Size([4452, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.407909870147705  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.407909870147705  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.410032749176025  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.635923862457275  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4452, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.603767395019531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6071553230285645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.610543251037598  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.606985569000244  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22733, 40])
input nodes number: 87876
output nodes number: 22733
edges number: 154355
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6078104972839355  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02509516477584839 |0.0053612589836120605 |0.14223307371139526 |0.0007517337799072266 |0.045691728591918945 |0.009180307388305664 |
----------------------------------------------------------pseudo_mini_loss sum 2.259685754776001
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1523402
Number of first layer input nodes during this epoch:  613557
block dataloader generation time/epoch 9.5367431640625e-07
for loop block_dataloader item  time:  0.1714155673980713
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09020662307739258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09020662307739258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153427, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09020662307739258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11155, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38264942169189453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38264942169189453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39328765869140625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4790172576904297  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11155, 128])
m.shape torch.Size([12840, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4859433174133301  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4859433174133301  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4990057945251465  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6880850791931152  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12840, 128])
m.shape torch.Size([11772, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6988024711608887  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6988024711608887  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.710029125213623  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9570155143737793  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11772, 128])
m.shape torch.Size([10279, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9710078239440918  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9710078239440918  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9819402694702148  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2662220001220703  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10279, 128])
m.shape torch.Size([93762, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4848666191101074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4848666191101074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5747103691101074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.809085369110107  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93762, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.550473690032959  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.58380651473999  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6171393394470215  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.582747459411621  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139808, 64])
input nodes number: 153427
output nodes number: 139808
edges number: 582077
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6183037757873535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.651636600494385  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.659969806671143  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.659969806671143  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139808, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.659969806671143  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5892, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.816503047943115  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.816503047943115  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.820260524749756  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.845357418060303  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5892, 64])
m.shape torch.Size([6907, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.84698486328125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.84698486328125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.850742340087891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.90153694152832  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6907, 64])
m.shape torch.Size([6773, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.9051289558410645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.9051289558410645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.909189701080322  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.981250286102295  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6773, 64])
m.shape torch.Size([6215, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.986117362976074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.986117362976074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.9893293380737305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.0776166915893555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6215, 64])
m.shape torch.Size([5750, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.083758354187012  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.083758354187012  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.08650016784668  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.186559677124023  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5750, 64])
m.shape torch.Size([4969, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.192604064941406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.192604064941406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.195159912109375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.299551963806152  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4969, 64])
m.shape torch.Size([4366, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.305306434631348  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.305306434631348  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.307426452636719  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.417397499084473  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4366, 64])
m.shape torch.Size([3979, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.424183368682861  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.424183368682861  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.42608118057251  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.536587715148926  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3979, 64])
m.shape torch.Size([3519, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.544022083282471  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.544022083282471  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.545700550079346  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.653355121612549  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3519, 64])
m.shape torch.Size([39702, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.750131130218506  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.750131130218506  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.769062519073486  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1197896003723145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39702, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.98147439956665  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.002472400665283  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.023470401763916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0018157958984375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([88072, 64])
input nodes number: 139808
output nodes number: 88072
edges number: 614534
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.02451753616333  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.045515537261963  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.050765037536621  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.050765037536621  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3324, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0906524658203125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0906524658203125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.09223747253418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1064581871032715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3324, 64])
m.shape torch.Size([2928, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.107191562652588  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.107191562652588  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.108587741851807  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.129530429840088  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2928, 64])
m.shape torch.Size([2315, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.13057279586792  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.13057279586792  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.131677150726318  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.158682346343994  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2315, 64])
m.shape torch.Size([1776, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.159992694854736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.159992694854736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.160839557647705  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.186122417449951  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1776, 64])
m.shape torch.Size([1581, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.187643051147461  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.187643051147461  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.188397407531738  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.216336250305176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1581, 64])
m.shape torch.Size([1251, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.217804908752441  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.217804908752441  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.218401908874512  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.244175910949707  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1251, 64])
m.shape torch.Size([1001, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.245600700378418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.245600700378418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2460784912109375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2699480056762695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1001, 64])
m.shape torch.Size([862, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.27140474319458  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.27140474319458  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.271815776824951  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2952446937561035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 862, 64])
m.shape torch.Size([739, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.296674728393555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.296674728393555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.297027587890625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.319584846496582  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 739, 64])
m.shape torch.Size([653, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.321014404296875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.321014404296875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.32132625579834  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.343439102172852  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 653, 64])
m.shape torch.Size([573, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3448333740234375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3448333740234375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.345107078552246  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.366424560546875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 573, 64])
m.shape torch.Size([478, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.367701530456543  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.367701530456543  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.367929458618164  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.387303352355957  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 478, 64])
m.shape torch.Size([411, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.388503551483154  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.388503551483154  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.388700008392334  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.406736850738525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 411, 64])
m.shape torch.Size([350, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.407875061035156  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.407875061035156  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.408041954040527  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.424564361572266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 350, 64])
m.shape torch.Size([4494, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4410552978515625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4410552978515625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.443351745605469  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.672656536102295  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4494, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.639516830444336  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.642904758453369  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.646475315093994  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.642917633056641  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 88072
output nodes number: 22736
edges number: 155416
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.643743991851807  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022342681884765625 |0.0053577423095703125 |0.139937162399292 |0.0007073879241943359 |0.04426264762878418 |0.009050607681274414 |
----------------------------------------------------------pseudo_mini_loss sum 2.183957576751709
for loop block_dataloader item  time:  0.6065926551818848
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09051179885864258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09051179885864258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153356, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09051179885864258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11098, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3839254379272461  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3839254379272461  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39450931549072266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4801301956176758  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11098, 128])
m.shape torch.Size([12802, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4871244430541992  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4871244430541992  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.49933338165283203  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6883039474487305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12802, 128])
m.shape torch.Size([11848, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6991481781005859  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6991481781005859  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.710902214050293  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.967036247253418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11848, 128])
m.shape torch.Size([10329, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9810876846313477  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9810876846313477  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9916625022888184  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.277327060699463  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10329, 128])
m.shape torch.Size([93618, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4956045150756836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4956045150756836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5854482650756836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.802943229675293  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93618, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.54447603225708  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.577782154083252  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.611088275909424  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.575838565826416  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139695, 64])
input nodes number: 153356
output nodes number: 139695
edges number: 581652
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6114888191223145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.644794940948486  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.653121471405029  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.653121471405029  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139695, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.653121471405029  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5821, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.810222148895264  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.810222148895264  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.813597202301025  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.838347911834717  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5821, 64])
m.shape torch.Size([7011, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.840045928955078  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.840045928955078  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8436126708984375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.895350933074951  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 7011, 64])
m.shape torch.Size([6812, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.899012088775635  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.899012088775635  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.902578830718994  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.975747585296631  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6812, 64])
m.shape torch.Size([6133, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.980465412139893  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.980465412139893  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.983473777770996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.071615219116211  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6133, 64])
m.shape torch.Size([5664, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.077116012573242  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.077116012573242  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.080010414123535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.181025981903076  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5664, 64])
m.shape torch.Size([4943, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.186342239379883  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.186342239379883  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.189177989959717  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.293734073638916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4943, 64])
m.shape torch.Size([4427, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.301036357879639  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.301036357879639  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.303287029266357  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.410668849945068  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4427, 64])
m.shape torch.Size([3983, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.416915416717529  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.416915416717529  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.4188151359558105  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.529346942901611  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3983, 64])
m.shape torch.Size([3541, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.536232948303223  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.536232948303223  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.537921905517578  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.646948337554932  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3541, 64])
m.shape torch.Size([39984, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.744838237762451  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.744838237762451  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.763904094696045  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.14876127243042  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39984, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.010898590087891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.031955718994141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.053012847900391  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.03129768371582  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([88319, 64])
input nodes number: 139695
output nodes number: 88319
edges number: 617351
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.054192543029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.075249671936035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.080513954162598  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.080513954162598  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3374, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1203227043151855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1203227043151855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.121931552886963  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.134988307952881  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3374, 64])
m.shape torch.Size([2954, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.135690689086914  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.135690689086914  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.137099266052246  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.15898323059082  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2954, 64])
m.shape torch.Size([2270, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.159954071044922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.159954071044922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.161036491394043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.188694000244141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2270, 64])
m.shape torch.Size([1780, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1899895668029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1899895668029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.19083833694458  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.215845584869385  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1780, 64])
m.shape torch.Size([1535, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.217308521270752  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.217308521270752  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.218040943145752  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.245498180389404  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1535, 64])
m.shape torch.Size([1190, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.246887683868408  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.246887683868408  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.24745512008667  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2723870277404785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1190, 64])
m.shape torch.Size([1074, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.273952007293701  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.273952007293701  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.274464130401611  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.300686359405518  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1074, 64])
m.shape torch.Size([895, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.302190780639648  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.302190780639648  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.302618026733398  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.326948165893555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 895, 64])
m.shape torch.Size([763, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.328423500061035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.328423500061035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.328787803649902  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.352077484130859  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 763, 64])
m.shape torch.Size([636, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.353459358215332  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.353459358215332  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.353762626647949  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3752946853637695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 636, 64])
m.shape torch.Size([571, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.376688003540039  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.376688003540039  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.376960754394531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3982038497924805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 571, 64])
m.shape torch.Size([455, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.399410247802734  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.399410247802734  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.399627685546875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4180755615234375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 455, 64])
m.shape torch.Size([423, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.419319152832031  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.419319152832031  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.419521331787109  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.438084602355957  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 423, 64])
m.shape torch.Size([357, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.439212799072266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.439212799072266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.439383506774902  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.456243515014648  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 357, 64])
m.shape torch.Size([4459, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.472603797912598  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.472603797912598  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.474730491638184  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.701742649078369  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4459, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.669447422027588  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.672835350036621  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.676223278045654  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.672665596008301  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 88319
output nodes number: 22736
edges number: 155055
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.673493385314941  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022878289222717285 |0.005229830741882324 |0.15008246898651123 |0.0007857084274291992 |0.05652296543121338 |0.009170055389404297 |
----------------------------------------------------------pseudo_mini_loss sum 2.0809147357940674
for loop block_dataloader item  time:  1.1095802783966064
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09023332595825195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09023332595825195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153495, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09023332595825195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11184, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38337135314941406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38337135314941406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39403724670410156  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.47982215881347656  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11184, 128])
m.shape torch.Size([12745, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.48664379119873047  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.48664379119873047  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4996333122253418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6819519996643066  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12745, 128])
m.shape torch.Size([11757, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6926932334899902  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6926932334899902  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7039055824279785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9505772590637207  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11757, 128])
m.shape torch.Size([10315, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9646453857421875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9646453857421875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9755845069885254  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.260861873626709  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10315, 128])
m.shape torch.Size([93784, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4795417785644531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4795417785644531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5693855285644531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.803760528564453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93784, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.545144081115723  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.578471660614014  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.611799240112305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.576753616333008  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139785, 64])
input nodes number: 153495
output nodes number: 139785
edges number: 582125
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.612462997436523  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6457905769348145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.654122829437256  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.654122829437256  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139785, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.654122829437256  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5997, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.810608863830566  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.810608863830566  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8142290115356445  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.839016437530518  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5997, 64])
m.shape torch.Size([7018, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.84071159362793  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.84071159362793  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.844331741333008  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.895349502563477  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 7018, 64])
m.shape torch.Size([6728, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.899023056030273  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.899023056030273  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.903074741363525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.975074768066406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6728, 64])
m.shape torch.Size([6308, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.979804515838623  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.979804515838623  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.982975959777832  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.070892333984375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6308, 64])
m.shape torch.Size([5701, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.07639741897583  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.07639741897583  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.079365253448486  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.18064546585083  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5701, 64])
m.shape torch.Size([4808, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.186799049377441  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.186799049377441  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.189282417297363  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.289018154144287  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4808, 64])
m.shape torch.Size([4304, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.296120643615723  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.296120643615723  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.298228740692139  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.401346206665039  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4304, 64])
m.shape torch.Size([3961, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.408077239990234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.408077239990234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.409966468811035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.520848274230957  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3961, 64])
m.shape torch.Size([3495, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.527637958526611  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.527637958526611  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.5293049812316895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.636075496673584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3495, 64])
m.shape torch.Size([39825, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.733912467956543  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.733912467956543  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.753443717956543  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.10768985748291  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39825, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.970486640930176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.991502285003662  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.012517929077148  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.990845203399658  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([88145, 64])
input nodes number: 139785
output nodes number: 88145
edges number: 614323
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.013579368591309  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.034595012664795  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.039849281311035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.039849281311035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3354, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.079640865325928  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.079640865325928  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.081240177154541  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.094579219818115  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3354, 64])
m.shape torch.Size([2860, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0953264236450195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0953264236450195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0966901779174805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.118084907531738  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2860, 64])
m.shape torch.Size([2347, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.119266033172607  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.119266033172607  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.120385646820068  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.145008563995361  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2347, 64])
m.shape torch.Size([1924, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.146538734436035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.146538734436035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.147456169128418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1744303703308105  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1924, 64])
m.shape torch.Size([1542, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.175867557525635  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.175867557525635  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.176602840423584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.203784465789795  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1542, 64])
m.shape torch.Size([1209, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.205200672149658  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.205200672149658  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.205777645111084  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.231724262237549  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1209, 64])
m.shape torch.Size([949, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.23306941986084  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.23306941986084  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.233522415161133  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.256152153015137  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 949, 64])
m.shape torch.Size([857, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2576117515563965  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2576117515563965  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.258020877838135  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.281318187713623  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 857, 64])
m.shape torch.Size([767, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.282811164855957  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.282811164855957  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.283177375793457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.306589126586914  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 767, 64])
m.shape torch.Size([663, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3080363273620605  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3080363273620605  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.308352947235107  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.330804347991943  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 663, 64])
m.shape torch.Size([514, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.33203649520874  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.33203649520874  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.332281589508057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.351398944854736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 514, 64])
m.shape torch.Size([513, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.352790355682373  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.352790355682373  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3530354499816895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.373834133148193  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 513, 64])
m.shape torch.Size([412, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.375028610229492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.375028610229492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.375225067138672  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.393299102783203  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 412, 64])
m.shape torch.Size([361, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.394443511962891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.394443511962891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.39461612701416  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.411664962768555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 361, 64])
m.shape torch.Size([4464, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.428042411804199  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.428042411804199  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.430207252502441  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.657464981079102  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4464, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.623458385467529  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6268463134765625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.630234241485596  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.626676559448242  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 88145
output nodes number: 22736
edges number: 154987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.627503395080566  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02382667859395345 |0.005281130472819011 |0.15468573570251465 |0.0008161067962646484 |0.05298407872517904 |0.009161949157714844 |
----------------------------------------------------------pseudo_mini_loss sum 2.029784679412842
for loop block_dataloader item  time:  1.5764796733856201
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09014654159545898  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09014654159545898  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153395, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09014654159545898  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11173, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3823533058166504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3823533058166504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3930087089538574  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4787726402282715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11173, 128])
m.shape torch.Size([12819, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4856700897216797  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4856700897216797  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4987053871154785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6877245903015137  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12819, 128])
m.shape torch.Size([11752, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6984233856201172  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6984233856201172  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7096309661865234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9563412666320801  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11752, 128])
m.shape torch.Size([10253, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9702935218811035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9702935218811035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9812250137329102  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2647876739501953  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10253, 128])
m.shape torch.Size([93605, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4830703735351562  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4830703735351562  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5729141235351562  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.790037155151367  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.531556606292725  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.564840316772461  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.598124027252197  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.563799858093262  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139602, 64])
input nodes number: 153395
output nodes number: 139602
edges number: 581104
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.5992751121521  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.632558822631836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.640880107879639  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.640880107879639  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139602, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.640880107879639  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5822, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.797558307647705  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.797558307647705  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.801081657409668  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.826290130615234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5822, 64])
m.shape torch.Size([7062, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.827901840209961  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.827901840209961  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.831758499145508  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8846540451049805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 7062, 64])
m.shape torch.Size([6800, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.887742042541504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.887742042541504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.891598701477051  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.96485710144043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6800, 64])
m.shape torch.Size([6116, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.969480037689209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.969480037689209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.973186492919922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.061899662017822  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6116, 64])
m.shape torch.Size([5691, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.067438125610352  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.067438125610352  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.070265769958496  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.170636177062988  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5691, 64])
m.shape torch.Size([4786, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.176339626312256  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.176339626312256  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.178631782531738  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.2769775390625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4786, 64])
m.shape torch.Size([4359, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.2832865715026855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.2832865715026855  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.285578727722168  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.39482307434082  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4359, 64])
m.shape torch.Size([3940, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.400709629058838  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.400709629058838  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.402588367462158  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.512996196746826  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3940, 64])
m.shape torch.Size([3477, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.519751071929932  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.519751071929932  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.521409511566162  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.627523899078369  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3477, 64])
m.shape torch.Size([39603, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.724067211151123  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.724067211151123  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.7429518699646  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.090846538543701  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39603, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.952704429626465  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.973603248596191  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.994502067565918  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.972949981689453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([87656, 64])
input nodes number: 139602
output nodes number: 87656
edges number: 611337
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.995696544647217  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.016595363616943  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.021820068359375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.021820068359375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3376, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.061306476593018  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.061306476593018  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.062916278839111  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.075832843780518  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3376, 64])
m.shape torch.Size([2964, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.076620578765869  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.076620578765869  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.078033924102783  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.100332260131836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2964, 64])
m.shape torch.Size([2345, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.101541519165039  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.101541519165039  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.102660179138184  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.127422332763672  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2345, 64])
m.shape torch.Size([1840, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.128846168518066  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.128846168518066  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.12972354888916  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1556196212768555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1840, 64])
m.shape torch.Size([1564, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.157104015350342  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.157104015350342  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1578497886657715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1853508949279785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1564, 64])
m.shape torch.Size([1218, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.186775207519531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.186775207519531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.187355995178223  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.214649200439453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1218, 64])
m.shape torch.Size([1021, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.216116428375244  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.216116428375244  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.216603755950928  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.240950107574463  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1021, 64])
m.shape torch.Size([858, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.24239444732666  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.24239444732666  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.242803573608398  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2661237716674805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 858, 64])
m.shape torch.Size([707, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.267484188079834  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.267484188079834  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.267821788787842  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.289402484893799  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 707, 64])
m.shape torch.Size([647, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.290824890136719  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.290824890136719  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.291133880615234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.313043594360352  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 647, 64])
m.shape torch.Size([545, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.314363479614258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.314363479614258  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.314623832702637  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.33489990234375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 545, 64])
m.shape torch.Size([491, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.33621883392334  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.33621883392334  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.336453437805176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.35636043548584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 491, 64])
m.shape torch.Size([410, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.357577323913574  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.357577323913574  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3577728271484375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.375759124755859  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 410, 64])
m.shape torch.Size([366, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3769941329956055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3769941329956055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.377168655395508  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.39444637298584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 366, 64])
m.shape torch.Size([4381, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.410516738891602  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.410516738891602  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.413105010986328  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6382622718811035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4381, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.606001853942871  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.609389781951904  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6127777099609375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.609220027923584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22733, 40])
input nodes number: 87656
output nodes number: 22733
edges number: 153727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.610043048858643  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023707091808319092 |0.006716132164001465 |0.15101838111877441 |0.0007987618446350098 |0.05062001943588257 |0.009157419204711914 |
----------------------------------------------------------pseudo_mini_loss sum 1.9825693368911743
Total (block generation + training)time/epoch 1.8507604598999023
Training time/epoch 1.85062575340271
Training time without block to device /epoch 1.823761224746704
Training time without total dataloading part /epoch 0.8189060688018799
load block tensor time/epoch 0.09482836723327637
block to device time/epoch 0.02686452865600586
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1524755
Number of first layer input nodes during this epoch:  613673
block dataloader generation time/epoch 8.344650268554688e-07
for loop block_dataloader item  time:  0.18110346794128418
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.0901341438293457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.0901341438293457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153371, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.0901341438293457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11240, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3824124336242676  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3824124336242676  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39313173294067383  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.47902345657348633  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11240, 128])
m.shape torch.Size([12733, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.485806941986084  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.485806941986084  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4987373352050781  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6808843612670898  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12733, 128])
m.shape torch.Size([11740, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6916069984436035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6916069984436035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7028031349182129  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9491181373596191  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11740, 128])
m.shape torch.Size([10326, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9632153511047363  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9632153511047363  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9741730690002441  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2597546577453613  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10326, 128])
m.shape torch.Size([93482, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4777092933654785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4777092933654785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5675530433654785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.78115701675415  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93482, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.522477149963379  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.555741786956787  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.589006423950195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.554656028747559  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139521, 64])
input nodes number: 153371
output nodes number: 139521
edges number: 580640
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.590283393859863  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6235480308532715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.631864547729492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.631864547729492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139521, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.631864547729492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5892, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.788324356079102  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.788324356079102  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.791844367980957  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8166680335998535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5892, 64])
m.shape torch.Size([7059, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.818395614624023  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.818395614624023  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.82197380065918  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.873100280761719  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 7059, 64])
m.shape torch.Size([6687, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8768205642700195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8768205642700195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.880398750305176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.953073501586914  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6687, 64])
m.shape torch.Size([6229, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.957732200622559  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.957732200622559  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.960897445678711  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.048617839813232  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6229, 64])
m.shape torch.Size([5670, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.054102897644043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.054102897644043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.056872367858887  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.155132293701172  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5670, 64])
m.shape torch.Size([4901, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.160977840423584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.160977840423584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.163679122924805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.273116588592529  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4901, 64])
m.shape torch.Size([4256, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.27927303314209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.27927303314209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.281363487243652  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.384044647216797  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4256, 64])
m.shape torch.Size([3913, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.390599250793457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.390599250793457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.392465591430664  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.50318717956543  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3913, 64])
m.shape torch.Size([3510, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.510021209716797  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.510021209716797  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.51169490814209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.61881160736084  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3510, 64])
m.shape torch.Size([39568, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.7156081199646  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.7156081199646  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.7351393699646  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.082032680511475  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39568, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.944637298583984  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.965543270111084  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.986449241638184  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.9648895263671875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([87685, 64])
input nodes number: 139521
output nodes number: 87685
edges number: 611109
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.987592697143555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.008498668670654  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.013725280761719  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.013725280761719  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3381, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.053310394287109  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.053310394287109  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.054923057556152  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.068036079406738  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3381, 64])
m.shape torch.Size([2924, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.068723678588867  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.068723678588867  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.070117950439453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0915679931640625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2924, 64])
m.shape torch.Size([2321, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.092711925506592  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.092711925506592  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0938191413879395  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.119284629821777  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2321, 64])
m.shape torch.Size([1839, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.120574951171875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.120574951171875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.121452331542969  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.147510528564453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1839, 64])
m.shape torch.Size([1597, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.149035453796387  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.149035453796387  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.149797439575195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.177748680114746  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1597, 64])
m.shape torch.Size([1209, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.17915153503418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.17915153503418  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1797285079956055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.207503795623779  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1209, 64])
m.shape torch.Size([1037, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.209000587463379  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.209000587463379  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.209495544433594  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.239373207092285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1037, 64])
m.shape torch.Size([845, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.240787982940674  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.240787982940674  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.241191387176514  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.264162540435791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 845, 64])
m.shape torch.Size([720, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.266442775726318  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.266442775726318  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.266786098480225  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.288758754730225  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 720, 64])
m.shape torch.Size([653, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2901930809021  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2901930809021  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2905049324035645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.312617778778076  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 653, 64])
m.shape torch.Size([556, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.313965797424316  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.313965797424316  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.314230918884277  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3349103927612305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 556, 64])
m.shape torch.Size([458, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.336129188537598  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.336129188537598  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.336347579956055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.354910850524902  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 458, 64])
m.shape torch.Size([432, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.35618257522583  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.35618257522583  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.356388568878174  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.375339984893799  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 432, 64])
m.shape torch.Size([380, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.376545429229736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.376545429229736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3767266273498535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.394665241241455  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 380, 64])
m.shape torch.Size([4384, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.410743236541748  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.410743236541748  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4128336906433105  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.635430812835693  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4384, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.603085994720459  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.606473922729492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.609861850738525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.606304168701172  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 87685
output nodes number: 22736
edges number: 154124
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.607127666473389  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03259849548339844 |0.0052814483642578125 |0.1393446922302246 |0.0007586479187011719 |0.04692554473876953 |0.009341001510620117 |
----------------------------------------------------------pseudo_mini_loss sum 1.937378168106079
for loop block_dataloader item  time:  0.7008898258209229
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09009075164794922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09009075164794922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153302, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09009075164794922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11272, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3823370933532715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3823370933532715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39308691024780273  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.47908544540405273  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11272, 128])
m.shape torch.Size([12769, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4858880043029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4858880043029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.49880504608154297  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6814670562744141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12769, 128])
m.shape torch.Size([11667, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6920680999755859  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6920680999755859  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7031946182250977  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9479780197143555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11667, 128])
m.shape torch.Size([10337, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9621310234069824  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9621310234069824  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9730691909790039  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2590241432189941  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10337, 128])
m.shape torch.Size([93474, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.476954460144043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.476954460144043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.566798210144043  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.780173301696777  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93474, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.521546363830566  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.554810523986816  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.588074684143066  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.553771018981934  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139519, 64])
input nodes number: 153302
output nodes number: 139519
edges number: 580529
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.589260101318359  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.622524261474609  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.630840301513672  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.630840301513672  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139519, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.630840301513672  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5901, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.787100315093994  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.787100315093994  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.790618419647217  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8150858879089355  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5901, 64])
m.shape torch.Size([6926, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.816723823547363  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.816723823547363  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.820260047912598  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.870499610900879  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6926, 64])
m.shape torch.Size([6713, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.874256610870361  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.874256610870361  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.877792835235596  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.949866771697998  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6713, 64])
m.shape torch.Size([6156, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.954538345336914  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.954538345336914  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.957606792449951  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.045172214508057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6156, 64])
m.shape torch.Size([5664, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.0502166748046875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.0502166748046875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.05300235748291  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.151334762573242  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5664, 64])
m.shape torch.Size([4857, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.157100200653076  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.157100200653076  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.159469127655029  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.26094388961792  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4857, 64])
m.shape torch.Size([4360, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.2670063972473145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.2670063972473145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.269533634185791  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.379142761230469  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4360, 64])
m.shape torch.Size([3953, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.385879039764404  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.385879039764404  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.3877644538879395  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.498619556427002  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3953, 64])
m.shape torch.Size([3535, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.505499839782715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.505499839782715  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.507185935974121  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.615163803100586  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3535, 64])
m.shape torch.Size([39446, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.71169376373291  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.71169376373291  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.73122501373291  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.074627876281738  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39446, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.936825275421143  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.958309650421143  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.9791741371154785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.957037448883057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([87511, 64])
input nodes number: 139519
output nodes number: 87511
edges number: 610397
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.980575084686279  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.002059459686279  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.007485866546631  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.007485866546631  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3453, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.046985626220703  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.046985626220703  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.048632621765137  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.061872482299805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3453, 64])
m.shape torch.Size([2984, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.062527179718018  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.062527179718018  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.063950061798096  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.085346698760986  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2984, 64])
m.shape torch.Size([2249, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.086297512054443  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.086297512054443  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0873703956604  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.113086223602295  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2249, 64])
m.shape torch.Size([1786, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.114371299743652  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.114371299743652  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.115222930908203  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.140780448913574  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1786, 64])
m.shape torch.Size([1538, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.142245769500732  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.142245769500732  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.142979145050049  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1699090003967285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1538, 64])
m.shape torch.Size([1273, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.171420574188232  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.171420574188232  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.172028064727783  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.202270030975342  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1273, 64])
m.shape torch.Size([991, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.203672409057617  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.203672409057617  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.204145431518555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.227776527404785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 991, 64])
m.shape torch.Size([889, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2292890548706055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2292890548706055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.229713439941406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.253880500793457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 889, 64])
m.shape torch.Size([771, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.255374908447266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.255374908447266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.255743026733398  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2792768478393555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 771, 64])
m.shape torch.Size([651, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.280693531036377  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.280693531036377  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.281004428863525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.303049564361572  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 651, 64])
m.shape torch.Size([535, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.304381847381592  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.304381847381592  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.304637432098389  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3245415687561035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 535, 64])
m.shape torch.Size([465, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.325899600982666  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.325899600982666  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.326121807098389  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.344974994659424  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 465, 64])
m.shape torch.Size([413, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.346347808837891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.346347808837891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.346545219421387  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3646697998046875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 413, 64])
m.shape torch.Size([337, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3657708168029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3657708168029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.365931987762451  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.381847858428955  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 337, 64])
m.shape torch.Size([4401, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.397998809814453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.397998809814453  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.400651931762695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.628078937530518  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4401, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.595893383026123  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.599281311035156  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6026692390441895  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.599111557006836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 87511
output nodes number: 22736
edges number: 153705
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.599933624267578  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027561306953430176 |0.005224108695983887 |0.1479167938232422 |0.0009472370147705078 |0.046018242835998535 |0.009361028671264648 |
----------------------------------------------------------pseudo_mini_loss sum 1.8901950120925903
for loop block_dataloader item  time:  1.154477596282959
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09013080596923828  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09013080596923828  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153282, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09013080596923828  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11122, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3824019432067871  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3824019432067871  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3930087089538574  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.47867536544799805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11122, 128])
m.shape torch.Size([12645, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4854311943054199  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4854311943054199  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4984321594238281  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6793203353881836  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12645, 128])
m.shape torch.Size([11748, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.690096378326416  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.690096378326416  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7013001441955566  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9477829933166504  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11748, 128])
m.shape torch.Size([10369, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9619584083557129  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9619584083557129  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9728636741638184  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2596344947814941  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10369, 128])
m.shape torch.Size([93660, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4779930114746094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4779930114746094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5678367614746094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.786533355712891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93660, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.527948379516602  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.56121826171875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.594488143920898  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.560090065002441  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139544, 64])
input nodes number: 153282
output nodes number: 139544
edges number: 581432
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.595678329467773  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.628948211669922  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.637265682220459  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.637265682220459  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139544, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.637265682220459  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5896, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.793235778808594  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.793235778808594  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.796346187591553  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.820789337158203  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5896, 64])
m.shape torch.Size([6908, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.822568416595459  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.822568416595459  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.825982570648193  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.875752925872803  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6908, 64])
m.shape torch.Size([6742, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.879500389099121  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.879500389099121  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8829145431518555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.954992294311523  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6742, 64])
m.shape torch.Size([6215, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.959839820861816  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.959839820861816  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.962930679321289  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.0512166023254395  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6215, 64])
m.shape torch.Size([5657, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.056689262390137  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.056689262390137  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.05938720703125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.160273551940918  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5657, 64])
m.shape torch.Size([4876, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.165469646453857  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.165469646453857  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.168014049530029  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.273025035858154  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4876, 64])
m.shape torch.Size([4365, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.2793755531311035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.2793755531311035  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.281466007232666  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.385951995849609  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4365, 64])
m.shape torch.Size([3916, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.392536640167236  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.392536640167236  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.39440393447876  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.504458904266357  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3916, 64])
m.shape torch.Size([3482, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.51123046875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.51123046875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.512890815734863  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.619153022766113  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3482, 64])
m.shape torch.Size([39898, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.717334270477295  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.717334270477295  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.736415863037109  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.092750549316406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39898, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.955601215362549  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.977085590362549  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.998055934906006  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.975915908813477  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([87955, 64])
input nodes number: 139544
output nodes number: 87955
edges number: 614540
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.999175071716309  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.020145416259766  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.025388240814209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.025388240814209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3368, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0652241706848145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0652241706848145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.066830158233643  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0801262855529785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3368, 64])
m.shape torch.Size([2934, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0808491706848145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0808491706848145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.082248210906982  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.103821277618408  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2934, 64])
m.shape torch.Size([2345, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.104881286621094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.104881286621094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.105999946594238  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.131984710693359  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2345, 64])
m.shape torch.Size([1855, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.133578300476074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.133578300476074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.134463310241699  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.160334587097168  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1855, 64])
m.shape torch.Size([1495, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1617302894592285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1617302894592285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1624436378479  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1888346672058105  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1495, 64])
m.shape torch.Size([1180, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.190218925476074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.190218925476074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.190781593322754  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2154927253723145  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1180, 64])
m.shape torch.Size([1008, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.216946601867676  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.216946601867676  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2174272537231445  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.241459846496582  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1008, 64])
m.shape torch.Size([863, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.242917060852051  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.242917060852051  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.243329048156738  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.266789436340332  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 863, 64])
m.shape torch.Size([750, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.268243312835693  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.268243312835693  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.268600940704346  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.291489124298096  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 750, 64])
m.shape torch.Size([604, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.292795658111572  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.292795658111572  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.293083667755127  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.31353235244751  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 604, 64])
m.shape torch.Size([537, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.314841270446777  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.314841270446777  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.315097808837891  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.335076332092285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 537, 64])
m.shape torch.Size([500, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.336423397064209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.336423397064209  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3366618156433105  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.356927394866943  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 500, 64])
m.shape torch.Size([415, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.358135223388672  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.358135223388672  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.358333587646484  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3765459060668945  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 415, 64])
m.shape torch.Size([363, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.377696514129639  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.377696514129639  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.377870082855225  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.395013332366943  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 363, 64])
m.shape torch.Size([4519, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.411593437194824  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.411593437194824  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.413748741149902  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.643120288848877  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4519, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.610034942626953  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.613422870635986  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6168107986450195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.613253116607666  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22736, 40])
input nodes number: 87955
output nodes number: 22736
edges number: 155165
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.614078521728516  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025803407033284504 |0.005201260248819987 |0.14489070574442545 |0.0008640289306640625 |0.04539354642232259 |0.010639429092407227 |
----------------------------------------------------------pseudo_mini_loss sum 1.8387352228164673
for loop block_dataloader item  time:  1.586207389831543
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09018087387084961  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09018087387084961  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153331, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09018087387084961  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11076, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38326120376586914  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38326120376586914  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39382410049438477  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.479403018951416  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11076, 128])
m.shape torch.Size([12807, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.48633527755737305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.48633527755737305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.49945735931396484  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6884422302246094  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12807, 128])
m.shape torch.Size([11758, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.699155330657959  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.699155330657959  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7103686332702637  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9572238922119141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11758, 128])
m.shape torch.Size([10290, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9712438583374023  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9712438583374023  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9821319580078125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2667179107666016  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10290, 128])
m.shape torch.Size([93724, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4852666854858398  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4852666854858398  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5751104354858398  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.80948543548584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93724, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.551035404205322  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.58433198928833  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.617628574371338  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.582432270050049  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139655, 64])
input nodes number: 153331
output nodes number: 139655
edges number: 581744
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6181511878967285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.651447772979736  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.659771919250488  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.659771919250488  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139655, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.659771919250488  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5754, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.817345142364502  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.817345142364502  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.821060657501221  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.845630168914795  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5754, 64])
m.shape torch.Size([7004, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.847288131713867  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.847288131713867  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.851003646850586  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.903173923492432  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 7004, 64])
m.shape torch.Size([6797, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.906749725341797  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.906749725341797  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.910512447357178  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.98314905166626  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6797, 64])
m.shape torch.Size([6241, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.987821578979492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.987821578979492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.990797996520996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.079860210418701  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6241, 64])
m.shape torch.Size([5715, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.086025238037109  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.086025238037109  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.089117527008057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.189499378204346  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5715, 64])
m.shape torch.Size([5022, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.195545196533203  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.195545196533203  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.197983264923096  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.302863597869873  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5022, 64])
m.shape torch.Size([4411, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.309258460998535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.309258460998535  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.311546325683594  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.420239448547363  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4411, 64])
m.shape torch.Size([3947, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.4269514083862305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.4269514083862305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.428833961486816  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.539669036865234  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3947, 64])
m.shape torch.Size([3518, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.546512603759766  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.546512603759766  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.548190116882324  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.655550956726074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3518, 64])
m.shape torch.Size([39895, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.753387928009033  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.753387928009033  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.772411823272705  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.128660678863525  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39895, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.990721702575684  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.011775016784668  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.032828330993652  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.011116981506348  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([88304, 64])
input nodes number: 139655
output nodes number: 88304
edges number: 616889
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.034026622772217  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.055079936981201  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.060343265533447  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.060343265533447  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3226, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.10039758682251  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.10039758682251  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.101935863494873  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.114964008331299  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3226, 64])
m.shape torch.Size([2864, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.115725994110107  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.115725994110107  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.117091655731201  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.13770055770874  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2864, 64])
m.shape torch.Size([2362, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.138801574707031  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.138801574707031  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.139927864074707  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.165069580078125  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2362, 64])
m.shape torch.Size([1840, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.16641902923584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.16641902923584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.167296409606934  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.193414688110352  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1840, 64])
m.shape torch.Size([1592, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1949334144592285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1949334144592285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.195692539215088  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.224149703979492  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1592, 64])
m.shape torch.Size([1206, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.225549697875977  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.225549697875977  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2261247634887695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.251841068267822  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1206, 64])
m.shape torch.Size([1009, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.25329065322876  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.25329065322876  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.253772258758545  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.277832508087158  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1009, 64])
m.shape torch.Size([875, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.279313087463379  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.279313087463379  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.279730796813965  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3035173416137695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 875, 64])
m.shape torch.Size([735, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.304935455322266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.304935455322266  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.305286407470703  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.32772159576416  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 735, 64])
m.shape torch.Size([691, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.329245090484619  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.329245090484619  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.329575061798096  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3529744148254395  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 691, 64])
m.shape torch.Size([575, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.35436487197876  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.35436487197876  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.354639530181885  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.376031398773193  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 575, 64])
m.shape torch.Size([514, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.377410888671875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.377410888671875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.377655982971191  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.398488998413086  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 514, 64])
m.shape torch.Size([396, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.399632453918457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.399632453918457  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3998212814331055  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.417193412780762  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 396, 64])
m.shape torch.Size([354, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.418317794799805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.418317794799805  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.418486595153809  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.435197830200195  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 354, 64])
m.shape torch.Size([4494, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.451687812805176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.451687812805176  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.453830718994141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.682594299316406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4494, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.650152683258057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.65354061126709  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.656928539276123  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6533708572387695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([22733, 40])
input nodes number: 88304
output nodes number: 22733
edges number: 156191
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.65419864654541  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02486240863800049 |0.005177319049835205 |0.14347612857818604 |0.0008274316787719727 |0.04603058099746704 |0.009256124496459961 |
----------------------------------------------------------pseudo_mini_loss sum 1.7737634181976318
Total (block generation + training)time/epoch 1.8519837856292725
Training time/epoch 1.8531453609466553
Training time without block to device /epoch 1.8324360847473145
Training time without total dataloading part /epoch 0.7705926895141602
load block tensor time/epoch 0.09944963455200195
block to device time/epoch 0.02070927619934082
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1522980
Number of first layer input nodes during this epoch:  613286
block dataloader generation time/epoch 7.947285970052084e-07
for loop block_dataloader item  time:  0.23244285583496094
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09128570556640625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09128570556640625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([153733, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09128570556640625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([11221, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38444995880126953  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38444995880126953  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39515113830566406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4810066223144531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11221, 128])
m.shape torch.Size([12784, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.48784780502319336  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.48784780502319336  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.5008206367492676  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6836972236633301  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 12784, 128])
m.shape torch.Size([11776, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6944470405578613  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6944470405578613  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7056775093078613  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9615368843078613  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 11776, 128])
m.shape torch.Size([10362, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9756855964660645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9756855964660645  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9866514205932617  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.273228645324707  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 10362, 128])
m.shape torch.Size([93835, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4928970336914062  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4928970336914062  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5827407836914062  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.817115783691406  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 93835, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.558481216430664  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.591854572296143  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.625227928161621  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.590429782867432  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139978, 64])
input nodes number: 153733
output nodes number: 139978
edges number: 582740
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6265740394592285  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.659947395324707  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.668291091918945  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.668291091918945  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([139978, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.668291091918945  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([5902, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.825432777404785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.825432777404785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.828873634338379  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.853229522705078  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5902, 64])
m.shape torch.Size([7019, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.854973793029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.854973793029785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.858414649963379  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.909384727478027  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 7019, 64])
m.shape torch.Size([6757, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.913166046142578  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.913166046142578  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.916497707366943  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.988494873046875  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6757, 64])
m.shape torch.Size([6260, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.993214130401611  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.993214130401611  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.9963178634643555  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.083892822265625  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 6260, 64])
m.shape torch.Size([5663, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.089233875274658  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.089233875274658  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.09220552444458  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.193472385406494  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 5663, 64])
m.shape torch.Size([4871, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.199307918548584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.199307918548584  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.201819896697998  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.307394504547119  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4871, 64])
m.shape torch.Size([4401, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.312858581542969  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.312858581542969  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.315007209777832  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.423891544342041  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 4401, 64])
m.shape torch.Size([3941, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.431471824645996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.431471824645996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.433351516723633  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.543459892272949  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3941, 64])
m.shape torch.Size([3547, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.551013946533203  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.551013946533203  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.552705764770508  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.660956382751465  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3547, 64])
m.shape torch.Size([39971, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.758791923522949  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.758791923522949  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.778109550476074  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.162941932678223  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 39971, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.024878978729248  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.045938968658447  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0669989585876465  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.045280456542969  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([88332, 64])
input nodes number: 139978
output nodes number: 88332
edges number: 616760
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.068049430847168  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.089109420776367  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.094374656677246  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.094374656677246  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

m.shape torch.Size([3328, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.134250640869141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.134250640869141  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.135837554931641  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.148987770080566  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 3328, 64])
m.shape torch.Size([2913, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.149730682373047  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.149730682373047  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.151120185852051  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.171957015991211  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2913, 64])
m.shape torch.Size([2256, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.173033237457275  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.173033237457275  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.174108982086182  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.200160503387451  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 2256, 64])
m.shape torch.Size([1854, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.201735496520996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.201735496520996  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.202619552612305  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.229011535644531  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1854, 64])
m.shape torch.Size([1622, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.230563640594482  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.230563640594482  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.231337070465088  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.259825229644775  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1622, 64])
m.shape torch.Size([1196, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.261203289031982  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.261203289031982  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.261773586273193  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.287054538726807  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1196, 64])
m.shape torch.Size([1024, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.28853178024292  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.28853178024292  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.28902006149292  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.31343412399292  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 1024, 64])
m.shape torch.Size([854, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3148698806762695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3148698806762695  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.315277099609375  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.338488578796387  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 854, 64])
m.shape torch.Size([752, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.339949131011963  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.339949131011963  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.340307712554932  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.363256931304932  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 752, 64])
m.shape torch.Size([667, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.364717960357666  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.364717960357666  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.365036487579346  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.387623310089111  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 667, 64])
m.shape torch.Size([539, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.388922214508057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.388922214508057  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.389179706573486  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4092326164245605  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 539, 64])
m.shape torch.Size([486, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.410538196563721  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.410538196563721  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.410769939422607  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4304680824279785  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 486, 64])
m.shape torch.Size([393, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4316086769104  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4316086769104  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.431796550750732  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4490437507629395  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 393, 64])
m.shape torch.Size([345, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.450137615203857  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.450137615203857  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.450302600860596  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4665961265563965  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

torch.Size([1, 345, 64])
m.shape torch.Size([4507, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.483136177062988  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.483136177062988  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.485316276550293  GigaBytes
Max Memory Allocated: 7.72629976272583  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.714087009429932  GigaBytes
Max Memory Allocated: 7.730205535888672  GigaBytes

torch.Size([1, 4507, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.681887149810791  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.685275077819824  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.688663005828857  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.685105323791504  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([22736, 40])
input nodes number: 88332
output nodes number: 22736
edges number: 155367
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.685933589935303  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.021873950958251953 |0.0062329769134521484 |0.1414048671722412 |0.0007436275482177734 |0.0446314811706543 |0.009089469909667969 |
----------------------------------------------------------pseudo_mini_loss sum 1.7732007503509521
for loop block_dataloader item  time:  0.7005972862243652
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09005117416381836  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09005117416381836  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([153207, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09005117416381836  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([11157, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38223886489868164  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38223886489868164  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39287900924682617  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.47861242294311523  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 11157, 128])
m.shape torch.Size([12656, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.48536205291748047  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.48536205291748047  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4983348846435547  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6793804168701172  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 12656, 128])
m.shape torch.Size([11788, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6902084350585938  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6902084350585938  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7014503479003906  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.956566333770752  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 11788, 128])
m.shape torch.Size([10301, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9705929756164551  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9705929756164551  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9815340042114258  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2664241790771484  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 10301, 128])
m.shape torch.Size([93494, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.484419345855713  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.484419345855713  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.574263095855713  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.788210391998291  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 93494, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.5296854972839355  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.562920093536377  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.596154689788818  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.561881065368652  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([139396, 64])
input nodes number: 153207
output nodes number: 139396
edges number: 580507
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.59740686416626  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.630641460418701  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.638950347900391  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.638950347900391  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([139396, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.638950347900391  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([5867, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.795515537261963  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.795515537261963  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.79856014251709  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.823049545288086  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 5867, 64])
m.shape torch.Size([6946, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8246941566467285  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8246941566467285  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.828367710113525  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.879133701324463  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 6946, 64])
m.shape torch.Size([6728, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.882767677307129  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.882767677307129  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.886441230773926  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.959442138671875  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 6728, 64])
m.shape torch.Size([6231, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.96339225769043  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.96339225769043  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.967148780822754  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.05535888671875  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 6231, 64])
m.shape torch.Size([5759, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.061515808105469  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.061515808105469  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.064603328704834  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.165006160736084  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 5759, 64])
m.shape torch.Size([4870, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.1708173751831055  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.1708173751831055  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.1732988357543945  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.279877662658691  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4870, 64])
m.shape torch.Size([4367, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.286032199859619  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.286032199859619  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.288221836090088  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.397744655609131  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4367, 64])
m.shape torch.Size([3914, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.4036126136779785  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.4036126136779785  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.4054789543151855  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.516199588775635  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3914, 64])
m.shape torch.Size([3466, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.5229363441467285  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.5229363441467285  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.5245890617370605  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.6303629875183105  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3466, 64])
m.shape torch.Size([39469, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.72664213180542  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.72664213180542  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.74617338180542  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.090234279632568  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 39469, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.952652931213379  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.9735426902771  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.99443244934082  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.972889423370361  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([87617, 64])
input nodes number: 139396
output nodes number: 87617
edges number: 610647
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.995795249938965  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0166850090026855  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.021907806396484  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.021907806396484  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([3431, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.061508655548096  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.061508655548096  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.063145160675049  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.076908111572266  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3431, 64])
m.shape torch.Size([2942, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0775556564331055  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0775556564331055  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.078958511352539  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1005964279174805  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 2942, 64])
m.shape torch.Size([2326, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.101617336273193  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.101617336273193  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.102726459503174  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1277756690979  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 2326, 64])
m.shape torch.Size([1813, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.129106521606445  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.129106521606445  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.129971504211426  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.156628608703613  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1813, 64])
m.shape torch.Size([1529, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.158076286315918  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.158076286315918  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.158805847167969  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.185957908630371  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1529, 64])
m.shape torch.Size([1253, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.187441825866699  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.187441825866699  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.188039779663086  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.21755313873291  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1253, 64])
m.shape torch.Size([985, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.218949794769287  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.218949794769287  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.219419956207275  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.242908000946045  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 985, 64])
m.shape torch.Size([819, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.244284152984619  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.244284152984619  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.244675159454346  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.266939640045166  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 819, 64])
m.shape torch.Size([732, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.268363952636719  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.268363952636719  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.268712997436523  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.291051864624023  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 732, 64])
m.shape torch.Size([682, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2925543785095215  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2925543785095215  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.292879581451416  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.315968990325928  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 682, 64])
m.shape torch.Size([545, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3172807693481445  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3172807693481445  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.317541122436523  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.337817192077637  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 545, 64])
m.shape torch.Size([467, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.339150905609131  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.339150905609131  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.33937406539917  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3583083152771  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 467, 64])
m.shape torch.Size([413, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.359658718109131  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.359658718109131  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.359856128692627  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.377980709075928  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 413, 64])
m.shape torch.Size([374, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.379343032836914  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.379343032836914  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.379521369934082  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.397176742553711  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 374, 64])
m.shape torch.Size([4425, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.413407802581787  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.413407802581787  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.415916442871094  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.643436431884766  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4425, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.611234664916992  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.614622592926025  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.618010520935059  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.614452838897705  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([22736, 40])
input nodes number: 87617
output nodes number: 22736
edges number: 154142
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.615275859832764  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025093913078308105 |0.005888938903808594 |0.1409982442855835 |0.0007587671279907227 |0.04485476016998291 |0.00939798355102539 |
----------------------------------------------------------pseudo_mini_loss sum 1.7362661361694336
for loop block_dataloader item  time:  1.145458459854126
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09015178680419922  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09015178680419922  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([153364, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09015178680419922  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([11079, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38239192962646484  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38239192962646484  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.3929576873779297  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4785423278808594  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 11079, 128])
m.shape torch.Size([12648, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4853215217590332  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4853215217590332  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.49738359451293945  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6783146858215332  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 12648, 128])
m.shape torch.Size([11734, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6890692710876465  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6890692710876465  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7002596855163574  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.946448802947998  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 11734, 128])
m.shape torch.Size([10299, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9604973793029785  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9604973793029785  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9713754653930664  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2562103271484375  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 10299, 128])
m.shape torch.Size([93783, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4748954772949219  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4748954772949219  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5647392272949219  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.799114227294922  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 93783, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.540572166442871  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.5738420486450195  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.607111930847168  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.572752952575684  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([139543, 64])
input nodes number: 153364
output nodes number: 139543
edges number: 581688
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.608346939086914  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6416168212890625  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6499342918396  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6499342918396  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([139543, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.6499342918396  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([5832, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.805877208709717  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.805877208709717  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.80904483795166  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.833587646484375  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 5832, 64])
m.shape torch.Size([7061, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.835282325744629  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.835282325744629  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.838963508605957  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.890410423278809  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 7061, 64])
m.shape torch.Size([6780, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8940043449401855  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8940043449401855  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.897685527801514  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.970041751861572  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 6780, 64])
m.shape torch.Size([6059, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.974030494689941  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.974030494689941  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.97769832611084  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.065125465393066  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 6059, 64])
m.shape torch.Size([5632, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.07060432434082  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.07060432434082  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.074244499206543  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.174586296081543  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 5632, 64])
m.shape torch.Size([4842, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.180386543273926  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.180386543273926  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.182919502258301  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.2826995849609375  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4842, 64])
m.shape torch.Size([4315, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.288971900939941  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.288971900939941  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.291085243225098  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.394804000854492  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4315, 64])
m.shape torch.Size([3966, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.40147590637207  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.40147590637207  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.403367042541504  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.51395845413208  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3966, 64])
m.shape torch.Size([3480, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.520713806152344  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.520713806152344  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.522373199462891  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.628659248352051  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3480, 64])
m.shape torch.Size([39750, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.7266035079956055  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.7266035079956055  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.74555778503418  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.097658157348633  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 39750, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.960255146026611  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.981168746948242  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.002082347869873  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.980515003204346  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([87717, 64])
input nodes number: 139543
output nodes number: 87717
edges number: 612495
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.003166675567627  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.024080276489258  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.029308795928955  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.029308795928955  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([3312, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0689826011657715  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0689826011657715  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.07056188583374  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.084150314331055  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3312, 64])
m.shape torch.Size([2981, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.084850311279297  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.084850311279297  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.086272239685059  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.108428955078125  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 2981, 64])
m.shape torch.Size([2389, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.109556198120117  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.109556198120117  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.110695838928223  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1377177238464355  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 2389, 64])
m.shape torch.Size([1808, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.139042377471924  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.139042377471924  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.139904499053955  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.166044235229492  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1808, 64])
m.shape torch.Size([1567, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.167540073394775  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.167540073394775  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.168287754058838  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.195312023162842  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1567, 64])
m.shape torch.Size([1172, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.196667194366455  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.196667194366455  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.197226047515869  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.221884250640869  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1172, 64])
m.shape torch.Size([980, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.223291873931885  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.223291873931885  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.223759174346924  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.247124195098877  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 980, 64])
m.shape torch.Size([896, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.248652935028076  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.248652935028076  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.249080181121826  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.273433208465576  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 896, 64])
m.shape torch.Size([751, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.274881839752197  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.274881839752197  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.275240421295166  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.298163890838623  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 751, 64])
m.shape torch.Size([612, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.299489498138428  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.299489498138428  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.299781322479248  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.32050085067749  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 612, 64])
m.shape torch.Size([562, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.321875095367432  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.321875095367432  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.322143077850342  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.343045711517334  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 562, 64])
m.shape torch.Size([495, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.344372272491455  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.344372272491455  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.344608783721924  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.364677906036377  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 495, 64])
m.shape torch.Size([414, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3658833503723145  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3658833503723145  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3660807609558105  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.384242534637451  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 414, 64])
m.shape torch.Size([347, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.385403156280518  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.385403156280518  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.385569095611572  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.401957035064697  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 347, 64])
m.shape torch.Size([4450, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.418285846710205  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.418285846710205  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.420593738555908  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.648037910461426  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4450, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.615826606750488  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.6192145347595215  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.622602462768555  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.619044780731201  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([22736, 40])
input nodes number: 87717
output nodes number: 22736
edges number: 154559
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.619868278503418  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.024132490158081055 |0.005596240361531575 |0.14066553115844727 |0.0007500648498535156 |0.04499387741088867 |0.009042739868164062 |
----------------------------------------------------------pseudo_mini_loss sum 1.6958820819854736
for loop block_dataloader item  time:  1.644258975982666
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09023761749267578  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09023761749267578  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([153490, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.09023761749267578  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([11091, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38333797454833984  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.38333797454833984  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.39391517639160156  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.479522705078125  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 11091, 128])
m.shape torch.Size([12840, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4864792823791504  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4864792823791504  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.4996027946472168  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6886820793151855  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 12840, 128])
m.shape torch.Size([11733, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6993436813354492  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.6993436813354492  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.7105331420898438  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9568357467651367  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 11733, 128])
m.shape torch.Size([10386, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9710507392883301  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9710507392883301  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 0.9819340705871582  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.2691750526428223  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 10386, 128])
m.shape torch.Size([93826, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4888319969177246  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.4888319969177246  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 1.5786757469177246  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.813050746917725  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 93826, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.554224491119385  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.587573528289795  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.620922565460205  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.5861029624938965  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([139876, 64])
input nodes number: 153490
output nodes number: 139876
edges number: 582644
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.62167501449585  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.65502405166626  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.663361549377441  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.663361549377441  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([139876, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.663361549377441  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([5829, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.820010185241699  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.820010185241699  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.823359489440918  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.847079753875732  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 5829, 64])
m.shape torch.Size([6895, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.848897457122803  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.848897457122803  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.8522467613220215  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.902730941772461  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 6895, 64])
m.shape torch.Size([6737, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.906495571136475  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.906495571136475  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.910389423370361  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.982231616973877  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 6737, 64])
m.shape torch.Size([6234, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.986933708190918  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.986933708190918  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 4.990001201629639  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.078095436096191  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 6234, 64])
m.shape torch.Size([5679, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.08425235748291  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.08425235748291  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.086960792541504  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.187192440032959  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 5679, 64])
m.shape torch.Size([4890, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.192477226257324  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.192477226257324  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.194918155670166  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.301435470581055  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4890, 64])
m.shape torch.Size([4384, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.3069376945495605  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.3069376945495605  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.309054851531982  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.416808605194092  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4384, 64])
m.shape torch.Size([3951, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.423534870147705  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.423534870147705  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.425419330596924  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.536553382873535  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3951, 64])
m.shape torch.Size([3507, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.54337215423584  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.54337215423584  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.545044898986816  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.652074813842773  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3507, 64])
m.shape torch.Size([39826, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.749908924102783  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.749908924102783  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 5.769440174102783  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.123714923858643  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 39826, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 6.985909938812256  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0068745613098145  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.027839183807373  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.006219387054443  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([87932, 64])
input nodes number: 139876
output nodes number: 87932
edges number: 614620
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.028921604156494  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.049886226654053  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0551276206970215  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.0551276206970215  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

m.shape torch.Size([3357, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.094949245452881  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.094949245452881  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.096550464630127  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.110673904418945  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 3357, 64])
m.shape torch.Size([2870, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.11140251159668  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.11140251159668  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.112771034240723  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.133726119995117  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 2870, 64])
m.shape torch.Size([2306, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.134768486022949  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.134768486022949  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.135868072509766  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.1603684425354  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 2306, 64])
m.shape torch.Size([1845, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.161846160888672  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.161846160888672  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.162726402282715  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.188241958618164  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1845, 64])
m.shape torch.Size([1504, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.189651012420654  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.189651012420654  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.190368175506592  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2169108390808105  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1504, 64])
m.shape torch.Size([1247, 6, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2183918952941895  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2183918952941895  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.218986988067627  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.245295524597168  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1247, 64])
m.shape torch.Size([1056, 7, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2468156814575195  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2468156814575195  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.247319221496582  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2740583419799805  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 1056, 64])
m.shape torch.Size([903, 8, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.275582790374756  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.275582790374756  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.2760138511657715  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.300561428070068  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 903, 64])
m.shape torch.Size([741, 9, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.301986217498779  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.301986217498779  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.302340030670166  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.324958324432373  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 741, 64])
m.shape torch.Size([638, 10, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.326350212097168  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.326350212097168  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.326654434204102  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.348254203796387  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 638, 64])
m.shape torch.Size([557, 11, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.349608898162842  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.349608898162842  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.349874973297119  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3705973625183105  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 557, 64])
m.shape torch.Size([489, 12, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3719072341918945  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.3719072341918945  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.372140884399414  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.391966819763184  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 489, 64])
m.shape torch.Size([436, 13, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.393981456756592  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.393981456756592  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.394189357757568  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.413316249847412  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 436, 64])
m.shape torch.Size([368, 14, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4144792556762695  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4144792556762695  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.414654731750488  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.4320268630981445  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 368, 64])
m.shape torch.Size([4416, 15, 64])
----------------------------------------1
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.448225498199463  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.448225498199463  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------3
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.450388431549072  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.674590110778809  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([1, 4416, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.642125606536865  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.646474361419678  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.649862289428711  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.645343780517578  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

torch.Size([22733, 40])
input nodes number: 87932
output nodes number: 22733
edges number: 155117
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.7078857421875 GB
    Memory Allocated: 7.647129535675049  GigaBytes
Max Memory Allocated: 7.730321407318115  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02351558208465576 |0.005394041538238525 |0.14458388090133667 |0.000841975212097168 |0.04623150825500488 |0.008858442306518555 |
----------------------------------------------------------pseudo_mini_loss sum 1.6562309265136719
Total (block generation + training)time/epoch 1.877996603647868
Training time/epoch 1.9299519062042236
Training time without block to device /epoch 1.9083757400512695
Training time without total dataloading part /epoch 0.7754878997802734
load block tensor time/epoch 0.09406232833862305
block to device time/epoch 0.0215761661529541
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1524185
Number of first layer input nodes during this epoch:  613794
