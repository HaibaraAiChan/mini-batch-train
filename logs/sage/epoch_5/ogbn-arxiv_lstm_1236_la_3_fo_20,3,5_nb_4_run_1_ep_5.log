main start at this time 1649566421.6417754
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
for loop block_dataloader item  time:  0.1872093677520752
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1844482421875 GB
    Memory Allocated: 0.08315277099609375  GigaBytes
Max Memory Allocated: 0.08315277099609375  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1844482421875 GB
    Memory Allocated: 0.08315277099609375  GigaBytes
Max Memory Allocated: 0.08315277099609375  GigaBytes

torch.Size([152982, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1844482421875 GB
    Memory Allocated: 0.08315277099609375  GigaBytes
Max Memory Allocated: 0.08315277099609375  GigaBytes

m.shape torch.Size([7460, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.7801513671875 GB
    Memory Allocated: 0.5585718154907227  GigaBytes
Max Memory Allocated: 0.5703649520874023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7801513671875 GB
    Memory Allocated: 0.5585718154907227  GigaBytes
Max Memory Allocated: 0.5703649520874023  GigaBytes

 h.shape torch.Size([1, 7460, 128]), torch.Size([1, 7460, 128])
----------------------------------------3
 Nvidia-smi: 2.7801513671875 GB
    Memory Allocated: 0.5656862258911133  GigaBytes
Max Memory Allocated: 0.5703649520874023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8485107421875 GB
    Memory Allocated: 0.6226015090942383  GigaBytes
Max Memory Allocated: 0.6261587142944336  GigaBytes

rst.shape  torch.Size([1, 7460, 128])
m.shape torch.Size([8754, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.8485107421875 GB
    Memory Allocated: 0.6273927688598633  GigaBytes
Max Memory Allocated: 0.6275887489318848  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8485107421875 GB
    Memory Allocated: 0.6273927688598633  GigaBytes
Max Memory Allocated: 0.6275887489318848  GigaBytes

 h.shape torch.Size([1, 8754, 128]), torch.Size([1, 8754, 128])
----------------------------------------3
 Nvidia-smi: 2.8680419921875 GB
    Memory Allocated: 0.6357412338256836  GigaBytes
Max Memory Allocated: 0.6357412338256836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0125732421875 GB
    Memory Allocated: 0.7662553787231445  GigaBytes
Max Memory Allocated: 0.7746038436889648  GigaBytes

rst.shape  torch.Size([1, 8754, 128])
m.shape torch.Size([8256, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.0125732421875 GB
    Memory Allocated: 0.7738914489746094  GigaBytes
Max Memory Allocated: 0.7746038436889648  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0125732421875 GB
    Memory Allocated: 0.7738914489746094  GigaBytes
Max Memory Allocated: 0.7746038436889648  GigaBytes

 h.shape torch.Size([1, 8256, 128]), torch.Size([1, 8256, 128])
----------------------------------------3
 Nvidia-smi: 3.0125732421875 GB
    Memory Allocated: 0.7818965911865234  GigaBytes
Max Memory Allocated: 0.7818965911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2235107421875 GB
    Memory Allocated: 0.9551143646240234  GigaBytes
Max Memory Allocated: 0.9669246673583984  GigaBytes

rst.shape  torch.Size([1, 8256, 128])
m.shape torch.Size([7383, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.2391357421875 GB
    Memory Allocated: 0.9652595520019531  GigaBytes
Max Memory Allocated: 0.9669246673583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2391357421875 GB
    Memory Allocated: 0.9652595520019531  GigaBytes
Max Memory Allocated: 0.9669246673583984  GigaBytes

 h.shape torch.Size([1, 7383, 128]), torch.Size([1, 7383, 128])
----------------------------------------3
 Nvidia-smi: 3.2391357421875 GB
    Memory Allocated: 0.9723529815673828  GigaBytes
Max Memory Allocated: 0.9723529815673828  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4617919921875 GB
    Memory Allocated: 1.177258014678955  GigaBytes
Max Memory Allocated: 1.1913399696350098  GigaBytes

rst.shape  torch.Size([1, 7383, 128])
m.shape torch.Size([6674, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.4617919921875 GB
    Memory Allocated: 1.1897482872009277  GigaBytes
Max Memory Allocated: 1.1913399696350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4617919921875 GB
    Memory Allocated: 1.1897482872009277  GigaBytes
Max Memory Allocated: 1.1913399696350098  GigaBytes

 h.shape torch.Size([1, 6674, 128]), torch.Size([1, 6674, 128])
----------------------------------------3
 Nvidia-smi: 3.4617919921875 GB
    Memory Allocated: 1.1963791847229004  GigaBytes
Max Memory Allocated: 1.1963791847229004  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7137451171875 GB
    Memory Allocated: 1.4366822242736816  GigaBytes
Max Memory Allocated: 1.45259428024292  GigaBytes

rst.shape  torch.Size([1, 6674, 128])
m.shape torch.Size([5623, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7137451171875 GB
    Memory Allocated: 1.449587345123291  GigaBytes
Max Memory Allocated: 1.45259428024292  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7137451171875 GB
    Memory Allocated: 1.449587345123291  GigaBytes
Max Memory Allocated: 1.45259428024292  GigaBytes

 h.shape torch.Size([1, 5623, 128]), torch.Size([1, 5623, 128])
----------------------------------------3
 Nvidia-smi: 3.7137451171875 GB
    Memory Allocated: 1.4553170204162598  GigaBytes
Max Memory Allocated: 1.4553170204162598  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9852294921875 GB
    Memory Allocated: 1.6886935234069824  GigaBytes
Max Memory Allocated: 1.7047810554504395  GigaBytes

rst.shape  torch.Size([1, 5623, 128])
m.shape torch.Size([4858, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.9852294921875 GB
    Memory Allocated: 1.7022275924682617  GigaBytes
Max Memory Allocated: 1.7047810554504395  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9852294921875 GB
    Memory Allocated: 1.7022275924682617  GigaBytes
Max Memory Allocated: 1.7047810554504395  GigaBytes

 h.shape torch.Size([1, 4858, 128]), torch.Size([1, 4858, 128])
----------------------------------------3
 Nvidia-smi: 3.9852294921875 GB
    Memory Allocated: 1.7072253227233887  GigaBytes
Max Memory Allocated: 1.7072253227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2371826171875 GB
    Memory Allocated: 1.9391427040100098  GigaBytes
Max Memory Allocated: 1.9553580284118652  GigaBytes

rst.shape  torch.Size([1, 4858, 128])
m.shape torch.Size([4375, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2371826171875 GB
    Memory Allocated: 1.954404354095459  GigaBytes
Max Memory Allocated: 1.9553580284118652  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2371826171875 GB
    Memory Allocated: 1.954404354095459  GigaBytes
Max Memory Allocated: 1.9553580284118652  GigaBytes

 h.shape torch.Size([1, 4375, 128]), torch.Size([1, 4375, 128])
----------------------------------------3
 Nvidia-smi: 4.2371826171875 GB
    Memory Allocated: 1.9588069915771484  GigaBytes
Max Memory Allocated: 1.9588069915771484  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5086669921875 GB
    Memory Allocated: 2.2056989669799805  GigaBytes
Max Memory Allocated: 2.2232770919799805  GigaBytes

rst.shape  torch.Size([1, 4375, 128])
m.shape torch.Size([3824, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.5086669921875 GB
    Memory Allocated: 2.2200236320495605  GigaBytes
Max Memory Allocated: 2.2232770919799805  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5086669921875 GB
    Memory Allocated: 2.2200236320495605  GigaBytes
Max Memory Allocated: 2.2232770919799805  GigaBytes

 h.shape torch.Size([1, 3824, 128]), torch.Size([1, 3824, 128])
----------------------------------------3
 Nvidia-smi: 4.5086669921875 GB
    Memory Allocated: 2.2236857414245605  GigaBytes
Max Memory Allocated: 2.2236857414245605  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7996826171875 GB
    Memory Allocated: 2.457400321960449  GigaBytes
Max Memory Allocated: 2.473811149597168  GigaBytes

rst.shape  torch.Size([1, 3824, 128])
m.shape torch.Size([3429, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.7996826171875 GB
    Memory Allocated: 2.4719276428222656  GigaBytes
Max Memory Allocated: 2.473811149597168  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7996826171875 GB
    Memory Allocated: 2.4719276428222656  GigaBytes
Max Memory Allocated: 2.473811149597168  GigaBytes

 h.shape torch.Size([1, 3429, 128]), torch.Size([1, 3429, 128])
----------------------------------------3
 Nvidia-smi: 4.7996826171875 GB
    Memory Allocated: 2.475386142730713  GigaBytes
Max Memory Allocated: 2.475386142730713  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0906982421875 GB
    Memory Allocated: 2.708311080932617  GigaBytes
Max Memory Allocated: 2.7246618270874023  GigaBytes

rst.shape  torch.Size([1, 3429, 128])
m.shape torch.Size([2976, 11, 128])
----------------------------------------1
 Nvidia-smi: 5.0906982421875 GB
    Memory Allocated: 2.722285747528076  GigaBytes
Max Memory Allocated: 2.7246618270874023  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0906982421875 GB
    Memory Allocated: 2.722285747528076  GigaBytes
Max Memory Allocated: 2.7246618270874023  GigaBytes

 h.shape torch.Size([1, 2976, 128]), torch.Size([1, 2976, 128])
----------------------------------------3
 Nvidia-smi: 5.0906982421875 GB
    Memory Allocated: 2.725215435028076  GigaBytes
Max Memory Allocated: 2.725215435028076  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2430419921875 GB
    Memory Allocated: 2.9599876403808594  GigaBytes
Max Memory Allocated: 2.9756126403808594  GigaBytes

rst.shape  torch.Size([1, 2976, 128])
m.shape torch.Size([2722, 12, 128])
----------------------------------------1
 Nvidia-smi: 5.2430419921875 GB
    Memory Allocated: 2.974193572998047  GigaBytes
Max Memory Allocated: 2.9756126403808594  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2430419921875 GB
    Memory Allocated: 2.974193572998047  GigaBytes
Max Memory Allocated: 2.9756126403808594  GigaBytes

 h.shape torch.Size([1, 2722, 128]), torch.Size([1, 2722, 128])
----------------------------------------3
 Nvidia-smi: 5.2430419921875 GB
    Memory Allocated: 2.97695255279541  GigaBytes
Max Memory Allocated: 2.97695255279541  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4930419921875 GB
    Memory Allocated: 3.198988914489746  GigaBytes
Max Memory Allocated: 3.214613914489746  GigaBytes

rst.shape  torch.Size([1, 2722, 128])
m.shape torch.Size([2473, 13, 128])
----------------------------------------1
 Nvidia-smi: 5.4930419921875 GB
    Memory Allocated: 3.213253974914551  GigaBytes
Max Memory Allocated: 3.214613914489746  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4930419921875 GB
    Memory Allocated: 3.213253974914551  GigaBytes
Max Memory Allocated: 3.214613914489746  GigaBytes

 h.shape torch.Size([1, 2473, 128]), torch.Size([1, 2473, 128])
----------------------------------------3
 Nvidia-smi: 5.4930419921875 GB
    Memory Allocated: 3.2156858444213867  GigaBytes
Max Memory Allocated: 3.2156858444213867  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7039794921875 GB
    Memory Allocated: 3.441408634185791  GigaBytes
Max Memory Allocated: 3.457033634185791  GigaBytes

rst.shape  torch.Size([1, 2473, 128])
m.shape torch.Size([2136, 14, 128])
----------------------------------------1
 Nvidia-smi: 5.7039794921875 GB
    Memory Allocated: 3.454488754272461  GigaBytes
Max Memory Allocated: 3.457033634185791  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7039794921875 GB
    Memory Allocated: 3.454488754272461  GigaBytes
Max Memory Allocated: 3.457033634185791  GigaBytes

 h.shape torch.Size([1, 2136, 128]), torch.Size([1, 2136, 128])
----------------------------------------3
 Nvidia-smi: 5.7039794921875 GB
    Memory Allocated: 3.456655502319336  GigaBytes
Max Memory Allocated: 3.457033634185791  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9149169921875 GB
    Memory Allocated: 3.661715507507324  GigaBytes
Max Memory Allocated: 3.6759748458862305  GigaBytes

rst.shape  torch.Size([1, 2136, 128])
m.shape torch.Size([2000, 15, 128])
----------------------------------------1
 Nvidia-smi: 5.9149169921875 GB
    Memory Allocated: 3.674654960632324  GigaBytes
Max Memory Allocated: 3.6759748458862305  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9149169921875 GB
    Memory Allocated: 3.674654960632324  GigaBytes
Max Memory Allocated: 3.6759748458862305  GigaBytes

 h.shape torch.Size([1, 2000, 128]), torch.Size([1, 2000, 128])
----------------------------------------3
 Nvidia-smi: 5.9168701171875 GB
    Memory Allocated: 3.6765623092651367  GigaBytes
Max Memory Allocated: 3.6765623092651367  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1395263671875 GB
    Memory Allocated: 3.8828611373901367  GigaBytes
Max Memory Allocated: 3.8971662521362305  GigaBytes

rst.shape  torch.Size([1, 2000, 128])
m.shape torch.Size([1716, 16, 128])
----------------------------------------1
 Nvidia-smi: 6.1395263671875 GB
    Memory Allocated: 3.8949995040893555  GigaBytes
Max Memory Allocated: 3.8971662521362305  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1395263671875 GB
    Memory Allocated: 3.8949995040893555  GigaBytes
Max Memory Allocated: 3.8971662521362305  GigaBytes

 h.shape torch.Size([1, 1716, 128]), torch.Size([1, 1716, 128])
----------------------------------------3
 Nvidia-smi: 6.1414794921875 GB
    Memory Allocated: 3.8966360092163086  GigaBytes
Max Memory Allocated: 3.8971662521362305  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3836669921875 GB
    Memory Allocated: 4.081561088562012  GigaBytes
Max Memory Allocated: 4.095232963562012  GigaBytes

rst.shape  torch.Size([1, 1716, 128])
m.shape torch.Size([1689, 17, 128])
----------------------------------------1
 Nvidia-smi: 6.3992919921875 GB
    Memory Allocated: 4.0944342613220215  GigaBytes
Max Memory Allocated: 4.095232963562012  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3992919921875 GB
    Memory Allocated: 4.0944342613220215  GigaBytes
Max Memory Allocated: 4.095232963562012  GigaBytes

 h.shape torch.Size([1, 1689, 128]), torch.Size([1, 1689, 128])
----------------------------------------3
 Nvidia-smi: 6.3992919921875 GB
    Memory Allocated: 4.096045017242432  GigaBytes
Max Memory Allocated: 4.096045017242432  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5867919921875 GB
    Memory Allocated: 4.291422367095947  GigaBytes
Max Memory Allocated: 4.305113792419434  GigaBytes

rst.shape  torch.Size([1, 1689, 128])
m.shape torch.Size([1560, 18, 128])
----------------------------------------1
 Nvidia-smi: 6.5867919921875 GB
    Memory Allocated: 4.304006576538086  GigaBytes
Max Memory Allocated: 4.305113792419434  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5867919921875 GB
    Memory Allocated: 4.304006576538086  GigaBytes
Max Memory Allocated: 4.305113792419434  GigaBytes

 h.shape torch.Size([1, 1560, 128]), torch.Size([1, 1560, 128])
----------------------------------------3
 Nvidia-smi: 6.5867919921875 GB
    Memory Allocated: 4.30549430847168  GigaBytes
Max Memory Allocated: 4.30549430847168  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7801513671875 GB
    Memory Allocated: 4.496601104736328  GigaBytes
Max Memory Allocated: 4.510181427001953  GigaBytes

rst.shape  torch.Size([1, 1560, 128])
m.shape torch.Size([1333, 19, 128])
----------------------------------------1
 Nvidia-smi: 6.7801513671875 GB
    Memory Allocated: 4.507934093475342  GigaBytes
Max Memory Allocated: 4.510181427001953  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7801513671875 GB
    Memory Allocated: 4.507934093475342  GigaBytes
Max Memory Allocated: 4.510181427001953  GigaBytes

 h.shape torch.Size([1, 1333, 128]), torch.Size([1, 1333, 128])
----------------------------------------3
 Nvidia-smi: 6.7821044921875 GB
    Memory Allocated: 4.509205341339111  GigaBytes
Max Memory Allocated: 4.510181427001953  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9832763671875 GB
    Memory Allocated: 4.6795525550842285  GigaBytes
Max Memory Allocated: 4.691629409790039  GigaBytes

rst.shape  torch.Size([1, 1333, 128])
m.shape torch.Size([20680, 20, 128])
----------------------------------------1
 Nvidia-smi: 7.1805419921875 GB
    Memory Allocated: 4.876182556152344  GigaBytes
Max Memory Allocated: 4.8809428215026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1805419921875 GB
    Memory Allocated: 4.876182556152344  GigaBytes
Max Memory Allocated: 4.8809428215026855  GigaBytes

 h.shape torch.Size([1, 20680, 128]), torch.Size([1, 20680, 128])
----------------------------------------3
 Nvidia-smi: 7.1922607421875 GB
    Memory Allocated: 4.895904541015625  GigaBytes
Max Memory Allocated: 4.895904541015625  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3426513671875 GB
    Memory Allocated: 7.676704406738281  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

rst.shape  torch.Size([1, 20680, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.251677513122559  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.275500774383545  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.299324035644531  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.274755954742432  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

torch.Size([99921, 64])
input nodes number: 152982
output nodes number: 99921
edges number: 964717
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.300504207611084  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.32432746887207  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.331008434295654  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.331008434295654  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

torch.Size([99921, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.331008434295654  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

m.shape torch.Size([5208, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.379668712615967  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.379668712615967  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

 h.shape torch.Size([1, 5208, 64]), torch.Size([1, 5208, 64])
----------------------------------------3
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.3824076652526855  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.403526306152344  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

rst.shape  torch.Size([1, 5208, 64])
m.shape torch.Size([5962, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.405226230621338  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.405226230621338  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

 h.shape torch.Size([1, 5962, 64]), torch.Size([1, 5962, 64])
----------------------------------------3
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.408369541168213  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.452261447906494  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

rst.shape  torch.Size([1, 5962, 64])
m.shape torch.Size([55095, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.491668701171875  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.491668701171875  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

 h.shape torch.Size([1, 55095, 64]), torch.Size([1, 55095, 64])
----------------------------------------3
 Nvidia-smi: 10.3446044921875 GB
    Memory Allocated: 7.517940521240234  GigaBytes
Max Memory Allocated: 7.873970031738281  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6258544921875 GB
    Memory Allocated: 8.099702835083008  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

rst.shape  torch.Size([1, 55095, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6434326171875 GB
    Memory Allocated: 8.056085586547852  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6434326171875 GB
    Memory Allocated: 8.071884632110596  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6434326171875 GB
    Memory Allocated: 8.08768367767334  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 10.6434326171875 GB
    Memory Allocated: 8.071390628814697  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

torch.Size([66265, 64])
input nodes number: 99921
output nodes number: 66265
edges number: 182417
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 10.6434326171875 GB
    Memory Allocated: 8.08842945098877  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 10.6434326171875 GB
    Memory Allocated: 8.104477405548096  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 10.6434326171875 GB
    Memory Allocated: 8.108402729034424  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6434326171875 GB
    Memory Allocated: 8.108402729034424  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

m.shape torch.Size([3393, 1, 64])
----------------------------------------1
 Nvidia-smi: 10.6649169921875 GB
    Memory Allocated: 8.130931377410889  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6649169921875 GB
    Memory Allocated: 8.130931377410889  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

 h.shape torch.Size([1, 3393, 64]), torch.Size([1, 3393, 64])
----------------------------------------3
 Nvidia-smi: 10.6649169921875 GB
    Memory Allocated: 8.13254976272583  GigaBytes
Max Memory Allocated: 8.139110088348389  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6688232421875 GB
    Memory Allocated: 8.146800994873047  GigaBytes
Max Memory Allocated: 8.147610187530518  GigaBytes

rst.shape  torch.Size([1, 3393, 64])
m.shape torch.Size([2936, 2, 64])
----------------------------------------1
 Nvidia-smi: 10.6688232421875 GB
    Memory Allocated: 8.147607326507568  GigaBytes
Max Memory Allocated: 8.147629261016846  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6688232421875 GB
    Memory Allocated: 8.147607326507568  GigaBytes
Max Memory Allocated: 8.147629261016846  GigaBytes

 h.shape torch.Size([1, 2936, 64]), torch.Size([1, 2936, 64])
----------------------------------------3
 Nvidia-smi: 10.6688232421875 GB
    Memory Allocated: 8.149007320404053  GigaBytes
Max Memory Allocated: 8.149007320404053  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6746826171875 GB
    Memory Allocated: 8.170007228851318  GigaBytes
Max Memory Allocated: 8.171571254730225  GigaBytes

rst.shape  torch.Size([1, 2936, 64])
m.shape torch.Size([2356, 3, 64])
----------------------------------------1
 Nvidia-smi: 10.6746826171875 GB
    Memory Allocated: 8.171093940734863  GigaBytes
Max Memory Allocated: 8.171571254730225  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6746826171875 GB
    Memory Allocated: 8.171093940734863  GigaBytes
Max Memory Allocated: 8.171571254730225  GigaBytes

 h.shape torch.Size([1, 2356, 64]), torch.Size([1, 2356, 64])
----------------------------------------3
 Nvidia-smi: 10.6746826171875 GB
    Memory Allocated: 8.17221736907959  GigaBytes
Max Memory Allocated: 8.17221736907959  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6785888671875 GB
    Memory Allocated: 8.197722911834717  GigaBytes
Max Memory Allocated: 8.199456691741943  GigaBytes

rst.shape  torch.Size([1, 2356, 64])
m.shape torch.Size([1822, 4, 64])
----------------------------------------1
 Nvidia-smi: 10.6785888671875 GB
    Memory Allocated: 8.198994636535645  GigaBytes
Max Memory Allocated: 8.199456691741943  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6785888671875 GB
    Memory Allocated: 8.198994636535645  GigaBytes
Max Memory Allocated: 8.199456691741943  GigaBytes

 h.shape torch.Size([1, 1822, 64]), torch.Size([1, 1822, 64])
----------------------------------------3
 Nvidia-smi: 10.6785888671875 GB
    Memory Allocated: 8.19986343383789  GigaBytes
Max Memory Allocated: 8.19986343383789  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6785888671875 GB
    Memory Allocated: 8.226393699645996  GigaBytes
Max Memory Allocated: 8.228251457214355  GigaBytes

rst.shape  torch.Size([1, 1822, 64])
m.shape torch.Size([12229, 5, 64])
----------------------------------------1
 Nvidia-smi: 10.6785888671875 GB
    Memory Allocated: 8.24099349975586  GigaBytes
Max Memory Allocated: 8.24122142791748  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6785888671875 GB
    Memory Allocated: 8.24099349975586  GigaBytes
Max Memory Allocated: 8.24122142791748  GigaBytes

 h.shape torch.Size([1, 12229, 64]), torch.Size([1, 12229, 64])
----------------------------------------3
 Nvidia-smi: 10.6785888671875 GB
    Memory Allocated: 8.246825218200684  GigaBytes
Max Memory Allocated: 8.246825218200684  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9246826171875 GB
    Memory Allocated: 8.457802295684814  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 12229, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9246826171875 GB
    Memory Allocated: 8.439669609069824  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9246826171875 GB
    Memory Allocated: 8.443057537078857  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9246826171875 GB
    Memory Allocated: 8.44644546508789  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9246826171875 GB
    Memory Allocated: 8.442887783050537  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

torch.Size([22736, 40])
input nodes number: 66265
output nodes number: 22736
edges number: 84766
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9246826171875 GB
    Memory Allocated: 8.446939468383789  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033446311950683594 |0.35898613929748535 |0.6597123146057129 |0.0002129077911376953 |0.07010841369628906 |0.008428812026977539 |
----------------------------------------------------------pseudo_mini_loss sum 4.964419841766357
for loop block_dataloader item  time:  1.5954270362854004
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0262451171875 GB
    Memory Allocated: 0.08918285369873047  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0262451171875 GB
    Memory Allocated: 0.08918285369873047  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

torch.Size([153068, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0262451171875 GB
    Memory Allocated: 0.08918285369873047  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

m.shape torch.Size([7383, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.5669746398925781  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.5669746398925781  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 7383, 128]), torch.Size([1, 7383, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.5740156173706055  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.6303434371948242  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 7383, 128])
m.shape torch.Size([8690, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.6351103782653809  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.6351103782653809  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 8690, 128]), torch.Size([1, 8690, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.6444659233093262  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.7687773704528809  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 8690, 128])
m.shape torch.Size([8252, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.7764382362365723  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.7764382362365723  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 8252, 128]), torch.Size([1, 8252, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.7845168113708496  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.9576506614685059  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 8252, 128])
m.shape torch.Size([7414, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.9678568840026855  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.9678568840026855  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 7414, 128]), torch.Size([1, 7414, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 0.9755549430847168  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.1823410987854004  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 7414, 128])
m.shape torch.Size([6531, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.1944308280944824  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.1944308280944824  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 6531, 128]), torch.Size([1, 6531, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.2012934684753418  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.4269790649414062  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 6531, 128])
m.shape torch.Size([5600, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.4398865699768066  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.4398865699768066  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 5600, 128]), torch.Size([1, 5600, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.4453768730163574  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.6756153106689453  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 5600, 128])
m.shape torch.Size([4952, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.689474105834961  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.689474105834961  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 4952, 128]), torch.Size([1, 4952, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.6945204734802246  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.930650234222412  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 4952, 128])
m.shape torch.Size([4371, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.9458670616149902  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.9458670616149902  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 4371, 128]), torch.Size([1, 4371, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 1.9504141807556152  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.1950430870056152  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 4371, 128])
m.shape torch.Size([3816, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.209146022796631  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.209146022796631  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 3816, 128]), torch.Size([1, 3816, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.2128233909606934  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.4487929344177246  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 3816, 128])
m.shape torch.Size([3487, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.4636006355285645  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.4636006355285645  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 3487, 128]), torch.Size([1, 3487, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.466926097869873  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.7037367820739746  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 3487, 128])
m.shape torch.Size([3040, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.718019485473633  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.718019485473633  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 3040, 128]), torch.Size([1, 3040, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.720987319946289  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.955254077911377  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 3040, 128])
m.shape torch.Size([2745, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.9693121910095215  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.9693121910095215  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 2745, 128]), torch.Size([1, 2745, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 2.971956729888916  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.201620578765869  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 2745, 128])
m.shape torch.Size([2476, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.2156600952148438  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.2156600952148438  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 2476, 128]), torch.Size([1, 2476, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.2180728912353516  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.4428720474243164  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 2476, 128])
m.shape torch.Size([2183, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.4562644958496094  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.4562644958496094  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 2183, 128]), torch.Size([1, 2183, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.4584264755249023  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.6754508018493652  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 2183, 128])
m.shape torch.Size([1976, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.6885433197021484  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.6885433197021484  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 1976, 128]), torch.Size([1, 1976, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.690427780151367  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.8956737518310547  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 1976, 128])
m.shape torch.Size([1753, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.9081058502197266  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.9081058502197266  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 1753, 128]), torch.Size([1, 1753, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 3.9097776412963867  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.098690032958984  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 1753, 128])
m.shape torch.Size([1700, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.111634731292725  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.111634731292725  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 1700, 128]), torch.Size([1, 1700, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.113255977630615  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.308444499969482  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 1700, 128])
m.shape torch.Size([1540, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.320851802825928  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.320851802825928  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 1540, 128]), torch.Size([1, 1540, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.322320461273193  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.508973598480225  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 1540, 128])
m.shape torch.Size([1344, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.520415782928467  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.520415782928467  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 1344, 128]), torch.Size([1, 1344, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.521697521209717  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.695949077606201  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 1344, 128])
m.shape torch.Size([20838, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.8940348625183105  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.8940348625183105  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 20838, 128]), torch.Size([1, 20838, 128])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 4.913907527923584  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.715953350067139  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 20838, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.287885665893555  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.311749458312988  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.335613250732422  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.311003684997559  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

torch.Size([100091, 64])
input nodes number: 153068
output nodes number: 100091
edges number: 970010
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.336794853210449  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.360658645629883  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.36662483215332  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.36662483215332  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

torch.Size([100091, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.36662483215332  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

m.shape torch.Size([5138, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.415332794189453  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.415332794189453  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 5138, 64]), torch.Size([1, 5138, 64])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.417873382568359  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.437975883483887  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 5138, 64])
m.shape torch.Size([5887, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.439907550811768  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.439907550811768  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 5887, 64]), torch.Size([1, 5887, 64])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.4430317878723145  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.486280918121338  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 5887, 64])
m.shape torch.Size([55272, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.525497913360596  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.525497913360596  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 55272, 64]), torch.Size([1, 55272, 64])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 7.551853656768799  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.131680011749268  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 55272, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.08923625946045  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.105042934417725  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.120849609375  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.104548931121826  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

torch.Size([66297, 64])
input nodes number: 100091
output nodes number: 66297
edges number: 182728
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.121596336364746  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.137403011322021  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.141383647918701  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.141383647918701  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

m.shape torch.Size([3381, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.16393756866455  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.16393756866455  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 3381, 64]), torch.Size([1, 3381, 64])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.165550231933594  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.179460048675537  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 3381, 64])
m.shape torch.Size([2952, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.180180072784424  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.180180072784424  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 2952, 64]), torch.Size([1, 2952, 64])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.18158769607544  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.202972888946533  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 2952, 64])
m.shape torch.Size([2280, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.20396900177002  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.20396900177002  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 2280, 64]), torch.Size([1, 2280, 64])
----------------------------------------3
 Nvidia-smi: 11.4891357421875 GB
    Memory Allocated: 8.205056190490723  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.231199741363525  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 2280, 64])
m.shape torch.Size([1855, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.232517719268799  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.232517719268799  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 1855, 64]), torch.Size([1, 1855, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.233402729034424  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.260655879974365  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

rst.shape  torch.Size([1, 1855, 64])
m.shape torch.Size([12268, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.27529525756836  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.27529525756836  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

 h.shape torch.Size([1, 12268, 64]), torch.Size([1, 12268, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.281145095825195  GigaBytes
Max Memory Allocated: 8.472380638122559  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.492746353149414  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 12268, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.474576950073242  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.478751182556152  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.482139110565186  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.477795124053955  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

torch.Size([22736, 40])
input nodes number: 66297
output nodes number: 22736
edges number: 84885
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.47924518585205  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03151583671569824 |0.18210601806640625 |0.39040064811706543 |0.0004869699478149414 |0.06623494625091553 |0.0066204071044921875 |
----------------------------------------------------------pseudo_mini_loss sum 3.8531641960144043
for loop block_dataloader item  time:  1.9857726097106934
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.08988332748413086  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.08988332748413086  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

torch.Size([152886, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.08988332748413086  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

m.shape torch.Size([7332, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.5681304931640625  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.5681304931640625  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 7332, 128]), torch.Size([1, 7332, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.5751228332519531  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.6310615539550781  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 7332, 128])
m.shape torch.Size([8848, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.6360034942626953  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.6360034942626953  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 8848, 128]), torch.Size([1, 8848, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.6444416046142578  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.7752246856689453  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 8848, 128])
m.shape torch.Size([8271, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.7828373908996582  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.7828373908996582  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 8271, 128]), torch.Size([1, 8271, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.7907252311706543  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.9642577171325684  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 8271, 128])
m.shape torch.Size([7380, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.9743900299072266  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.9743900299072266  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 7380, 128]), torch.Size([1, 7380, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.981501579284668  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.187279224395752  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 7380, 128])
m.shape torch.Size([6675, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.1996746063232422  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.1996746063232422  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 6675, 128]), torch.Size([1, 6675, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.2062358856201172  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.4499425888061523  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 6675, 128])
m.shape torch.Size([5642, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.4629015922546387  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.4629015922546387  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 5642, 128]), torch.Size([1, 5642, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.468857765197754  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.720332145690918  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 5642, 128])
m.shape torch.Size([4912, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.7340373992919922  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.7340373992919922  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 4912, 128]), torch.Size([1, 4912, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.739069938659668  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.973414421081543  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 4912, 128])
m.shape torch.Size([4354, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.988642692565918  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.988642692565918  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 4354, 128]), torch.Size([1, 4354, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 1.9929828643798828  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.2341837882995605  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 4354, 128])
m.shape torch.Size([3860, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.2478270530700684  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.2478270530700684  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 3860, 128]), torch.Size([1, 3860, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.251587390899658  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.4872536659240723  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 3860, 128])
m.shape torch.Size([3404, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.5016446113586426  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.5016446113586426  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 3404, 128]), torch.Size([1, 3404, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.50492525100708  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.7452149391174316  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 3404, 128])
m.shape torch.Size([3063, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.759657859802246  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.759657859802246  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 3063, 128]), torch.Size([1, 3063, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.762704372406006  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 2.996588706970215  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 3063, 128])
m.shape torch.Size([2704, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.010056495666504  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.010056495666504  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 2704, 128]), torch.Size([1, 2704, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.012711524963379  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.2363319396972656  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 2704, 128])
m.shape torch.Size([2486, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.250452995300293  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.250452995300293  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 2486, 128]), torch.Size([1, 2486, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.252913475036621  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.480595588684082  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 2486, 128])
m.shape torch.Size([2193, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.494199752807617  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.494199752807617  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 2193, 128]), torch.Size([1, 2193, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.4964423179626465  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.7118945121765137  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 2193, 128])
m.shape torch.Size([1991, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.7250895500183105  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.7250895500183105  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 1991, 128]), torch.Size([1, 1991, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.7269883155822754  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.933149814605713  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 1991, 128])
m.shape torch.Size([1734, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.945429801940918  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.945429801940918  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 1734, 128]), torch.Size([1, 1734, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 3.9470834732055664  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.13394832611084  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 1734, 128])
m.shape torch.Size([1629, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.146326541900635  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.146326541900635  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 1629, 128]), torch.Size([1, 1629, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.1478800773620605  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.341126441955566  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 1629, 128])
m.shape torch.Size([1564, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.353773593902588  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.353773593902588  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 1564, 128]), torch.Size([1, 1564, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.355265140533447  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.544947147369385  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 1564, 128])
m.shape torch.Size([1331, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.556260108947754  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.556260108947754  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.557529449462891  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.728309631347656  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([20812, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.926153659820557  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.926153659820557  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 20812, 128]), torch.Size([1, 20812, 128])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 4.9460015296936035  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.744551181793213  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 20812, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.316310882568359  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.3401970863342285  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.364083290100098  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.339450359344482  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

torch.Size([100185, 64])
input nodes number: 152886
output nodes number: 100185
edges number: 968728
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.365269660949707  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.389155864715576  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.395127773284912  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.395127773284912  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

torch.Size([100185, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.395127773284912  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

m.shape torch.Size([5066, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.444103717803955  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.444103717803955  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 5066, 64]), torch.Size([1, 5066, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.446712970733643  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.466879367828369  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 5066, 64])
m.shape torch.Size([5960, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.468831539154053  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.468831539154053  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 5960, 64]), torch.Size([1, 5960, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.472096920013428  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.516168117523193  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 5960, 64])
m.shape torch.Size([55605, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.555583477020264  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.555583477020264  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 55605, 64]), torch.Size([1, 55605, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 7.582098484039307  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.165420055389404  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 55605, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.12253189086914  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.138418197631836  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.154304504394531  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.137921333312988  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

torch.Size([66631, 64])
input nodes number: 100185
output nodes number: 66631
edges number: 183801
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.155052185058594  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.170938491821289  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.17515754699707  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.17515754699707  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

m.shape torch.Size([3284, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.197790622711182  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.197790622711182  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 3284, 64]), torch.Size([1, 3284, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.19935655593872  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.213427066802979  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 3284, 64])
m.shape torch.Size([2922, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.214364528656006  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.214364528656006  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 2922, 64]), torch.Size([1, 2922, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.215757846832275  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.236670970916748  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 2922, 64])
m.shape torch.Size([2313, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.237786769866943  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.237786769866943  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 2313, 64]), torch.Size([1, 2313, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.238890171051025  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.265002250671387  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 2313, 64])
m.shape torch.Size([1850, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.266346454620361  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.266346454620361  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 1850, 64]), torch.Size([1, 1850, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.267228603363037  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.293460845947266  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

rst.shape  torch.Size([1, 1850, 64])
m.shape torch.Size([12367, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.308223724365234  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.308223724365234  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

 h.shape torch.Size([1, 12367, 64]), torch.Size([1, 12367, 64])
----------------------------------------3
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.31412124633789  GigaBytes
Max Memory Allocated: 8.507370948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.528383255004883  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 12367, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.509328842163086  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.513038635253906  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.51642656326294  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.512547016143799  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

torch.Size([22736, 40])
input nodes number: 66631
output nodes number: 22736
edges number: 85302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 8.512749195098877  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03095531463623047 |0.12324039141337077 |0.3015166123708089 |0.0006000200907389323 |0.06539591153462727 |0.006333351135253906 |
----------------------------------------------------------pseudo_mini_loss sum 3.162508726119995
for loop block_dataloader item  time:  2.383814573287964
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.08951473236083984  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.08951473236083984  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

torch.Size([153003, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4910888671875 GB
    Memory Allocated: 0.08951473236083984  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

m.shape torch.Size([7366, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.5697145462036133  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.5697145462036133  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 7366, 128]), torch.Size([1, 7366, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.5767393112182617  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.6329374313354492  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 7366, 128])
m.shape torch.Size([8652, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.6376762390136719  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.6376762390136719  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 8652, 128]), torch.Size([1, 8652, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.6459274291992188  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.7696952819824219  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 8652, 128])
m.shape torch.Size([8267, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.7773957252502441  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.7773957252502441  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 8267, 128]), torch.Size([1, 8267, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.7852797508239746  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.9587817192077637  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 8267, 128])
m.shape torch.Size([7317, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.9687957763671875  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.9687957763671875  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 7317, 128]), torch.Size([1, 7317, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.9760980606079102  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.1802968978881836  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 7317, 128])
m.shape torch.Size([6667, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.1927032470703125  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.1927032470703125  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 6667, 128]), torch.Size([1, 6667, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.1996383666992188  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.4434638023376465  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 6667, 128])
m.shape torch.Size([5582, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.4562549591064453  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.4562549591064453  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 5582, 128]), torch.Size([1, 5582, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.4623332023620605  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.691239833831787  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 5582, 128])
m.shape torch.Size([4953, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.7051105499267578  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.7051105499267578  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 4953, 128]), torch.Size([1, 4953, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.7101340293884277  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.9463114738464355  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 4953, 128])
m.shape torch.Size([4381, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.9615278244018555  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.9615278244018555  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 4381, 128]), torch.Size([1, 4381, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.965890884399414  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.210700511932373  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 4381, 128])
m.shape torch.Size([3875, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.2250585556030273  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.2250585556030273  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 3875, 128]), torch.Size([1, 3875, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.2296018600463867  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.4710798263549805  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 3875, 128])
m.shape torch.Size([3439, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.4858617782592773  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.4858617782592773  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 3439, 128]), torch.Size([1, 3439, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.489199638366699  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.729696273803711  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 3439, 128])
m.shape torch.Size([3009, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.743669033050537  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.743669033050537  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 3009, 128]), torch.Size([1, 3009, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.7466988563537598  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.986084461212158  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 3009, 128])
m.shape torch.Size([2743, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.9999876022338867  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.9999876022338867  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 2743, 128]), torch.Size([1, 2743, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.0031752586364746  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.2268714904785156  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 2743, 128])
m.shape torch.Size([2476, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.2412590980529785  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.2412590980529785  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 2476, 128]), torch.Size([1, 2476, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.243622303009033  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.4670238494873047  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 2476, 128])
m.shape torch.Size([2184, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.480010986328125  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.480010986328125  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 2184, 128]), torch.Size([1, 2184, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.4821105003356934  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.689204216003418  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 2184, 128])
m.shape torch.Size([2005, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.7024693489074707  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.7024693489074707  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 2005, 128]), torch.Size([1, 2005, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.7043814659118652  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.910346508026123  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 2005, 128])
m.shape torch.Size([1748, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.922726631164551  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.922726631164551  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 1748, 128]), torch.Size([1, 1748, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.924393653869629  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.112767219543457  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 1748, 128])
m.shape torch.Size([1668, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.125454902648926  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.125454902648926  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 1668, 128]), torch.Size([1, 1668, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.127045631408691  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.321501731872559  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 1668, 128])
m.shape torch.Size([1554, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.334044456481934  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.334044456481934  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 1554, 128]), torch.Size([1, 1554, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.335526466369629  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.52382755279541  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 1554, 128])
m.shape torch.Size([1352, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.535335540771484  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.535335540771484  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 1352, 128]), torch.Size([1, 1352, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.536624908447266  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.715354919433594  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 1352, 128])
m.shape torch.Size([21053, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.915487289428711  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.915487289428711  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 21053, 128]), torch.Size([1, 21053, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.935564994812012  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.818134307861328  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 21053, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.388765335083008  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.412676811218262  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.436588287353516  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.411929130554199  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

torch.Size([100291, 64])
input nodes number: 153003
output nodes number: 100291
edges number: 974448
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.437769889831543  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.461681365966797  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.4676594734191895  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.4676594734191895  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

torch.Size([100291, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.4676594734191895  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

m.shape torch.Size([5195, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.516666412353516  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.516666412353516  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 5195, 64]), torch.Size([1, 5195, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.519423007965088  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.5401611328125  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 5195, 64])
m.shape torch.Size([5885, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.541947841644287  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.541947841644287  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 5885, 64]), torch.Size([1, 5885, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.544908046722412  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.589065074920654  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 5885, 64])
m.shape torch.Size([55588, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.628824710845947  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.628824710845947  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 55588, 64]), torch.Size([1, 55588, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.655331134796143  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.23847246170044  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 55588, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.195480346679688  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.21137523651123  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.227694511413574  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.211302757263184  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

torch.Size([66668, 64])
input nodes number: 100291
output nodes number: 66668
edges number: 183729
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.228443145751953  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.244338035583496  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.24846363067627  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.24846363067627  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

m.shape torch.Size([3370, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.271055698394775  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.271055698394775  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 3370, 64]), torch.Size([1, 3370, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.27266263961792  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.286116123199463  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 3370, 64])
m.shape torch.Size([2896, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.28683614730835  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.28683614730835  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 2896, 64]), torch.Size([1, 2896, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.288217067718506  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.30893087387085  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 2896, 64])
m.shape torch.Size([2328, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.31003999710083  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.31003999710083  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 2328, 64]), torch.Size([1, 2328, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.311150074005127  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.336698055267334  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 2328, 64])
m.shape torch.Size([1793, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.337918758392334  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.337918758392334  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 1793, 64]), torch.Size([1, 1793, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.33877420425415  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.365398406982422  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

rst.shape  torch.Size([1, 1793, 64])
m.shape torch.Size([12346, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.38014841079712  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.38014841079712  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

 h.shape torch.Size([1, 12346, 64]), torch.Size([1, 12346, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.386035442352295  GigaBytes
Max Memory Allocated: 8.543126106262207  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.598750591278076  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12346, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.580522537231445  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.5845947265625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.587982654571533  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.583740711212158  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22733, 40])
input nodes number: 66668
output nodes number: 22733
edges number: 85048
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.58476972579956  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03068244457244873 |0.09374803304672241 |0.257956862449646 |0.0006714463233947754 |0.06464493274688721 |0.0068514347076416016 |
----------------------------------------------------------pseudo_mini_loss sum 2.8571321964263916
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1278288
Number of first layer input nodes during this epoch:  611939
for loop block_dataloader item  time:  0.2055654525756836
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.0897364616394043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.0897364616394043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152836, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.0897364616394043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7362, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.5664253234863281  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.5664253234863281  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7362, 128]), torch.Size([1, 7362, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.5734462738037109  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.6296138763427734  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7362, 128])
m.shape torch.Size([8746, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.6344442367553711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.6344442367553711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8746, 128]), torch.Size([1, 8746, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.6427850723266602  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.7732763290405273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8746, 128])
m.shape torch.Size([8193, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.7808260917663574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.7808260917663574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8193, 128]), torch.Size([1, 8193, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.7886395454406738  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.9605355262756348  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8193, 128])
m.shape torch.Size([7310, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.9705715179443359  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.9705715179443359  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7310, 128]), torch.Size([1, 7310, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 0.9778547286987305  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.1821236610412598  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7310, 128])
m.shape torch.Size([6702, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.1946167945861816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.1946167945861816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6702, 128]), torch.Size([1, 6702, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.2013726234436035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.4452719688415527  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6702, 128])
m.shape torch.Size([5594, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.458080768585205  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.458080768585205  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5594, 128]), torch.Size([1, 5594, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.4641270637512207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.693525791168213  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5594, 128])
m.shape torch.Size([4861, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.7070837020874023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.7070837020874023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4861, 128]), torch.Size([1, 4861, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.712069034576416  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.9459271430969238  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4861, 128])
m.shape torch.Size([4331, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.9600014686584473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.9600014686584473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4331, 128]), torch.Size([1, 4331, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 1.9642643928527832  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.2029976844787598  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4331, 128])
m.shape torch.Size([3854, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.2165274620056152  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.2165274620056152  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3854, 128]), torch.Size([1, 3854, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.2204298973083496  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.456979751586914  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3854, 128])
m.shape torch.Size([3468, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.4716787338256836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.4716787338256836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3468, 128]), torch.Size([1, 3468, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.475043296813965  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.710179328918457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3468, 128])
m.shape torch.Size([3002, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.724271774291992  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.724271774291992  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3002, 128]), torch.Size([1, 3002, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.727302074432373  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.9653806686401367  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3002, 128])
m.shape torch.Size([2714, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.9796953201293945  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.9796953201293945  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2714, 128]), torch.Size([1, 2714, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 2.9823741912841797  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.2041821479797363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2714, 128])
m.shape torch.Size([2450, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.217956066131592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.217956066131592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2450, 128]), torch.Size([1, 2450, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.2203307151794434  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.447868824005127  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2450, 128])
m.shape torch.Size([2185, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.461287021636963  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.461287021636963  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.4633851051330566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.6716928482055664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([1973, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.6846508979797363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.6846508979797363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1973, 128]), torch.Size([1, 1973, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.686532497406006  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.8917040824890137  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1973, 128])
m.shape torch.Size([1709, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.903801918029785  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.903801918029785  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1709, 128]), torch.Size([1, 1709, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 3.9054317474365234  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.090012550354004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1709, 128])
m.shape torch.Size([1678, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.102799892425537  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.102799892425537  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1678, 128]), torch.Size([1, 1678, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.104400157928467  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.298842906951904  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1678, 128])
m.shape torch.Size([1561, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.311440944671631  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.311440944671631  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1561, 128]), torch.Size([1, 1561, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.312929630279541  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.502171039581299  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1561, 128])
m.shape torch.Size([1352, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.513675689697266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.513675689697266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1352, 128]), torch.Size([1, 1352, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.514965057373047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.690430641174316  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1352, 128])
m.shape torch.Size([20820, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.888340950012207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.888340950012207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20820, 128]), torch.Size([1, 20820, 128])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 4.908196449279785  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.707821846008301  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20820, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.281215667724609  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.305025577545166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.328835487365723  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.304281234741211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99865, 64])
input nodes number: 152836
output nodes number: 99865
edges number: 967469
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.329990386962891  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.353800296783447  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.359753131866455  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.359753131866455  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99865, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.359753131866455  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5202, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.408450126647949  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.408450126647949  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5202, 64]), torch.Size([1, 5202, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.411059379577637  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.431622505187988  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5202, 64])
m.shape torch.Size([6002, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.4335832595825195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.4335832595825195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6002, 64]), torch.Size([1, 6002, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.436494827270508  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.479892730712891  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6002, 64])
m.shape torch.Size([55122, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.519143581390381  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.519143581390381  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55122, 64]), torch.Size([1, 55122, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 7.5454277992248535  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.123680591583252  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55122, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.081298351287842  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.097111701965332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.112925052642822  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.096617221832275  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66326, 64])
input nodes number: 99865
output nodes number: 66326
edges number: 182572
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.113670349121094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.129483699798584  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.133654117584229  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.133654117584229  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3312, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.156210899353027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.156210899353027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3312, 64]), torch.Size([1, 3312, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.157790184020996  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.17111873626709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3312, 64])
m.shape torch.Size([2980, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.171854019165039  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.171854019165039  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2980, 64]), torch.Size([1, 2980, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.173274993896484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.196066856384277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2980, 64])
m.shape torch.Size([2362, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.19724702835083  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.19724702835083  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2362, 64]), torch.Size([1, 2362, 64])
----------------------------------------3
 Nvidia-smi: 11.9559326171875 GB
    Memory Allocated: 8.198373317718506  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.223761081695557  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2362, 64])
m.shape torch.Size([1799, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.225101947784424  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.225101947784424  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1799, 64]), torch.Size([1, 1799, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.22596025466919  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.253133773803711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1799, 64])
m.shape torch.Size([12283, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.267805099487305  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.267805099487305  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12283, 64]), torch.Size([1, 12283, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.273691654205322  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.486368656158447  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12283, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.468175411224365  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.472358226776123  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.475746154785156  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.471393585205078  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66326
output nodes number: 22736
edges number: 84969
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.472168445587158  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030420303344726562 |0.005533695220947266 |0.12075972557067871 |0.0008745193481445312 |0.062018394470214844 |0.006720542907714844 |
----------------------------------------------------------pseudo_mini_loss sum 2.946977376937866
for loop block_dataloader item  time:  0.5924623012542725
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.09003210067749023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.09003210067749023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([153160, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.09003210067749023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7397, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.568305492401123  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.568305492401123  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7397, 128]), torch.Size([1, 7397, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.5753598213195801  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.6317944526672363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7397, 128])
m.shape torch.Size([8781, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.6366415023803711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.6366415023803711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8781, 128]), torch.Size([1, 8781, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.6450157165527344  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.7756071090698242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8781, 128])
m.shape torch.Size([8311, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.7833089828491211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.7833089828491211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8311, 128]), torch.Size([1, 8311, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.7912349700927734  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.965606689453125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8311, 128])
m.shape torch.Size([7344, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.9756512641906738  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.9756512641906738  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7344, 128]), torch.Size([1, 7344, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.9827885627746582  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.1875228881835938  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7344, 128])
m.shape torch.Size([6722, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.200047492980957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.200047492980957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6722, 128]), torch.Size([1, 6722, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.2067365646362305  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.450714111328125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6722, 128])
m.shape torch.Size([5606, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.463547706604004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.463547706604004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5606, 128]), torch.Size([1, 5606, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.4696202278137207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.6995110511779785  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5606, 128])
m.shape torch.Size([4920, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.7132601737976074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.7132601737976074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4920, 128]), torch.Size([1, 4920, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.7182793617248535  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.952883243560791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4920, 128])
m.shape torch.Size([4440, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.9681153297424316  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.9681153297424316  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4440, 128]), torch.Size([1, 4440, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.9727845191955566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.2199769020080566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4440, 128])
m.shape torch.Size([3843, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.2341346740722656  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.2341346740722656  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3843, 128]), torch.Size([1, 3843, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.238340377807617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.477022171020508  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3843, 128])
m.shape torch.Size([3412, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.4916820526123047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.4916820526123047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3412, 128]), torch.Size([1, 3412, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.495088577270508  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.7329649925231934  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3412, 128])
m.shape torch.Size([3024, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.747199535369873  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.747199535369873  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3024, 128]), torch.Size([1, 3024, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.75022554397583  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.9807753562927246  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3024, 128])
m.shape torch.Size([2693, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.993957042694092  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.993957042694092  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2693, 128]), torch.Size([1, 2693, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.996786594390869  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.226135730743408  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2693, 128])
m.shape torch.Size([2483, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.239974021911621  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.239974021911621  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2483, 128]), torch.Size([1, 2483, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.242386817932129  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.470400333404541  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2483, 128])
m.shape torch.Size([2185, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.484011650085449  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.484011650085449  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.4861974716186523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.7013449668884277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([1981, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.7144722938537598  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.7144722938537598  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1981, 128]), torch.Size([1, 1981, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.7163615226745605  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.921731472015381  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1981, 128])
m.shape torch.Size([1759, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.934206962585449  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.934206962585449  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1759, 128]), torch.Size([1, 1759, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.935884475708008  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.125443458557129  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1759, 128])
m.shape torch.Size([1671, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.138150215148926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.138150215148926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1671, 128]), torch.Size([1, 1671, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.139743804931641  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.33430290222168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1671, 128])
m.shape torch.Size([1525, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.346662998199463  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.346662998199463  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1525, 128]), torch.Size([1, 1525, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.348117351531982  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.532820224761963  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1525, 128])
m.shape torch.Size([1344, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.544269561767578  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.544269561767578  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1344, 128]), torch.Size([1, 1344, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.545551300048828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.719595432281494  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1344, 128])
m.shape torch.Size([20885, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.9181294441223145  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.9181294441223145  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20885, 128]), torch.Size([1, 20885, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.938046932220459  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.746412754058838  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20885, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.318508148193359  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.342427730560303  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.366347312927246  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.34168004989624  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100326, 64])
input nodes number: 153160
output nodes number: 100326
edges number: 970582
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.367528915405273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.391448497772217  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.397428512573242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.397428512573242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100326, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.397428512573242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5109, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.446340560913086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.446340560913086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5109, 64]), torch.Size([1, 5109, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.449514389038086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.470595359802246  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5109, 64])
m.shape torch.Size([5887, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.472301483154297  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.472301483154297  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5887, 64]), torch.Size([1, 5887, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.475475311279297  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.521388530731201  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5887, 64])
m.shape torch.Size([55529, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.561106204986572  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.561106204986572  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55529, 64]), torch.Size([1, 55529, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.587584972381592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.170109272003174  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55529, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.126656532287598  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.142517566680908  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.158378601074219  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.142021656036377  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66525, 64])
input nodes number: 100326
output nodes number: 66525
edges number: 183470
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.159127235412598  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.174988269805908  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.17917537689209  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.17917537689209  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3343, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.201755046844482  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.201755046844482  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3343, 64]), torch.Size([1, 3343, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.203349590301514  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.217525959014893  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3343, 64])
m.shape torch.Size([2903, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.218406677246094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.218406677246094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2903, 64]), torch.Size([1, 2903, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.219791412353516  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.240556716918945  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2903, 64])
m.shape torch.Size([2372, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.241996765136719  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.241996765136719  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2372, 64]), torch.Size([1, 2372, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.243127822875977  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.269538879394531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2372, 64])
m.shape torch.Size([1832, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.271107196807861  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.271107196807861  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1832, 64]), torch.Size([1, 1832, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.27198076248169  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.299806594848633  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1832, 64])
m.shape torch.Size([12286, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.314473628997803  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.314473628997803  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12286, 64]), torch.Size([1, 12286, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.320332050323486  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.5336275100708  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12286, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.515419960021973  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.519571781158447  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.52295970916748  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.518638134002686  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66525
output nodes number: 22736
edges number: 85023
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.519272804260254  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030745506286621094 |0.0054656267166137695 |0.12081372737884521 |0.0008785724639892578 |0.06206333637237549 |0.007174253463745117 |
----------------------------------------------------------pseudo_mini_loss sum 2.6261749267578125
for loop block_dataloader item  time:  0.998553991317749
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.08985042572021484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.08985042572021484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152810, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.08985042572021484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7480, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.5691080093383789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.5691080093383789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7480, 128]), torch.Size([1, 7480, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.5772027969360352  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.6342706680297852  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7480, 128])
m.shape torch.Size([8570, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.6388769149780273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.6388769149780273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8570, 128]), torch.Size([1, 8570, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.6470499038696289  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.7696447372436523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8570, 128])
m.shape torch.Size([8267, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.7773842811584473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.7773842811584473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8267, 128]), torch.Size([1, 8267, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.7852683067321777  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.958716869354248  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8267, 128])
m.shape torch.Size([7354, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.9688014984130859  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.9688014984130859  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7354, 128]), torch.Size([1, 7354, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 0.9758930206298828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.1814332008361816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7354, 128])
m.shape torch.Size([6560, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.1935667991638184  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.1935667991638184  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6560, 128]), torch.Size([1, 6560, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.2002015113830566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.4254212379455566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6560, 128])
m.shape torch.Size([5567, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.438220500946045  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.438220500946045  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5567, 128]), torch.Size([1, 5567, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.4443955421447754  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.67268705368042  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5567, 128])
m.shape torch.Size([4886, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.6863412857055664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.6863412857055664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4886, 128]), torch.Size([1, 4886, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.6910104751586914  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.9249773025512695  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4886, 128])
m.shape torch.Size([4390, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.9401559829711914  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.9401559829711914  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4390, 128]), torch.Size([1, 4390, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 1.9449548721313477  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.188345432281494  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4390, 128])
m.shape torch.Size([3887, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.202241897583008  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.202241897583008  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3887, 128]), torch.Size([1, 3887, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.206033229827881  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.443276882171631  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3887, 128])
m.shape torch.Size([3388, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.457578659057617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.457578659057617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3388, 128]), torch.Size([1, 3388, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.4610204696655273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.700817584991455  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3388, 128])
m.shape torch.Size([3056, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.715231418609619  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.715231418609619  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3056, 128]), torch.Size([1, 3056, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.7181763648986816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.9530367851257324  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3056, 128])
m.shape torch.Size([2712, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.96651029586792  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.96651029586792  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2712, 128]), torch.Size([1, 2712, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 2.969221591949463  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.1922974586486816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2712, 128])
m.shape torch.Size([2530, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.2066874504089355  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.2066874504089355  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2530, 128]), torch.Size([1, 2530, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.2091517448425293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.435246467590332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2530, 128])
m.shape torch.Size([2207, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.449329376220703  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.449329376220703  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2207, 128]), torch.Size([1, 2207, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.451526641845703  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.661989688873291  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2207, 128])
m.shape torch.Size([1967, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.674899101257324  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.674899101257324  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1967, 128]), torch.Size([1, 1967, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.6767749786376953  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.8825817108154297  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1967, 128])
m.shape torch.Size([1762, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.8950867652893066  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.8950867652893066  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1762, 128]), torch.Size([1, 1762, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 3.8967671394348145  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.086649417877197  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1762, 128])
m.shape torch.Size([1702, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.099606037139893  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.099606037139893  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1702, 128]), torch.Size([1, 1702, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.101229190826416  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.29638147354126  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1702, 128])
m.shape torch.Size([1553, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.308899402618408  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.308899402618408  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1553, 128]), torch.Size([1, 1553, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.310380458831787  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.499387264251709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1553, 128])
m.shape torch.Size([1370, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.511058807373047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.511058807373047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1370, 128]), torch.Size([1, 1370, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.512365341186523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.689334869384766  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1370, 128])
m.shape torch.Size([20949, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.888466835021973  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.888466835021973  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20949, 128]), torch.Size([1, 20949, 128])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 4.908445358276367  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.725417137145996  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20949, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.296413421630859  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.320292949676514  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.344172477722168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.319546699523926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100157, 64])
input nodes number: 152810
output nodes number: 100157
edges number: 972767
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.345333099365234  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.369212627410889  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.376141548156738  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.376141548156738  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100157, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.376141548156738  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5251, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.425177574157715  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.425177574157715  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5251, 64]), torch.Size([1, 5251, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.428182601928711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.450033664703369  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5251, 64])
m.shape torch.Size([5839, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.45149040222168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.45149040222168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5839, 64]), torch.Size([1, 5839, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.455007553100586  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.498971939086914  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5839, 64])
m.shape torch.Size([55480, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.538654327392578  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.538654327392578  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55480, 64]), torch.Size([1, 55480, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 7.5651092529296875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.147117614746094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55480, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.104037284851074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.119908809661865  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.135780334472656  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.119412422180176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66570, 64])
input nodes number: 100157
output nodes number: 66570
edges number: 183369
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.13652753829956  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.152399063110352  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.156372547149658  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.156372547149658  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3379, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.178988456726074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.178988456726074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3379, 64]), torch.Size([1, 3379, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.1806001663208  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.195245742797852  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3379, 64])
m.shape torch.Size([2878, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.19624137878418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.19624137878418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2878, 64]), torch.Size([1, 2878, 64])
----------------------------------------3
 Nvidia-smi: 11.9578857421875 GB
    Memory Allocated: 8.197613716125488  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.218198776245117  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2878, 64])
m.shape torch.Size([2287, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.219324588775635  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.219324588775635  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2287, 64]), torch.Size([1, 2287, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.220415592193604  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.245971202850342  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2287, 64])
m.shape torch.Size([1817, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.247269630432129  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.247269630432129  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1817, 64]), torch.Size([1, 1817, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.248136520385742  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.274729251861572  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1817, 64])
m.shape torch.Size([12375, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.289509296417236  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.289509296417236  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12375, 64]), torch.Size([1, 12375, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.295813083648682  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.509541034698486  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12375, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.491284847259521  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.495406150817871  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.498794078826904  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.494503021240234  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66570
output nodes number: 22736
edges number: 85139
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.49513864517212  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030466477076212566 |0.005568106969197591 |0.12199664115905762 |0.0008744398752848307 |0.06210573514302572 |0.007088184356689453 |
----------------------------------------------------------pseudo_mini_loss sum 2.4955451488494873
for loop block_dataloader item  time:  1.4703519344329834
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08982229232788086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08982229232788086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152851, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08982229232788086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7397, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5680961608886719  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5680961608886719  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7397, 128]), torch.Size([1, 7397, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5751504898071289  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6315851211547852  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7397, 128])
m.shape torch.Size([8775, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6364264488220215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6364264488220215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8775, 128]), torch.Size([1, 8775, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6447949409484863  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7753691673278809  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8775, 128])
m.shape torch.Size([8230, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7829580307006836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7829580307006836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8230, 128]), torch.Size([1, 8230, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.790806770324707  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9634790420532227  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8230, 128])
m.shape torch.Size([7431, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9737281799316406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9737281799316406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7431, 128]), torch.Size([1, 7431, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9809484481811523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1881518363952637  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7431, 128])
m.shape torch.Size([6637, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.200432300567627  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.200432300567627  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6637, 128]), torch.Size([1, 6637, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2071328163146973  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4355602264404297  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6637, 128])
m.shape torch.Size([5599, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4484143257141113  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4484143257141113  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5599, 128]), torch.Size([1, 5599, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.45444917678833  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6840529441833496  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5599, 128])
m.shape torch.Size([4918, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.697798728942871  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.697798728942871  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4918, 128]), torch.Size([1, 4918, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7028136253356934  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9373221397399902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4918, 128])
m.shape torch.Size([4413, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9525551795959473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9525551795959473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4413, 128]), torch.Size([1, 4413, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9570040702819824  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2032241821289062  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4413, 128])
m.shape torch.Size([3856, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2174339294433594  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2174339294433594  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3856, 128]), torch.Size([1, 3856, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2211952209472656  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.462374210357666  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3856, 128])
m.shape torch.Size([3447, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.476113796234131  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.476113796234131  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3447, 128]), torch.Size([1, 3447, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4795570373535156  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7191848754882812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3447, 128])
m.shape torch.Size([3017, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.733366012573242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.733366012573242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3017, 128]), torch.Size([1, 3017, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7362685203552246  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.971040725708008  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3017, 128])
m.shape torch.Size([2690, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9841651916503906  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9841651916503906  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2690, 128]), torch.Size([1, 2690, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9868626594543457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.207526206970215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2690, 128])
m.shape torch.Size([2491, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2216849327087402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2216849327087402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2491, 128]), torch.Size([1, 2491, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2241554260253906  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.45168399810791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2491, 128])
m.shape torch.Size([2169, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.464449405670166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.464449405670166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2169, 128]), torch.Size([1, 2169, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4665284156799316  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6734180450439453  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2169, 128])
m.shape torch.Size([2004, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6867175102233887  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6867175102233887  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2004, 128]), torch.Size([1, 2004, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.688628673553467  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.894568920135498  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2004, 128])
m.shape torch.Size([1788, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.907254695892334  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.907254695892334  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1788, 128]), torch.Size([1, 1788, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9089598655700684  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.101846218109131  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1788, 128])
m.shape torch.Size([1678, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.114595890045166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.114595890045166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1678, 128]), torch.Size([1, 1678, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.116196155548096  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.310852527618408  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1678, 128])
m.shape torch.Size([1541, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.323278903961182  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.323278903961182  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.324748516082764  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.512210369110107  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([1353, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.523733615875244  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.523733615875244  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1353, 128]), torch.Size([1, 1353, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.525023937225342  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.69839334487915  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1353, 128])
m.shape torch.Size([20843, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.896522521972656  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.896522521972656  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20843, 128]), torch.Size([1, 20843, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.916399955749512  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.719118118286133  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20843, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.290256977081299  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.314165115356445  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.338073253631592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.313417911529541  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100277, 64])
input nodes number: 152851
output nodes number: 100277
edges number: 970759
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.339262008666992  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.363170146942139  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.369798183441162  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.369798183441162  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100277, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.369798183441162  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5170, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4186248779296875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4186248779296875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5170, 64]), torch.Size([1, 5170, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.421146392822266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.440980911254883  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5170, 64])
m.shape torch.Size([5975, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.442974090576172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.442974090576172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5975, 64]), torch.Size([1, 5975, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4459075927734375  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.489004135131836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5975, 64])
m.shape torch.Size([55363, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.528397083282471  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.528397083282471  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55363, 64]), torch.Size([1, 55363, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.5547966957092285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.135579586029053  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55363, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.093137264251709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.108994007110596  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.124850749969482  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.108498096466064  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66508, 64])
input nodes number: 100277
output nodes number: 66508
edges number: 183209
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.125598907470703  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.14145565032959  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.145639896392822  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.145639896392822  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3394, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.168195247650146  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.168195247650146  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3394, 64]), torch.Size([1, 3394, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.169813632965088  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.183520793914795  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3394, 64])
m.shape torch.Size([2945, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.184172630310059  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.184172630310059  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2945, 64]), torch.Size([1, 2945, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.185577392578125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.206643104553223  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2945, 64])
m.shape torch.Size([2256, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.207634925842285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.207634925842285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2256, 64]), torch.Size([1, 2256, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.208710670471191  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.234789371490479  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2256, 64])
m.shape torch.Size([1872, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.236145973205566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.236145973205566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1872, 64]), torch.Size([1, 1872, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.237038612365723  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.267361164093018  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1872, 64])
m.shape torch.Size([12266, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.281994342803955  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.281994342803955  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12266, 64]), torch.Size([1, 12266, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.287843227386475  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.498936176300049  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12266, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.480769157409668  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.484941482543945  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.488329410552979  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.48398733139038  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22733, 40])
input nodes number: 66508
output nodes number: 22733
edges number: 84870
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.483919620513916  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031892597675323486 |0.00585252046585083 |0.12171196937561035 |0.0008758306503295898 |0.062118589878082275 |0.006821632385253906 |
----------------------------------------------------------pseudo_mini_loss sum 2.430783987045288
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1278211
Number of first layer input nodes during this epoch:  611657
block dataloader generation time/epoch 1.1920928955078125e-06
for loop block_dataloader item  time:  0.14697694778442383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08907365798950195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08907365798950195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152875, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08907365798950195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7421, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5655779838562012  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5655779838562012  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7421, 128]), torch.Size([1, 7421, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.572655200958252  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6292729377746582  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7421, 128])
m.shape torch.Size([8748, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6340770721435547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6340770721435547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8748, 128]), torch.Size([1, 8748, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6433601379394531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7738571166992188  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8748, 128])
m.shape torch.Size([8259, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7815003395080566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7815003395080566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8259, 128]), torch.Size([1, 8259, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7896099090576172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.962890625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8259, 128])
m.shape torch.Size([7391, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9730496406555176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9730496406555176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7391, 128]), torch.Size([1, 7391, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9804306030273438  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1869401931762695  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7391, 128])
m.shape torch.Size([6621, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1992015838623047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1992015838623047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6621, 128]), torch.Size([1, 6621, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.205953598022461  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4337053298950195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6621, 128])
m.shape torch.Size([5620, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.446627140045166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.446627140045166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5620, 128]), torch.Size([1, 5620, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4520316123962402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.683018684387207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5620, 128])
m.shape torch.Size([4878, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6966209411621094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6966209411621094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4878, 128]), torch.Size([1, 4878, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7016267776489258  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9356470108032227  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4878, 128])
m.shape torch.Size([4412, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.950810432434082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.950810432434082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4412, 128]), torch.Size([1, 4412, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.955472469329834  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.1983561515808105  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4412, 128])
m.shape torch.Size([3796, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.21254301071167  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.21254301071167  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3796, 128]), torch.Size([1, 3796, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.216193675994873  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4483537673950195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3796, 128])
m.shape torch.Size([3463, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4630565643310547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4630565643310547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3463, 128]), torch.Size([1, 3463, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.46663236618042  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7065329551696777  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3463, 128])
m.shape torch.Size([3033, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7212977409362793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7212977409362793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3033, 128]), torch.Size([1, 3033, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.724238872528076  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9607062339782715  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3033, 128])
m.shape torch.Size([2700, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9739794731140137  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9739794731140137  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2700, 128]), torch.Size([1, 2700, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9765610694885254  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2006711959838867  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2700, 128])
m.shape torch.Size([2445, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2145400047302246  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2145400047302246  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2445, 128]), torch.Size([1, 2445, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2169394493103027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.443993091583252  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2445, 128])
m.shape torch.Size([2184, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.457406997680664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.457406997680664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2184, 128]), torch.Size([1, 2184, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.459493637084961  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6727404594421387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2184, 128])
m.shape torch.Size([1970, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6857895851135254  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6857895851135254  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1970, 128]), torch.Size([1, 1970, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6876683235168457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.893089771270752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1970, 128])
m.shape torch.Size([1722, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9052882194519043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9052882194519043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1722, 128]), torch.Size([1, 1722, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.906930446624756  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.092502117156982  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1722, 128])
m.shape torch.Size([1696, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.105429172515869  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.105429172515869  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1696, 128]), torch.Size([1, 1696, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.107046604156494  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.302156925201416  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1696, 128])
m.shape torch.Size([1548, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.314634799957275  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.314634799957275  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1548, 128]), torch.Size([1, 1548, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.316111087799072  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.505552768707275  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1548, 128])
m.shape torch.Size([1309, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.516674041748047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.516674041748047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1309, 128]), torch.Size([1, 1309, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.517922401428223  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.686551570892334  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1309, 128])
m.shape torch.Size([20795, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.884243965148926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.884243965148926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20795, 128]), torch.Size([1, 20795, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.904075622558594  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.700339317321777  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20795, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.2733025550842285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.297147274017334  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.3209919929504395  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.2964019775390625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100011, 64])
input nodes number: 152875
output nodes number: 100011
edges number: 967012
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.3221588134765625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.346003532409668  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.351964950561523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.351964950561523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100011, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.351964950561523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5166, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.400889873504639  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.400889873504639  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5166, 64]), torch.Size([1, 5166, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.403594493865967  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.424139499664307  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5166, 64])
m.shape torch.Size([5898, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.42574405670166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.42574405670166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5898, 64]), torch.Size([1, 5898, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4289021492004395  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.47340726852417  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5898, 64])
m.shape torch.Size([55425, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.512587070465088  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.512587070465088  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55425, 64]), torch.Size([1, 55425, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.539016246795654  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.120449542999268  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55425, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.07793378829956  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.093786239624023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.109638690948486  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.09329080581665  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66489, 64])
input nodes number: 100011
output nodes number: 66489
edges number: 183237
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.110384941101074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.126237392425537  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.130228042602539  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.130228042602539  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3324, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.15284252166748  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.15284252166748  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3324, 64]), torch.Size([1, 3324, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.154427528381348  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.168598651885986  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3324, 64])
m.shape torch.Size([2928, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.169665813446045  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.169665813446045  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2928, 64]), torch.Size([1, 2928, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.171061992645264  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.19236946105957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2928, 64])
m.shape torch.Size([2315, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.193539142608643  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.193539142608643  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2315, 64]), torch.Size([1, 2315, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.194643497467041  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.219862461090088  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2315, 64])
m.shape torch.Size([1776, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.221179008483887  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.221179008483887  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1776, 64]), torch.Size([1, 1776, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.222025871276855  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.25003719329834  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1776, 64])
m.shape torch.Size([12393, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.264849662780762  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.264849662780762  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12393, 64]), torch.Size([1, 12393, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.270759582519531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.485620498657227  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12393, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.466597557067871  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.470303058624268  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.4736909866333  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.469815731048584  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66489
output nodes number: 22736
edges number: 85194
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.47079849243164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029867887496948242 |0.0055294036865234375 |0.11981773376464844 |0.0008795261383056641 |0.06183457374572754 |0.006727457046508789 |
----------------------------------------------------------pseudo_mini_loss sum 2.3091254234313965
for loop block_dataloader item  time:  0.5307321548461914
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0895228385925293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0895228385925293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([153099, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0895228385925293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7426, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5678133964538574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5678133964538574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7426, 128]), torch.Size([1, 7426, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5748953819274902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6315512657165527  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7426, 128])
m.shape torch.Size([8775, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6363787651062012  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6363787651062012  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8775, 128]), torch.Size([1, 8775, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.644747257232666  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7753214836120605  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8775, 128])
m.shape torch.Size([8307, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7830204963684082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7830204963684082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8307, 128]), torch.Size([1, 8307, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7909426689147949  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9652304649353027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8307, 128])
m.shape torch.Size([7366, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9753189086914062  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9753189086914062  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7366, 128]), torch.Size([1, 7366, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9824657440185547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1877694129943848  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7366, 128])
m.shape torch.Size([6584, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.200082778930664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.200082778930664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6584, 128]), torch.Size([1, 6584, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2067832946777344  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.43341064453125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6584, 128])
m.shape torch.Size([5628, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4463729858398438  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4463729858398438  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5628, 128]), torch.Size([1, 5628, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4524102210998535  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6832032203674316  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5628, 128])
m.shape torch.Size([4943, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6970186233520508  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6970186233520508  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4943, 128]), torch.Size([1, 4943, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.702059268951416  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9377598762512207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4943, 128])
m.shape torch.Size([4430, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9529809951782227  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9529809951782227  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4430, 128]), torch.Size([1, 4430, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9575624465942383  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.204300880432129  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4430, 128])
m.shape torch.Size([3890, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2187042236328125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2187042236328125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3890, 128]), torch.Size([1, 3890, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.223285675048828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.465573310852051  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3890, 128])
m.shape torch.Size([3458, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.480412483215332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.480412483215332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3458, 128]), torch.Size([1, 3458, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.483880043029785  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7233967781066895  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3458, 128])
m.shape torch.Size([3059, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.73779296875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.73779296875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3059, 128]), torch.Size([1, 3059, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7407150268554688  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9791135787963867  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3059, 128])
m.shape torch.Size([2705, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9925642013549805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9925642013549805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2705, 128]), torch.Size([1, 2705, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9953527450561523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2185864448547363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2705, 128])
m.shape torch.Size([2504, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.232818603515625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.232818603515625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2504, 128]), torch.Size([1, 2504, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.235374927520752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4626412391662598  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2504, 128])
m.shape torch.Size([2173, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4759535789489746  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4759535789489746  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2173, 128]), torch.Size([1, 2173, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.478128433227539  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6906399726867676  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2173, 128])
m.shape torch.Size([2008, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.7030858993530273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.7030858993530273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2008, 128]), torch.Size([1, 2008, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.705000877380371  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.911421775817871  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2008, 128])
m.shape torch.Size([1762, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9239072799682617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9239072799682617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1762, 128]), torch.Size([1, 1762, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9255876541137695  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.115469932556152  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1762, 128])
m.shape torch.Size([1668, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.128150939941406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.128150939941406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1668, 128]), torch.Size([1, 1668, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.129741668701172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.323810577392578  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1668, 128])
m.shape torch.Size([1568, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.33647346496582  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.33647346496582  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1568, 128]), torch.Size([1, 1568, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.337968826293945  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.52879524230957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1568, 128])
m.shape torch.Size([1320, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.540006637573242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.540006637573242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1320, 128]), torch.Size([1, 1320, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.541265487670898  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.714534759521484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1320, 128])
m.shape torch.Size([20761, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.911897659301758  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.911897659301758  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20761, 128]), torch.Size([1, 20761, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.931696891784668  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.723388671875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20761, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.295626640319824  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.319548606872559  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.343470573425293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.318800926208496  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100335, 64])
input nodes number: 153099
output nodes number: 100335
edges number: 969955
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.344888687133789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.368810653686523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.374791145324707  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.374791145324707  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100335, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.374791145324707  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5155, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4239115715026855  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4239115715026855  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5155, 64]), torch.Size([1, 5155, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.426745891571045  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.447163105010986  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5155, 64])
m.shape torch.Size([5943, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.448671817779541  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.448671817779541  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5943, 64]), torch.Size([1, 5943, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4515061378479  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.494015216827393  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5943, 64])
m.shape torch.Size([55569, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.533761501312256  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.533761501312256  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55569, 64]), torch.Size([1, 55569, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.5602593421936035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.143203258514404  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55569, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.100607872009277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.11650276184082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.132397651672363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.116005897521973  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66667, 64])
input nodes number: 100335
output nodes number: 66667
edges number: 183748
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.133146286010742  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.149041175842285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.153225421905518  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.153225421905518  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3374, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.175806999206543  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.175806999206543  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3374, 64]), torch.Size([1, 3374, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.17741584777832  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.19096851348877  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3374, 64])
m.shape torch.Size([2954, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191625595092773  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191625595092773  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2954, 64]), torch.Size([1, 2954, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.193034172058105  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.215454578399658  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2954, 64])
m.shape torch.Size([2270, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.216450214385986  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.216450214385986  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2270, 64]), torch.Size([1, 2270, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.217532634735107  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.242377281188965  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2270, 64])
m.shape torch.Size([1780, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.243688583374023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.243688583374023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1780, 64]), torch.Size([1, 1780, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.244537353515625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.2710542678833  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1780, 64])
m.shape torch.Size([12358, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.28582239151001  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.28582239151001  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12358, 64]), torch.Size([1, 12358, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.291715145111084  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.504842758178711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12358, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.486623764038086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.490834712982178  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.494222640991211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.489841938018799  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66667
output nodes number: 22736
edges number: 85002
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.491014003753662  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029912829399108887 |0.005421042442321777 |0.12002694606781006 |0.0008838176727294922 |0.061869025230407715 |0.006888151168823242 |
----------------------------------------------------------pseudo_mini_loss sum 2.2007133960723877
for loop block_dataloader item  time:  0.9724044799804688
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08992862701416016  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08992862701416016  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152936, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08992862701416016  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7498, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5666065216064453  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5666065216064453  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7498, 128]), torch.Size([1, 7498, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5747213363647461  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6319265365600586  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7498, 128])
m.shape torch.Size([8761, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6367063522338867  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6367063522338867  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8761, 128]), torch.Size([1, 8761, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6450614929199219  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7755956649780273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8761, 128])
m.shape torch.Size([8194, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.783139705657959  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.783139705657959  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8194, 128]), torch.Size([1, 8194, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7909541130065918  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9628710746765137  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8194, 128])
m.shape torch.Size([7372, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.973024845123291  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.973024845123291  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7372, 128]), torch.Size([1, 7372, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.980292797088623  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1861252784729004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7372, 128])
m.shape torch.Size([6604, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1983551979064941  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1983551979064941  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6604, 128]), torch.Size([1, 6604, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2050824165344238  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4323935508728027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6604, 128])
m.shape torch.Size([5601, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4452691078186035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4452691078186035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5601, 128]), torch.Size([1, 5601, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4513912200927734  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.681077003479004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5601, 128])
m.shape torch.Size([4897, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6947517395019531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6947517395019531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4897, 128]), torch.Size([1, 4897, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6997575759887695  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9339590072631836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4897, 128])
m.shape torch.Size([4329, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.948094367980957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.948094367980957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4329, 128]), torch.Size([1, 4329, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9526376724243164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.1910057067871094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4329, 128])
m.shape torch.Size([3838, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2044591903686523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2044591903686523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3838, 128]), torch.Size([1, 3838, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2082414627075195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4443159103393555  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3838, 128])
m.shape torch.Size([3437, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.458956718444824  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.458956718444824  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3437, 128]), torch.Size([1, 3437, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4622373580932617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.6961965560913086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3437, 128])
m.shape torch.Size([2986, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7102198600769043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7102198600769043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2986, 128]), torch.Size([1, 2986, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7132439613342285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.947232723236084  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2986, 128])
m.shape torch.Size([2728, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.961418628692627  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.961418628692627  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2728, 128]), torch.Size([1, 2728, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9640660285949707  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.1875057220458984  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2728, 128])
m.shape torch.Size([2478, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2015466690063477  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2015466690063477  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2478, 128]), torch.Size([1, 2478, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.204007148742676  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4302029609680176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2478, 128])
m.shape torch.Size([2150, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4433741569519043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4433741569519043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2150, 128]), torch.Size([1, 2150, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4454455375671387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6492257118225098  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2150, 128])
m.shape torch.Size([1966, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6622118949890137  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6622118949890137  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1966, 128]), torch.Size([1, 1966, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6640868186950684  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8694281578063965  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1966, 128])
m.shape torch.Size([1712, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.881552219390869  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.881552219390869  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1712, 128]), torch.Size([1, 1712, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8831849098205566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.067678928375244  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1712, 128])
m.shape torch.Size([1659, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.080310821533203  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.080310821533203  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1659, 128]), torch.Size([1, 1659, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.081892967224121  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.275525093078613  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1659, 128])
m.shape torch.Size([1523, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.287806034088135  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.287806034088135  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1523, 128]), torch.Size([1, 1523, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.2892584800720215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.476613998413086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1523, 128])
m.shape torch.Size([1365, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.488254547119141  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.488254547119141  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1365, 128]), torch.Size([1, 1365, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.489556312561035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.663992881774902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1365, 128])
m.shape torch.Size([20872, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.862392902374268  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.862392902374268  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20872, 128]), torch.Size([1, 20872, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.882297992706299  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.688915729522705  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20872, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.26341438293457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.2872490882873535  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.311083793640137  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.286503791809082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99970, 64])
input nodes number: 152936
output nodes number: 99970
edges number: 967309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.312229156494141  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.336063861846924  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.342022895812988  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.342022895812988  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99970, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.342022895812988  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5263, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.39094352722168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.39094352722168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5263, 64]), torch.Size([1, 5263, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.393556594848633  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.41397762298584  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5263, 64])
m.shape torch.Size([5971, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.415909290313721  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.415909290313721  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5971, 64]), torch.Size([1, 5971, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.419267654418945  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.465735912322998  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5971, 64])
m.shape torch.Size([55401, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.504566669464111  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.504566669464111  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55401, 64]), torch.Size([1, 55401, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.530984401702881  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.112165927886963  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55401, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.069142818450928  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.08503007888794  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.100917339324951  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.084533214569092  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66635, 64])
input nodes number: 99970
output nodes number: 66635
edges number: 183408
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.101663589477539  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.117757797241211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.121728420257568  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.121728420257568  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3354, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.144320964813232  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.144320964813232  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3354, 64]), torch.Size([1, 3354, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.145920276641846  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.160402774810791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3354, 64])
m.shape torch.Size([2860, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.161035537719727  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.161035537719727  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2860, 64]), torch.Size([1, 2860, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.162399291992188  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.182855606079102  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2860, 64])
m.shape torch.Size([2347, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.184328556060791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.184328556060791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2347, 64]), torch.Size([1, 2347, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.185448169708252  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.210942268371582  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2347, 64])
m.shape torch.Size([1924, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.212285995483398  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.212285995483398  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1924, 64]), torch.Size([1, 1924, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.213203430175781  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.24265718460083  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1924, 64])
m.shape torch.Size([12251, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.257259845733643  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.257259845733643  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12251, 64]), torch.Size([1, 12251, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.263700485229492  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.475906372070312  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12251, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.456881046295166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.460617542266846  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.464005470275879  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.460099220275879  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66635
output nodes number: 22736
edges number: 85066
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.460291385650635  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029903968175252277 |0.0054264068603515625 |0.1199945608774821 |0.0008731683095296224 |0.061931610107421875 |0.006992816925048828 |
----------------------------------------------------------pseudo_mini_loss sum 2.1660101413726807
for loop block_dataloader item  time:  1.3474187850952148
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08940315246582031  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08940315246582031  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152885, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08940315246582031  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7449, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5657544136047363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5657544136047363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7449, 128]), torch.Size([1, 7449, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5728583335876465  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6296896934509277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7449, 128])
m.shape torch.Size([8725, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6344585418701172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6344585418701172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8725, 128]), torch.Size([1, 8725, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6427793502807617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7732105255126953  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8725, 128])
m.shape torch.Size([8242, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7808403968811035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7808403968811035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8242, 128]), torch.Size([1, 8242, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7887005805969238  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9616990089416504  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8242, 128])
m.shape torch.Size([7343, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9717745780944824  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9717745780944824  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7343, 128]), torch.Size([1, 7343, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9790310859680176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1839704513549805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7343, 128])
m.shape torch.Size([6734, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1965241432189941  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1965241432189941  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6734, 128]), torch.Size([1, 6734, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.203320026397705  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4474077224731445  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6734, 128])
m.shape torch.Size([5570, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4601325988769531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4601325988769531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5570, 128]), torch.Size([1, 5570, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4662871360778809  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6947016716003418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5570, 128])
m.shape torch.Size([4914, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7084479331970215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7084479331970215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4914, 128]), torch.Size([1, 4914, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.713447093963623  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9478106498718262  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4914, 128])
m.shape torch.Size([4308, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9618983268737793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9618983268737793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4308, 128]), torch.Size([1, 4308, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9660696983337402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2020325660705566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4308, 128])
m.shape torch.Size([3824, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2163891792297363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2163891792297363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3824, 128]), torch.Size([1, 3824, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.220104694366455  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.455099582672119  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3824, 128])
m.shape torch.Size([3405, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.469686985015869  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.469686985015869  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3405, 128]), torch.Size([1, 3405, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4729528427124023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.705733299255371  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3405, 128])
m.shape torch.Size([2986, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7197718620300293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7197718620300293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2986, 128]), torch.Size([1, 2986, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7226672172546387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.947923183441162  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2986, 128])
m.shape torch.Size([2719, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.961857795715332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.961857795715332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2719, 128]), torch.Size([1, 2719, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.964451789855957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.185767650604248  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2719, 128])
m.shape torch.Size([2485, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.1998753547668457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.1998753547668457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2485, 128]), torch.Size([1, 2485, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2023658752441406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.429419994354248  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2485, 128])
m.shape torch.Size([2206, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4429616928100586  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4429616928100586  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2206, 128]), torch.Size([1, 2206, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.445087432861328  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.655672073364258  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2206, 128])
m.shape torch.Size([1967, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6685924530029297  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6685924530029297  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1967, 128]), torch.Size([1, 1967, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.670468330383301  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8763089179992676  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1967, 128])
m.shape torch.Size([1733, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8885927200317383  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8885927200317383  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1733, 128]), torch.Size([1, 1733, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8902454376220703  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.07700252532959  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1733, 128])
m.shape torch.Size([1665, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.089673042297363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.089673042297363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1665, 128]), torch.Size([1, 1665, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.09126091003418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.28523063659668  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1665, 128])
m.shape torch.Size([1513, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.297422885894775  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.297422885894775  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1513, 128]), torch.Size([1, 1513, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.298865795135498  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.484719753265381  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1513, 128])
m.shape torch.Size([1363, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.496346950531006  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.496346950531006  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1363, 128]), torch.Size([1, 1363, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.497646808624268  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.673097610473633  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1363, 128])
m.shape torch.Size([20696, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.8698201179504395  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.8698201179504395  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20696, 128]), torch.Size([1, 20696, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.889557361602783  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.672508716583252  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20696, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.246788501739502  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.270594120025635  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.294399738311768  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.26984977722168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99847, 64])
input nodes number: 152885
output nodes number: 99847
edges number: 964667
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.295549392700195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.319355010986328  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.325306415557861  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.325306415557861  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99847, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.325306415557861  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5130, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.374087333679199  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.374087333679199  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5130, 64]), torch.Size([1, 5130, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.376753807067871  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.397711753845215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5130, 64])
m.shape torch.Size([6031, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.399632930755615  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.399632930755615  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6031, 64]), torch.Size([1, 6031, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.40271520614624  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.446471691131592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6031, 64])
m.shape torch.Size([55186, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.485735893249512  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.485735893249512  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55186, 64]), torch.Size([1, 55186, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.512050628662109  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.090974807739258  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55186, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.048404216766357  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.064222812652588  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.080041408538818  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.063728332519531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66347, 64])
input nodes number: 99847
output nodes number: 66347
edges number: 182750
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.08078670501709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.09660530090332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.100765705108643  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.100765705108643  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3376, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.12328290939331  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.12328290939331  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3376, 64]), torch.Size([1, 3376, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.124892711639404  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.138876914978027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3376, 64])
m.shape torch.Size([2964, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.139657497406006  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.139657497406006  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2964, 64]), torch.Size([1, 2964, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.14107084274292  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.16227102279663  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2964, 64])
m.shape torch.Size([2345, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.16332721710205  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.16332721710205  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2345, 64]), torch.Size([1, 2345, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.164445877075195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.190659046173096  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2345, 64])
m.shape torch.Size([1840, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191977977752686  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191977977752686  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1840, 64]), torch.Size([1, 1840, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.19285535812378  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.222530364990234  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1840, 64])
m.shape torch.Size([12208, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.237375736236572  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.237375736236572  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12208, 64]), torch.Size([1, 12208, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.243749618530273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.454419136047363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12208, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.436298370361328  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.440540790557861  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.443928718566895  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.439516544342041  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22733, 40])
input nodes number: 66347
output nodes number: 22733
edges number: 84739
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.439832210540771  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029840290546417236 |0.005402743816375732 |0.11981302499771118 |0.0008660554885864258 |0.06187033653259277 |0.006611824035644531 |
----------------------------------------------------------pseudo_mini_loss sum 2.0946128368377686
Total (block generation + training)time/epoch 1.587052345275879
Training time/epoch 1.5869085788726807
Training time without block to device /epoch 1.5652976036071777
Training time without total dataloading part /epoch 0.736809492111206
load block tensor time/epoch 0.11936116218566895
block to device time/epoch 0.02161097526550293
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1278096
Number of first layer input nodes during this epoch:  611795
block dataloader generation time/epoch 1.0728836059570312e-06
for loop block_dataloader item  time:  0.14929628372192383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08898019790649414  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08898019790649414  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152725, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08898019790649414  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7491, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5653495788574219  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5653495788574219  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7491, 128]), torch.Size([1, 7491, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5724935531616211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6296453475952148  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7491, 128])
m.shape torch.Size([8746, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6344141960144043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6344141960144043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8746, 128]), torch.Size([1, 8746, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6435637474060059  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.774055004119873  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8746, 128])
m.shape torch.Size([8157, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7816033363342285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7816033363342285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8157, 128]), torch.Size([1, 8157, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7896633148193359  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.961555004119873  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8157, 128])
m.shape torch.Size([7369, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9717206954956055  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9717206954956055  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7369, 128]), torch.Size([1, 7369, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.979182243347168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1830015182495117  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7369, 128])
m.shape torch.Size([6635, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1952977180480957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1952977180480957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6635, 128]), torch.Size([1, 6635, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2020535469055176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4307785034179688  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6635, 128])
m.shape torch.Size([5558, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4435162544250488  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4435162544250488  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5558, 128]), torch.Size([1, 5558, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4493303298950195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6772527694702148  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5558, 128])
m.shape torch.Size([4895, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.690941333770752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.690941333770752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4895, 128]), torch.Size([1, 4895, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6959257125854492  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9301080703735352  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4895, 128])
m.shape torch.Size([4321, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.944209098815918  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.944209098815918  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4321, 128]), torch.Size([1, 4321, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9486637115478516  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.1856489181518555  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4321, 128])
m.shape torch.Size([3849, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.200106620788574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.200106620788574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3849, 128]), torch.Size([1, 3849, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.203777313232422  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.438701629638672  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3849, 128])
m.shape torch.Size([3407, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4531121253967285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4531121253967285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3407, 128]), torch.Size([1, 3407, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.456547737121582  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.6891465187072754  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3407, 128])
m.shape torch.Size([3049, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7038040161132812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7038040161132812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3049, 128]), torch.Size([1, 3049, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7068657875061035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.94064998626709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3049, 128])
m.shape torch.Size([2723, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.954146385192871  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.954146385192871  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2723, 128]), torch.Size([1, 2723, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.956820487976074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.18210506439209  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2723, 128])
m.shape torch.Size([2460, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.1960558891296387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.1960558891296387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2460, 128]), torch.Size([1, 2460, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.1984105110168457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.424360752105713  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2460, 128])
m.shape torch.Size([2133, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4369959831237793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4369959831237793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2133, 128]), torch.Size([1, 2133, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4391160011291504  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.64398193359375  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2133, 128])
m.shape torch.Size([1996, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6571407318115234  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6571407318115234  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1996, 128]), torch.Size([1, 1996, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6590442657470703  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.865072250366211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1996, 128])
m.shape torch.Size([1741, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8774032592773438  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8774032592773438  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1741, 128]), torch.Size([1, 1741, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.879063606262207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.06688117980957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1741, 128])
m.shape torch.Size([1683, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.079693794250488  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.079693794250488  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1683, 128]), torch.Size([1, 1683, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.081298828125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.276006698608398  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1683, 128])
m.shape torch.Size([1558, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.288576602935791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.288576602935791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1558, 128]), torch.Size([1, 1558, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.290062427520752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.478762149810791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1558, 128])
m.shape torch.Size([1345, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.490204811096191  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.490204811096191  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1345, 128]), torch.Size([1, 1345, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.491487503051758  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.667337894439697  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1345, 128])
m.shape torch.Size([20688, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.863992691040039  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.863992691040039  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20688, 128]), torch.Size([1, 20688, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.883722305297852  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.665597915649414  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20688, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.239680290222168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.26347541809082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.287270545959473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.262731552124023  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99804, 64])
input nodes number: 152725
output nodes number: 99804
edges number: 964820
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.288444519042969  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.312239646911621  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.318188667297363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.318188667297363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99804, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.318188667297363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5182, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.366929531097412  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.366929531097412  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5182, 64]), torch.Size([1, 5182, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.369933605194092  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.391591548919678  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5182, 64])
m.shape torch.Size([5952, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.393287658691406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.393287658691406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5952, 64]), torch.Size([1, 5952, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.396400451660156  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.439796447753906  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5952, 64])
m.shape torch.Size([55217, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.479290962219238  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.479290962219238  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55217, 64]), torch.Size([1, 55217, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.505620956420898  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.084872245788574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55217, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.04226303100586  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.058082580566406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.073902130126953  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.05758810043335  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66351, 64])
input nodes number: 99804
output nodes number: 66351
edges number: 182737
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.074646949768066  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.091387271881104  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.094456672668457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.094456672668457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3381, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.11701488494873  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.11701488494873  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3381, 64]), torch.Size([1, 3381, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.118627548217773  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.132878303527832  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3381, 64])
m.shape torch.Size([2924, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.133636951446533  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.133636951446533  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2924, 64]), torch.Size([1, 2924, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.13503122329712  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.155945301055908  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2924, 64])
m.shape torch.Size([2321, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.157001495361328  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.157001495361328  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2321, 64]), torch.Size([1, 2321, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.158108711242676  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.18329381942749  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2321, 64])
m.shape torch.Size([1839, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.184630393981934  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.184630393981934  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1839, 64]), torch.Size([1, 1839, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.185507774353027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.212594032287598  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1839, 64])
m.shape torch.Size([12271, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.227241039276123  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.227241039276123  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12271, 64]), torch.Size([1, 12271, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.233092784881592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.446634292602539  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12271, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.428459167480469  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.43270492553711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.436092853546143  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.431677341461182  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66351
output nodes number: 22736
edges number: 84903
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.433199405670166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028615713119506836 |0.005528926849365234 |0.11954975128173828 |0.0008459091186523438 |0.06151747703552246 |0.006817817687988281 |
----------------------------------------------------------pseudo_mini_loss sum 2.0566821098327637
for loop block_dataloader item  time:  0.5707299709320068
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0899820327758789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0899820327758789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([153011, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0899820327758789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7484, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.56634521484375  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.56634521484375  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7484, 128]), torch.Size([1, 7484, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5734825134277344  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6305809020996094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7484, 128])
m.shape torch.Size([8759, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6353654861450195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6353654861450195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8759, 128]), torch.Size([1, 8759, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6437187194824219  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7742471694946289  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8759, 128])
m.shape torch.Size([8136, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7817893028259277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7817893028259277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8136, 128]), torch.Size([1, 8136, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.789548397064209  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9613699913024902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8136, 128])
m.shape torch.Size([7350, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9715094566345215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9715094566345215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7350, 128]), torch.Size([1, 7350, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9788346290588379  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1829943656921387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7350, 128])
m.shape torch.Size([6651, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1952924728393555  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1952924728393555  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6651, 128]), torch.Size([1, 6651, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2020235061645508  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4305615425109863  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6651, 128])
m.shape torch.Size([5589, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.443380355834961  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.443380355834961  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5589, 128]), torch.Size([1, 5589, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4495124816894531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.678706169128418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5589, 128])
m.shape torch.Size([4944, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6925435066223145  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6925435066223145  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4944, 128]), torch.Size([1, 4944, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.697566032409668  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.933314323425293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4944, 128])
m.shape torch.Size([4373, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9485349655151367  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9485349655151367  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4373, 128]), torch.Size([1, 4373, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9529438018798828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2023062705993652  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4373, 128])
m.shape torch.Size([3867, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2166128158569336  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2166128158569336  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3867, 128]), torch.Size([1, 3867, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2207727432250977  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4613819122314453  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3867, 128])
m.shape torch.Size([3445, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.476133346557617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.476133346557617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3445, 128]), torch.Size([1, 3445, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4795279502868652  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.712791919708252  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3445, 128])
m.shape torch.Size([3022, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7270002365112305  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7270002365112305  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3022, 128]), torch.Size([1, 3022, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7299890518188477  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9664883613586426  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3022, 128])
m.shape torch.Size([2728, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.980492115020752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.980492115020752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2728, 128]), torch.Size([1, 2728, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9831929206848145  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.211116313934326  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2728, 128])
m.shape torch.Size([2462, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2250771522521973  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2250771522521973  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2462, 128]), torch.Size([1, 2462, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2274861335754395  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4546704292297363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2462, 128])
m.shape torch.Size([2149, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.467851161956787  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.467851161956787  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.469968318939209  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.674715995788574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
m.shape torch.Size([1987, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6878819465637207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6878819465637207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1987, 128]), torch.Size([1, 1987, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.68977689743042  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8952956199645996  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1987, 128])
m.shape torch.Size([1740, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.907623291015625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.907623291015625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1740, 128]), torch.Size([1, 1740, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.909282684326172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.096794128417969  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1740, 128])
m.shape torch.Size([1622, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.109112739562988  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.109112739562988  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1622, 128]), torch.Size([1, 1622, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.110659599304199  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.30344295501709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1622, 128])
m.shape torch.Size([1529, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.315793037414551  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.315793037414551  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1529, 128]), torch.Size([1, 1529, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.317251205444336  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.503371238708496  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1529, 128])
m.shape torch.Size([1378, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.515126705169678  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.515126705169678  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1378, 128]), torch.Size([1, 1378, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.5164408683776855  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.692538738250732  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1378, 128])
m.shape torch.Size([20722, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.889502048492432  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.889502048492432  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20722, 128]), torch.Size([1, 20722, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.909264087677002  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.695711612701416  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20722, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.270303726196289  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.294130802154541  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.317957878112793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.293385982513428  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99937, 64])
input nodes number: 153011
output nodes number: 99937
edges number: 965877
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.3191328048706055  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.342959880828857  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.349349498748779  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.349349498748779  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99937, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.349349498748779  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5214, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.398143768310547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.398143768310547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5214, 64]), torch.Size([1, 5214, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.401126861572266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.422334671020508  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5214, 64])
m.shape torch.Size([5874, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.424066543579102  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.424066543579102  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5874, 64]), torch.Size([1, 5874, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.42704963684082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.469610214233398  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5874, 64])
m.shape torch.Size([55323, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.509180545806885  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.509180545806885  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55323, 64]), torch.Size([1, 55323, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.5355610847473145  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.11592435836792  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55323, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.073375225067139  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.089209079742432  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.105042934417725  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.088714122772217  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66411, 64])
input nodes number: 99937
output nodes number: 66411
edges number: 182931
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.105788707733154  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.121622562408447  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.125670909881592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.125670909881592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3453, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.148179531097412  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.148179531097412  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3453, 64]), torch.Size([1, 3453, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.149826526641846  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.164553165435791  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3453, 64])
m.shape torch.Size([2984, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.165219783782959  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.165219783782959  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2984, 64]), torch.Size([1, 2984, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.166642665863037  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.188311576843262  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2984, 64])
m.shape torch.Size([2249, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.189293384552002  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.189293384552002  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2249, 64]), torch.Size([1, 2249, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.190366268157959  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.215688228607178  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2249, 64])
m.shape torch.Size([1786, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.216995239257812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.216995239257812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1786, 64]), torch.Size([1, 1786, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.217846870422363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.244664669036865  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1786, 64])
m.shape torch.Size([12264, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.259315967559814  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.259315967559814  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12264, 64]), torch.Size([1, 12264, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.265174388885498  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.477458477020264  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12264, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.459351062774658  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.46358060836792  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.466968536376953  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.462569236755371  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66411
output nodes number: 22736
edges number: 84632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.463217735290527  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028762340545654297 |0.005605340003967285 |0.11946225166320801 |0.0008490085601806641 |0.06138265132904053 |0.00686192512512207 |
----------------------------------------------------------pseudo_mini_loss sum 2.021310567855835
for loop block_dataloader item  time:  0.950493574142456
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08998441696166992  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08998441696166992  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152950, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08998441696166992  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7452, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.56866455078125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.56866455078125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7452, 128]), torch.Size([1, 7452, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5757713317871094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6326255798339844  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7452, 128])
m.shape torch.Size([8641, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6373128890991211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6373128890991211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8641, 128]), torch.Size([1, 8641, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6455535888671875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7691640853881836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8641, 128])
m.shape torch.Size([8205, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7767810821533203  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7767810821533203  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8205, 128]), torch.Size([1, 8205, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7846059799194336  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9567537307739258  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8205, 128])
m.shape torch.Size([7410, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9669747352600098  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9669747352600098  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7410, 128]), torch.Size([1, 7410, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9743466377258301  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1811027526855469  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7410, 128])
m.shape torch.Size([6667, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.193464756011963  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.193464756011963  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6667, 128]), torch.Size([1, 6667, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.20042085647583  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4443011283874512  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6667, 128])
m.shape torch.Size([5603, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4571523666381836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4571523666381836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5603, 128]), torch.Size([1, 5603, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.46331787109375  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6930856704711914  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5603, 128])
m.shape torch.Size([4909, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7067995071411133  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7067995071411133  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4909, 128]), torch.Size([1, 4909, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7118120193481445  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9461278915405273  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4909, 128])
m.shape torch.Size([4345, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9603471755981445  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9603471755981445  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4345, 128]), torch.Size([1, 4345, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9647102355957031  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2035984992980957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4345, 128])
m.shape torch.Size([3813, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.217005729675293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.217005729675293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3813, 128]), torch.Size([1, 3813, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.22086238861084  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.455404758453369  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3813, 128])
m.shape torch.Size([3471, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.470137596130371  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.470137596130371  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3471, 128]), torch.Size([1, 3471, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.473475456237793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7096738815307617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3471, 128])
m.shape torch.Size([3055, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7240428924560547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7240428924560547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3055, 128]), torch.Size([1, 3055, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7270073890686035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.964621067047119  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3055, 128])
m.shape torch.Size([2708, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9786596298217773  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9786596298217773  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2708, 128]), torch.Size([1, 2708, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9813342094421387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.20338773727417  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2708, 128])
m.shape torch.Size([2477, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2172889709472656  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2172889709472656  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2477, 128]), torch.Size([1, 2477, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.219738483428955  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.447465419769287  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2477, 128])
m.shape torch.Size([2165, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4607372283935547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4607372283935547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2165, 128]), torch.Size([1, 2165, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4628543853759766  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6776695251464844  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2165, 128])
m.shape torch.Size([1976, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6907706260681152  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6907706260681152  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1976, 128]), torch.Size([1, 1976, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.692655086517334  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8979010581970215  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1976, 128])
m.shape torch.Size([1743, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.910256862640381  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.910256862640381  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1743, 128]), torch.Size([1, 1743, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.911919116973877  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.099803447723389  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1743, 128])
m.shape torch.Size([1680, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.112590789794922  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.112590789794922  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1680, 128]), torch.Size([1, 1680, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.114192962646484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.308895111083984  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1680, 128])
m.shape torch.Size([1554, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.321432113647461  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.321432113647461  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1554, 128]), torch.Size([1, 1554, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.322914123535156  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.511219024658203  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1554, 128])
m.shape torch.Size([1334, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.522563934326172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.522563934326172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1334, 128]), torch.Size([1, 1334, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.523836135864258  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.697795867919922  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1334, 128])
m.shape torch.Size([20973, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.897173881530762  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.897173881530762  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20973, 128]), torch.Size([1, 20973, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.91717529296875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.737374305725098  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20973, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.309408664703369  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.333293914794922  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.357179164886475  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.332547187805176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100181, 64])
input nodes number: 152950
output nodes number: 100181
edges number: 971570
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.358471393585205  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.382356643676758  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.3883280754089355  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.3883280754089355  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100181, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.3883280754089355  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5220, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.437501430511475  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.437501430511475  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5220, 64]), torch.Size([1, 5220, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4407057762146  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.462409973144531  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5220, 64])
m.shape torch.Size([5890, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.463956832885742  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.463956832885742  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5890, 64]), torch.Size([1, 5890, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.467397689819336  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.511503219604492  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5890, 64])
m.shape torch.Size([55511, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.551208019256592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.551208019256592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55511, 64]), torch.Size([1, 55511, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.577678203582764  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.160013675689697  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55511, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.116841793060303  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.132725715637207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.148609638214111  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.132229328155518  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66621, 64])
input nodes number: 100181
output nodes number: 66621
edges number: 183533
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.149357318878174  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.165241241455078  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.16927719116211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.16927719116211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3368, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191821098327637  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191821098327637  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3368, 64]), torch.Size([1, 3368, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.193427085876465  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.207284927368164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3368, 64])
m.shape torch.Size([2934, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.208246231079102  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.208246231079102  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2934, 64]), torch.Size([1, 2934, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.20964527130127  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.230630874633789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2934, 64])
m.shape torch.Size([2345, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.231730937957764  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.231730937957764  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2345, 64]), torch.Size([1, 2345, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.232849597930908  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.25834846496582  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2345, 64])
m.shape torch.Size([1855, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.259662628173828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.259662628173828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1855, 64]), torch.Size([1, 1855, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.260547637939453  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.286776542663574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1855, 64])
m.shape torch.Size([12234, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.301373958587646  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.301373958587646  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12234, 64]), torch.Size([1, 12234, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.307486057281494  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.518880367279053  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12234, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.50058889389038  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.504698753356934  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.508086681365967  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.503807067871094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66621
output nodes number: 22736
edges number: 84861
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.503631591796875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0291897455851237 |0.005571524302164714 |0.12024974822998047 |0.0008594989776611328 |0.06170201301574707 |0.00677180290222168 |
----------------------------------------------------------pseudo_mini_loss sum 1.9640506505966187
for loop block_dataloader item  time:  1.3469157218933105
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08918523788452148  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08918523788452148  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152989, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08918523788452148  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7300, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.568516731262207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.568516731262207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7300, 128]), torch.Size([1, 7300, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5754785537719727  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6311731338500977  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7300, 128])
m.shape torch.Size([8742, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6360292434692383  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6360292434692383  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8742, 128]), torch.Size([1, 8742, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6443662643432617  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.774846076965332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8742, 128])
m.shape torch.Size([8278, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7825193405151367  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7825193405151367  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8278, 128]), torch.Size([1, 8278, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7904138565063477  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9640932083129883  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8278, 128])
m.shape torch.Size([7360, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9741840362548828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9741840362548828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7360, 128]), torch.Size([1, 7360, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9813899993896484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1866388320922852  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7360, 128])
m.shape torch.Size([6672, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1990365982055664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1990365982055664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6672, 128]), torch.Size([1, 6672, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2058000564575195  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4495840072631836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6672, 128])
m.shape torch.Size([5676, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.462641716003418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.462641716003418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5676, 128]), torch.Size([1, 5676, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.468183994293213  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.720165729522705  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5676, 128])
m.shape torch.Size([4947, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.733078956604004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.733078956604004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4947, 128]), torch.Size([1, 4947, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7379546165466309  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9738459587097168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4947, 128])
m.shape torch.Size([4368, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.989065170288086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.989065170288086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4368, 128]), torch.Size([1, 4368, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9934139251708984  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2370986938476562  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4368, 128])
m.shape torch.Size([3812, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2511749267578125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2511749267578125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3812, 128]), torch.Size([1, 3812, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2549405097961426  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4910473823547363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3812, 128])
m.shape torch.Size([3427, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.505570888519287  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.505570888519287  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3427, 128]), torch.Size([1, 3427, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.5089430809020996  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.742691993713379  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3427, 128])
m.shape torch.Size([3055, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.757081985473633  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.757081985473633  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3055, 128]), torch.Size([1, 3055, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7601380348205566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.001223564147949  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3055, 128])
m.shape torch.Size([2753, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.014925956726074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.014925956726074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2753, 128]), torch.Size([1, 2753, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.017605781555176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.243863582611084  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2753, 128])
m.shape torch.Size([2519, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2581658363342285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2581658363342285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2519, 128]), torch.Size([1, 2519, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2606821060180664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.486720085144043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2519, 128])
m.shape torch.Size([2187, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.5002455711364746  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.5002455711364746  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2187, 128]), torch.Size([1, 2187, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.5023622512817383  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.7175145149230957  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2187, 128])
m.shape torch.Size([2005, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.7308125495910645  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.7308125495910645  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2005, 128]), torch.Size([1, 2005, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.732724666595459  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.938689708709717  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2005, 128])
m.shape torch.Size([1738, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.950993537902832  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.950993537902832  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1738, 128]), torch.Size([1, 1738, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.952651023864746  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.140172004699707  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1738, 128])
m.shape torch.Size([1686, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.153010368347168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.153010368347168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1686, 128]), torch.Size([1, 1686, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.154618263244629  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.349457740783691  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1686, 128])
m.shape torch.Size([1566, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.362094879150391  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.362094879150391  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1566, 128]), torch.Size([1, 1566, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.363588333129883  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.55354118347168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1566, 128])
m.shape torch.Size([1352, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.5650434494018555  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.5650434494018555  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1352, 128]), torch.Size([1, 1352, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.566332817077637  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.742832183837891  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1352, 128])
m.shape torch.Size([20907, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.941572189331055  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.941572189331055  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20907, 128]), torch.Size([1, 20907, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.96151065826416  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.772834777832031  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20907, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.342432498931885  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.366357803344727  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.390283107757568  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.365610122680664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100350, 64])
input nodes number: 152989
output nodes number: 100350
edges number: 973192
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.391485214233398  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.41541051864624  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.42139196395874  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.42139196395874  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100350, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.42139196395874  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5008, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.470521926879883  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.470521926879883  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5008, 64]), torch.Size([1, 5008, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.473368167877197  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.494069576263428  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5008, 64])
m.shape torch.Size([5934, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.495523929595947  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.495523929595947  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5934, 64]), torch.Size([1, 5934, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.498484134674072  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.542097568511963  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5934, 64])
m.shape torch.Size([55775, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.581991195678711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.581991195678711  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55775, 64]), torch.Size([1, 55775, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.608587265014648  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.193692207336426  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55775, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.150527477264404  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.166434288024902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.1823410987854  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.165936946868896  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66717, 64])
input nodes number: 100350
output nodes number: 66717
edges number: 184201
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.18308973312378  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.198996543884277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.203055381774902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.203055381774902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3226, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.225748062133789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.225748062133789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3226, 64]), torch.Size([1, 3226, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.227286338806152  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.240534782409668  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3226, 64])
m.shape torch.Size([2864, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.241418361663818  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.241418361663818  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2864, 64]), torch.Size([1, 2864, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.242784023284912  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.264118194580078  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2864, 64])
m.shape torch.Size([2362, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.265305995941162  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.265305995941162  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2362, 64]), torch.Size([1, 2362, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.266432285308838  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.291930675506592  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2362, 64])
m.shape torch.Size([1840, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.293338298797607  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.293338298797607  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1840, 64]), torch.Size([1, 1840, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.294215679168701  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.322052001953125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1840, 64])
m.shape torch.Size([12441, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.336907863616943  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.336907863616943  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12441, 64]), torch.Size([1, 12441, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.342840671539307  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.559058666229248  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12441, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.540012836456299  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.544154644012451  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.547542572021484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.543231010437012  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22733, 40])
input nodes number: 66717
output nodes number: 22733
edges number: 85605
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.544651985168457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02925419807434082 |0.005555510520935059 |0.1212460994720459 |0.000874638557434082 |0.06220602989196777 |0.0068776607513427734 |
----------------------------------------------------------pseudo_mini_loss sum 1.8938851356506348
Total (block generation + training)time/epoch 1.5886509418487549
Training time/epoch 1.5901696681976318
Training time without block to device /epoch 1.5679476261138916
Training time without total dataloading part /epoch 0.7441847324371338
load block tensor time/epoch 0.11701679229736328
block to device time/epoch 0.022222042083740234
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  1278047
Number of first layer input nodes during this epoch:  611675
block dataloader generation time/epoch 1.0331471761067708e-06
for loop block_dataloader item  time:  0.20493674278259277
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08993816375732422  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08993816375732422  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([153015, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08993816375732422  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7483, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5685825347900391  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5685825347900391  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7483, 128]), torch.Size([1, 7483, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5766820907592773  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6337728500366211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7483, 128])
m.shape torch.Size([8793, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6385903358459473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6385903358459473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8793, 128]), torch.Size([1, 8793, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6469759941101074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7776017189025879  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8793, 128])
m.shape torch.Size([8258, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.785222053527832  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.785222053527832  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8258, 128]), torch.Size([1, 8258, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7930974960327148  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9663572311401367  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8258, 128])
m.shape torch.Size([7400, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9765338897705078  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9765338897705078  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7400, 128]), torch.Size([1, 7400, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9837102890014648  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1900367736816406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7400, 128])
m.shape torch.Size([6637, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2023320198059082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2023320198059082  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6637, 128]), torch.Size([1, 6637, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.208998203277588  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4373936653137207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6637, 128])
m.shape torch.Size([5554, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4501190185546875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4501190185546875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5554, 128]), torch.Size([1, 5554, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4562273025512695  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.683985710144043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5554, 128])
m.shape torch.Size([4960, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6978931427001953  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6978931427001953  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4960, 128]), torch.Size([1, 4960, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.702906608581543  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.939417839050293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4960, 128])
m.shape torch.Size([4375, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9546308517456055  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9546308517456055  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4375, 128]), torch.Size([1, 4375, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9590797424316406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2026333808898926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4375, 128])
m.shape torch.Size([3820, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.216768741607666  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.216768741607666  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3820, 128]), torch.Size([1, 3820, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2204232215881348  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4576926231384277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3820, 128])
m.shape torch.Size([3428, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4722647666931152  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4722647666931152  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3428, 128]), torch.Size([1, 3428, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.475644588470459  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7157163619995117  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3428, 128])
m.shape torch.Size([3043, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7300429344177246  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7300429344177246  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3043, 128]), torch.Size([1, 3043, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7330427169799805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9719481468200684  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3043, 128])
m.shape torch.Size([2745, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.985781669616699  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.985781669616699  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2745, 128]), torch.Size([1, 2745, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.988450050354004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.212688446044922  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2745, 128])
m.shape torch.Size([2476, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2267279624938965  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2267279624938965  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2476, 128]), torch.Size([1, 2476, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2291407585144043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.454845428466797  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2476, 128])
m.shape torch.Size([2180, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4682178497314453  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4682178497314453  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2180, 128]), torch.Size([1, 2180, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4704599380493164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6822710037231445  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2180, 128])
m.shape torch.Size([2033, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6949524879455566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6949524879455566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2033, 128]), torch.Size([1, 2033, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6968913078308105  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.903550624847412  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2033, 128])
m.shape torch.Size([1777, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9161386489868164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9161386489868164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1777, 128]), torch.Size([1, 1777, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9178333282470703  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.109402656555176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1777, 128])
m.shape torch.Size([1652, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.121946811676025  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.121946811676025  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1652, 128]), torch.Size([1, 1652, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.1235222816467285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.3175835609436035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1652, 128])
m.shape torch.Size([1551, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.330108165740967  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.330108165740967  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1551, 128]), torch.Size([1, 1551, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.331587314605713  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.5198750495910645  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1551, 128])
m.shape torch.Size([1332, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.531203269958496  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.531203269958496  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1332, 128]), torch.Size([1, 1332, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.532473564147949  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.705239295959473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1332, 128])
m.shape torch.Size([20888, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.903807640075684  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.903807640075684  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20888, 128]), torch.Size([1, 20888, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.923727989196777  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.732497215270996  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20888, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.305126190185547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.329060077667236  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.352993965148926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.328311920166016  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100385, 64])
input nodes number: 153015
output nodes number: 100385
edges number: 971450
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.354169845581055  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.378103733062744  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.384087562561035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.384087562561035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100385, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.384087562561035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5201, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.433306694030762  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.433306694030762  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5201, 64]), torch.Size([1, 5201, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.436304569244385  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.457921504974365  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5201, 64])
m.shape torch.Size([6002, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.459163188934326  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.459163188934326  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6002, 64]), torch.Size([1, 6002, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.462657451629639  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.50758695602417  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6002, 64])
m.shape torch.Size([55778, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.547482490539551  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.547482490539551  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55778, 64]), torch.Size([1, 55778, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.574079513549805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.15921401977539  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55778, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.115780353546143  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.131750106811523  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.147719860076904  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.131250858306885  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66981, 64])
input nodes number: 100385
output nodes number: 66981
edges number: 184539
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.148468971252441  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.164438724517822  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.168631553649902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.168631553649902  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3328, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191264629364014  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191264629364014  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3328, 64]), torch.Size([1, 3328, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.192851543426514  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.206861019134521  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3328, 64])
m.shape torch.Size([2913, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.207858562469482  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.207858562469482  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2913, 64]), torch.Size([1, 2913, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.209248065948486  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.23047161102295  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2913, 64])
m.shape torch.Size([2256, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.231608867645264  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.231608867645264  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2256, 64]), torch.Size([1, 2256, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.23268461227417  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.257499694824219  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2256, 64])
m.shape torch.Size([1854, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.258798599243164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.258798599243164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1854, 64]), torch.Size([1, 1854, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.259682655334473  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.28622817993164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1854, 64])
m.shape torch.Size([12385, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.30101203918457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.30101203918457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12385, 64]), torch.Size([1, 12385, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.306918144226074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.520423889160156  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12385, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.502136707305908  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.505655765533447  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.50904369354248  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.505354881286621  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66981
output nodes number: 22736
edges number: 85263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.505401134490967  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02971053123474121 |0.005564212799072266 |0.12149691581726074 |0.0008857250213623047 |0.06289553642272949 |0.0069692134857177734 |
----------------------------------------------------------pseudo_mini_loss sum 1.8932931423187256
for loop block_dataloader item  time:  0.5858299732208252
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0891580581665039  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0891580581665039  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152809, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.0891580581665039  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7455, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5651793479919434  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5651793479919434  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7455, 128]), torch.Size([1, 7455, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.572288990020752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6291661262512207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7455, 128])
m.shape torch.Size([8709, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6339168548583984  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6339168548583984  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8709, 128]), torch.Size([1, 8709, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6422224044799805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7726078033447266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8709, 128])
m.shape torch.Size([8215, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7802066802978516  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7802066802978516  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8215, 128]), torch.Size([1, 8215, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7880411148071289  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9603986740112305  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8215, 128])
m.shape torch.Size([7346, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9704928398132324  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9704928398132324  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7346, 128]), torch.Size([1, 7346, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.977790355682373  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1828956604003906  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7346, 128])
m.shape torch.Size([6691, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.195345401763916  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.195345401763916  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6691, 128]), torch.Size([1, 6691, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.202171802520752  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4460711479187012  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6691, 128])
m.shape torch.Size([5627, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.458979606628418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.458979606628418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5627, 128]), torch.Size([1, 5627, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4651269912719727  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6958789825439453  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5627, 128])
m.shape torch.Size([4821, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7092876434326172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7092876434326172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4821, 128]), torch.Size([1, 4821, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7142696380615234  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9477462768554688  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4821, 128])
m.shape torch.Size([4327, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9617290496826172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9617290496826172  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4327, 128]), torch.Size([1, 4327, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9660234451293945  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.205259323120117  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4327, 128])
m.shape torch.Size([3826, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.218653678894043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.218653678894043  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3826, 128]), torch.Size([1, 3826, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2224721908569336  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4574437141418457  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3826, 128])
m.shape torch.Size([3426, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4719557762145996  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4719557762145996  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3426, 128]), torch.Size([1, 3426, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4752230644226074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7091755867004395  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3426, 128])
m.shape torch.Size([2990, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7230801582336426  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7230801582336426  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2990, 128]), torch.Size([1, 2990, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7260375022888184  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9623165130615234  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2990, 128])
m.shape torch.Size([2715, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.976426124572754  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.976426124572754  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2715, 128]), torch.Size([1, 2715, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9792308807373047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2011008262634277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2715, 128])
m.shape torch.Size([2455, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2149124145507812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2149124145507812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2455, 128]), torch.Size([1, 2455, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.217410087585449  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4444680213928223  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2455, 128])
m.shape torch.Size([2177, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4578304290771484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4578304290771484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2177, 128]), torch.Size([1, 2177, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4599390029907227  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.675717353820801  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2177, 128])
m.shape torch.Size([1977, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6888198852539062  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6888198852539062  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1977, 128]), torch.Size([1, 1977, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6907052993774414  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8959760665893555  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1977, 128])
m.shape torch.Size([1726, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9082016944885254  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9082016944885254  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1726, 128]), torch.Size([1, 1726, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9098477363586426  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.095850467681885  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1726, 128])
m.shape torch.Size([1686, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.108694553375244  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.108694553375244  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1686, 128]), torch.Size([1, 1686, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.110302448272705  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.305141925811768  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1686, 128])
m.shape torch.Size([1530, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.317470073699951  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.317470073699951  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1530, 128]), torch.Size([1, 1530, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.318929195404053  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.50610876083374  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1530, 128])
m.shape torch.Size([1380, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.517881870269775  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.517881870269775  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1380, 128]), torch.Size([1, 1380, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.519197940826416  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.695567607879639  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1380, 128])
m.shape torch.Size([20762, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.892911434173584  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.892911434173584  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20762, 128]), torch.Size([1, 20762, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.9127116203308105  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.704537868499756  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20762, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.279051780700684  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.302855968475342  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.32666015625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.302111625671387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99841, 64])
input nodes number: 152809
output nodes number: 99841
edges number: 965972
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.327955722808838  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.351759910583496  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.35813045501709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.35813045501709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([99841, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.35813045501709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5172, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.406986236572266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.406986236572266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5172, 64]), torch.Size([1, 5172, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.409816741943359  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.430856704711914  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5172, 64])
m.shape torch.Size([5932, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.43272066116333  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.43272066116333  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5932, 64]), torch.Size([1, 5932, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.435551166534424  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.477985858917236  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5932, 64])
m.shape torch.Size([55231, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.517490386962891  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.517490386962891  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55231, 64]), torch.Size([1, 55231, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.543827056884766  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.123225212097168  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55231, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.080939292907715  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.096755027770996  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.112570762634277  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.09626054763794  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66335, 64])
input nodes number: 99841
output nodes number: 66335
edges number: 182729
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.113316059112549  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.12913179397583  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.133105754852295  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.133105754852295  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3431, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.155617713928223  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.155617713928223  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3431, 64]), torch.Size([1, 3431, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.157254219055176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.171502113342285  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3431, 64])
m.shape torch.Size([2942, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.17214298248291  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.17214298248291  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2942, 64]), torch.Size([1, 2942, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.173545837402344  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.195029735565186  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2942, 64])
m.shape torch.Size([2326, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.196145057678223  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.196145057678223  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2326, 64]), torch.Size([1, 2326, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.197254180908203  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.222879409790039  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2326, 64])
m.shape torch.Size([1813, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.22420358657837  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.22420358657837  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1813, 64]), torch.Size([1, 1813, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.22506856918335  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.253573894500732  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1813, 64])
m.shape torch.Size([12224, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.268168926239014  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.268168926239014  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12224, 64]), torch.Size([1, 12224, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.274531841278076  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.48649263381958  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12224, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.468386173248291  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.472596645355225  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.475984573364258  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.471604347229004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66335
output nodes number: 22736
edges number: 84665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.472959995269775  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029183626174926758 |0.005468964576721191 |0.12208199501037598 |0.0008600950241088867 |0.06224870681762695 |0.0070841312408447266 |
----------------------------------------------------------pseudo_mini_loss sum 1.85769784450531
for loop block_dataloader item  time:  0.9698307514190674
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08989095687866211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08989095687866211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152800, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08989095687866211  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7354, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.568321704864502  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.568321704864502  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7354, 128]), torch.Size([1, 7354, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5753350257873535  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.631441593170166  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7354, 128])
m.shape torch.Size([8705, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6362366676330566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6362366676330566  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8705, 128]), torch.Size([1, 8705, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.644538402557373  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7749123573303223  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8705, 128])
m.shape torch.Size([8270, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7825918197631836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7825918197631836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8270, 128]), torch.Size([1, 8270, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7904787063598633  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9639902114868164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8270, 128])
m.shape torch.Size([7266, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9739055633544922  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9739055633544922  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7266, 128]), torch.Size([1, 7266, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9811544418334961  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1840543746948242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7266, 128])
m.shape torch.Size([6592, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1963062286376953  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.1963062286376953  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6592, 128]), torch.Size([1, 6592, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2031402587890625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4300537109375  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6592, 128])
m.shape torch.Size([5555, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4428033828735352  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4428033828735352  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5555, 128]), torch.Size([1, 5555, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4488091468811035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6766085624694824  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5555, 128])
m.shape torch.Size([4874, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6902284622192383  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6902284622192383  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4874, 128]), torch.Size([1, 4874, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6952013969421387  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9291834831237793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4874, 128])
m.shape torch.Size([4442, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9443392753601074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9443392753601074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4442, 128]), torch.Size([1, 4442, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9489169120788574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.1941123008728027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4442, 128])
m.shape torch.Size([3885, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2081985473632812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2081985473632812  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3885, 128]), torch.Size([1, 3885, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.212038993835449  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.449160575866699  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3885, 128])
m.shape torch.Size([3412, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4635777473449707  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4635777473449707  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3412, 128]), torch.Size([1, 3412, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4669089317321777  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.70704984664917  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3412, 128])
m.shape torch.Size([3054, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.721264362335205  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.721264362335205  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3054, 128]), torch.Size([1, 3054, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.724461078643799  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9609570503234863  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3054, 128])
m.shape torch.Size([2733, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.97517728805542  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.97517728805542  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2733, 128]), torch.Size([1, 2733, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.977811336517334  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2007570266723633  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2733, 128])
m.shape torch.Size([2434, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2145419120788574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2145419120788574  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2434, 128]), torch.Size([1, 2434, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2169394493103027  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4439711570739746  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2434, 128])
m.shape torch.Size([2194, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.456495761871338  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.456495761871338  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2194, 128]), torch.Size([1, 2194, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.458681583404541  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6677956581115723  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2194, 128])
m.shape torch.Size([1953, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6806411743164062  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6806411743164062  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1953, 128]), torch.Size([1, 1953, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6825037002563477  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.887179374694824  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1953, 128])
m.shape torch.Size([1717, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8993477821350098  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.8993477821350098  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1717, 128]), torch.Size([1, 1717, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9009852409362793  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.08645486831665  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1717, 128])
m.shape torch.Size([1681, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.099262714385986  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.099262714385986  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1681, 128]), torch.Size([1, 1681, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.100865840911865  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.295384883880615  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1681, 128])
m.shape torch.Size([1571, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.308067321777344  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.308067321777344  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1571, 128]), torch.Size([1, 1571, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.309565544128418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.501839637756348  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1571, 128])
m.shape torch.Size([1365, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.513457298278809  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.513457298278809  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1365, 128]), torch.Size([1, 1365, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.514759063720703  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.690989971160889  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1365, 128])
m.shape torch.Size([20959, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.890219688415527  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.890219688415527  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20959, 128]), torch.Size([1, 20959, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.910207748413086  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.728524208068848  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20959, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.30090856552124  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.324754238128662  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.348599910736084  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.324008941650391  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100016, 64])
input nodes number: 152800
output nodes number: 100016
edges number: 971152
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.349761486053467  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.373607158660889  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.379568576812744  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.379568576812744  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100016, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.379568576812744  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5114, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.428470134735107  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.428470134735107  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5114, 64]), torch.Size([1, 5114, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4310832023620605  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.451588153839111  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5114, 64])
m.shape torch.Size([5956, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.453514099121094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.453514099121094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5956, 64]), torch.Size([1, 5956, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4566192626953125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.500094413757324  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5956, 64])
m.shape torch.Size([55439, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.539501667022705  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.539501667022705  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55439, 64]), torch.Size([1, 55439, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.565937519073486  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.147517681121826  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55439, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.104994297027588  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.120851516723633  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.136708736419678  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.120355606079102  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66509, 64])
input nodes number: 100016
output nodes number: 66509
edges number: 183343
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.137454986572266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.15331220626831  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.157463073730469  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.157463073730469  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3312, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.180005073547363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.180005073547363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3312, 64]), torch.Size([1, 3312, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.181584358215332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.195290088653564  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3312, 64])
m.shape torch.Size([2981, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.196001529693604  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.196001529693604  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2981, 64]), torch.Size([1, 2981, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.197423458099365  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.218746662139893  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2981, 64])
m.shape torch.Size([2389, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.219815731048584  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.219815731048584  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2389, 64]), torch.Size([1, 2389, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.22095537185669  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.246993064880371  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2389, 64])
m.shape torch.Size([1808, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.248233795166016  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.248233795166016  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1808, 64]), torch.Size([1, 1808, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.249095916748047  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.275610446929932  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1808, 64])
m.shape torch.Size([12246, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.290234088897705  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.290234088897705  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12246, 64]), torch.Size([1, 12246, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.29664421081543  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.508417129516602  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12246, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.489469528198242  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.493167400360107  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.49655532836914  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.492687702178955  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22736, 40])
input nodes number: 66509
output nodes number: 22736
edges number: 84903
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.492840766906738  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02903890609741211 |0.005552609761555989 |0.12229355176289876 |0.0008599758148193359 |0.06232388814290365 |0.0070400238037109375 |
----------------------------------------------------------pseudo_mini_loss sum 1.8221032619476318
for loop block_dataloader item  time:  1.3560340404510498
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08945941925048828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08945941925048828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([152976, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.08945941925048828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([7403, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5677304267883301  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5677304267883301  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7403, 128]), torch.Size([1, 7403, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.5747904777526855  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6312708854675293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7403, 128])
m.shape torch.Size([8783, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6361169815063477  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6361169815063477  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8783, 128]), torch.Size([1, 8783, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.6444931030273438  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.775090217590332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8783, 128])
m.shape torch.Size([8198, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7826294898986816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7826294898986816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 8198, 128]), torch.Size([1, 8198, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.7904477119445801  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9626455307006836  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 8198, 128])
m.shape torch.Size([7408, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9728660583496094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9728660583496094  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 7408, 128]), torch.Size([1, 7408, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 0.9801092147827148  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.186838150024414  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 7408, 128])
m.shape torch.Size([6640, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.199136734008789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.199136734008789  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 6640, 128]), torch.Size([1, 6640, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.2058219909667969  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.434330940246582  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 6640, 128])
m.shape torch.Size([5628, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4472665786743164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4472665786743164  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5628, 128]), torch.Size([1, 5628, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.4533047676086426  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6840977668762207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5628, 128])
m.shape torch.Size([4945, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6979198455810547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.6979198455810547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4945, 128]), torch.Size([1, 4945, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.7029614448547363  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9387574195861816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4945, 128])
m.shape torch.Size([4413, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9539775848388672  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9539775848388672  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 4413, 128]), torch.Size([1, 4413, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 1.9584178924560547  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.2045021057128906  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 4413, 128])
m.shape torch.Size([3838, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.218686103820801  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.218686103820801  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3838, 128]), torch.Size([1, 3838, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.222569465637207  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.462655544281006  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3838, 128])
m.shape torch.Size([3429, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4771761894226074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4771761894226074  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3429, 128]), torch.Size([1, 3429, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.4805588722229004  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.718174457550049  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3429, 128])
m.shape torch.Size([3096, 11, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.732778549194336  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.732778549194336  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3096, 128]), torch.Size([1, 3096, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.7357425689697266  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.973104953765869  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3096, 128])
m.shape torch.Size([2736, 12, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.98714017868042  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.98714017868042  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2736, 128]), torch.Size([1, 2736, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 2.9899864196777344  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.216362953186035  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2736, 128])
m.shape torch.Size([2451, 13, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2302517890930176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2302517890930176  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2451, 128]), torch.Size([1, 2451, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.2326626777648926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4589619636535645  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2451, 128])
m.shape torch.Size([2158, 14, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.471817970275879  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.471817970275879  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2158, 128]), torch.Size([1, 2158, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.4739341735839844  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.679811477661133  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2158, 128])
m.shape torch.Size([2006, 15, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6931304931640625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6931304931640625  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2006, 128]), torch.Size([1, 2006, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.6950435638427734  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.901033401489258  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2006, 128])
m.shape torch.Size([1722, 16, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.913214683532715  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.913214683532715  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1722, 128]), torch.Size([1, 1722, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 3.9148569107055664  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.101370811462402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1722, 128])
m.shape torch.Size([1663, 17, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.114030361175537  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.114030361175537  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1663, 128]), torch.Size([1, 1663, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.115616321563721  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.309929370880127  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1663, 128])
m.shape torch.Size([1527, 18, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.322242736816406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.322242736816406  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1527, 128]), torch.Size([1, 1527, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.323698997497559  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.5113630294799805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1527, 128])
m.shape torch.Size([1365, 19, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.523001670837402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.523001670837402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1365, 128]), torch.Size([1, 1365, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.524303436279297  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.698902606964111  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1365, 128])
m.shape torch.Size([20855, 20, 128])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.8971405029296875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.8971405029296875  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 20855, 128]), torch.Size([1, 20855, 128])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 4.91702938079834  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.72136116027832  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 20855, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.293935298919678  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.317840099334717  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.341744899749756  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.3170928955078125  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100264, 64])
input nodes number: 152976
output nodes number: 100264
edges number: 970311
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.342914581298828  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.366819381713867  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.372795581817627  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.372795581817627  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([100264, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.372795581817627  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([5108, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.421716213226318  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.421716213226318  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5108, 64]), torch.Size([1, 5108, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.424191951751709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.443917751312256  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5108, 64])
m.shape torch.Size([5850, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4459333419799805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4459333419799805  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 5850, 64]), torch.Size([1, 5850, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.4493842124938965  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.494968891143799  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 5850, 64])
m.shape torch.Size([55623, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.533975601196289  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.533975601196289  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 55623, 64]), torch.Size([1, 55623, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 7.56049919128418  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.144009590148926  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 55623, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.100905895233154  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.116780281066895  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.132654666900635  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.116283893585205  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([66581, 64])
input nodes number: 100264
output nodes number: 66581
edges number: 183677
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.133402824401855  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.149277210235596  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.153285026550293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.153285026550293  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

m.shape torch.Size([3357, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.175904273986816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.175904273986816  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 3357, 64]), torch.Size([1, 3357, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.177505493164062  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.191380977630615  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 3357, 64])
m.shape torch.Size([2870, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.192679405212402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.192679405212402  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2870, 64]), torch.Size([1, 2870, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.194047927856445  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.21457576751709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2870, 64])
m.shape torch.Size([2306, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.215999603271484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.215999603271484  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 2306, 64]), torch.Size([1, 2306, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.2170991897583  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.242866516113281  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 2306, 64])
m.shape torch.Size([1845, 4, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.24436092376709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.24436092376709  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 1845, 64]), torch.Size([1, 1845, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.245241165161133  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.27140998840332  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 1845, 64])
m.shape torch.Size([12355, 5, 64])
----------------------------------------1
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.286159038543701  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.286159038543701  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

 h.shape torch.Size([1, 12355, 64]), torch.Size([1, 12355, 64])
----------------------------------------3
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.292050838470459  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.507137775421143  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

rst.shape  torch.Size([1, 12355, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.488128662109375  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.492295265197754  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.495683193206787  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.491346836090088  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

torch.Size([22733, 40])
input nodes number: 66581
output nodes number: 22733
edges number: 85170
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9637451171875 GB
    Memory Allocated: 8.492481708526611  GigaBytes
Max Memory Allocated: 8.613468170166016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0296364426612854 |0.0055065155029296875 |0.1328149437904358 |0.0008790493011474609 |0.06227654218673706 |0.006947994232177734 |
----------------------------------------------------------pseudo_mini_loss sum 1.780312180519104
Total (block generation + training)time/epoch 1.6057251294453938
Training time/epoch 1.6397924423217773
Training time without block to device /epoch 1.6177663803100586
Training time without total dataloading part /epoch 0.790830135345459
load block tensor time/epoch 0.1185457706451416
block to device time/epoch 0.02202606201171875
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  1278512
Number of first layer input nodes during this epoch:  611600
