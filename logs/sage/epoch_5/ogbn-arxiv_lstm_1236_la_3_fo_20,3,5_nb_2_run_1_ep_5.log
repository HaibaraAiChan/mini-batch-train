main start at this time 1649566408.293316
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
for loop block_dataloader item  time:  0.35451316833496094
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1883544921875 GB
    Memory Allocated: 0.09023904800415039  GigaBytes
Max Memory Allocated: 0.09023904800415039  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1883544921875 GB
    Memory Allocated: 0.09023904800415039  GigaBytes
Max Memory Allocated: 0.09023904800415039  GigaBytes

torch.Size([160325, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1883544921875 GB
    Memory Allocated: 0.09023904800415039  GigaBytes
Max Memory Allocated: 0.09023904800415039  GigaBytes

m.shape torch.Size([11723, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.9012451171875 GB
    Memory Allocated: 0.6623210906982422  GigaBytes
Max Memory Allocated: 0.6750273704528809  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9012451171875 GB
    Memory Allocated: 0.6623210906982422  GigaBytes
Max Memory Allocated: 0.6750273704528809  GigaBytes

 h.shape torch.Size([1, 11723, 128]), torch.Size([1, 11723, 128])
----------------------------------------3
 Nvidia-smi: 2.9012451171875 GB
    Memory Allocated: 0.6735010147094727  GigaBytes
Max Memory Allocated: 0.6750273704528809  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9930419921875 GB
    Memory Allocated: 0.7629404067993164  GigaBytes
Max Memory Allocated: 0.7685303688049316  GigaBytes

rst.shape  torch.Size([1, 11723, 128])
m.shape torch.Size([12490, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.0067138671875 GB
    Memory Allocated: 0.7692618370056152  GigaBytes
Max Memory Allocated: 0.7695417404174805  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0067138671875 GB
    Memory Allocated: 0.7692618370056152  GigaBytes
Max Memory Allocated: 0.7695417404174805  GigaBytes

 h.shape torch.Size([1, 12490, 128]), torch.Size([1, 12490, 128])
----------------------------------------3
 Nvidia-smi: 3.0067138671875 GB
    Memory Allocated: 0.7811732292175293  GigaBytes
Max Memory Allocated: 0.7811732292175293  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2176513671875 GB
    Memory Allocated: 0.9598441123962402  GigaBytes
Max Memory Allocated: 0.9717555046081543  GigaBytes

rst.shape  torch.Size([1, 12490, 128])
m.shape torch.Size([11099, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.2352294921875 GB
    Memory Allocated: 0.9697656631469727  GigaBytes
Max Memory Allocated: 0.9717555046081543  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2352294921875 GB
    Memory Allocated: 0.9697656631469727  GigaBytes
Max Memory Allocated: 0.9717555046081543  GigaBytes

 h.shape torch.Size([1, 11099, 128]), torch.Size([1, 11099, 128])
----------------------------------------3
 Nvidia-smi: 3.2352294921875 GB
    Memory Allocated: 0.9813113212585449  GigaBytes
Max Memory Allocated: 0.9813113212585449  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4852294921875 GB
    Memory Allocated: 1.2170100212097168  GigaBytes
Max Memory Allocated: 1.2328872680664062  GigaBytes

rst.shape  torch.Size([1, 11099, 128])
m.shape torch.Size([9498, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.5047607421875 GB
    Memory Allocated: 1.2298336029052734  GigaBytes
Max Memory Allocated: 1.2328872680664062  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5047607421875 GB
    Memory Allocated: 1.2298336029052734  GigaBytes
Max Memory Allocated: 1.2328872680664062  GigaBytes

 h.shape torch.Size([1, 9498, 128]), torch.Size([1, 9498, 128])
----------------------------------------3
 Nvidia-smi: 3.5047607421875 GB
    Memory Allocated: 1.2396550178527832  GigaBytes
Max Memory Allocated: 1.2396550178527832  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7977294921875 GB
    Memory Allocated: 1.5023369789123535  GigaBytes
Max Memory Allocated: 1.5204529762268066  GigaBytes

rst.shape  torch.Size([1, 9498, 128])
m.shape torch.Size([8266, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8192138671875 GB
    Memory Allocated: 1.5175156593322754  GigaBytes
Max Memory Allocated: 1.5204529762268066  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8192138671875 GB
    Memory Allocated: 1.5175156593322754  GigaBytes
Max Memory Allocated: 1.5204529762268066  GigaBytes

 h.shape torch.Size([1, 8266, 128]), torch.Size([1, 8266, 128])
----------------------------------------3
 Nvidia-smi: 3.8192138671875 GB
    Memory Allocated: 1.5259242057800293  GigaBytes
Max Memory Allocated: 1.5259242057800293  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.8103022575378418  GigaBytes
Max Memory Allocated: 1.830009937286377  GigaBytes

rst.shape  torch.Size([1, 8266, 128])
m.shape torch.Size([6848, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.8259530067443848  GigaBytes
Max Memory Allocated: 1.830009937286377  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.8259530067443848  GigaBytes
Max Memory Allocated: 1.830009937286377  GigaBytes

 h.shape torch.Size([1, 6848, 128]), torch.Size([1, 6848, 128])
----------------------------------------3
 Nvidia-smi: 4.1453857421875 GB
    Memory Allocated: 1.8333721160888672  GigaBytes
Max Memory Allocated: 1.8333721160888672  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4520263671875 GB
    Memory Allocated: 2.126856803894043  GigaBytes
Max Memory Allocated: 2.146449089050293  GigaBytes

rst.shape  torch.Size([1, 6848, 128])
m.shape torch.Size([6001, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.4520263671875 GB
    Memory Allocated: 2.1436219215393066  GigaBytes
Max Memory Allocated: 2.146449089050293  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4520263671875 GB
    Memory Allocated: 2.1436219215393066  GigaBytes
Max Memory Allocated: 2.146449089050293  GigaBytes

 h.shape torch.Size([1, 6001, 128]), torch.Size([1, 6001, 128])
----------------------------------------3
 Nvidia-smi: 4.4520263671875 GB
    Memory Allocated: 2.1498169898986816  GigaBytes
Max Memory Allocated: 2.1498169898986816  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7703857421875 GB
    Memory Allocated: 2.441007614135742  GigaBytes
Max Memory Allocated: 2.461038112640381  GigaBytes

rst.shape  torch.Size([1, 6001, 128])
m.shape torch.Size([5225, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.7703857421875 GB
    Memory Allocated: 2.458077907562256  GigaBytes
Max Memory Allocated: 2.461038112640381  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7703857421875 GB
    Memory Allocated: 2.458077907562256  GigaBytes
Max Memory Allocated: 2.461038112640381  GigaBytes

 h.shape torch.Size([1, 5225, 128]), torch.Size([1, 5225, 128])
----------------------------------------3
 Nvidia-smi: 4.7703857421875 GB
    Memory Allocated: 2.463700771331787  GigaBytes
Max Memory Allocated: 2.463700771331787  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1239013671875 GB
    Memory Allocated: 2.7483396530151367  GigaBytes
Max Memory Allocated: 2.7682714462280273  GigaBytes

rst.shape  torch.Size([1, 5225, 128])
m.shape torch.Size([4649, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.1239013671875 GB
    Memory Allocated: 2.7657995223999023  GigaBytes
Max Memory Allocated: 2.7682714462280273  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1239013671875 GB
    Memory Allocated: 2.7657995223999023  GigaBytes
Max Memory Allocated: 2.7682714462280273  GigaBytes

 h.shape torch.Size([1, 4649, 128]), torch.Size([1, 4649, 128])
----------------------------------------3
 Nvidia-smi: 5.1239013671875 GB
    Memory Allocated: 2.77048921585083  GigaBytes
Max Memory Allocated: 2.77048921585083  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4383544921875 GB
    Memory Allocated: 3.0562829971313477  GigaBytes
Max Memory Allocated: 3.0762343406677246  GigaBytes

rst.shape  torch.Size([1, 4649, 128])
m.shape torch.Size([4132, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4383544921875 GB
    Memory Allocated: 3.0737690925598145  GigaBytes
Max Memory Allocated: 3.0762343406677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4383544921875 GB
    Memory Allocated: 3.0737690925598145  GigaBytes
Max Memory Allocated: 3.0762343406677246  GigaBytes

 h.shape torch.Size([1, 4132, 128]), torch.Size([1, 4132, 128])
----------------------------------------3
 Nvidia-smi: 5.4383544921875 GB
    Memory Allocated: 3.0778627395629883  GigaBytes
Max Memory Allocated: 3.0778627395629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7528076171875 GB
    Memory Allocated: 3.358644962310791  GigaBytes
Max Memory Allocated: 3.378347873687744  GigaBytes

rst.shape  torch.Size([1, 4132, 128])
m.shape torch.Size([3614, 11, 128])
----------------------------------------1
 Nvidia-smi: 5.7528076171875 GB
    Memory Allocated: 3.3756308555603027  GigaBytes
Max Memory Allocated: 3.378347873687744  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7528076171875 GB
    Memory Allocated: 3.3756308555603027  GigaBytes
Max Memory Allocated: 3.378347873687744  GigaBytes

 h.shape torch.Size([1, 3614, 128]), torch.Size([1, 3614, 128])
----------------------------------------3
 Nvidia-smi: 5.7528076171875 GB
    Memory Allocated: 3.379136562347412  GigaBytes
Max Memory Allocated: 3.379136562347412  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1043701171875 GB
    Memory Allocated: 3.6488709449768066  GigaBytes
Max Memory Allocated: 3.6684021949768066  GigaBytes

rst.shape  torch.Size([1, 3614, 128])
m.shape torch.Size([3267, 12, 128])
----------------------------------------1
 Nvidia-smi: 6.1043701171875 GB
    Memory Allocated: 3.6666054725646973  GigaBytes
Max Memory Allocated: 3.6684021949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1043701171875 GB
    Memory Allocated: 3.6666054725646973  GigaBytes
Max Memory Allocated: 3.6684021949768066  GigaBytes

 h.shape torch.Size([1, 3267, 128]), torch.Size([1, 3267, 128])
----------------------------------------3
 Nvidia-smi: 6.1043701171875 GB
    Memory Allocated: 3.6697354316711426  GigaBytes
Max Memory Allocated: 3.6697354316711426  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3582763671875 GB
    Memory Allocated: 3.948805809020996  GigaBytes
Max Memory Allocated: 3.968337059020996  GigaBytes

rst.shape  torch.Size([1, 3267, 128])
m.shape torch.Size([2962, 13, 128])
----------------------------------------1
 Nvidia-smi: 6.3582763671875 GB
    Memory Allocated: 3.9653682708740234  GigaBytes
Max Memory Allocated: 3.968337059020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3582763671875 GB
    Memory Allocated: 3.9653682708740234  GigaBytes
Max Memory Allocated: 3.968337059020996  GigaBytes

 h.shape torch.Size([1, 2962, 128]), torch.Size([1, 2962, 128])
----------------------------------------3
 Nvidia-smi: 6.3582763671875 GB
    Memory Allocated: 3.968198776245117  GigaBytes
Max Memory Allocated: 3.968337059020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5145263671875 GB
    Memory Allocated: 4.235132217407227  GigaBytes
Max Memory Allocated: 4.253493309020996  GigaBytes

rst.shape  torch.Size([1, 2962, 128])
m.shape torch.Size([2605, 14, 128])
----------------------------------------1
 Nvidia-smi: 6.5145263671875 GB
    Memory Allocated: 4.250710487365723  GigaBytes
Max Memory Allocated: 4.253493309020996  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5145263671875 GB
    Memory Allocated: 4.250710487365723  GigaBytes
Max Memory Allocated: 4.253493309020996  GigaBytes

 h.shape torch.Size([1, 2605, 128]), torch.Size([1, 2605, 128])
----------------------------------------3
 Nvidia-smi: 6.5145263671875 GB
    Memory Allocated: 4.254334449768066  GigaBytes
Max Memory Allocated: 4.254334449768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8055419921875 GB
    Memory Allocated: 4.509328842163086  GigaBytes
Max Memory Allocated: 4.526906967163086  GigaBytes

rst.shape  torch.Size([1, 2605, 128])
m.shape torch.Size([2362, 15, 128])
----------------------------------------1
 Nvidia-smi: 6.8055419921875 GB
    Memory Allocated: 4.525664806365967  GigaBytes
Max Memory Allocated: 4.526906967163086  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8055419921875 GB
    Memory Allocated: 4.525664806365967  GigaBytes
Max Memory Allocated: 4.526906967163086  GigaBytes

 h.shape torch.Size([1, 2362, 128]), torch.Size([1, 2362, 128])
----------------------------------------3
 Nvidia-smi: 6.8055419921875 GB
    Memory Allocated: 4.527985572814941  GigaBytes
Max Memory Allocated: 4.527985572814941  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9989013671875 GB
    Memory Allocated: 4.77246618270874  GigaBytes
Max Memory Allocated: 4.79004430770874  GigaBytes

rst.shape  torch.Size([1, 2362, 128])
m.shape torch.Size([2067, 16, 128])
----------------------------------------1
 Nvidia-smi: 6.9989013671875 GB
    Memory Allocated: 4.787109851837158  GigaBytes
Max Memory Allocated: 4.79004430770874  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9989013671875 GB
    Memory Allocated: 4.787109851837158  GigaBytes
Max Memory Allocated: 4.79004430770874  GigaBytes

 h.shape torch.Size([1, 2067, 128]), torch.Size([1, 2067, 128])
----------------------------------------3
 Nvidia-smi: 6.9989013671875 GB
    Memory Allocated: 4.7892022132873535  GigaBytes
Max Memory Allocated: 4.79004430770874  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2508544921875 GB
    Memory Allocated: 5.021162509918213  GigaBytes
Max Memory Allocated: 5.036932468414307  GigaBytes

rst.shape  torch.Size([1, 2067, 128])
m.shape torch.Size([2022, 17, 128])
----------------------------------------1
 Nvidia-smi: 7.2508544921875 GB
    Memory Allocated: 5.035745143890381  GigaBytes
Max Memory Allocated: 5.036932468414307  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2508544921875 GB
    Memory Allocated: 5.035745143890381  GigaBytes
Max Memory Allocated: 5.036932468414307  GigaBytes

 h.shape torch.Size([1, 2022, 128]), torch.Size([1, 2022, 128])
----------------------------------------3
 Nvidia-smi: 7.2508544921875 GB
    Memory Allocated: 5.037673473358154  GigaBytes
Max Memory Allocated: 5.037673473358154  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5184326171875 GB
    Memory Allocated: 5.271552562713623  GigaBytes
Max Memory Allocated: 5.287943363189697  GigaBytes

rst.shape  torch.Size([1, 2022, 128])
m.shape torch.Size([1872, 18, 128])
----------------------------------------1
 Nvidia-smi: 7.5184326171875 GB
    Memory Allocated: 5.286655902862549  GigaBytes
Max Memory Allocated: 5.287943363189697  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5184326171875 GB
    Memory Allocated: 5.286655902862549  GigaBytes
Max Memory Allocated: 5.287943363189697  GigaBytes

 h.shape torch.Size([1, 1872, 128]), torch.Size([1, 1872, 128])
----------------------------------------3
 Nvidia-smi: 7.5203857421875 GB
    Memory Allocated: 5.288441181182861  GigaBytes
Max Memory Allocated: 5.288441181182861  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7703857421875 GB
    Memory Allocated: 5.515552997589111  GigaBytes
Max Memory Allocated: 5.531620502471924  GigaBytes

rst.shape  torch.Size([1, 1872, 128])
m.shape torch.Size([1656, 19, 128])
----------------------------------------1
 Nvidia-smi: 7.7703857421875 GB
    Memory Allocated: 5.529663562774658  GigaBytes
Max Memory Allocated: 5.531620502471924  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7703857421875 GB
    Memory Allocated: 5.529663562774658  GigaBytes
Max Memory Allocated: 5.531620502471924  GigaBytes

 h.shape torch.Size([1, 1656, 128]), torch.Size([1, 1656, 128])
----------------------------------------3
 Nvidia-smi: 7.7703857421875 GB
    Memory Allocated: 5.531242847442627  GigaBytes
Max Memory Allocated: 5.531620502471924  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0047607421875 GB
    Memory Allocated: 5.7480854988098145  GigaBytes
Max Memory Allocated: 5.763088703155518  GigaBytes

rst.shape  torch.Size([1, 1656, 128])
m.shape torch.Size([24032, 20, 128])
----------------------------------------1
 Nvidia-smi: 8.2352294921875 GB
    Memory Allocated: 5.97648286819458  GigaBytes
Max Memory Allocated: 5.9825663566589355  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2352294921875 GB
    Memory Allocated: 5.97648286819458  GigaBytes
Max Memory Allocated: 5.9825663566589355  GigaBytes

 h.shape torch.Size([1, 24032, 128]), torch.Size([1, 24032, 128])
----------------------------------------3
 Nvidia-smi: 8.2469482421875 GB
    Memory Allocated: 5.999660968780518  GigaBytes
Max Memory Allocated: 5.999660968780518  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.7821044921875 GB
    Memory Allocated: 9.242092609405518  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

rst.shape  torch.Size([1, 24032, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.733789443969727  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.763923168182373  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.79405689239502  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.762981414794922  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

torch.Size([126390, 64])
input nodes number: 160325
output nodes number: 126390
edges number: 1159988
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.795300006866455  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.825433731079102  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.832967281341553  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.832967281341553  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

torch.Size([126390, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.832967281341553  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

m.shape torch.Size([9510, 1, 64])
----------------------------------------1
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.906070232391357  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.906070232391357  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

 h.shape torch.Size([1, 9510, 64]), torch.Size([1, 9510, 64])
----------------------------------------3
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.911147594451904  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.948315620422363  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

rst.shape  torch.Size([1, 9510, 64])
m.shape torch.Size([10147, 2, 64])
----------------------------------------1
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.951113224029541  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.951113224029541  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

 h.shape torch.Size([1, 10147, 64]), torch.Size([1, 10147, 64])
----------------------------------------3
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 8.957240104675293  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 9.030349254608154  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

rst.shape  torch.Size([1, 10147, 64])
m.shape torch.Size([80564, 3, 64])
----------------------------------------1
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 9.086912155151367  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 9.086912155151367  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

 h.shape torch.Size([1, 80564, 64]), torch.Size([1, 80564, 64])
----------------------------------------3
 Nvidia-smi: 11.7840576171875 GB
    Memory Allocated: 9.125328063964844  GigaBytes
Max Memory Allocated: 9.471279621124268  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3699951171875 GB
    Memory Allocated: 9.971447944641113  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

rst.shape  torch.Size([1, 80564, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3953857421875 GB
    Memory Allocated: 9.908889770507812  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3953857421875 GB
    Memory Allocated: 9.93278455734253  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3953857421875 GB
    Memory Allocated: 9.956679344177246  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 12.3953857421875 GB
    Memory Allocated: 9.932037830352783  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

torch.Size([100221, 64])
input nodes number: 126390
output nodes number: 100221
edges number: 271496
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 12.3953857421875 GB
    Memory Allocated: 9.957622051239014  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 12.3953857421875 GB
    Memory Allocated: 9.98151683807373  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 12.4207763671875 GB
    Memory Allocated: 9.988173007965088  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.4207763671875 GB
    Memory Allocated: 9.988173007965088  GigaBytes
Max Memory Allocated: 10.030041694641113  GigaBytes

m.shape torch.Size([6774, 1, 64])
----------------------------------------1
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.03387975692749  GigaBytes
Max Memory Allocated: 10.03416919708252  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.03387975692749  GigaBytes
Max Memory Allocated: 10.03416919708252  GigaBytes

 h.shape torch.Size([1, 6774, 64]), torch.Size([1, 6774, 64])
----------------------------------------3
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.03723669052124  GigaBytes
Max Memory Allocated: 10.03723669052124  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.063331127166748  GigaBytes
Max Memory Allocated: 10.065009593963623  GigaBytes

rst.shape  torch.Size([1, 6774, 64])
m.shape torch.Size([5887, 2, 64])
----------------------------------------1
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.064613342285156  GigaBytes
Max Memory Allocated: 10.065009593963623  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.064613342285156  GigaBytes
Max Memory Allocated: 10.065009593963623  GigaBytes

 h.shape torch.Size([1, 5887, 64]), torch.Size([1, 5887, 64])
----------------------------------------3
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.067605018615723  GigaBytes
Max Memory Allocated: 10.067605018615723  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.111454486846924  GigaBytes
Max Memory Allocated: 10.114261627197266  GigaBytes

rst.shape  torch.Size([1, 5887, 64])
m.shape torch.Size([4636, 3, 64])
----------------------------------------1
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.113821506500244  GigaBytes
Max Memory Allocated: 10.114261627197266  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.113821506500244  GigaBytes
Max Memory Allocated: 10.114261627197266  GigaBytes

 h.shape torch.Size([1, 4636, 64]), torch.Size([1, 4636, 64])
----------------------------------------3
 Nvidia-smi: 12.4617919921875 GB
    Memory Allocated: 10.11629056930542  GigaBytes
Max Memory Allocated: 10.11629056930542  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4813232421875 GB
    Memory Allocated: 10.166401863098145  GigaBytes
Max Memory Allocated: 10.170152187347412  GigaBytes

rst.shape  torch.Size([1, 4636, 64])
m.shape torch.Size([3677, 4, 64])
----------------------------------------1
 Nvidia-smi: 12.4813232421875 GB
    Memory Allocated: 10.168968677520752  GigaBytes
Max Memory Allocated: 10.170152187347412  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4813232421875 GB
    Memory Allocated: 10.168968677520752  GigaBytes
Max Memory Allocated: 10.170152187347412  GigaBytes

 h.shape torch.Size([1, 3677, 64]), torch.Size([1, 3677, 64])
----------------------------------------3
 Nvidia-smi: 12.4813232421875 GB
    Memory Allocated: 10.170722484588623  GigaBytes
Max Memory Allocated: 10.170722484588623  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5301513671875 GB
    Memory Allocated: 10.222084522247314  GigaBytes
Max Memory Allocated: 10.22559118270874  GigaBytes

rst.shape  torch.Size([1, 3677, 64])
m.shape torch.Size([24497, 5, 64])
----------------------------------------1
 Nvidia-smi: 12.5594482421875 GB
    Memory Allocated: 10.25141716003418  GigaBytes
Max Memory Allocated: 10.25187349319458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5594482421875 GB
    Memory Allocated: 10.25141716003418  GigaBytes
Max Memory Allocated: 10.25187349319458  GigaBytes

 h.shape torch.Size([1, 24497, 64]), torch.Size([1, 24497, 64])
----------------------------------------3
 Nvidia-smi: 12.5594482421875 GB
    Memory Allocated: 10.263935089111328  GigaBytes
Max Memory Allocated: 10.263935089111328  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0184326171875 GB
    Memory Allocated: 10.685586929321289  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 24497, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.0301513671875 GB
    Memory Allocated: 10.648886680603027  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.0301513671875 GB
    Memory Allocated: 10.655662536621094  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.0301513671875 GB
    Memory Allocated: 10.66243839263916  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.0301513671875 GB
    Memory Allocated: 10.655323505401611  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

torch.Size([45471, 40])
input nodes number: 100221
output nodes number: 45471
edges number: 169649
-----------------------------------------after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.0301513671875 GB
    Memory Allocated: 10.663185119628906  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04327130317687988 |0.3484766483306885 |0.6688847541809082 |0.0001418590545654297 |0.0823976993560791 |0.01117396354675293 |
----------------------------------------------------------pseudo_mini_loss sum 4.948383808135986
for loop block_dataloader item  time:  1.8141865730285645
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1922607421875 GB
    Memory Allocated: 0.10018205642700195  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.1922607421875 GB
    Memory Allocated: 0.10018205642700195  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

torch.Size([160144, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.1922607421875 GB
    Memory Allocated: 0.10018205642700195  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

m.shape torch.Size([11597, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.6746354103088379  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.6746354103088379  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 11597, 128]), torch.Size([1, 11597, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.6863541603088379  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.7761502265930176  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 11597, 128])
m.shape torch.Size([12529, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.7819099426269531  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.7819099426269531  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 12529, 128]), torch.Size([1, 12529, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.7940731048583984  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.973301887512207  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 12529, 128])
m.shape torch.Size([11145, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.9832706451416016  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.9832706451416016  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 11145, 128]), torch.Size([1, 11145, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 0.9947595596313477  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.2323541641235352  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 11145, 128])
m.shape torch.Size([9487, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.2451348304748535  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.2451348304748535  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 9487, 128]), torch.Size([1, 9487, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.2549729347229004  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.517350673675537  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 9487, 128])
m.shape torch.Size([8305, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.5326275825500488  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.5326275825500488  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 8305, 128]), torch.Size([1, 8305, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.5405478477478027  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.8256773948669434  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 8305, 128])
m.shape torch.Size([6872, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.8413782119750977  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.8413782119750977  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 6872, 128]), torch.Size([1, 6872, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 1.8489751815795898  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.143714427947998  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 6872, 128])
m.shape torch.Size([6019, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.1605281829833984  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.1605281829833984  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 6019, 128]), torch.Size([1, 6019, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.1669979095458984  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.460134983062744  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 6019, 128])
m.shape torch.Size([5323, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.4775705337524414  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.4775705337524414  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 5323, 128]), torch.Size([1, 5323, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.482913017272949  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.7734365463256836  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 5323, 128])
m.shape torch.Size([4590, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.7905964851379395  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.7905964851379395  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 4590, 128]), torch.Size([1, 4590, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 2.795323371887207  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.0760021209716797  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 4590, 128])
m.shape torch.Size([4130, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.0935068130493164  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.0935068130493164  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 4130, 128]), torch.Size([1, 4130, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.097550392150879  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.3778367042541504  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 4130, 128])
m.shape torch.Size([3633, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.3953986167907715  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.3953986167907715  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 3633, 128]), torch.Size([1, 3633, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.398873805999756  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.6699748039245605  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 3633, 128])
m.shape torch.Size([3244, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.6876988410949707  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.6876988410949707  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 3244, 128]), torch.Size([1, 3244, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.690830707550049  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.965458869934082  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 3244, 128])
m.shape torch.Size([2980, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.982365608215332  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.982365608215332  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 2980, 128]), torch.Size([1, 2980, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 3.9852380752563477  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.251319885253906  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 2980, 128])
m.shape torch.Size([2627, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.266968727111816  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.266968727111816  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 2627, 128]), torch.Size([1, 2627, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.269604682922363  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.531235694885254  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 2627, 128])
m.shape torch.Size([2370, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.5461931228637695  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.5461931228637695  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 2370, 128]), torch.Size([1, 2370, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.548506259918213  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.794513702392578  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 2370, 128])
m.shape torch.Size([2122, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.809573173522949  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.809573173522949  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 2122, 128]), torch.Size([1, 2122, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 4.8117218017578125  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.047715187072754  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 2122, 128])
m.shape torch.Size([2020, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.063077926635742  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.063077926635742  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 2020, 128]), torch.Size([1, 2020, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.065004348754883  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.298578262329102  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 2020, 128])
m.shape torch.Size([1876, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.313716888427734  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.313716888427734  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 1876, 128]), torch.Size([1, 1876, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.3155059814453125  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.543415069580078  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 1876, 128])
m.shape torch.Size([1620, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.557197570800781  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.557197570800781  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 1620, 128]), torch.Size([1, 1620, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.558742523193359  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.766439437866211  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 1620, 128])
m.shape torch.Size([24203, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.996484756469727  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 5.996484756469727  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 24203, 128]), torch.Size([1, 24203, 128])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 6.019566535949707  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.317851066589355  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 24203, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.80722713470459  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.837432861328125  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.86763858795166  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.836488723754883  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

torch.Size([126692, 64])
input nodes number: 160144
output nodes number: 126692
edges number: 1164981
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.868892192840576  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.899097919464111  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.907088279724121  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.907088279724121  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

torch.Size([126692, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.907088279724121  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

m.shape torch.Size([9402, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.981267929077148  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.981267929077148  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 9402, 64]), torch.Size([1, 9402, 64])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 8.986676216125488  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.022582530975342  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 9402, 64])
m.shape torch.Size([10174, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.025402545928955  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.025402545928955  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 10174, 64]), torch.Size([1, 10174, 64])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.030487060546875  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.10372018814087  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 10174, 64])
m.shape torch.Size([80892, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.161731719970703  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.161731719970703  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 80892, 64]), torch.Size([1, 80892, 64])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.20030403137207  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.048894882202148  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 80892, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 9.986738681793213  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.010692119598389  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.034645557403564  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.00994348526001  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

torch.Size([100468, 64])
input nodes number: 126692
output nodes number: 100468
edges number: 272426
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.035590648651123  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.059544086456299  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.065532684326172  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.065532684326172  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

m.shape torch.Size([6654, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.111154079437256  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.111154079437256  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 6654, 64]), torch.Size([1, 6654, 64])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.114434719085693  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.14003324508667  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 6654, 64])
m.shape torch.Size([5819, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.141254425048828  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.141254425048828  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 5819, 64]), torch.Size([1, 5819, 64])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.144128799438477  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.18769645690918  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 5819, 64])
m.shape torch.Size([4641, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.190311431884766  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.190311431884766  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 4641, 64]), torch.Size([1, 4641, 64])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.193328380584717  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.24836015701294  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 4641, 64])
m.shape torch.Size([3643, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.250144958496094  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.250144958496094  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 3643, 64]), torch.Size([1, 3643, 64])
----------------------------------------3
 Nvidia-smi: 13.7489013671875 GB
    Memory Allocated: 10.251882553100586  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7508544921875 GB
    Memory Allocated: 10.306864738464355  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

rst.shape  torch.Size([1, 3643, 64])
m.shape torch.Size([24713, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.336377143859863  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.336377143859863  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

 h.shape torch.Size([1, 24713, 64]), torch.Size([1, 24713, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.348161697387695  GigaBytes
Max Memory Allocated: 10.714883804321289  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.772391319274902  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 24713, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.735031604766846  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.741807460784912  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.748583316802979  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.74146842956543  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([45470, 40])
input nodes number: 100468
output nodes number: 45470
edges number: 170352
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.742556095123291  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.033179521560668945 |0.17733776569366455 |0.4105738401412964 |0.0006233453750610352 |0.07615160942077637 |0.006209135055541992 |
----------------------------------------------------------pseudo_mini_loss sum 3.8585760593414307
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  774240
Number of first layer input nodes during this epoch:  320469
for loop block_dataloader item  time:  0.2898705005645752
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09979581832885742  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09979581832885742  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([160209, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09979581832885742  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

m.shape torch.Size([11637, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6734256744384766  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6734256744384766  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 11637, 128]), torch.Size([1, 11637, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6851444244384766  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7751693725585938  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 11637, 128])
m.shape torch.Size([12578, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7816157341003418  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7816157341003418  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 12578, 128]), torch.Size([1, 12578, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7937831878662109  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9737129211425781  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 12578, 128])
m.shape torch.Size([11125, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9836297035217285  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9836297035217285  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 11125, 128]), torch.Size([1, 11125, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9948997497558594  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2327790260314941  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 11125, 128])
m.shape torch.Size([9511, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.245615005493164  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.245615005493164  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 9511, 128]), torch.Size([1, 9511, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.254685401916504  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5177268981933594  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 9511, 128])
m.shape torch.Size([8314, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5330138206481934  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5330138206481934  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 8314, 128]), torch.Size([1, 8314, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.541513442993164  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8269519805908203  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 8314, 128])
m.shape torch.Size([6913, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8427658081054688  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8427658081054688  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 6913, 128]), torch.Size([1, 6913, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8503456115722656  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.144069194793701  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 6913, 128])
m.shape torch.Size([6013, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1608433723449707  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1608433723449707  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 6013, 128]), torch.Size([1, 6013, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1667823791503906  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.459501266479492  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 6013, 128])
m.shape torch.Size([5233, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.476346492767334  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.476346492767334  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 5233, 128]), torch.Size([1, 5233, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4816431999206543  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7673797607421875  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 5233, 128])
m.shape torch.Size([4637, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7847843170166016  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7847843170166016  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 4637, 128]), torch.Size([1, 4637, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7895383834838867  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0733165740966797  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 4637, 128])
m.shape torch.Size([4111, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0907082557678223  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0907082557678223  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 4111, 128]), torch.Size([1, 4111, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.094909191131592  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.374574661254883  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 4111, 128])
m.shape torch.Size([3615, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3921456336975098  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3921456336975098  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 3615, 128]), torch.Size([1, 3615, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.395620822906494  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.664860248565674  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 3615, 128])
m.shape torch.Size([3292, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6826539039611816  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6826539039611816  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 3292, 128]), torch.Size([1, 3292, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6859006881713867  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.965134620666504  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 3292, 128])
m.shape torch.Size([2961, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.98164701461792  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.98164701461792  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2961, 128]), torch.Size([1, 2961, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9845829010009766  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.257195949554443  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2961, 128])
m.shape torch.Size([2602, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.273154258728027  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.273154258728027  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2602, 128]), torch.Size([1, 2602, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.275637626647949  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.526491165161133  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2602, 128])
m.shape torch.Size([2379, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.541346073150635  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.541346073150635  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2379, 128]), torch.Size([1, 2379, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.5436692237854  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.78892183303833  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2379, 128])
m.shape torch.Size([2113, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.803908348083496  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.803908348083496  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.805937767028809  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.03790283203125  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([2004, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.053140163421631  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.053140163421631  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2004, 128]), torch.Size([1, 2004, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.055051326751709  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.288171291351318  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2004, 128])
m.shape torch.Size([1866, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.303231716156006  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.303231716156006  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.30501127243042  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.531960964202881  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1621, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.545757293701172  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.545757293701172  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 1621, 128]), torch.Size([1, 1621, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.547303199768066  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.755118370056152  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 1621, 128])
m.shape torch.Size([24104, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.984814167022705  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.984814167022705  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 24104, 128]), torch.Size([1, 24104, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.007801532745361  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.304386615753174  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 24104, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.794609069824219  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.82480001449585  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.85499095916748  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.823856353759766  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([126629, 64])
input nodes number: 160209
output nodes number: 126629
edges number: 1162276
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.856232643127441  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.886423587799072  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.894461154937744  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.894461154937744  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([126629, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.894461154937744  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

m.shape torch.Size([9394, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.96845006942749  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.96845006942749  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 9394, 64]), torch.Size([1, 9394, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.973556995391846  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.009448051452637  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 9394, 64])
m.shape torch.Size([10173, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.012609004974365  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.012609004974365  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 10173, 64]), torch.Size([1, 10173, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.017760276794434  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.090524673461914  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 10173, 64])
m.shape torch.Size([80807, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.148535251617432  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.148535251617432  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 80807, 64]), torch.Size([1, 80807, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.18706750869751  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.03476858139038  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 80807, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.972672939300537  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.996603965759277  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.020534992218018  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.995855808258057  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([100374, 64])
input nodes number: 126629
output nodes number: 100374
edges number: 272161
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.021479606628418  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.045410633087158  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.051580429077148  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.051580429077148  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

m.shape torch.Size([6655, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.09673023223877  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.09673023223877  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 6655, 64]), torch.Size([1, 6655, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.10019063949585  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.126083850860596  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 6655, 64])
m.shape torch.Size([5883, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.127241134643555  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.127241134643555  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 5883, 64]), torch.Size([1, 5883, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.130160331726074  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.174192428588867  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 5883, 64])
m.shape torch.Size([4734, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.17673397064209  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.17673397064209  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 4734, 64]), torch.Size([1, 4734, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.179050922393799  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.234188079833984  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 4734, 64])
m.shape torch.Size([3631, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.236065864562988  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.236065864562988  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 3631, 64]), torch.Size([1, 3631, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.237797737121582  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.291974067687988  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 3631, 64])
m.shape torch.Size([24568, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.321320533752441  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.321320533752441  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 24568, 64]), torch.Size([1, 24568, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.333035469055176  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.755920886993408  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 24568, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.718320846557617  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.725096702575684  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.73187255859375  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.724757671356201  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([45471, 40])
input nodes number: 100374
output nodes number: 45471
edges number: 169987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.725844860076904  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.031365394592285156 |0.0077648162841796875 |0.13387298583984375 |0.0007956027984619141 |0.06936264038085938 |0.006661653518676758 |
----------------------------------------------------------pseudo_mini_loss sum 3.127164602279663
for loop block_dataloader item  time:  0.7948858737945557
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09984874725341797  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09984874725341797  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([160243, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09984874725341797  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

m.shape torch.Size([11747, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6735444068908691  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6735444068908691  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 11747, 128]), torch.Size([1, 11747, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6852631568908691  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7759175300598145  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 11747, 128])
m.shape torch.Size([12534, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7822694778442383  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7822694778442383  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 12534, 128]), torch.Size([1, 12534, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7943634986877441  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9736638069152832  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 12534, 128])
m.shape torch.Size([11142, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9836258888244629  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9836258888244629  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 11142, 128]), torch.Size([1, 11142, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.994969367980957  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2329778671264648  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 11142, 128])
m.shape torch.Size([9574, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2459259033203125  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2459259033203125  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 9574, 128]), torch.Size([1, 9574, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.255056381225586  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5198402404785156  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 9574, 128])
m.shape torch.Size([8303, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5350708961486816  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5350708961486816  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 8303, 128]), torch.Size([1, 8303, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.543595314025879  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8286561965942383  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 8303, 128])
m.shape torch.Size([6927, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.844515323638916  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.844515323638916  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 6927, 128]), torch.Size([1, 6927, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8521161079406738  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.145944595336914  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 6927, 128])
m.shape torch.Size([5973, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.162578582763672  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.162578582763672  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 5973, 128]), torch.Size([1, 5973, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1684794425964355  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4611220359802246  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 5973, 128])
m.shape torch.Size([5279, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4784116744995117  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4784116744995117  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 5279, 128]), torch.Size([1, 5279, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.483588218688965  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.771608352661133  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 5279, 128])
m.shape torch.Size([4648, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7890381813049316  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7890381813049316  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 4648, 128]), torch.Size([1, 4648, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7938199043273926  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.078183650970459  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 4648, 128])
m.shape torch.Size([4146, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0957369804382324  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0957369804382324  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 4146, 128]), torch.Size([1, 4146, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0998644828796387  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3816351890563965  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 4146, 128])
m.shape torch.Size([3660, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3991894721984863  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3991894721984863  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 3660, 128]), torch.Size([1, 3660, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.4027905464172363  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.677201271057129  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 3660, 128])
m.shape torch.Size([3240, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.693661689758301  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.693661689758301  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 3240, 128]), torch.Size([1, 3240, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6968483924865723  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9624085426330566  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 3240, 128])
m.shape torch.Size([2976, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9792065620422363  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9792065620422363  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2976, 128]), torch.Size([1, 2976, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9821743965148926  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.250764846801758  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2976, 128])
m.shape torch.Size([2614, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.266473770141602  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.266473770141602  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2614, 128]), torch.Size([1, 2614, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.269014358520508  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.532381057739258  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2614, 128])
m.shape torch.Size([2391, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.548575401306152  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.548575401306152  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2391, 128]), torch.Size([1, 2391, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.550882339477539  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.797325611114502  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2391, 128])
m.shape torch.Size([2120, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.813065052032471  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.813065052032471  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 2120, 128]), torch.Size([1, 2120, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.815128803253174  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.048050880432129  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 2120, 128])
m.shape torch.Size([1985, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.062806606292725  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.062806606292725  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 1985, 128]), torch.Size([1, 1985, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.064699649810791  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.297750949859619  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 1985, 128])
m.shape torch.Size([1873, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.312880516052246  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.312880516052246  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 1873, 128]), torch.Size([1, 1873, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.314666748046875  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.541518211364746  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 1873, 128])
m.shape torch.Size([1625, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.555347442626953  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.555347442626953  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 1625, 128]), torch.Size([1, 1625, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.556897163391113  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.772990703582764  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 1625, 128])
m.shape torch.Size([24082, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.002684593200684  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.002684593200684  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 24082, 128]), torch.Size([1, 24082, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.025650978088379  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.3223295211792  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 24082, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.812013626098633  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.842254638671875  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.872495651245117  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.841309547424316  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([126839, 64])
input nodes number: 160243
output nodes number: 126839
edges number: 1163132
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.873831748962402  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.904072761535645  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.912120819091797  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.912120819091797  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([126839, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.912120819091797  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

m.shape torch.Size([9456, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.986239910125732  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.986239910125732  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 9456, 64]), torch.Size([1, 9456, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.991342544555664  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.027470588684082  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 9456, 64])
m.shape torch.Size([10142, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.03062391281128  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.03062391281128  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 10142, 64]), torch.Size([1, 10142, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.0357027053833  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.108243942260742  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 10142, 64])
m.shape torch.Size([80953, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.166396617889404  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.166396617889404  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 80953, 64]), torch.Size([1, 80953, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.20499849319458  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.056997776031494  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 80953, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.994802951812744  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.018776416778564  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.042749881744385  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.01802682876587  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

torch.Size([100551, 64])
input nodes number: 126839
output nodes number: 100551
edges number: 272599
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.04369592666626  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.06766939163208  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.073786735534668  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.073786735534668  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

m.shape torch.Size([6773, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.119005680084229  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.119005680084229  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 6773, 64]), torch.Size([1, 6773, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.12234354019165  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.149071216583252  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 6773, 64])
m.shape torch.Size([5823, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.15026569366455  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.15026569366455  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 5823, 64]), torch.Size([1, 5823, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.15310001373291  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.19611930847168  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 5823, 64])
m.shape torch.Size([4543, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.198688507080078  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.198688507080078  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 4543, 64]), torch.Size([1, 4543, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.200931549072266  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.253285884857178  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 4543, 64])
m.shape torch.Size([3689, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.255366325378418  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.255366325378418  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 3689, 64]), torch.Size([1, 3689, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.257125854492188  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.312614917755127  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

rst.shape  torch.Size([1, 3689, 64])
m.shape torch.Size([24642, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.342029094696045  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.342029094696045  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

 h.shape torch.Size([1, 24642, 64]), torch.Size([1, 24642, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.353779315948486  GigaBytes
Max Memory Allocated: 10.801851749420166  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.777745246887207  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24642, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.740349292755127  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.747125148773193  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.75390100479126  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.746786117553711  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([45470, 40])
input nodes number: 100551
output nodes number: 45470
edges number: 170014
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.747874736785889  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03127419948577881 |0.0074117183685302734 |0.13346564769744873 |0.000867009162902832 |0.06977331638336182 |0.006765127182006836 |
----------------------------------------------------------pseudo_mini_loss sum 2.911341905593872
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  774845
Number of first layer input nodes during this epoch:  320452
block dataloader generation time/epoch 9.5367431640625e-07
for loop block_dataloader item  time:  0.29769325256347656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09986591339111328  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09986591339111328  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([160342, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09986591339111328  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([11596, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6737842559814453  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6737842559814453  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11596, 128]), torch.Size([1, 11596, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6855030059814453  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7752933502197266  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11596, 128])
m.shape torch.Size([12594, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7817745208740234  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7817745208740234  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 12594, 128]), torch.Size([1, 12594, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7939691543579102  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9741277694702148  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 12594, 128])
m.shape torch.Size([11123, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9840340614318848  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9840340614318848  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11123, 128]), torch.Size([1, 11123, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.995276927947998  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2331151962280273  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11123, 128])
m.shape torch.Size([9491, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2459139823913574  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2459139823913574  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9491, 128]), torch.Size([1, 9491, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2549653053283691  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.517453670501709  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9491, 128])
m.shape torch.Size([8379, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.532905101776123  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.532905101776123  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 8379, 128]), torch.Size([1, 8379, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.541426181793213  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8290963172912598  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 8379, 128])
m.shape torch.Size([6892, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8448190689086914  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8448190689086914  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6892, 128]), torch.Size([1, 6892, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8522748947143555  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.145702362060547  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6892, 128])
m.shape torch.Size([5999, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1624398231506348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1624398231506348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5999, 128]), torch.Size([1, 5999, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1683473587036133  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4610395431518555  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5999, 128])
m.shape torch.Size([5259, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.478240489959717  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.478240489959717  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5259, 128]), torch.Size([1, 5259, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4835753440856934  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7707910537719727  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5259, 128])
m.shape torch.Size([4655, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7882604598999023  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7882604598999023  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4655, 128]), torch.Size([1, 4655, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.79305362701416  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0778369903564453  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4655, 128])
m.shape torch.Size([4138, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.095348834991455  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.095348834991455  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4138, 128]), torch.Size([1, 4138, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0994296073913574  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.380605697631836  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4138, 128])
m.shape torch.Size([3660, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3981637954711914  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3981637954711914  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3660, 128]), torch.Size([1, 3660, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.4016828536987305  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6746110916137695  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3660, 128])
m.shape torch.Size([3263, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.692368507385254  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.692368507385254  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3263, 128]), torch.Size([1, 3263, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.695561408996582  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.971799373626709  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3263, 128])
m.shape torch.Size([3001, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.98964262008667  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.98964262008667  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3001, 128]), torch.Size([1, 3001, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.992610454559326  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.266730308532715  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3001, 128])
m.shape torch.Size([2602, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.281741142272949  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.281741142272949  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2602, 128]), torch.Size([1, 2602, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.284380912780762  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.545066833496094  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2602, 128])
m.shape torch.Size([2401, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.560079097747803  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.560079097747803  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2401, 128]), torch.Size([1, 2401, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.562380313873291  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.807247161865234  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2401, 128])
m.shape torch.Size([2118, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.822261333465576  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.822261333465576  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2118, 128]), torch.Size([1, 2118, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.824498653411865  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.057117462158203  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2118, 128])
m.shape torch.Size([2029, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.072555065155029  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.072555065155029  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2029, 128]), torch.Size([1, 2029, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.074490070343018  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.308502674102783  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2029, 128])
m.shape torch.Size([1839, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.323319435119629  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.323319435119629  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1839, 128]), torch.Size([1, 1839, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.3250732421875  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.5480804443359375  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1839, 128])
m.shape torch.Size([1597, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.561672210693359  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.561672210693359  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1597, 128]), torch.Size([1, 1597, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.56319522857666  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.768301486968994  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1597, 128])
m.shape torch.Size([24124, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.998008728027344  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.998008728027344  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24124, 128]), torch.Size([1, 24124, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.021015167236328  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.318374633789062  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24124, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.807369232177734  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.837591171264648  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.867813110351562  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.836646556854248  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126760, 64])
input nodes number: 160342
output nodes number: 126760
edges number: 1163882
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.869027137756348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.899249076843262  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.90727710723877  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.90727710723877  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126760, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.90727710723877  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([9356, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.980998039245605  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.980998039245605  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9356, 64]), torch.Size([1, 9356, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.985867977142334  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.022252559661865  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9356, 64])
m.shape torch.Size([10146, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.025107860565186  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.025107860565186  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 10146, 64]), torch.Size([1, 10146, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.029945850372314  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.10312557220459  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 10146, 64])
m.shape torch.Size([81058, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.16070556640625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.16070556640625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 81058, 64]), torch.Size([1, 81058, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.199357032775879  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.052155494689941  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 81058, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.989819049835205  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.013794422149658  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.037769794464111  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.013044834136963  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([100560, 64])
input nodes number: 126760
output nodes number: 100560
edges number: 272822
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.038715362548828  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.062690734863281  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.068696022033691  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.068696022033691  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([6698, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.1139554977417  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.1139554977417  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6698, 64]), torch.Size([1, 6698, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.117417335510254  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.143659591674805  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6698, 64])
m.shape torch.Size([5882, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.144761085510254  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.144761085510254  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5882, 64]), torch.Size([1, 5882, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.147591590881348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.192895889282227  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5882, 64])
m.shape torch.Size([4585, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.195116996765137  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.195116996765137  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4585, 64]), torch.Size([1, 4585, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.197627067565918  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.25033712387085  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4585, 64])
m.shape torch.Size([3556, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.252105712890625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.252105712890625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3556, 64]), torch.Size([1, 3556, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.253801345825195  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.308882713317871  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3556, 64])
m.shape torch.Size([24750, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.33846139907837  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.33846139907837  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24750, 64]), torch.Size([1, 24750, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.350263118743896  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.77599048614502  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24750, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.737637519836426  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.744413375854492  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.751189231872559  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.74407434463501  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([45471, 40])
input nodes number: 100560
output nodes number: 45471
edges number: 170191
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.745162963867188  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03126788139343262 |0.007547616958618164 |0.13358211517333984 |0.00092315673828125 |0.06961846351623535 |0.006656169891357422 |
----------------------------------------------------------pseudo_mini_loss sum 2.9425079822540283
for loop block_dataloader item  time:  0.8082342147827148
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09984111785888672  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09984111785888672  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([160341, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09984111785888672  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([11743, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6736950874328613  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6736950874328613  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11743, 128]), torch.Size([1, 11743, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6854138374328613  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7760453224182129  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11743, 128])
m.shape torch.Size([12563, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7824268341064453  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7824268341064453  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 12563, 128]), torch.Size([1, 12563, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7945365905761719  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9742517471313477  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 12563, 128])
m.shape torch.Size([11105, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9841470718383789  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9841470718383789  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11105, 128]), torch.Size([1, 11105, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9954748153686523  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2333612442016602  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11105, 128])
m.shape torch.Size([9566, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2463116645812988  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2463116645812988  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9566, 128]), torch.Size([1, 9566, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.255434513092041  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5199971199035645  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9566, 128])
m.shape torch.Size([8269, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5351505279541016  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5351505279541016  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 8269, 128]), torch.Size([1, 8269, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5436549186706543  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8275485038757324  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 8269, 128])
m.shape torch.Size([6844, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.843186378479004  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.843186378479004  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6844, 128]), torch.Size([1, 6844, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8508520126342773  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1443424224853516  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6844, 128])
m.shape torch.Size([5991, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.161076068878174  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.161076068878174  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5991, 128]), torch.Size([1, 5991, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1669816970825195  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.459658622741699  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5991, 128])
m.shape torch.Size([5264, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4768824577331543  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4768824577331543  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5264, 128]), torch.Size([1, 5264, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.48207426071167  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.769381523132324  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5264, 128])
m.shape torch.Size([4594, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7865867614746094  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7865867614746094  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4594, 128]), torch.Size([1, 4594, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7914319038391113  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0729870796203613  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4594, 128])
m.shape torch.Size([4131, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0904946327209473  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0904946327209473  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4131, 128]), torch.Size([1, 4131, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0945076942443848  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3747358322143555  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4131, 128])
m.shape torch.Size([3626, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3922972679138184  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3922972679138184  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3626, 128]), torch.Size([1, 3626, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3958358764648438  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6673412322998047  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3626, 128])
m.shape torch.Size([3293, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6850662231445312  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6850662231445312  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3293, 128]), torch.Size([1, 3293, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6884231567382812  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.965829372406006  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3293, 128])
m.shape torch.Size([2950, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9824252128601074  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9824252128601074  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2950, 128]), torch.Size([1, 2950, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9852824211120605  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.252557754516602  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2950, 128])
m.shape torch.Size([2588, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.268427848815918  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.268427848815918  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2588, 128]), torch.Size([1, 2588, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.270916938781738  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.516434669494629  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2588, 128])
m.shape torch.Size([2386, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.532266616821289  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.532266616821289  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2386, 128]), torch.Size([1, 2386, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.534542083740234  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.780060768127441  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2386, 128])
m.shape torch.Size([2082, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.794807434082031  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.794807434082031  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2082, 128]), torch.Size([1, 2082, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.796867370605469  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.027222633361816  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2082, 128])
m.shape torch.Size([1998, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.042426109313965  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.042426109313965  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1998, 128]), torch.Size([1, 1998, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.0443315505981445  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.277592658996582  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1998, 128])
m.shape torch.Size([1869, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.292681694030762  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.292681694030762  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1869, 128]), torch.Size([1, 1869, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.294464111328125  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.520995140075684  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1869, 128])
m.shape torch.Size([1614, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.534726619720459  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.534726619720459  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1614, 128]), torch.Size([1, 1614, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.536265850067139  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.743190288543701  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1614, 128])
m.shape torch.Size([24234, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.973534107208252  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.973534107208252  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24234, 128]), torch.Size([1, 24234, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.996645450592041  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.295462131500244  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24234, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.784907817840576  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.815117835998535  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.845327854156494  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.814173698425293  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126710, 64])
input nodes number: 160341
output nodes number: 126710
edges number: 1163602
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.846543788909912  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.876753807067871  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.884729385375977  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.884729385375977  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126710, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.884729385375977  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([9520, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.957867622375488  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.957867622375488  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9520, 64]), torch.Size([1, 9520, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.963234424591064  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.000400066375732  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9520, 64])
m.shape torch.Size([10139, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.003227710723877  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.003227710723877  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 10139, 64]), torch.Size([1, 10139, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.008062839508057  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.08104419708252  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 10139, 64])
m.shape torch.Size([80716, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.139026641845703  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.139026641845703  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 80716, 64]), torch.Size([1, 80716, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.177515029907227  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.024259567260742  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 80716, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.962237358093262  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.98616886138916  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.010100364685059  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.98542070388794  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([100375, 64])
input nodes number: 126710
output nodes number: 100375
edges number: 271946
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.011045455932617  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.034976959228516  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.040967464447021  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.040967464447021  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([6730, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.0861496925354  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.0861496925354  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6730, 64]), torch.Size([1, 6730, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.08954906463623  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.115632057189941  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6730, 64])
m.shape torch.Size([5824, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.116788864135742  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.116788864135742  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5824, 64]), torch.Size([1, 5824, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.119664192199707  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.162627220153809  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5824, 64])
m.shape torch.Size([4692, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.165509223937988  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.165509223937988  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4692, 64]), torch.Size([1, 4692, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.167805671691895  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.22046422958374  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4692, 64])
m.shape torch.Size([3764, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.223062992095947  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.223062992095947  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3764, 64]), torch.Size([1, 3764, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.224857807159424  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.282314777374268  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3764, 64])
m.shape torch.Size([24460, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.311625480651855  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.311625480651855  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24460, 64]), torch.Size([1, 24460, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.323288917541504  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.74491024017334  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24460, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.707722663879395  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.714498519897461  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.721274375915527  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.714159488677979  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([45470, 40])
input nodes number: 100375
output nodes number: 45470
edges number: 169810
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.715246677398682  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030704140663146973 |0.007330775260925293 |0.15522480010986328 |0.000975489616394043 |0.06933951377868652 |0.0065174102783203125 |
----------------------------------------------------------pseudo_mini_loss sum 2.746542453765869
Total (block generation + training)time/epoch 1.121154546737671
Training time/epoch 1.1210143566131592
Training time without block to device /epoch 1.1063528060913086
Training time without total dataloading part /epoch 0.457597017288208
load block tensor time/epoch 0.061408281326293945
block to device time/epoch 0.014661550521850586
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  775088
Number of first layer input nodes during this epoch:  320683
block dataloader generation time/epoch 7.152557373046875e-07
for loop block_dataloader item  time:  0.2531929016113281
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.0997467041015625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.0997467041015625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([160217, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.0997467041015625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([11726, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6709680557250977  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6709680557250977  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11726, 128]), torch.Size([1, 11726, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6826868057250977  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7732210159301758  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11726, 128])
m.shape torch.Size([12539, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7795877456665039  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7795877456665039  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 12539, 128]), torch.Size([1, 12539, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.791694164276123  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9710659980773926  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 12539, 128])
m.shape torch.Size([11070, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9809226989746094  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9809226989746094  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11070, 128]), torch.Size([1, 11070, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9922537803649902  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.230147361755371  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11070, 128])
m.shape torch.Size([9528, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2430419921875  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2430419921875  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9528, 128]), torch.Size([1, 9528, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2521286010742188  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5156402587890625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9528, 128])
m.shape torch.Size([8310, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.530909538269043  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.530909538269043  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 8310, 128]), torch.Size([1, 8310, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5394153594970703  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.824716567993164  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 8310, 128])
m.shape torch.Size([6905, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8405094146728516  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8405094146728516  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6905, 128]), torch.Size([1, 6905, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8480968475341797  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1417899131774902  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6905, 128])
m.shape torch.Size([5990, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1584911346435547  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1584911346435547  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5990, 128]), torch.Size([1, 5990, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.164505958557129  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.457180976867676  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5990, 128])
m.shape torch.Size([5266, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.474119186401367  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.474119186401367  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5266, 128]), torch.Size([1, 5266, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4793834686279297  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.766845226287842  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5266, 128])
m.shape torch.Size([4620, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.78416109085083  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.78416109085083  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4620, 128]), torch.Size([1, 4620, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.788848400115967  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.071930408477783  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4620, 128])
m.shape torch.Size([4107, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.089311122894287  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.089311122894287  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4107, 128]), torch.Size([1, 4107, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.093625545501709  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3734827041625977  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4107, 128])
m.shape torch.Size([3623, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3910555839538574  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3910555839538574  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3623, 128]), torch.Size([1, 3623, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.3945116996765137  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.665553569793701  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3623, 128])
m.shape torch.Size([3235, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6821584701538086  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6821584701538086  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3235, 128]), torch.Size([1, 3235, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.685487747192383  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9514389038085938  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3235, 128])
m.shape torch.Size([2980, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9682369232177734  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9682369232177734  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2980, 128]), torch.Size([1, 2980, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9711856842041016  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.244291305541992  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2980, 128])
m.shape torch.Size([2605, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.259774208068848  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.259774208068848  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2605, 128]), torch.Size([1, 2605, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.2624616622924805  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.514777183532715  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2605, 128])
m.shape torch.Size([2353, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.529466152191162  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.529466152191162  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2353, 128]), torch.Size([1, 2353, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.531808376312256  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.777065753936768  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2353, 128])
m.shape torch.Size([2098, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.791950225830078  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.791950225830078  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2098, 128]), torch.Size([1, 2098, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.793989658355713  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.025604248046875  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2098, 128])
m.shape torch.Size([2044, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.041172981262207  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.041172981262207  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2044, 128]), torch.Size([1, 2044, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.043122291564941  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.277420997619629  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2044, 128])
m.shape torch.Size([1823, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.292093276977539  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.292093276977539  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1823, 128]), torch.Size([1, 1823, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.293831825256348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.515423774719238  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1823, 128])
m.shape torch.Size([1612, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.529159069061279  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.529159069061279  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1612, 128]), torch.Size([1, 1612, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.530696392059326  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.736976146697998  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1612, 128])
m.shape torch.Size([23973, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.964831829071045  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.964831829071045  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 23973, 128]), torch.Size([1, 23973, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.987694263458252  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.213022708892822  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 23973, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.704282760620117  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.734420776367188  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.764558792114258  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.733478546142578  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126407, 64])
input nodes number: 160217
output nodes number: 126407
edges number: 1158210
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.765801906585693  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.795939922332764  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.80403995513916  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.80403995513916  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126407, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.80403995513916  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([9542, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.877240180969238  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.877240180969238  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9542, 64]), torch.Size([1, 9542, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.882620811462402  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.920660972595215  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9542, 64])
m.shape torch.Size([10138, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.923555374145508  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.923555374145508  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 10138, 64]), torch.Size([1, 10138, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.928389549255371  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.001346588134766  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 10138, 64])
m.shape torch.Size([80538, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.058379173278809  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.058379173278809  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 80538, 64]), torch.Size([1, 80538, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.096782684326172  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.941707611083984  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 80538, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.879815578460693  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.903709411621094  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.927603244781494  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.902962684631348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([100218, 64])
input nodes number: 126407
output nodes number: 100218
edges number: 271432
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.92854642868042  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.95244026184082  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.95841932296753  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.95841932296753  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([6834, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.003527641296387  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.003527641296387  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6834, 64]), torch.Size([1, 6834, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.006989002227783  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.03517770767212  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6834, 64])
m.shape torch.Size([5907, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.035936832427979  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.035936832427979  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5907, 64]), torch.Size([1, 5907, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.03885269165039  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.082269668579102  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5907, 64])
m.shape torch.Size([4570, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.085188865661621  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.085188865661621  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4570, 64]), torch.Size([1, 4570, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.087489128112793  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.136099815368652  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4570, 64])
m.shape torch.Size([3625, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.138799667358398  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.138799667358398  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3625, 64]), torch.Size([1, 3625, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.140528678894043  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.197038650512695  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3625, 64])
m.shape torch.Size([24535, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.226385116577148  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.226385116577148  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24535, 64]), torch.Size([1, 24535, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.23808479309082  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.660272121429443  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24535, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.623240947723389  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.630016803741455  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.636792659759521  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.629677772521973  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([45471, 40])
input nodes number: 100218
output nodes number: 45471
edges number: 169533
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.630763530731201  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03048396110534668 |0.007257223129272461 |0.13247108459472656 |0.0008957386016845703 |0.06887102127075195 |0.006606578826904297 |
----------------------------------------------------------pseudo_mini_loss sum 2.5493569374084473
for loop block_dataloader item  time:  0.8080573081970215
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09993696212768555  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09993696212768555  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([160321, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09993696212768555  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([11538, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6755032539367676  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6755032539367676  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11538, 128]), torch.Size([1, 11538, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6872220039367676  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7766804695129395  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11538, 128])
m.shape torch.Size([12473, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.783073902130127  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.783073902130127  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 12473, 128]), torch.Size([1, 12473, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7952384948730469  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9736661911010742  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 12473, 128])
m.shape torch.Size([11128, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9836373329162598  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9836373329162598  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11128, 128]), torch.Size([1, 11128, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9949102401733398  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.233044147491455  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11128, 128])
m.shape torch.Size([9566, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.245983600616455  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.245983600616455  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9566, 128]), torch.Size([1, 9566, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2551064491271973  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5196690559387207  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9566, 128])
m.shape torch.Size([8335, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5349798202514648  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5349798202514648  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 8335, 128]), torch.Size([1, 8335, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.543515682220459  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8296751976013184  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 8335, 128])
m.shape torch.Size([6890, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8454132080078125  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8454132080078125  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6890, 128]), torch.Size([1, 6890, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8529529571533203  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.146495819091797  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6890, 128])
m.shape torch.Size([6050, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1634044647216797  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1634044647216797  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6050, 128]), torch.Size([1, 6050, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1693191528320312  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.462108612060547  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6050, 128])
m.shape torch.Size([5238, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4792051315307617  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4792051315307617  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5238, 128]), torch.Size([1, 5238, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4843969345092773  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7711777687072754  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5238, 128])
m.shape torch.Size([4656, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.788661479949951  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.788661479949951  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4656, 128]), torch.Size([1, 4656, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.793422222137451  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0782828330993652  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4656, 128])
m.shape torch.Size([4111, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.095665454864502  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.095665454864502  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4111, 128]), torch.Size([1, 4111, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0997395515441895  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.379178524017334  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4111, 128])
m.shape torch.Size([3657, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.396749496459961  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.396749496459961  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3657, 128]), torch.Size([1, 3657, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.400289535522461  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6745128631591797  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3657, 128])
m.shape torch.Size([3226, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6910834312438965  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6910834312438965  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3226, 128]), torch.Size([1, 3226, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.694283962249756  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.959564208984375  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3226, 128])
m.shape torch.Size([2974, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.976271629333496  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.976271629333496  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2974, 128]), torch.Size([1, 2974, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.979132652282715  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.248478412628174  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2974, 128])
m.shape torch.Size([2619, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.264073371887207  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.264073371887207  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2619, 128]), torch.Size([1, 2619, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.266644477844238  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.528822422027588  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2619, 128])
m.shape torch.Size([2382, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.543812274932861  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.543812274932861  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2382, 128]), torch.Size([1, 2382, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.546159267425537  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.791898727416992  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2382, 128])
m.shape torch.Size([2093, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.806731224060059  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.806731224060059  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2093, 128]), torch.Size([1, 2093, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.80887508392334  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.038904190063477  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2093, 128])
m.shape torch.Size([2020, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.054280757904053  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.054280757904053  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2020, 128]), torch.Size([1, 2020, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.056207180023193  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.2899088859558105  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2020, 128])
m.shape torch.Size([1873, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.3050217628479  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.3050217628479  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1873, 128]), torch.Size([1, 1873, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.306807994842529  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.5336594581604  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1873, 128])
m.shape torch.Size([1613, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.547379970550537  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.547379970550537  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1613, 128]), torch.Size([1, 1613, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.5489182472229  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.757937908172607  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1613, 128])
m.shape torch.Size([24277, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.988692283630371  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.988692283630371  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24277, 128]), torch.Size([1, 24277, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.011844635009766  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.311399459838867  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24277, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.798635482788086  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.828847885131836  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.859060287475586  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.827903747558594  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126719, 64])
input nodes number: 160321
output nodes number: 126719
edges number: 1166141
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.860310077667236  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.890522480010986  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.898477554321289  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.898477554321289  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126719, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.898477554321289  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([9378, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.97209882736206  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.97209882736206  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9378, 64]), torch.Size([1, 9378, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.977548599243164  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.014377117156982  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9378, 64])
m.shape torch.Size([10089, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.017508506774902  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.017508506774902  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 10089, 64]), torch.Size([1, 10089, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.022622108459473  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.095727920532227  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 10089, 64])
m.shape torch.Size([81242, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.153775691986084  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.153775691986084  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 81242, 64]), torch.Size([1, 81242, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.192514896392822  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.046717166900635  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 81242, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.984325408935547  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.008336544036865  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.032347679138184  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.007586002349854  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([100709, 64])
input nodes number: 126719
output nodes number: 100709
edges number: 273282
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.033292770385742  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.05730390548706  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.063520908355713  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.063520908355713  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([6594, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.108850955963135  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.108850955963135  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6594, 64]), torch.Size([1, 6594, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.112188816070557  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.137725353240967  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6594, 64])
m.shape torch.Size([5799, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.138908386230469  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.138908386230469  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5799, 64]), torch.Size([1, 5799, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.1422438621521  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.185498714447021  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5799, 64])
m.shape torch.Size([4707, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.188003063201904  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.188003063201904  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4707, 64]), torch.Size([1, 4707, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.190442085266113  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.244099617004395  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4707, 64])
m.shape torch.Size([3695, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.24648904800415  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.24648904800415  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3695, 64]), torch.Size([1, 3695, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.24825143814087  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.304791927337646  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3695, 64])
m.shape torch.Size([24675, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.334245204925537  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.334245204925537  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24675, 64]), torch.Size([1, 24675, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.346011638641357  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.769588947296143  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24675, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.73193073272705  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.738706588745117  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.745482444763184  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.738367557525635  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([45470, 40])
input nodes number: 100709
output nodes number: 45470
edges number: 170468
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.739457130432129  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03030073642730713 |0.007288098335266113 |0.1332765817642212 |0.0009158849716186523 |0.06916868686676025 |0.006987333297729492 |
----------------------------------------------------------pseudo_mini_loss sum 2.424466609954834
Total (block generation + training)time/epoch 1.0994476079940796
Training time/epoch 1.0776758193969727
Training time without block to device /epoch 1.0630996227264404
Training time without total dataloading part /epoch 0.4137096405029297
load block tensor time/epoch 0.06060147285461426
block to device time/epoch 0.014576196670532227
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  774591
Number of first layer input nodes during this epoch:  320538
block dataloader generation time/epoch 7.152557373046875e-07
for loop block_dataloader item  time:  0.2665877342224121
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09975862503051758  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09975862503051758  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([160192, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09975862503051758  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([11720, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.673433780670166  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.673433780670166  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11720, 128]), torch.Size([1, 11720, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.685152530670166  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7756524085998535  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11720, 128])
m.shape torch.Size([12499, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7819838523864746  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7819838523864746  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 12499, 128]), torch.Size([1, 12499, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7940740585327148  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9728736877441406  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 12499, 128])
m.shape torch.Size([11205, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9829425811767578  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9829425811767578  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11205, 128]), torch.Size([1, 11205, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9942898750305176  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2324719429016113  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11205, 128])
m.shape torch.Size([9519, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2452850341796875  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2452850341796875  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9519, 128]), torch.Size([1, 9519, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.2543630599975586  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5176258087158203  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9519, 128])
m.shape torch.Size([8340, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.532970905303955  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.532970905303955  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 8340, 128]), torch.Size([1, 8340, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5414867401123047  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8278179168701172  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 8340, 128])
m.shape torch.Size([6927, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8436594009399414  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8436594009399414  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6927, 128]), torch.Size([1, 6927, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8511896133422852  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1449122428894043  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6927, 128])
m.shape torch.Size([5983, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1615796089172363  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1615796089172363  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5983, 128]), torch.Size([1, 5983, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.167555809020996  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4602174758911133  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5983, 128])
m.shape torch.Size([5282, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4772067070007324  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4772067070007324  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5282, 128]), torch.Size([1, 5282, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4824881553649902  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.770813465118408  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5282, 128])
m.shape torch.Size([4625, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7881431579589844  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7881431579589844  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4625, 128]), torch.Size([1, 4625, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.792921543121338  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0759663581848145  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4625, 128])
m.shape torch.Size([4110, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0933589935302734  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0933589935302734  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4110, 128]), torch.Size([1, 4110, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.097640037536621  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.377384662628174  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4110, 128])
m.shape torch.Size([3613, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.394956111907959  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.394956111907959  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3613, 128]), torch.Size([1, 3613, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.398517608642578  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6711950302124023  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3613, 128])
m.shape torch.Size([3209, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.687664031982422  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.687664031982422  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3209, 128]), torch.Size([1, 3209, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.6907639503479004  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9537353515625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3209, 128])
m.shape torch.Size([3010, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9716224670410156  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.9716224670410156  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3010, 128]), torch.Size([1, 3010, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.974780559539795  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.246544361114502  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3010, 128])
m.shape torch.Size([2613, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.262094974517822  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.262094974517822  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2613, 128]), torch.Size([1, 2613, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.264739990234375  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.517123699188232  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2613, 128])
m.shape torch.Size([2364, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.532479763031006  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.532479763031006  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2364, 128]), torch.Size([1, 2364, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.5347514152526855  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.779421329498291  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2364, 128])
m.shape torch.Size([2108, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.794376850128174  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.794376850128174  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2108, 128]), torch.Size([1, 2108, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.7965006828308105  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.028939247131348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2108, 128])
m.shape torch.Size([2030, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.044389724731445  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.044389724731445  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2030, 128]), torch.Size([1, 2030, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.04632568359375  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.280185699462891  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2030, 128])
m.shape torch.Size([1877, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.295328140258789  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.295328140258789  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1877, 128]), torch.Size([1, 1877, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.297118186950684  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.525083541870117  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1877, 128])
m.shape torch.Size([1620, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.538865566253662  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.538865566253662  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1620, 128]), torch.Size([1, 1620, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.54041051864624  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.748852252960205  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1620, 128])
m.shape torch.Size([24071, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.978548526763916  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.978548526763916  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24071, 128]), torch.Size([1, 24071, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.001504421234131  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.297523021697998  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24071, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.785963535308838  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.816177368164062  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.846391201019287  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.815232753753662  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126725, 64])
input nodes number: 160192
output nodes number: 126725
edges number: 1162180
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.847887516021729  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.878101348876953  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.886154651641846  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.886154651641846  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126725, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.886154651641846  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([9470, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.960640907287598  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.960640907287598  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9470, 64]), torch.Size([1, 9470, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.966012477874756  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.00395393371582  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9470, 64])
m.shape torch.Size([10141, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.006789684295654  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.006789684295654  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 10141, 64]), torch.Size([1, 10141, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.01162576675415  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.084668159484863  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 10141, 64])
m.shape torch.Size([80907, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.142736911773682  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.142736911773682  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 80907, 64]), torch.Size([1, 80907, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.18131685256958  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.032965183258057  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 80907, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.970778942108154  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.994744300842285  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.018709659576416  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.993995189666748  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([100518, 64])
input nodes number: 126725
output nodes number: 100518
edges number: 272473
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.019655227661133  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.043620586395264  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.049750804901123  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.049750804901123  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([6759, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.094910621643066  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.094910621643066  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6759, 64]), torch.Size([1, 6759, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.098172187805176  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.124032974243164  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6759, 64])
m.shape torch.Size([5854, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.126031398773193  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.126031398773193  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5854, 64]), torch.Size([1, 5854, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.128881931304932  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.17196798324585  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5854, 64])
m.shape torch.Size([4582, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.17458724975586  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.17458724975586  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4582, 64]), torch.Size([1, 4582, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.177862167358398  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.23137617111206  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4582, 64])
m.shape torch.Size([3667, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.234076976776123  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.234076976776123  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3667, 64]), torch.Size([1, 3667, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.235826015472412  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.291557788848877  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3667, 64])
m.shape torch.Size([24609, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.320936679840088  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.320936679840088  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24609, 64]), torch.Size([1, 24609, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.332671642303467  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.755115985870361  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24609, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.718991756439209  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.725767612457275  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.732543468475342  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.725428581237793  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([45471, 40])
input nodes number: 100518
output nodes number: 45471
edges number: 169926
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.726516723632812  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030266761779785156 |0.007368326187133789 |0.1331322193145752 |0.0008747577667236328 |0.06961846351623535 |0.0069103240966796875 |
----------------------------------------------------------pseudo_mini_loss sum 2.337190866470337
for loop block_dataloader item  time:  0.8147938251495361
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09989118576049805  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09989118576049805  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([160284, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.09989118576049805  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([11626, 1, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6755099296569824  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6755099296569824  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11626, 128]), torch.Size([1, 11626, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.6872286796569824  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7771906852722168  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11626, 128])
m.shape torch.Size([12595, 2, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.783658504486084  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.783658504486084  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 12595, 128]), torch.Size([1, 12595, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.7958393096923828  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9760122299194336  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 12595, 128])
m.shape torch.Size([11147, 3, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9859523773193359  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9859523773193359  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 11147, 128]), torch.Size([1, 11147, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 0.9972090721130371  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.235079288482666  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 11147, 128])
m.shape torch.Size([9418, 4, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.247727394104004  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.247727394104004  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9418, 128]), torch.Size([1, 9418, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.256709098815918  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.5171785354614258  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9418, 128])
m.shape torch.Size([8339, 5, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.532569408416748  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.532569408416748  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 8339, 128]), torch.Size([1, 8339, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.541036605834961  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8273334503173828  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 8339, 128])
m.shape torch.Size([6879, 6, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8430380821228027  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8430380821228027  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6879, 128]), torch.Size([1, 6879, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 1.8505702018737793  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1440439224243164  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6879, 128])
m.shape torch.Size([5976, 7, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1607108116149902  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.1607108116149902  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5976, 128]), torch.Size([1, 5976, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.166586399078369  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4592347145080566  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5976, 128])
m.shape torch.Size([5312, 8, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4766488075256348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4766488075256348  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5312, 128]), torch.Size([1, 5312, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.4821228981018066  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.773221492767334  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5312, 128])
m.shape torch.Size([4679, 9, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.790768623352051  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.790768623352051  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4679, 128]), torch.Size([1, 4679, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 2.7956104278564453  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.081757068634033  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4679, 128])
m.shape torch.Size([4146, 10, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0992956161499023  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.0992956161499023  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4146, 128]), torch.Size([1, 4146, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.10371732711792  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.384660243988037  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4146, 128])
m.shape torch.Size([3663, 11, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.402214527130127  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.402214527130127  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3663, 128]), torch.Size([1, 3663, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.4058961868286133  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.681276798248291  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3663, 128])
m.shape torch.Size([3305, 12, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.699061393737793  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.699061393737793  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3305, 128]), torch.Size([1, 3305, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.702235221862793  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.977931022644043  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3305, 128])
m.shape torch.Size([2975, 13, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.994770050048828  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.994770050048828  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2975, 128]), torch.Size([1, 2975, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 3.997875213623047  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.2646708488464355  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2975, 128])
m.shape torch.Size([2618, 14, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.28047513961792  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.28047513961792  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2618, 128]), torch.Size([1, 2618, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.283000469207764  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.547337532043457  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2618, 128])
m.shape torch.Size([2358, 15, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.562464714050293  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.562464714050293  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2358, 128]), torch.Size([1, 2358, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.56479024887085  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.8155293464660645  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2358, 128])
m.shape torch.Size([2085, 16, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.830312252044678  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.830312252044678  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2085, 128]), torch.Size([1, 2085, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 4.832447052001953  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.064789772033691  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2085, 128])
m.shape torch.Size([2009, 17, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.080080986022949  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.080080986022949  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 2009, 128]), torch.Size([1, 2009, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.081996917724609  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.3156280517578125  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 2009, 128])
m.shape torch.Size([1862, 18, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.330651760101318  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.330651760101318  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1862, 128]), torch.Size([1, 1862, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.332427501678467  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.5584540367126465  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1862, 128])
m.shape torch.Size([1657, 19, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.572578430175781  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.572578430175781  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 1657, 128]), torch.Size([1, 1657, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.574158668518066  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 5.7909321784973145  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 1657, 128])
m.shape torch.Size([24234, 20, 128])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.0212554931640625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.0212554931640625  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24234, 128]), torch.Size([1, 24234, 128])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 6.044366836547852  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.343509674072266  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 24234, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.8314208984375  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.861672401428223  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.891923904418945  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.860726833343506  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126883, 64])
input nodes number: 160284
output nodes number: 126883
edges number: 1166639
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.893283367156982  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.923534870147705  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.93151044845581  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.93151044845581  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([126883, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 8.93151044845581  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([9382, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.00574779510498  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.00574779510498  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 9382, 64]), torch.Size([1, 9382, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.011153221130371  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.04695987701416  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 9382, 64])
m.shape torch.Size([10170, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.049779415130615  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.049779415130615  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 10170, 64]), torch.Size([1, 10170, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.054628849029541  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.127836227416992  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 10170, 64])
m.shape torch.Size([80982, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.185822010040283  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.185822010040283  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 80982, 64]), torch.Size([1, 80982, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 9.224437236785889  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.076655864715576  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 80982, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.014416217803955  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.038385391235352  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.062354564666748  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.037636280059814  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

torch.Size([100534, 64])
input nodes number: 126883
output nodes number: 100534
edges number: 272668
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.063301086425781  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.087270259857178  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.093445301055908  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.093445301055908  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

m.shape torch.Size([6669, 1, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.138627052307129  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.138627052307129  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 6669, 64]), torch.Size([1, 6669, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.141932010650635  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.168574333190918  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 6669, 64])
m.shape torch.Size([5852, 2, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.170468807220459  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.170468807220459  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 5852, 64]), torch.Size([1, 5852, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.173311710357666  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.216797351837158  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 5852, 64])
m.shape torch.Size([4695, 3, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.219258785247803  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.219258785247803  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 4695, 64]), torch.Size([1, 4695, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.222419738769531  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.276709079742432  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 4695, 64])
m.shape torch.Size([3653, 4, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.279196739196777  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.279196739196777  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 3653, 64]), torch.Size([1, 3653, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.280939102172852  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.335418701171875  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

rst.shape  torch.Size([1, 3653, 64])
m.shape torch.Size([24601, 5, 64])
----------------------------------------1
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.364790916442871  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.364790916442871  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

 h.shape torch.Size([1, 24601, 64]), torch.Size([1, 24601, 64])
----------------------------------------3
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.376522064208984  GigaBytes
Max Memory Allocated: 10.80712080001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.798829078674316  GigaBytes
Max Memory Allocated: 10.828155994415283  GigaBytes

rst.shape  torch.Size([1, 24601, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.761839866638184  GigaBytes
Max Memory Allocated: 10.828155994415283  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.76861572265625  GigaBytes
Max Memory Allocated: 10.828155994415283  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.775391578674316  GigaBytes
Max Memory Allocated: 10.828155994415283  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.768276691436768  GigaBytes
Max Memory Allocated: 10.828155994415283  GigaBytes

torch.Size([45470, 40])
input nodes number: 100534
output nodes number: 45470
edges number: 170075
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7528076171875 GB
    Memory Allocated: 10.769364833831787  GigaBytes
Max Memory Allocated: 10.828155994415283  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030167698860168457 |0.007317900657653809 |0.13551044464111328 |0.001028299331665039 |0.06959676742553711 |0.00664973258972168 |
----------------------------------------------------------pseudo_mini_loss sum 2.2331433296203613
Total (block generation + training)time/epoch 1.0954972108205159
Training time/epoch 1.0875329971313477
Training time without block to device /epoch 1.07289719581604
Training time without total dataloading part /epoch 0.41892075538635254
load block tensor time/epoch 0.060335397720336914
block to device time/epoch 0.014635801315307617
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  775136
Number of first layer input nodes during this epoch:  320476
