main start at this time 1649566437.6257052
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

in feats:  128
for loop block_dataloader item  time:  0.14434170722961426
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1785888671875 GB
    Memory Allocated: 0.07483816146850586  GigaBytes
Max Memory Allocated: 0.07483816146850586  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.1785888671875 GB
    Memory Allocated: 0.07483816146850586  GigaBytes
Max Memory Allocated: 0.07483816146850586  GigaBytes

torch.Size([141071, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.1785888671875 GB
    Memory Allocated: 0.07483816146850586  GigaBytes
Max Memory Allocated: 0.07483816146850586  GigaBytes

m.shape torch.Size([4321, 1, 128])
----------------------------------------1
 Nvidia-smi: 2.6610107421875 GB
    Memory Allocated: 0.4366335868835449  GigaBytes
Max Memory Allocated: 0.4467339515686035  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6610107421875 GB
    Memory Allocated: 0.4366335868835449  GigaBytes
Max Memory Allocated: 0.4467339515686035  GigaBytes

 h.shape torch.Size([1, 4321, 128]), torch.Size([1, 4321, 128])
----------------------------------------3
 Nvidia-smi: 2.6610107421875 GB
    Memory Allocated: 0.44075441360473633  GigaBytes
Max Memory Allocated: 0.4467339515686035  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6824951171875 GB
    Memory Allocated: 0.4740414619445801  GigaBytes
Max Memory Allocated: 0.4761018753051758  GigaBytes

rst.shape  torch.Size([1, 4321, 128])
m.shape torch.Size([5464, 2, 128])
----------------------------------------1
 Nvidia-smi: 2.7020263671875 GB
    Memory Allocated: 0.4771919250488281  GigaBytes
Max Memory Allocated: 0.47731447219848633  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7020263671875 GB
    Memory Allocated: 0.4771919250488281  GigaBytes
Max Memory Allocated: 0.47731447219848633  GigaBytes

 h.shape torch.Size([1, 5464, 128]), torch.Size([1, 5464, 128])
----------------------------------------3
 Nvidia-smi: 2.7020263671875 GB
    Memory Allocated: 0.4824028015136719  GigaBytes
Max Memory Allocated: 0.4824028015136719  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7879638671875 GB
    Memory Allocated: 0.5605659484863281  GigaBytes
Max Memory Allocated: 0.5657768249511719  GigaBytes

rst.shape  torch.Size([1, 5464, 128])
m.shape torch.Size([5363, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.7879638671875 GB
    Memory Allocated: 0.5657768249511719  GigaBytes
Max Memory Allocated: 0.5659570693969727  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7879638671875 GB
    Memory Allocated: 0.5657768249511719  GigaBytes
Max Memory Allocated: 0.5659570693969727  GigaBytes

 h.shape torch.Size([1, 5363, 128]), torch.Size([1, 5363, 128])
----------------------------------------3
 Nvidia-smi: 2.7879638671875 GB
    Memory Allocated: 0.5708913803100586  GigaBytes
Max Memory Allocated: 0.5708913803100586  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9207763671875 GB
    Memory Allocated: 0.6834115982055664  GigaBytes
Max Memory Allocated: 0.6910834312438965  GigaBytes

rst.shape  torch.Size([1, 5363, 128])
m.shape torch.Size([4908, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.9207763671875 GB
    Memory Allocated: 0.6910834312438965  GigaBytes
Max Memory Allocated: 0.6913032531738281  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9207763671875 GB
    Memory Allocated: 0.6910834312438965  GigaBytes
Max Memory Allocated: 0.6913032531738281  GigaBytes

 h.shape torch.Size([1, 4908, 128]), torch.Size([1, 4908, 128])
----------------------------------------3
 Nvidia-smi: 2.9403076171875 GB
    Memory Allocated: 0.6959266662597656  GigaBytes
Max Memory Allocated: 0.6959266662597656  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0770263671875 GB
    Memory Allocated: 0.8373260498046875  GigaBytes
Max Memory Allocated: 0.8466873168945312  GigaBytes

rst.shape  torch.Size([1, 4908, 128])
m.shape torch.Size([4625, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.0770263671875 GB
    Memory Allocated: 0.8466873168945312  GigaBytes
Max Memory Allocated: 0.8469462394714355  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0770263671875 GB
    Memory Allocated: 0.8466873168945312  GigaBytes
Max Memory Allocated: 0.8469462394714355  GigaBytes

 h.shape torch.Size([1, 4625, 128]), torch.Size([1, 4625, 128])
----------------------------------------3
 Nvidia-smi: 3.0965576171875 GB
    Memory Allocated: 0.8520417213439941  GigaBytes
Max Memory Allocated: 0.8520417213439941  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2840576171875 GB
    Memory Allocated: 1.0108284950256348  GigaBytes
Max Memory Allocated: 1.0225472450256348  GigaBytes

rst.shape  torch.Size([1, 4625, 128])
m.shape torch.Size([4004, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.2840576171875 GB
    Memory Allocated: 1.0203418731689453  GigaBytes
Max Memory Allocated: 1.0225472450256348  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2840576171875 GB
    Memory Allocated: 1.0203418731689453  GigaBytes
Max Memory Allocated: 1.0225472450256348  GigaBytes

 h.shape torch.Size([1, 4004, 128]), torch.Size([1, 4004, 128])
----------------------------------------3
 Nvidia-smi: 3.2840576171875 GB
    Memory Allocated: 1.0244355201721191  GigaBytes
Max Memory Allocated: 1.0244355201721191  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4520263671875 GB
    Memory Allocated: 1.19140625  GigaBytes
Max Memory Allocated: 1.203125  GigaBytes

rst.shape  torch.Size([1, 4004, 128])
m.shape torch.Size([3495, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.4520263671875 GB
    Memory Allocated: 1.2007770538330078  GigaBytes
Max Memory Allocated: 1.203125  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4520263671875 GB
    Memory Allocated: 1.2007770538330078  GigaBytes
Max Memory Allocated: 1.203125  GigaBytes

 h.shape torch.Size([1, 3495, 128]), torch.Size([1, 3495, 128])
----------------------------------------3
 Nvidia-smi: 3.4520263671875 GB
    Memory Allocated: 1.2045536041259766  GigaBytes
Max Memory Allocated: 1.2045536041259766  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6668701171875 GB
    Memory Allocated: 1.3748254776000977  GigaBytes
Max Memory Allocated: 1.386491298675537  GigaBytes

rst.shape  torch.Size([1, 3495, 128])
m.shape torch.Size([3209, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6668701171875 GB
    Memory Allocated: 1.386023998260498  GigaBytes
Max Memory Allocated: 1.386491298675537  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6668701171875 GB
    Memory Allocated: 1.386023998260498  GigaBytes
Max Memory Allocated: 1.386491298675537  GigaBytes

 h.shape torch.Size([1, 3209, 128]), torch.Size([1, 3209, 128])
----------------------------------------3
 Nvidia-smi: 3.6668701171875 GB
    Memory Allocated: 1.389284610748291  GigaBytes
Max Memory Allocated: 1.389284610748291  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8172607421875 GB
    Memory Allocated: 1.564486026763916  GigaBytes
Max Memory Allocated: 1.5767273902893066  GigaBytes

rst.shape  torch.Size([1, 3209, 128])
m.shape torch.Size([2896, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8172607421875 GB
    Memory Allocated: 1.5753841400146484  GigaBytes
Max Memory Allocated: 1.5767273902893066  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8172607421875 GB
    Memory Allocated: 1.5753841400146484  GigaBytes
Max Memory Allocated: 1.5767273902893066  GigaBytes

 h.shape torch.Size([1, 2896, 128]), torch.Size([1, 2896, 128])
----------------------------------------3
 Nvidia-smi: 3.8172607421875 GB
    Memory Allocated: 1.5783114433288574  GigaBytes
Max Memory Allocated: 1.5783114433288574  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0067138671875 GB
    Memory Allocated: 1.757192611694336  GigaBytes
Max Memory Allocated: 1.7696208953857422  GigaBytes

rst.shape  torch.Size([1, 2896, 128])
m.shape torch.Size([2596, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0067138671875 GB
    Memory Allocated: 1.7679920196533203  GigaBytes
Max Memory Allocated: 1.7696208953857422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0067138671875 GB
    Memory Allocated: 1.7679920196533203  GigaBytes
Max Memory Allocated: 1.7696208953857422  GigaBytes

 h.shape torch.Size([1, 2596, 128]), torch.Size([1, 2596, 128])
----------------------------------------3
 Nvidia-smi: 4.0067138671875 GB
    Memory Allocated: 1.770528793334961  GigaBytes
Max Memory Allocated: 1.770528793334961  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2156982421875 GB
    Memory Allocated: 1.9503674507141113  GigaBytes
Max Memory Allocated: 1.9627461433410645  GigaBytes

rst.shape  torch.Size([1, 2596, 128])
m.shape torch.Size([2358, 11, 128])
----------------------------------------1
 Nvidia-smi: 4.2156982421875 GB
    Memory Allocated: 1.961442470550537  GigaBytes
Max Memory Allocated: 1.9627461433410645  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2156982421875 GB
    Memory Allocated: 1.961442470550537  GigaBytes
Max Memory Allocated: 1.9627461433410645  GigaBytes

 h.shape torch.Size([1, 2358, 128]), torch.Size([1, 2358, 128])
----------------------------------------3
 Nvidia-smi: 4.2156982421875 GB
    Memory Allocated: 1.9637808799743652  GigaBytes
Max Memory Allocated: 1.9637808799743652  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3660888671875 GB
    Memory Allocated: 2.1442160606384277  GigaBytes
Max Memory Allocated: 2.1565842628479004  GigaBytes

rst.shape  torch.Size([1, 2358, 128])
m.shape torch.Size([2089, 12, 128])
----------------------------------------1
 Nvidia-smi: 4.3660888671875 GB
    Memory Allocated: 2.1548657417297363  GigaBytes
Max Memory Allocated: 2.1565842628479004  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3660888671875 GB
    Memory Allocated: 2.1548657417297363  GigaBytes
Max Memory Allocated: 2.1565842628479004  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 4.3660888671875 GB
    Memory Allocated: 2.1570138931274414  GigaBytes
Max Memory Allocated: 2.1570138931274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5555419921875 GB
    Memory Allocated: 2.332223892211914  GigaBytes
Max Memory Allocated: 2.34417724609375  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([1870, 13, 128])
----------------------------------------1
 Nvidia-smi: 4.5555419921875 GB
    Memory Allocated: 2.342576026916504  GigaBytes
Max Memory Allocated: 2.34417724609375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5555419921875 GB
    Memory Allocated: 2.342576026916504  GigaBytes
Max Memory Allocated: 2.34417724609375  GigaBytes

 h.shape torch.Size([1, 1870, 128]), torch.Size([1, 1870, 128])
----------------------------------------3
 Nvidia-smi: 4.5574951171875 GB
    Memory Allocated: 2.3443593978881836  GigaBytes
Max Memory Allocated: 2.3443593978881836  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7410888671875 GB
    Memory Allocated: 2.5089006423950195  GigaBytes
Max Memory Allocated: 2.5204925537109375  GigaBytes

rst.shape  torch.Size([1, 1870, 128])
m.shape torch.Size([1652, 14, 128])
----------------------------------------1
 Nvidia-smi: 4.7410888671875 GB
    Memory Allocated: 2.5190372467041016  GigaBytes
Max Memory Allocated: 2.5204925537109375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7410888671875 GB
    Memory Allocated: 2.5190372467041016  GigaBytes
Max Memory Allocated: 2.5204925537109375  GigaBytes

 h.shape torch.Size([1, 1652, 128]), torch.Size([1, 1652, 128])
----------------------------------------3
 Nvidia-smi: 4.7410888671875 GB
    Memory Allocated: 2.5206127166748047  GigaBytes
Max Memory Allocated: 2.5206127166748047  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9188232421875 GB
    Memory Allocated: 2.680337905883789  GigaBytes
Max Memory Allocated: 2.692056655883789  GigaBytes

rst.shape  torch.Size([1, 1652, 128])
m.shape torch.Size([1553, 15, 128])
----------------------------------------1
 Nvidia-smi: 4.9188232421875 GB
    Memory Allocated: 2.6912689208984375  GigaBytes
Max Memory Allocated: 2.692056655883789  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9188232421875 GB
    Memory Allocated: 2.6912689208984375  GigaBytes
Max Memory Allocated: 2.692056655883789  GigaBytes

 h.shape torch.Size([1, 1553, 128]), torch.Size([1, 1553, 128])
----------------------------------------3
 Nvidia-smi: 4.9207763671875 GB
    Memory Allocated: 2.6927499771118164  GigaBytes
Max Memory Allocated: 2.6927499771118164  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1082763671875 GB
    Memory Allocated: 2.8505563735961914  GigaBytes
Max Memory Allocated: 2.861664295196533  GigaBytes

rst.shape  torch.Size([1, 1553, 128])
m.shape torch.Size([1351, 16, 128])
----------------------------------------1
 Nvidia-smi: 5.1082763671875 GB
    Memory Allocated: 2.8601231575012207  GigaBytes
Max Memory Allocated: 2.861664295196533  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1082763671875 GB
    Memory Allocated: 2.8601231575012207  GigaBytes
Max Memory Allocated: 2.861664295196533  GigaBytes

 h.shape torch.Size([1, 1351, 128]), torch.Size([1, 1351, 128])
----------------------------------------3
 Nvidia-smi: 5.1082763671875 GB
    Memory Allocated: 2.8614115715026855  GigaBytes
Max Memory Allocated: 2.861664295196533  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2801513671875 GB
    Memory Allocated: 3.007725238800049  GigaBytes
Max Memory Allocated: 3.0180325508117676  GigaBytes

rst.shape  torch.Size([1, 1351, 128])
m.shape torch.Size([1297, 17, 128])
----------------------------------------1
 Nvidia-smi: 5.2801513671875 GB
    Memory Allocated: 3.017594814300537  GigaBytes
Max Memory Allocated: 3.0180325508117676  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2801513671875 GB
    Memory Allocated: 3.017594814300537  GigaBytes
Max Memory Allocated: 3.0180325508117676  GigaBytes

 h.shape torch.Size([1, 1297, 128]), torch.Size([1, 1297, 128])
----------------------------------------3
 Nvidia-smi: 5.2801513671875 GB
    Memory Allocated: 3.018831729888916  GigaBytes
Max Memory Allocated: 3.018831729888916  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4520263671875 GB
    Memory Allocated: 3.1672616004943848  GigaBytes
Max Memory Allocated: 3.1777753829956055  GigaBytes

rst.shape  torch.Size([1, 1297, 128])
m.shape torch.Size([1143, 18, 128])
----------------------------------------1
 Nvidia-smi: 5.4520263671875 GB
    Memory Allocated: 3.1764535903930664  GigaBytes
Max Memory Allocated: 3.1777753829956055  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4520263671875 GB
    Memory Allocated: 3.1764535903930664  GigaBytes
Max Memory Allocated: 3.1777753829956055  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 5.4520263671875 GB
    Memory Allocated: 3.1775436401367188  GigaBytes
Max Memory Allocated: 3.1777753829956055  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6043701171875 GB
    Memory Allocated: 3.316220283508301  GigaBytes
Max Memory Allocated: 3.326030731201172  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([1043, 19, 128])
----------------------------------------1
 Nvidia-smi: 5.6043701171875 GB
    Memory Allocated: 3.325124740600586  GigaBytes
Max Memory Allocated: 3.326030731201172  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6043701171875 GB
    Memory Allocated: 3.325124740600586  GigaBytes
Max Memory Allocated: 3.326030731201172  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 5.6063232421875 GB
    Memory Allocated: 3.3261194229125977  GigaBytes
Max Memory Allocated: 3.3261194229125977  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7489013671875 GB
    Memory Allocated: 3.460484027862549  GigaBytes
Max Memory Allocated: 3.46993350982666  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([16501, 20, 128])
----------------------------------------1
 Nvidia-smi: 5.9071044921875 GB
    Memory Allocated: 3.618189811706543  GigaBytes
Max Memory Allocated: 3.6221423149108887  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9071044921875 GB
    Memory Allocated: 3.618189811706543  GigaBytes
Max Memory Allocated: 3.6221423149108887  GigaBytes

 h.shape torch.Size([1, 16501, 128]), torch.Size([1, 16501, 128])
----------------------------------------3
 Nvidia-smi: 5.9266357421875 GB
    Memory Allocated: 3.6339263916015625  GigaBytes
Max Memory Allocated: 3.6339263916015625  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.852784156799316  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

rst.shape  torch.Size([1, 16501, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.524523735046387  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.541627407073975  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.5587310791015625  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.541092872619629  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

torch.Size([71738, 64])
input nodes number: 141071
output nodes number: 71738
edges number: 736095
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.559856414794922  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.57696008682251  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.581236362457275  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.581236362457275  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

torch.Size([71738, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.581236362457275  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

m.shape torch.Size([2693, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.610723495483398  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.610723495483398  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

 h.shape torch.Size([1, 2693, 64]), torch.Size([1, 2693, 64])
----------------------------------------3
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.612008094787598  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.622319221496582  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

rst.shape  torch.Size([1, 2693, 64])
m.shape torch.Size([3246, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.623326778411865  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.623326778411865  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

 h.shape torch.Size([1, 3246, 64]), torch.Size([1, 3246, 64])
----------------------------------------3
 Nvidia-smi: 8.4871826171875 GB
    Memory Allocated: 5.624874591827393  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4930419921875 GB
    Memory Allocated: 5.652286052703857  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

rst.shape  torch.Size([1, 3246, 64])
m.shape torch.Size([33995, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.4930419921875 GB
    Memory Allocated: 5.6765875816345215  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4930419921875 GB
    Memory Allocated: 5.6765875816345215  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

 h.shape torch.Size([1, 33995, 64]), torch.Size([1, 33995, 64])
----------------------------------------3
 Nvidia-smi: 8.4930419921875 GB
    Memory Allocated: 5.692798137664795  GigaBytes
Max Memory Allocated: 6.010987281799316  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.049421787261963  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

rst.shape  torch.Size([1, 33995, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.023585319519043  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.033106327056885  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.043116569519043  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.033298015594482  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

torch.Size([39934, 64])
input nodes number: 71738
output nodes number: 39934
edges number: 111170
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.043652057647705  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.053173065185547  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.05573034286499  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.05573034286499  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

m.shape torch.Size([1654, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.06700325012207  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.06700325012207  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

 h.shape torch.Size([1, 1654, 64]), torch.Size([1, 1654, 64])
----------------------------------------3
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.067791938781738  GigaBytes
Max Memory Allocated: 6.073737144470215  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.074250221252441  GigaBytes
Max Memory Allocated: 6.074644565582275  GigaBytes

rst.shape  torch.Size([1, 1654, 64])
m.shape torch.Size([1503, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.074594974517822  GigaBytes
Max Memory Allocated: 6.074644565582275  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.074594974517822  GigaBytes
Max Memory Allocated: 6.074644565582275  GigaBytes

 h.shape torch.Size([1, 1503, 64]), torch.Size([1, 1503, 64])
----------------------------------------3
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.07531213760376  GigaBytes
Max Memory Allocated: 6.07531213760376  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.086424350738525  GigaBytes
Max Memory Allocated: 6.087141036987305  GigaBytes

rst.shape  torch.Size([1, 1503, 64])
m.shape torch.Size([1171, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.086929798126221  GigaBytes
Max Memory Allocated: 6.087141036987305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.086929798126221  GigaBytes
Max Memory Allocated: 6.087141036987305  GigaBytes

 h.shape torch.Size([1, 1171, 64]), torch.Size([1, 1171, 64])
----------------------------------------3
 Nvidia-smi: 8.5574951171875 GB
    Memory Allocated: 6.087488651275635  GigaBytes
Max Memory Allocated: 6.087488651275635  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5594482421875 GB
    Memory Allocated: 6.1028218269348145  GigaBytes
Max Memory Allocated: 6.103659629821777  GigaBytes

rst.shape  torch.Size([1, 1171, 64])
m.shape torch.Size([918, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.5594482421875 GB
    Memory Allocated: 6.103445529937744  GigaBytes
Max Memory Allocated: 6.103659629821777  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5594482421875 GB
    Memory Allocated: 6.103445529937744  GigaBytes
Max Memory Allocated: 6.103659629821777  GigaBytes

 h.shape torch.Size([1, 918, 64]), torch.Size([1, 918, 64])
----------------------------------------3
 Nvidia-smi: 8.5594482421875 GB
    Memory Allocated: 6.103883266448975  GigaBytes
Max Memory Allocated: 6.103883266448975  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5711669921875 GB
    Memory Allocated: 6.116577625274658  GigaBytes
Max Memory Allocated: 6.117453098297119  GigaBytes

rst.shape  torch.Size([1, 918, 64])
m.shape torch.Size([6122, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.5711669921875 GB
    Memory Allocated: 6.123973846435547  GigaBytes
Max Memory Allocated: 6.124088287353516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5711669921875 GB
    Memory Allocated: 6.123973846435547  GigaBytes
Max Memory Allocated: 6.124088287353516  GigaBytes

 h.shape torch.Size([1, 6122, 64]), torch.Size([1, 6122, 64])
----------------------------------------3
 Nvidia-smi: 8.5711669921875 GB
    Memory Allocated: 6.127368927001953  GigaBytes
Max Memory Allocated: 6.127368927001953  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6688232421875 GB
    Memory Allocated: 6.235532760620117  GigaBytes
Max Memory Allocated: 6.242830753326416  GigaBytes

rst.shape  torch.Size([1, 6122, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6688232421875 GB
    Memory Allocated: 6.226239204406738  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6688232421875 GB
    Memory Allocated: 6.227969169616699  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6688232421875 GB
    Memory Allocated: 6.22969913482666  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.6688232421875 GB
    Memory Allocated: 6.227884292602539  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([11368, 40])
input nodes number: 39934
output nodes number: 11368
edges number: 42455
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.6688232421875 GB
    Memory Allocated: 6.229996681213379  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04510021209716797 |0.35814380645751953 |0.6279888153076172 |0.0002009868621826172 |0.05695199966430664 |0.008408546447753906 |
----------------------------------------------------------pseudo_mini_loss sum 4.971736907958984
for loop block_dataloader item  time:  1.3595168590545654
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.0790719985961914  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.0790719985961914  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([141017, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.0790719985961914  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

m.shape torch.Size([4395, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.4395785331726074  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.4395785331726074  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 4395, 128]), torch.Size([1, 4395, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.4437699317932129  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.47730112075805664  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 4395, 128])
m.shape torch.Size([5472, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.4804239273071289  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.4804239273071289  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 5472, 128]), torch.Size([1, 5472, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.48709583282470703  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.565373420715332  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 5472, 128])
m.shape torch.Size([5421, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.570518970489502  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.570518970489502  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 5421, 128]), torch.Size([1, 5421, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.5757131576538086  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.6931862831115723  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 5421, 128])
m.shape torch.Size([5020, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.6994290351867676  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.6994290351867676  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 5020, 128]), torch.Size([1, 5020, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.7051548957824707  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.8466610908508301  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 5020, 128])
m.shape torch.Size([4705, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.8562359809875488  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.8562359809875488  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 4705, 128]), torch.Size([1, 4705, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 0.8612546920776367  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.0227880477905273  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 4705, 128])
m.shape torch.Size([3976, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.0319199562072754  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.0319199562072754  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 3976, 128]), torch.Size([1, 3976, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.0360260009765625  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.2025418281555176  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 3976, 128])
m.shape torch.Size([3487, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.2117128372192383  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.2117128372192383  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 3487, 128]), torch.Size([1, 3487, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.215919017791748  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.3829975128173828  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 3487, 128])
m.shape torch.Size([3139, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.3933091163635254  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.3933091163635254  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 3139, 128]), torch.Size([1, 3139, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.396413803100586  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.5699515342712402  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 3139, 128])
m.shape torch.Size([2812, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.5805225372314453  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.5805225372314453  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2812, 128]), torch.Size([1, 2812, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.5832805633544922  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.7612829208374023  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2812, 128])
m.shape torch.Size([2594, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.7715520858764648  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.7715520858764648  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2594, 128]), torch.Size([1, 2594, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.7740325927734375  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.952362060546875  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2594, 128])
m.shape torch.Size([2265, 11, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.963005542755127  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.963005542755127  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2265, 128]), torch.Size([1, 2265, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 1.9653244018554688  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.1375341415405273  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2265, 128])
m.shape torch.Size([2065, 12, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.1482701301574707  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.1482701301574707  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2065, 128]), torch.Size([1, 2065, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.1503472328186035  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.3244810104370117  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2065, 128])
m.shape torch.Size([1909, 13, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.334507465362549  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.334507465362549  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1909, 128]), torch.Size([1, 1909, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.3363280296325684  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.50423526763916  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1909, 128])
m.shape torch.Size([1627, 14, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.514186382293701  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.514186382293701  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1627, 128]), torch.Size([1, 1627, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.515738010406494  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.6757311820983887  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1627, 128])
m.shape torch.Size([1496, 15, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.6856555938720703  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.6856555938720703  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1496, 128]), torch.Size([1, 1496, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.687082290649414  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.838582992553711  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1496, 128])
m.shape torch.Size([1314, 16, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.8478946685791016  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.8478946685791016  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1314, 128]), torch.Size([1, 1314, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.8491477966308594  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 2.991036891937256  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1314, 128])
m.shape torch.Size([1287, 17, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.000843048095703  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.000843048095703  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.002070426940918  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.149355888366699  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1287, 128])
m.shape torch.Size([1171, 18, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.1587929725646973  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.1587929725646973  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1171, 128]), torch.Size([1, 1171, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.159909725189209  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.304105281829834  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1171, 128])
m.shape torch.Size([1034, 19, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.3129148483276367  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.3129148483276367  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1034, 128]), torch.Size([1, 1034, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.313900947570801  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.4469223022460938  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1034, 128])
m.shape torch.Size([16484, 20, 128])
----------------------------------------1
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.603632926940918  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.603632926940918  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 16484, 128]), torch.Size([1, 16484, 128])
----------------------------------------3
 Nvidia-smi: 8.7039794921875 GB
    Memory Allocated: 3.6193532943725586  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.8359575271606445  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 16484, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.511379718780518  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.528468132019043  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.545556545257568  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.5279340744018555  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([71673, 64])
input nodes number: 141017
output nodes number: 71673
edges number: 732869
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.546728134155273  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.563816547393799  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.5690107345581055  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.5690107345581055  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([71673, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.5690107345581055  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

m.shape torch.Size([2749, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.598367691040039  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.598367691040039  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2749, 64]), torch.Size([1, 2749, 64])
----------------------------------------3
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.599678993225098  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.610166549682617  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2749, 64])
m.shape torch.Size([3253, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.6111907958984375  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.6111907958984375  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 3253, 64]), torch.Size([1, 3253, 64])
----------------------------------------3
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.6127424240112305  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.640262603759766  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 3253, 64])
m.shape torch.Size([33786, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.664407730102539  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.664407730102539  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 33786, 64]), torch.Size([1, 33786, 64])
----------------------------------------3
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 5.68051815032959  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.034947395324707  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 33786, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.009263515472412  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.019308567047119  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.029353618621826  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.019011974334717  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([39788, 64])
input nodes number: 71673
output nodes number: 39788
edges number: 110613
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.029329776763916  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.039374828338623  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.041209697723389  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.041209697723389  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

m.shape torch.Size([1739, 1, 64])
----------------------------------------1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.0524702072143555  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.0524702072143555  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1739, 64]), torch.Size([1, 1739, 64])
----------------------------------------3
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.053299903869629  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.059948444366455  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1739, 64])
m.shape torch.Size([1433, 2, 64])
----------------------------------------1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.060238361358643  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.060238361358643  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1433, 64]), torch.Size([1, 1433, 64])
----------------------------------------3
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.060922145843506  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.072709083557129  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1433, 64])
m.shape torch.Size([1185, 3, 64])
----------------------------------------1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.073241710662842  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.073241710662842  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1185, 64]), torch.Size([1, 1185, 64])
----------------------------------------3
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.073807239532471  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.087401390075684  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1185, 64])
m.shape torch.Size([904, 4, 64])
----------------------------------------1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.088007926940918  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.088007926940918  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 904, 64]), torch.Size([1, 904, 64])
----------------------------------------3
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.088438987731934  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.100939750671387  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 904, 64])
m.shape torch.Size([6107, 5, 64])
----------------------------------------1
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.108232498168945  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.108232498168945  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 6107, 64]), torch.Size([1, 6107, 64])
----------------------------------------3
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.111757278442383  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.220466613769531  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 6107, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.2115678787231445  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.213330268859863  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.215092658996582  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.213245391845703  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([11368, 40])
input nodes number: 39788
output nodes number: 11368
edges number: 42311
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 6.213659286499023  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03322935104370117 |0.1808459758758545 |0.4121588468551636 |0.000538945198059082 |0.05694568157196045 |0.006176948547363281 |
----------------------------------------------------------pseudo_mini_loss sum 3.885798454284668
for loop block_dataloader item  time:  1.7518362998962402
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 0.07917928695678711  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 0.07917928695678711  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([141058, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8621826171875 GB
    Memory Allocated: 0.07917928695678711  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

m.shape torch.Size([4317, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.4436478614807129  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.4436478614807129  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 4317, 128]), torch.Size([1, 4317, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.44776487350463867  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.4807009696960449  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 4317, 128])
m.shape torch.Size([5378, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.48377132415771484  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.48377132415771484  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 5378, 128]), torch.Size([1, 5378, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.4898204803466797  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.5667533874511719  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 5378, 128])
m.shape torch.Size([5276, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.5717363357543945  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.5717363357543945  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 5276, 128]), torch.Size([1, 5276, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.5767679214477539  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.6875600814819336  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 5276, 128])
m.shape torch.Size([4918, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.6945123672485352  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.6945123672485352  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 4918, 128]), torch.Size([1, 4918, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.6992025375366211  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.840611457824707  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 4918, 128])
m.shape torch.Size([4572, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.8499917984008789  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.8499917984008789  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 4572, 128]), torch.Size([1, 4572, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 0.8552875518798828  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.0122547149658203  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 4572, 128])
m.shape torch.Size([3993, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.021498680114746  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.021498680114746  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 3993, 128]), torch.Size([1, 3993, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.0256476402282715  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.1926336288452148  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 3993, 128])
m.shape torch.Size([3531, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.2025156021118164  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.2025156021118164  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 3531, 128]), torch.Size([1, 3531, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.2061033248901367  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.3800649642944336  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 3531, 128])
m.shape torch.Size([3211, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.3906302452087402  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.3906302452087402  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 3211, 128]), torch.Size([1, 3211, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.3939414024353027  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.5692172050476074  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 3211, 128])
m.shape torch.Size([2816, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.5797710418701172  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.5797710418701172  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2816, 128]), torch.Size([1, 2816, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.5825777053833008  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.7595887184143066  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2816, 128])
m.shape torch.Size([2592, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.7706055641174316  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.7706055641174316  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2592, 128]), torch.Size([1, 2592, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.773190975189209  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.9554266929626465  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2592, 128])
m.shape torch.Size([2301, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.9662599563598633  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.9662599563598633  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2301, 128]), torch.Size([1, 2301, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 1.968515396118164  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.149501323699951  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2301, 128])
m.shape torch.Size([2110, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.160477638244629  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.160477638244629  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.1624984741210938  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.3370237350463867  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([1914, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.3478822708129883  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.3478822708129883  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1914, 128]), torch.Size([1, 1914, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.34970760345459  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.518159866333008  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1914, 128])
m.shape torch.Size([1662, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.5283422470092773  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.5283422470092773  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.5299272537231445  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.6901731491088867  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([1553, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.700488567352295  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.700488567352295  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1553, 128]), torch.Size([1, 1553, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.701969623565674  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.858961582183838  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1553, 128])
m.shape torch.Size([1351, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.868528366088867  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.868528366088867  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1351, 128]), torch.Size([1, 1351, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 2.869816780090332  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.0154075622558594  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1351, 128])
m.shape torch.Size([1348, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.0256905555725098  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.0256905555725098  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1348, 128]), torch.Size([1, 1348, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.0269761085510254  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.1821274757385254  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1348, 128])
m.shape torch.Size([1178, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.1915955543518066  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.1915955543518066  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.192718982696533  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.336361885070801  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1178, 128])
m.shape torch.Size([1059, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.3453946113586426  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.3453946113586426  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.346404552459717  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.4818129539489746  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([16641, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.6400089263916016  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.6400089263916016  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 16641, 128]), torch.Size([1, 16641, 128])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 3.655879020690918  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.893562316894531  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 16641, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.563321113586426  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.580420970916748  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.59752082824707  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.579886436462402  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([71721, 64])
input nodes number: 141058
output nodes number: 71721
edges number: 739813
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.598618984222412  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.615718841552734  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.619994163513184  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.619994163513184  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([71721, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.619994163513184  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

m.shape torch.Size([2692, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.649416446685791  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.649416446685791  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 2692, 64]), torch.Size([1, 2692, 64])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.650700092315674  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.661818027496338  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 2692, 64])
m.shape torch.Size([3151, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.662754535675049  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.662754535675049  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 3151, 64]), torch.Size([1, 3151, 64])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.664257526397705  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.690733432769775  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 3151, 64])
m.shape torch.Size([33975, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.715042591094971  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.715042591094971  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 33975, 64]), torch.Size([1, 33975, 64])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 5.73124361038208  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.087657451629639  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 33975, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.061978340148926  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.071471691131592  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.080965042114258  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.071174621582031  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

torch.Size([39818, 64])
input nodes number: 71721
output nodes number: 39818
edges number: 110919
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.08150053024292  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.090993881225586  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.09338903427124  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.09338903427124  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

m.shape torch.Size([1687, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.104689121246338  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.104689121246338  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1687, 64]), torch.Size([1, 1687, 64])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.105494022369385  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.1123046875  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1687, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.112630844116211  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.112630844116211  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1481, 64]), torch.Size([1, 1481, 64])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.113337516784668  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.124235153198242  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1481, 64])
m.shape torch.Size([1108, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.124699115753174  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.124699115753174  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 1108, 64]), torch.Size([1, 1108, 64])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.125227451324463  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.137981414794922  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 1108, 64])
m.shape torch.Size([909, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.138611316680908  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.138611316680908  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 909, 64]), torch.Size([1, 909, 64])
----------------------------------------3
 Nvidia-smi: 9.2156982421875 GB
    Memory Allocated: 6.139045238494873  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.151617527008057  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

rst.shape  torch.Size([1, 909, 64])
m.shape torch.Size([6183, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.159002304077148  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.159002304077148  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

 h.shape torch.Size([1, 6183, 64]), torch.Size([1, 6183, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.161989212036133  GigaBytes
Max Memory Allocated: 6.2429656982421875  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.268655300140381  GigaBytes
Max Memory Allocated: 6.276026248931885  GigaBytes

rst.shape  torch.Size([1, 6183, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.260656833648682  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.262415409088135  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.264173984527588  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.262330532073975  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

torch.Size([11368, 40])
input nodes number: 39818
output nodes number: 11368
edges number: 42524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.26270866394043  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03143715858459473 |0.12202588717142741 |0.31302881240844727 |0.0006296634674072266 |0.05685774485270182 |0.006586551666259766 |
----------------------------------------------------------pseudo_mini_loss sum 3.1548752784729004
for loop block_dataloader item  time:  2.0727484226226807
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.07912635803222656  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.07912635803222656  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

torch.Size([140969, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.07912635803222656  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

m.shape torch.Size([4309, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.44250011444091797  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.44250011444091797  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 4309, 128]), torch.Size([1, 4309, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.4466094970703125  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.47948455810546875  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 4309, 128])
m.shape torch.Size([5504, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.4826788902282715  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.4826788902282715  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 5504, 128]), torch.Size([1, 5504, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.4888033866882324  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.5675387382507324  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 5504, 128])
m.shape torch.Size([5380, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.5726103782653809  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.5726103782653809  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 5380, 128]), torch.Size([1, 5380, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.5777411460876465  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.6949610710144043  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 5380, 128])
m.shape torch.Size([5053, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.7011885643005371  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.7011885643005371  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 5053, 128]), torch.Size([1, 5053, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.7060074806213379  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.84808349609375  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 5053, 128])
m.shape torch.Size([4504, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.856412410736084  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.856412410736084  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 4504, 128]), torch.Size([1, 4504, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.8607077598571777  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.0169577598571777  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 4504, 128])
m.shape torch.Size([3922, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.0260310173034668  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.0260310173034668  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 3922, 128]), torch.Size([1, 3922, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.0299558639526367  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.1965246200561523  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 3922, 128])
m.shape torch.Size([3582, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.2057809829711914  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.2057809829711914  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 3582, 128]), torch.Size([1, 3582, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.2091970443725586  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.3837146759033203  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 3582, 128])
m.shape torch.Size([3161, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.3940649032592773  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.3940649032592773  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 3161, 128]), torch.Size([1, 3161, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.3974380493164062  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.5692682266235352  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 3161, 128])
m.shape torch.Size([2847, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.5799789428710938  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.5799789428710938  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 2847, 128]), torch.Size([1, 2847, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.5828666687011719  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.7602248191833496  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 2847, 128])
m.shape torch.Size([2566, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.7705774307250977  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.7705774307250977  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 2566, 128]), torch.Size([1, 2566, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.773137092590332  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.9537601470947266  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 2566, 128])
m.shape torch.Size([2314, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.9638805389404297  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.9638805389404297  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 2314, 128]), torch.Size([1, 2314, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.9661884307861328  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.1496963500976562  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 2314, 128])
m.shape torch.Size([2081, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.159956932067871  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.159956932067871  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 2081, 128]), torch.Size([1, 2081, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.1620593070983887  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.336714267730713  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 2081, 128])
m.shape torch.Size([1895, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.347468852996826  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.347468852996826  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1895, 128]), torch.Size([1, 1895, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.349276065826416  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.5164899826049805  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1895, 128])
m.shape torch.Size([1636, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.52650785446167  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.52650785446167  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1636, 128]), torch.Size([1, 1636, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.5280680656433105  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.6873812675476074  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1636, 128])
m.shape torch.Size([1523, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.6974945068359375  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.6974945068359375  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1523, 128]), torch.Size([1, 1523, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.698946952819824  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.8529062271118164  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1523, 128])
m.shape torch.Size([1386, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.8627543449401855  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.8627543449401855  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1386, 128]), torch.Size([1, 1386, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.8640761375427246  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.0136232376098633  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1386, 128])
m.shape torch.Size([1329, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.023735523223877  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.023735523223877  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1329, 128]), torch.Size([1, 1329, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.025002956390381  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.1770949363708496  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1329, 128])
m.shape torch.Size([1165, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.186460494995117  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.186460494995117  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.1875715255737305  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.329604148864746  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([1029, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.3383712768554688  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.3383712768554688  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1029, 128]), torch.Size([1, 1029, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.339352607727051  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.4720816612243652  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1029, 128])
m.shape torch.Size([16680, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.6306638717651367  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.6306638717651367  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 16680, 128]), torch.Size([1, 16680, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.646571159362793  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.889498710632324  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 16680, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.561089992523193  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.578224182128906  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.595358371734619  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.577688694000244  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

torch.Size([71866, 64])
input nodes number: 140969
output nodes number: 71866
edges number: 739066
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.596462726593018  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.6135969161987305  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.617880821228027  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.617880821228027  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

torch.Size([71866, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.617880821228027  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

m.shape torch.Size([2681, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.64731502532959  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.64731502532959  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 2681, 64]), torch.Size([1, 2681, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.648593902587891  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.659851551055908  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 2681, 64])
m.shape torch.Size([3244, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.660922050476074  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.660922050476074  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 3244, 64]), torch.Size([1, 3244, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.662468910217285  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.6888532638549805  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 3244, 64])
m.shape torch.Size([33936, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.713111400604248  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.713111400604248  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 33936, 64]), torch.Size([1, 33936, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.729293346405029  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.085296154022217  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 33936, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.059504985809326  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.069008827209473  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.07874870300293  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.068947792053223  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

torch.Size([39861, 64])
input nodes number: 71866
output nodes number: 39861
edges number: 110977
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.079285144805908  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.088788986206055  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.091186046600342  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.091186046600342  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

m.shape torch.Size([1694, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.10244607925415  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.10244607925415  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1694, 64]), torch.Size([1, 1694, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.1032538414001465  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.110133647918701  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1694, 64])
m.shape torch.Size([1471, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.110453128814697  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.110453128814697  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1471, 64]), torch.Size([1, 1471, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.111155033111572  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.122015476226807  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1471, 64])
m.shape torch.Size([1172, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.122529029846191  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.122529029846191  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 1172, 64]), torch.Size([1, 1172, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.1230878829956055  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.137204647064209  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 1172, 64])
m.shape torch.Size([946, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.1378560066223145  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.1378560066223145  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 946, 64]), torch.Size([1, 946, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.138307094573975  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.151388645172119  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

rst.shape  torch.Size([1, 946, 64])
m.shape torch.Size([6085, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.158644199371338  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.158644199371338  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

 h.shape torch.Size([1, 6085, 64]), torch.Size([1, 6085, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.1616106033325195  GigaBytes
Max Memory Allocated: 6.277199745178223  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.270166397094727  GigaBytes
Max Memory Allocated: 6.277420520782471  GigaBytes

rst.shape  torch.Size([1, 6085, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.26128625869751  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.263153553009033  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.265020847320557  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.263068675994873  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

torch.Size([11368, 40])
input nodes number: 39861
output nodes number: 11368
edges number: 42361
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 6.263559341430664  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03131103515625 |0.09256929159164429 |0.26259666681289673 |0.0007066130638122559 |0.055834054946899414 |0.00668644905090332 |
----------------------------------------------------------pseudo_mini_loss sum 2.8522756099700928
for loop block_dataloader item  time:  2.382913112640381
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.07941150665283203  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.07941150665283203  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

torch.Size([141297, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.07941150665283203  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

m.shape torch.Size([4287, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.4438776969909668  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.4438776969909668  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 4287, 128]), torch.Size([1, 4287, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.4479660987854004  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.48067331314086914  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 4287, 128])
m.shape torch.Size([5458, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.48383426666259766  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.48383426666259766  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 5458, 128]), torch.Size([1, 5458, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.4899787902832031  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.5680561065673828  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 5458, 128])
m.shape torch.Size([5428, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.5732183456420898  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.5732183456420898  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 5428, 128]), torch.Size([1, 5428, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.578394889831543  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.6959600448608398  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 5428, 128])
m.shape torch.Size([5116, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.7023992538452148  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.7023992538452148  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 5116, 128]), torch.Size([1, 5116, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.7081575393676758  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.8497552871704102  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 5116, 128])
m.shape torch.Size([4674, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.8584442138671875  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.8584442138671875  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 4674, 128]), torch.Size([1, 4674, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 0.8633308410644531  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.024658203125  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 4674, 128])
m.shape torch.Size([4061, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.034048080444336  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.034048080444336  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 4061, 128]), torch.Size([1, 4061, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.0380287170410156  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.2056207656860352  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 4061, 128])
m.shape torch.Size([3556, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.2153868675231934  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.2153868675231934  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 3556, 128]), torch.Size([1, 3556, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.2187895774841309  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.3923163414001465  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 3556, 128])
m.shape torch.Size([3265, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.4030756950378418  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.4030756950378418  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 3265, 128]), torch.Size([1, 3265, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.4063282012939453  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.590601921081543  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 3265, 128])
m.shape torch.Size([2894, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.6014647483825684  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.6014647483825684  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 2894, 128]), torch.Size([1, 2894, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.6044530868530273  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.7841796875  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 2894, 128])
m.shape torch.Size([2568, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.7950448989868164  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.7950448989868164  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 2568, 128]), torch.Size([1, 2568, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.7976360321044922  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.9732346534729004  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 2568, 128])
m.shape torch.Size([2292, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.984032154083252  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.984032154083252  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 2292, 128]), torch.Size([1, 2292, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 1.986340045928955  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.167158603668213  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 2292, 128])
m.shape torch.Size([2012, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.1775784492492676  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.1775784492492676  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 2012, 128]), torch.Size([1, 2012, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.179497241973877  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.345390796661377  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 2012, 128])
m.shape torch.Size([1855, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.3559303283691406  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.3559303283691406  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1855, 128]), torch.Size([1, 1855, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.357699394226074  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.5223517417907715  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1855, 128])
m.shape torch.Size([1664, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.5325756072998047  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.5325756072998047  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1664, 128]), torch.Size([1, 1664, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.5341625213623047  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.6941967010498047  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1664, 128])
m.shape torch.Size([1507, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.7041821479797363  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.7041821479797363  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1507, 128]), torch.Size([1, 1507, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.7056193351745605  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.858090400695801  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1507, 128])
m.shape torch.Size([1371, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.8678317070007324  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.8678317070007324  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1371, 128]), torch.Size([1, 1371, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 2.8691391944885254  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.0170741081237793  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1371, 128])
m.shape torch.Size([1274, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.026747703552246  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.026747703552246  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1274, 128]), torch.Size([1, 1274, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.0279626846313477  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.174309730529785  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1274, 128])
m.shape torch.Size([1204, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.1840362548828125  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.1840362548828125  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.1851844787597656  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.3310203552246094  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1060, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.3400497436523438  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.3400497436523438  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1060, 128]), torch.Size([1, 1060, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.3410606384277344  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.4781532287597656  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1060, 128])
m.shape torch.Size([16643, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.6363677978515625  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.6363677978515625  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 16643, 128]), torch.Size([1, 16643, 128])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 3.6522397994995117  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.890192031860352  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 16643, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.560718059539795  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.577929496765137  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.5951409339904785  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.577391624450684  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

torch.Size([72189, 64])
input nodes number: 141297
output nodes number: 72189
edges number: 740063
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.596229076385498  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.61344051361084  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.617743492126465  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.617743492126465  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

torch.Size([72189, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.617743492126465  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

m.shape torch.Size([2639, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.647469520568848  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.647469520568848  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 2639, 64]), torch.Size([1, 2639, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.648728370666504  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.659204959869385  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 2639, 64])
m.shape torch.Size([3178, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.660214900970459  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.660214900970459  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 3178, 64]), torch.Size([1, 3178, 64])
----------------------------------------3
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.6617302894592285  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2196044921875 GB
    Memory Allocated: 5.687891483306885  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 3178, 64])
m.shape torch.Size([34385, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 5.713293075561523  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 5.713293075561523  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 34385, 64]), torch.Size([1, 34385, 64])
----------------------------------------3
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 5.729689598083496  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.090404510498047  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 34385, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.064300537109375  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.074246883392334  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.084193229675293  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.073946952819824  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

torch.Size([40202, 64])
input nodes number: 72189
output nodes number: 40202
edges number: 112150
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.0843706130981445  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.0943169593811035  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.096395015716553  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.096395015716553  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

m.shape torch.Size([1651, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.107751846313477  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.107751846313477  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1651, 64]), torch.Size([1, 1651, 64])
----------------------------------------3
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.108539581298828  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.115544319152832  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1651, 64])
m.shape torch.Size([1397, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.115837574005127  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.115837574005127  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1397, 64]), torch.Size([1, 1397, 64])
----------------------------------------3
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.116504192352295  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.126638889312744  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1397, 64])
m.shape torch.Size([1144, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.12714958190918  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.12714958190918  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 1144, 64]), torch.Size([1, 1144, 64])
----------------------------------------3
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.127695083618164  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.140514373779297  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 1144, 64])
m.shape torch.Size([953, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.141179084777832  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.141179084777832  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 953, 64]), torch.Size([1, 953, 64])
----------------------------------------3
 Nvidia-smi: 9.2215576171875 GB
    Memory Allocated: 6.141633987426758  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.154814720153809  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

rst.shape  torch.Size([1, 953, 64])
m.shape torch.Size([6223, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.162238121032715  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.162238121032715  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

 h.shape torch.Size([1, 6223, 64]), torch.Size([1, 6223, 64])
----------------------------------------3
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.165919303894043  GigaBytes
Max Memory Allocated: 6.277973651885986  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.279214382171631  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 6223, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.270033836364746  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.272353649139404  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.2740478515625  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.271643161773682  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

torch.Size([11368, 40])
input nodes number: 40202
output nodes number: 11368
edges number: 42804
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 6.272480487823486  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030619335174560548 |0.07490105628967285 |0.23265519142150878 |0.0007328987121582031 |0.055249261856079104 |0.0068171024322509766 |
----------------------------------------------------------pseudo_mini_loss sum 2.863924741744995
for loop block_dataloader item  time:  2.6963536739349365
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 0.07973623275756836  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 0.07973623275756836  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

torch.Size([140999, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.2352294921875 GB
    Memory Allocated: 0.07973623275756836  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

m.shape torch.Size([4244, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.44507789611816406  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.44507789611816406  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 4244, 128]), torch.Size([1, 4244, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.4491252899169922  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.4815044403076172  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 4244, 128])
m.shape torch.Size([5488, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.4847145080566406  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.4847145080566406  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 5488, 128]), torch.Size([1, 5488, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.4899482727050781  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.5684547424316406  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 5488, 128])
m.shape torch.Size([5277, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.5733866691589355  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.5733866691589355  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 5277, 128]), torch.Size([1, 5277, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.5784192085266113  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.6893362998962402  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 5277, 128])
m.shape torch.Size([4924, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.6962118148803711  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.6962118148803711  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 4924, 128]), torch.Size([1, 4924, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.7009077072143555  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.843172550201416  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 4924, 128])
m.shape torch.Size([4577, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.8525643348693848  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.8525643348693848  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 4577, 128]), torch.Size([1, 4577, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.8569293022155762  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.0140681266784668  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 4577, 128])
m.shape torch.Size([3960, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.0232152938842773  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.0232152938842773  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 3960, 128]), torch.Size([1, 3960, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.0273103713989258  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.1929411888122559  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 3960, 128])
m.shape torch.Size([3603, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.2030792236328125  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.2030792236328125  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 3603, 128]), torch.Size([1, 3603, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.2067327499389648  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.3791699409484863  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 3603, 128])
m.shape torch.Size([3279, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.3899602890014648  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.3899602890014648  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 3279, 128]), torch.Size([1, 3279, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.3931608200073242  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.5788936614990234  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 3279, 128])
m.shape torch.Size([2829, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.5894708633422852  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.5894708633422852  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 2829, 128]), torch.Size([1, 2829, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.5921745300292969  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.7718100547790527  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 2829, 128])
m.shape torch.Size([2546, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.7826013565063477  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.7826013565063477  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 2546, 128]), torch.Size([1, 2546, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.7851037979125977  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.9597282409667969  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 2546, 128])
m.shape torch.Size([2289, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.9705204963684082  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.9705204963684082  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 2289, 128]), torch.Size([1, 2289, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.9727129936218262  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.152247905731201  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 2289, 128])
m.shape torch.Size([2079, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.163052558898926  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.163052558898926  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 2079, 128]), torch.Size([1, 2079, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.1650853157043457  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.3396663665771484  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 2079, 128])
m.shape torch.Size([1904, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.350477695465088  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.350477695465088  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1904, 128]), torch.Size([1, 1904, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.3522934913635254  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.519554615020752  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1904, 128])
m.shape torch.Size([1690, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.529928684234619  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.529928684234619  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1690, 128]), torch.Size([1, 1690, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.5315403938293457  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.692244052886963  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1690, 128])
m.shape torch.Size([1531, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.7023887634277344  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.7023887634277344  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1531, 128]), torch.Size([1, 1531, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.7038488388061523  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.8591108322143555  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1531, 128])
m.shape torch.Size([1317, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.8684287071228027  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.8684287071228027  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1317, 128]), torch.Size([1, 1317, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.8696846961975098  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.0118398666381836  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1317, 128])
m.shape torch.Size([1272, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.0215229988098145  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.0215229988098145  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1272, 128]), torch.Size([1, 1272, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.022736072540283  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.169037342071533  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1272, 128])
m.shape torch.Size([1168, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.1784558296203613  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.1784558296203613  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1168, 128]), torch.Size([1, 1168, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.179569721221924  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.321232318878174  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1168, 128])
m.shape torch.Size([1049, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.330179214477539  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.330179214477539  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1049, 128]), torch.Size([1, 1049, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.331179618835449  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.4653005599975586  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1049, 128])
m.shape torch.Size([16920, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.626162052154541  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.626162052154541  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 16920, 128]), torch.Size([1, 16920, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.6422982215881348  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.9733452796936035  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 16920, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.642544746398926  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.659698009490967  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.676851272583008  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.659161567687988  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

torch.Size([71946, 64])
input nodes number: 140999
output nodes number: 71946
edges number: 743321
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.677943706512451  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.695096969604492  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.699385643005371  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.699385643005371  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

torch.Size([71946, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.699385643005371  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

m.shape torch.Size([2643, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.728835105895996  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.728835105895996  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 2643, 64]), torch.Size([1, 2643, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.730095863342285  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.74044942855835  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 2643, 64])
m.shape torch.Size([3269, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.741431713104248  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.741431713104248  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 3269, 64]), torch.Size([1, 3269, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.742990970611572  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.768039226531982  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 3269, 64])
m.shape torch.Size([33964, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.792312145233154  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.792312145233154  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 33964, 64]), torch.Size([1, 33964, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.808507442474365  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.164803981781006  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 33964, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.139104843139648  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.148612022399902  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.158636093139648  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.148831367492676  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

torch.Size([39876, 64])
input nodes number: 71946
output nodes number: 39876
edges number: 111073
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.159173488616943  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.168680667877197  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.171058654785156  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.171058654785156  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

m.shape torch.Size([1633, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.182337760925293  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.182337760925293  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1633, 64]), torch.Size([1, 1633, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.183116912841797  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.189802169799805  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1633, 64])
m.shape torch.Size([1525, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.190162658691406  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.190162658691406  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1525, 64]), torch.Size([1, 1525, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.190890312194824  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.202152252197266  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1525, 64])
m.shape torch.Size([1169, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.202651023864746  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.202651023864746  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 1169, 64]), torch.Size([1, 1169, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.203208923339844  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.21735954284668  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 1169, 64])
m.shape torch.Size([897, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.217963218688965  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.217963218688965  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 897, 64]), torch.Size([1, 897, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.218391418457031  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.23079776763916  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

rst.shape  torch.Size([1, 897, 64])
m.shape torch.Size([6144, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.2381367683410645  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.2381367683410645  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

 h.shape torch.Size([1, 6144, 64]), torch.Size([1, 6144, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.2415547370910645  GigaBytes
Max Memory Allocated: 6.286633014678955  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.352165222167969  GigaBytes
Max Memory Allocated: 6.359489440917969  GigaBytes

rst.shape  torch.Size([1, 6144, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.343031883239746  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.344979286193848  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.347161769866943  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.345129489898682  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([11368, 40])
input nodes number: 39876
output nodes number: 11368
edges number: 42498
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.345139503479004  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03014949957529704 |0.06314718723297119 |0.2126147747039795 |0.0007585287094116211 |0.05486611525217692 |0.006690502166748047 |
----------------------------------------------------------pseudo_mini_loss sum 2.530148983001709
for loop block_dataloader item  time:  3.004727363586426
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.07944297790527344  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.07944297790527344  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([141199, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.07944297790527344  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

m.shape torch.Size([4449, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.44397592544555664  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.44397592544555664  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 4449, 128]), torch.Size([1, 4449, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.44821882247924805  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.4821619987487793  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 4449, 128])
m.shape torch.Size([5314, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.4851083755493164  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.4851083755493164  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 5314, 128]), torch.Size([1, 5314, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.490875244140625  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.5668926239013672  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 5314, 128])
m.shape torch.Size([5423, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.5721163749694824  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.5721163749694824  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 5423, 128]), torch.Size([1, 5423, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.5772881507873535  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.6947793960571289  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 5423, 128])
m.shape torch.Size([5017, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.7010202407836914  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.7010202407836914  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 5017, 128]), torch.Size([1, 5017, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.7068305015563965  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.8483338356018066  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 5017, 128])
m.shape torch.Size([4594, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.856501579284668  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.856501579284668  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 4594, 128]), torch.Size([1, 4594, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.861548900604248  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.0192713737487793  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 4594, 128])
m.shape torch.Size([3991, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.0284991264343262  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.0284991264343262  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 3991, 128]), torch.Size([1, 3991, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.0325121879577637  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.19840669631958  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 3991, 128])
m.shape torch.Size([3533, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.2077956199645996  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.2077956199645996  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 3533, 128]), torch.Size([1, 3533, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.2113256454467773  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.386855125427246  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 3533, 128])
m.shape torch.Size([3257, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.397594928741455  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.397594928741455  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 3257, 128]), torch.Size([1, 3257, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.4007611274719238  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.5852479934692383  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 3257, 128])
m.shape torch.Size([2870, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.5960116386413574  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.5960116386413574  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2870, 128]), torch.Size([1, 2870, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.598762035369873  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.779768466949463  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2870, 128])
m.shape torch.Size([2567, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.7906403541564941  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.7906403541564941  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2567, 128]), torch.Size([1, 2567, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.7932329177856445  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.9683833122253418  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2567, 128])
m.shape torch.Size([2260, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.979013442993164  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.979013442993164  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2260, 128]), torch.Size([1, 2260, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 1.981236457824707  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.153327465057373  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2260, 128])
m.shape torch.Size([2109, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.1643176078796387  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.1643176078796387  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2109, 128]), torch.Size([1, 2109, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.1664257049560547  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.341259002685547  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2109, 128])
m.shape torch.Size([1822, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.3515477180480957  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.3515477180480957  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1822, 128]), torch.Size([1, 1822, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.353285312652588  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.513144016265869  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1822, 128])
m.shape torch.Size([1682, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.5235037803649902  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.5235037803649902  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1682, 128]), torch.Size([1, 1682, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.5251078605651855  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.6860709190368652  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1682, 128])
m.shape torch.Size([1511, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.6960763931274414  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.6960763931274414  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.6975173950195312  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.85127592086792  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([1352, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.860870361328125  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.860870361328125  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1352, 128]), torch.Size([1, 1352, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 2.8621597290039062  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.0081253051757812  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1352, 128])
m.shape torch.Size([1265, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.017735004425049  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.017735004425049  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1265, 128]), torch.Size([1, 1265, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.0189414024353027  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.1650824546813965  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1265, 128])
m.shape torch.Size([1139, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.17425537109375  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.17425537109375  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1139, 128]), torch.Size([1, 1139, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.1753416061401367  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.3136940002441406  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1139, 128])
m.shape torch.Size([1076, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.322899341583252  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.322899341583252  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1076, 128]), torch.Size([1, 1076, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.323925495147705  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.462646961212158  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1076, 128])
m.shape torch.Size([16810, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.6224465370178223  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.6224465370178223  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 16810, 128]), torch.Size([1, 16810, 128])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 3.6384778022766113  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.898886203765869  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 16810, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.570120334625244  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.587296485900879  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.604472637176514  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.586759567260742  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([72041, 64])
input nodes number: 141199
output nodes number: 72041
edges number: 740967
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.605534076690674  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.622710227966309  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.627004623413086  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.627004623413086  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([72041, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.627004623413086  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

m.shape torch.Size([2709, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.656543254852295  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.656543254852295  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2709, 64]), torch.Size([1, 2709, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.657835483551025  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.670005798339844  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2709, 64])
m.shape torch.Size([3132, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.67095947265625  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.67095947265625  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 3132, 64]), torch.Size([1, 3132, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.672452926635742  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.697933197021484  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 3132, 64])
m.shape torch.Size([34128, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.722359657287598  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.722359657287598  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 34128, 64]), torch.Size([1, 34128, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 5.738633155822754  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.096650123596191  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 34128, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.070745944976807  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.080747604370117  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.090749263763428  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.08044958114624  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([39969, 64])
input nodes number: 72041
output nodes number: 39969
edges number: 111357
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.09081506729126  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.10081672668457  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.102736949920654  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.102736949920654  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

m.shape torch.Size([1684, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.114040851593018  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.114040851593018  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1684, 64]), torch.Size([1, 1684, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.114843845367432  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.121739864349365  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1684, 64])
m.shape torch.Size([1435, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.122044086456299  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.122044086456299  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1435, 64]), torch.Size([1, 1435, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.1227288246154785  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.133663654327393  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1435, 64])
m.shape torch.Size([1170, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.13418436050415  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.13418436050415  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1170, 64]), torch.Size([1, 1170, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.134742259979248  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.1472392082214355  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1170, 64])
m.shape torch.Size([918, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.147863388061523  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.147863388061523  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 918, 64]), torch.Size([1, 918, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.148301124572754  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.1609954833984375  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 918, 64])
m.shape torch.Size([6161, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.168351173400879  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.168351173400879  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 6161, 64]), torch.Size([1, 6161, 64])
----------------------------------------3
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.17173433303833  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.283384323120117  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 6161, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.275282859802246  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.277071475982666  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.278765678405762  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.276892185211182  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([11368, 40])
input nodes number: 39969
output nodes number: 11368
edges number: 42541
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 6.277116298675537  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030163492475237166 |0.0547100475856236 |0.19823220797947474 |0.0007772445678710938 |0.054629462105887275 |0.0067598819732666016 |
----------------------------------------------------------pseudo_mini_loss sum 2.432976245880127
for loop block_dataloader item  time:  3.362037181854248
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.07932853698730469  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.07932853698730469  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([141208, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.5906982421875 GB
    Memory Allocated: 0.07932853698730469  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

m.shape torch.Size([4364, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44595813751220703  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44595813751220703  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 4364, 128]), torch.Size([1, 4364, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4501199722290039  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4834146499633789  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 4364, 128])
m.shape torch.Size([5368, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4864530563354492  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4864530563354492  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 5368, 128]), torch.Size([1, 5368, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.49240779876708984  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5691976547241211  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 5368, 128])
m.shape torch.Size([5358, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5743026733398438  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5743026733398438  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 5358, 128]), torch.Size([1, 5358, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5794124603271484  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.696324348449707  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 5358, 128])
m.shape torch.Size([4934, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7022829055786133  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7022829055786133  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 4934, 128]), torch.Size([1, 4934, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7069883346557617  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8495869636535645  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 4934, 128])
m.shape torch.Size([4682, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8589978218078613  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8589978218078613  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 4682, 128]), torch.Size([1, 4682, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8634629249572754  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0242066383361816  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 4682, 128])
m.shape torch.Size([4017, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0334668159484863  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0334668159484863  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 4017, 128]), torch.Size([1, 4017, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0374631881713867  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2045249938964844  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 4017, 128])
m.shape torch.Size([3549, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2140789031982422  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2140789031982422  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 3549, 128]), torch.Size([1, 3549, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2177214622497559  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.393460750579834  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 3549, 128])
m.shape torch.Size([3157, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.402895450592041  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.402895450592041  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 3157, 128]), torch.Size([1, 3157, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4062371253967285  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5790081024169922  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 3157, 128])
m.shape torch.Size([2889, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5899009704589844  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5899009704589844  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2889, 128]), torch.Size([1, 2889, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.59283447265625  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7726430892944336  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2889, 128])
m.shape torch.Size([2585, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7834701538085938  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7834701538085938  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2585, 128]), torch.Size([1, 2585, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.786074161529541  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.967400074005127  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2585, 128])
m.shape torch.Size([2241, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.977921962738037  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.977921962738037  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2241, 128]), torch.Size([1, 2241, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9801244735717773  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.154285430908203  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2241, 128])
m.shape torch.Size([2078, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.165107250213623  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.165107250213623  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2078, 128]), torch.Size([1, 2078, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1671667098999023  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3417043685913086  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2078, 128])
m.shape torch.Size([1869, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3515944480895996  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3515944480895996  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1869, 128]), torch.Size([1, 1869, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.353376865386963  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.518686294555664  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1869, 128])
m.shape torch.Size([1645, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5287766456604004  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5287766456604004  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1645, 128]), torch.Size([1, 1645, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5303454399108887  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6898903846740723  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1645, 128])
m.shape torch.Size([1550, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.700192451477051  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.700192451477051  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1550, 128]), torch.Size([1, 1550, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7016706466674805  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8583593368530273  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1550, 128])
m.shape torch.Size([1338, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.867828369140625  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.867828369140625  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1338, 128]), torch.Size([1, 1338, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8691043853759766  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0134286880493164  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1338, 128])
m.shape torch.Size([1282, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0231828689575195  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0231828689575195  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1282, 128]), torch.Size([1, 1282, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0244054794311523  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.171205520629883  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1282, 128])
m.shape torch.Size([1187, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1807823181152344  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1807823181152344  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1187, 128]), torch.Size([1, 1187, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1819143295288086  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3272132873535156  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1187, 128])
m.shape torch.Size([1045, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3361148834228516  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3361148834228516  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1045, 128]), torch.Size([1, 1045, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.337111473083496  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.470858573913574  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1045, 128])
m.shape torch.Size([17048, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6329426765441895  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6329426765441895  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 17048, 128]), torch.Size([1, 17048, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.649200916290283  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.982811450958252  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 17048, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.650531768798828  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6677422523498535  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.684952735900879  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6672043800354  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([72186, 64])
input nodes number: 141208
output nodes number: 72186
edges number: 745919
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.68602180480957  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.703232288360596  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.707535266876221  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.707535266876221  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([72186, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.707535266876221  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

m.shape torch.Size([2717, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.7371721267700195  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.7371721267700195  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 2717, 64]), torch.Size([1, 2717, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.738468170166016  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.750668525695801  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 2717, 64])
m.shape torch.Size([3202, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.75166130065918  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.75166130065918  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 3202, 64]), torch.Size([1, 3202, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.753188133239746  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.777406692504883  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 3202, 64])
m.shape torch.Size([34201, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.802798748016357  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.802798748016357  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 34201, 64]), torch.Size([1, 34201, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.819107532501221  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.177892208099365  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 34201, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.151914596557617  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.161479949951172  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.171045303344727  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1611809730529785  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

torch.Size([40120, 64])
input nodes number: 72186
output nodes number: 40120
edges number: 111724
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.171584129333496  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.181149482727051  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.183676242828369  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.183676242828369  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

m.shape torch.Size([1686, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.194971084594727  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.194971084594727  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1686, 64]), torch.Size([1, 1686, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.195775032043457  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.202383995056152  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1686, 64])
m.shape torch.Size([1461, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.202700614929199  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.202700614929199  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1461, 64]), torch.Size([1, 1461, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.203397750854492  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.214083671569824  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1461, 64])
m.shape torch.Size([1158, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.214589595794678  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.214589595794678  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 1158, 64]), torch.Size([1, 1158, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.215141773223877  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.231894493103027  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 1158, 64])
m.shape torch.Size([875, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.232479095458984  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.232479095458984  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 875, 64]), torch.Size([1, 875, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.23289680480957  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.244998931884766  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

rst.shape  torch.Size([1, 875, 64])
m.shape torch.Size([6185, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.253057479858398  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.253057479858398  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

 h.shape torch.Size([1, 6185, 64]), torch.Size([1, 6185, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.256445407867432  GigaBytes
Max Memory Allocated: 6.360072612762451  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.365554332733154  GigaBytes
Max Memory Allocated: 6.372927665710449  GigaBytes

rst.shape  torch.Size([1, 6185, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.356731414794922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.358524322509766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.360317230224609  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.3584394454956055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11365, 40])
input nodes number: 40120
output nodes number: 11365
edges number: 42507
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.358827590942383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03018912672996521 |0.048406362533569336 |0.1875929832458496 |0.0007883906364440918 |0.05446556210517883 |0.0068149566650390625 |
----------------------------------------------------------pseudo_mini_loss sum 2.4039082527160645
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2023746
Number of first layer input nodes during this epoch:  1128818
for loop block_dataloader item  time:  0.11869645118713379
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.08033609390258789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.08033609390258789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141393, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.08033609390258789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4314, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44544219970703125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44544219970703125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4314, 128]), torch.Size([1, 4314, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4495563507080078  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4824695587158203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4314, 128])
m.shape torch.Size([5497, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4856548309326172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4856548309326172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5497, 128]), torch.Size([1, 5497, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.49176645278930664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.570401668548584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5497, 128])
m.shape torch.Size([5382, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5754795074462891  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5754795074462891  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5382, 128]), torch.Size([1, 5382, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5806121826171875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6978416442871094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5382, 128])
m.shape torch.Size([5041, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7040500640869141  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7040500640869141  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5041, 128]), torch.Size([1, 5041, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.708857536315918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8509469032287598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5041, 128])
m.shape torch.Size([4716, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8605618476867676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8605618476867676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4716, 128]), torch.Size([1, 4716, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8650593757629395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.026970386505127  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4716, 128])
m.shape torch.Size([4041, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.036283016204834  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.036283016204834  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4041, 128]), torch.Size([1, 4041, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.040271282196045  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2075581550598145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4041, 128])
m.shape torch.Size([3566, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2172718048095703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2172718048095703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3566, 128]), torch.Size([1, 3566, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2213239669799805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3965907096862793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3566, 128])
m.shape torch.Size([3205, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.407116413116455  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.407116413116455  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3205, 128]), torch.Size([1, 3205, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.41019868850708  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5846829414367676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3205, 128])
m.shape torch.Size([2826, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5952825546264648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5952825546264648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2826, 128]), torch.Size([1, 2826, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.598149299621582  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.778165340423584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2826, 128])
m.shape torch.Size([2590, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7885022163391113  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7885022163391113  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2590, 128]), torch.Size([1, 2590, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7910799980163574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9690771102905273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2590, 128])
m.shape torch.Size([2287, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9798378944396973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9798378944396973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2287, 128]), torch.Size([1, 2287, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.982222080230713  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1559081077575684  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2287, 128])
m.shape torch.Size([2069, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.166656494140625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.166656494140625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2069, 128]), torch.Size([1, 2069, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1686410903930664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.340269088745117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2069, 128])
m.shape torch.Size([1856, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.350921154022217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.350921154022217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1856, 128]), torch.Size([1, 1856, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.352691173553467  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5165629386901855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1856, 128])
m.shape torch.Size([1667, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.526806354522705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.526806354522705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1667, 128]), torch.Size([1, 1667, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5283961296081543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.688507556915283  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1667, 128])
m.shape torch.Size([1508, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6984987258911133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6984987258911133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1508, 128]), torch.Size([1, 1508, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.699936866760254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8524961471557617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1508, 128])
m.shape torch.Size([1322, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8626794815063477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8626794815063477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1322, 128]), torch.Size([1, 1322, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8639402389526367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.006405830383301  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1322, 128])
m.shape torch.Size([1276, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0161190032958984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0161190032958984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1276, 128]), torch.Size([1, 1276, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.017335891723633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.163667678833008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1276, 128])
m.shape torch.Size([1191, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.173281669616699  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.173281669616699  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1191, 128]), torch.Size([1, 1191, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.174417495727539  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.319124221801758  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1191, 128])
m.shape torch.Size([1031, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.327897071838379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.327897071838379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1031, 128]), torch.Size([1, 1031, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3288803100585938  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.4609384536743164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1031, 128])
m.shape torch.Size([16870, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6213316917419434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6213316917419434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16870, 128]), torch.Size([1, 16870, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.637420177459717  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.9058966636657715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16870, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.575562477111816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.592789649963379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.610016822814941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.592251300811768  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72255, 64])
input nodes number: 141393
output nodes number: 72255
edges number: 742722
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.611108303070068  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.628335475921631  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6326422691345215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6326422691345215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72255, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6326422691345215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2689, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.662261486053467  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.662261486053467  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2689, 64]), torch.Size([1, 2689, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.663544178009033  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.674195289611816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2689, 64])
m.shape torch.Size([3285, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6753034591674805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6753034591674805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3285, 64]), torch.Size([1, 3285, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.676870346069336  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.702191352844238  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3285, 64])
m.shape torch.Size([34140, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.727561950683594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.727561950683594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34140, 64]), torch.Size([1, 34140, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.743841171264648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.101984024047852  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34140, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.076030731201172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.085594654083252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.095561981201172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.085699081420898  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([40114, 64])
input nodes number: 72255
output nodes number: 40114
edges number: 111679
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0961012840271  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.10566520690918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.108917236328125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.108917236328125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1615, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.120234489440918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.120234489440918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1615, 64]), torch.Size([1, 1615, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.121005058288574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.128036022186279  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1615, 64])
m.shape torch.Size([1499, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.128387928009033  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.128387928009033  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1499, 64]), torch.Size([1, 1499, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.129103183746338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.141934394836426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1499, 64])
m.shape torch.Size([1159, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.14243221282959  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.14243221282959  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1159, 64]), torch.Size([1, 1159, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1429853439331055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.15734338760376  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1159, 64])
m.shape torch.Size([899, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.157951354980469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.157951354980469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 899, 64]), torch.Size([1, 899, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.158380508422852  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.170814514160156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 899, 64])
m.shape torch.Size([6196, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.17821741104126  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.17821741104126  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6196, 64]), torch.Size([1, 6196, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.181883335113525  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.293586730957031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6196, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.284352779388428  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.286409854888916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.2887139320373535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.286571979522705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 40114
output nodes number: 11368
edges number: 42666
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.287220001220703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027683496475219727 |0.004692792892456055 |0.1113283634185791 |0.0008754730224609375 |0.05302786827087402 |0.0067157745361328125 |
----------------------------------------------------------pseudo_mini_loss sum 2.2574524879455566
for loop block_dataloader item  time:  0.47066688537597656
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07926273345947266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07926273345947266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([140707, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07926273345947266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4362, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.43967151641845703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.43967151641845703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4362, 128]), torch.Size([1, 4362, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4438314437866211  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4771108627319336  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4362, 128])
m.shape torch.Size([5477, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4802541732788086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4802541732788086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5477, 128]), torch.Size([1, 5477, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.486264705657959  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5646138191223145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5477, 128])
m.shape torch.Size([5369, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5696825981140137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5696825981140137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5369, 128]), torch.Size([1, 5369, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5748028755187988  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6918048858642578  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5369, 128])
m.shape torch.Size([4990, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6987624168395996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6987624168395996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4990, 128]), torch.Size([1, 4990, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7037019729614258  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.844818115234375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4990, 128])
m.shape torch.Size([4614, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8534393310546875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8534393310546875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4614, 128]), torch.Size([1, 4614, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.858154296875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0165634155273438  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4614, 128])
m.shape torch.Size([3970, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.025721549987793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.025721549987793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3970, 128]), torch.Size([1, 3970, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0295820236206055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.1942920684814453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3970, 128])
m.shape torch.Size([3517, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2035374641418457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2035374641418457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3517, 128]), torch.Size([1, 3517, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.207873821258545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.376394271850586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3517, 128])
m.shape torch.Size([3138, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3866877555847168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3866877555847168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3138, 128]), torch.Size([1, 3138, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3899364471435547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5621585845947266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3138, 128])
m.shape torch.Size([2820, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5727643966674805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5727643966674805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2820, 128]), torch.Size([1, 2820, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5755400657653809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.752634048461914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2820, 128])
m.shape torch.Size([2616, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7630577087402344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7630577087402344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2616, 128]), torch.Size([1, 2616, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7656021118164062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.948258399963379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2616, 128])
m.shape torch.Size([2287, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9590067863464355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9590067863464355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2287, 128]), torch.Size([1, 2287, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9614672660827637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.13319730758667  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2287, 128])
m.shape torch.Size([2058, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1438827514648438  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1438827514648438  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2058, 128]), torch.Size([1, 2058, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.145867347717285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3161497116088867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2058, 128])
m.shape torch.Size([1858, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3257999420166016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3257999420166016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1858, 128]), torch.Size([1, 1858, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3275718688964844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.4936132431030273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1858, 128])
m.shape torch.Size([1677, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.503922462463379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.503922462463379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1677, 128]), torch.Size([1, 1677, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.505521774291992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.665890693664551  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1677, 128])
m.shape torch.Size([1530, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.676034450531006  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.676034450531006  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1530, 128]), torch.Size([1, 1530, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6774935722351074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8330607414245605  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1530, 128])
m.shape torch.Size([1327, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8424553871154785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8424553871154785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1327, 128]), torch.Size([1, 1327, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8437209129333496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.9872632026672363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1327, 128])
m.shape torch.Size([1283, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.997030735015869  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.997030735015869  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1283, 128]), torch.Size([1, 1283, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.9982542991638184  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1450819969177246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1283, 128])
m.shape torch.Size([1125, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1541261672973633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1541261672973633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1551990509033203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.2946863174438477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([1023, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3034181594848633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3034181594848633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.304393768310547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.4361319541931152  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([16581, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.5938472747802734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.5938472747802734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16581, 128]), torch.Size([1, 16581, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6096601486206055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.839275360107422  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.5132551193237305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.530331134796143  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.547407150268555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.529797077178955  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71622, 64])
input nodes number: 140707
output nodes number: 71622
edges number: 734321
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.548498630523682  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.565574645996094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.569843769073486  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.569843769073486  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71622, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.569843769073486  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2722, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.599246025085449  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.599246025085449  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2722, 64]), torch.Size([1, 2722, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.600543975830078  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.611800670623779  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2722, 64])
m.shape torch.Size([3210, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.612777233123779  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.612777233123779  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3210, 64]), torch.Size([1, 3210, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.614307880401611  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.641210079193115  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3210, 64])
m.shape torch.Size([33889, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.665441989898682  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.665441989898682  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33889, 64]), torch.Size([1, 33889, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6816020011901855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.037113666534424  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33889, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.011363983154297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0214009284973145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.031437873840332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.021103858947754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39821, 64])
input nodes number: 71622
output nodes number: 39821
edges number: 110809
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.031430244445801  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.041467189788818  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.043303966522217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.043303966522217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1697, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.05455207824707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.05455207824707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1697, 64]), torch.Size([1, 1697, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.055361747741699  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.062259674072266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1697, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0625834465026855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0625834465026855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1481, 64]), torch.Size([1, 1481, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.063290119171143  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.074793338775635  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1481, 64])
m.shape torch.Size([1203, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0753278732299805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0753278732299805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1203, 64]), torch.Size([1, 1203, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.075901985168457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0914506912231445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1203, 64])
m.shape torch.Size([900, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0920491218566895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0920491218566895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 900, 64]), torch.Size([1, 900, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.092478275299072  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.104923725128174  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 900, 64])
m.shape torch.Size([6087, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.112192630767822  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.112192630767822  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6087, 64]), torch.Size([1, 6087, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.115347385406494  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.221351146697998  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6087, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.212785720825195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.214597702026367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.216409683227539  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.214512825012207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39821
output nodes number: 11368
edges number: 42303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.214649677276611  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030624866485595703 |0.0050811767578125 |0.11196613311767578 |0.0008606910705566406 |0.05255401134490967 |0.006873130798339844 |
----------------------------------------------------------pseudo_mini_loss sum 2.196340322494507
for loop block_dataloader item  time:  0.7868719100952148
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.08035421371459961  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.08035421371459961  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141454, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.08035421371459961  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4266, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4453587532043457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4453587532043457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4266, 128]), torch.Size([1, 4266, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44942712783813477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48197412490844727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4266, 128])
m.shape torch.Size([5420, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4851088523864746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4851088523864746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5420, 128]), torch.Size([1, 5420, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4902777671813965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5678114891052246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5420, 128])
m.shape torch.Size([5393, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.572941780090332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.572941780090332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5393, 128]), torch.Size([1, 5393, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5780849456787109  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6953301429748535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5393, 128])
m.shape torch.Size([5024, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7015271186828613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7015271186828613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5024, 128]), torch.Size([1, 5024, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7063183784484863  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8484406471252441  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5024, 128])
m.shape torch.Size([4689, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8580231666564941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8580231666564941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4689, 128]), torch.Size([1, 4689, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.862494945526123  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0234789848327637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4689, 128])
m.shape torch.Size([4026, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.032761573791504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.032761573791504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4026, 128]), torch.Size([1, 4026, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0367155075073242  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2038569450378418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4026, 128])
m.shape torch.Size([3662, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2138266563415527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2138266563415527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3662, 128]), torch.Size([1, 3662, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2179770469665527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3957571983337402  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3662, 128])
m.shape torch.Size([3258, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4064393043518066  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4064393043518066  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3258, 128]), torch.Size([1, 3258, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4097275733947754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5979876518249512  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3258, 128])
m.shape torch.Size([2915, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.6089439392089844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.6089439392089844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2915, 128]), torch.Size([1, 2915, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.6117281913757324  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7910442352294922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2915, 128])
m.shape torch.Size([2591, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.8020925521850586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.8020925521850586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2591, 128]), torch.Size([1, 2591, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.804854393005371  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9823880195617676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2591, 128])
m.shape torch.Size([2320, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.993321418762207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.993321418762207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2320, 128]), torch.Size([1, 2320, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9955558776855469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.175764560699463  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2320, 128])
m.shape torch.Size([2065, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.186474323272705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.186474323272705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2065, 128]), torch.Size([1, 2065, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1884617805480957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.363084316253662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2065, 128])
m.shape torch.Size([1894, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.37384033203125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.37384033203125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1894, 128]), torch.Size([1, 1894, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3756465911865234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5427160263061523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1894, 128])
m.shape torch.Size([1620, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5526275634765625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5526275634765625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1620, 128]), torch.Size([1, 1620, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5541725158691406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.707122802734375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1620, 128])
m.shape torch.Size([1533, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.717315196990967  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.717315196990967  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1533, 128]), torch.Size([1, 1533, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7187771797180176  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8737473487854004  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1533, 128])
m.shape torch.Size([1331, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8831710815429688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8831710815429688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8844404220581055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0280556678771973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1287, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.037853717803955  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.037853717803955  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.03908109664917  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.186448574066162  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1287, 128])
m.shape torch.Size([1182, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1959800720214844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1959800720214844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1182, 128]), torch.Size([1, 1182, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1971073150634766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3416080474853516  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1182, 128])
m.shape torch.Size([1017, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3502583503723145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3502583503723145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1017, 128]), torch.Size([1, 1017, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3512282371520996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.4823169708251953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1017, 128])
m.shape torch.Size([16768, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6417441368103027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6417441368103027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16768, 128]), torch.Size([1, 16768, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6577353477478027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.912496089935303  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16768, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.581243515014648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.5984721183776855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.615700721740723  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.597933292388916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72261, 64])
input nodes number: 141454
output nodes number: 72261
edges number: 742556
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.61680793762207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.634036540985107  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.638343811035156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.638343811035156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72261, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.638343811035156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2625, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.667980194091797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.667980194091797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2625, 64]), torch.Size([1, 2625, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.669232368469238  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.679874897003174  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2625, 64])
m.shape torch.Size([3150, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.680941581726074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.680941581726074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3150, 64]), torch.Size([1, 3150, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.682443618774414  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.708035469055176  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3150, 64])
m.shape torch.Size([34298, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.7334418296813965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.7334418296813965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34298, 64]), torch.Size([1, 34298, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.749796390533447  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1095967292785645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34298, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.083564758300781  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.093119144439697  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.102673530578613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.092820167541504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([40073, 64])
input nodes number: 72261
output nodes number: 40073
edges number: 111819
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.103635787963867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.113190174102783  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.115644931793213  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.115644931793213  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1658, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.126956939697266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.126956939697266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1658, 64]), torch.Size([1, 1658, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.127747535705566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.134485721588135  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1658, 64])
m.shape torch.Size([1449, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.134803295135498  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.134803295135498  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1449, 64]), torch.Size([1, 1449, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.135494709014893  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.146373748779297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1449, 64])
m.shape torch.Size([1162, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.146885395050049  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.146885395050049  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1162, 64]), torch.Size([1, 1162, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.147439479827881  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.160642147064209  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1162, 64])
m.shape torch.Size([928, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.161277770996094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.161277770996094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 928, 64]), torch.Size([1, 928, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.161720275878906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.174552917480469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 928, 64])
m.shape torch.Size([6171, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.182819843292236  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.182819843292236  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6171, 64]), torch.Size([1, 6171, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.185810565948486  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.295326232910156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6171, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.28579568862915  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.287829875946045  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.290132522583008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.288013458251953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 40073
output nodes number: 11368
edges number: 42609
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.288619518280029  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029763221740722656 |0.004795074462890625 |0.11086257298787434 |0.0008481343587239584 |0.05232652028401693 |0.007027626037597656 |
----------------------------------------------------------pseudo_mini_loss sum 2.1247096061706543
for loop block_dataloader item  time:  1.0883185863494873
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07942628860473633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07942628860473633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141032, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07942628860473633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4359, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4430365562438965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4430365562438965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4359, 128]), torch.Size([1, 4359, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44719362258911133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48110389709472656  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4359, 128])
m.shape torch.Size([5442, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48421525955200195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48421525955200195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5442, 128]), torch.Size([1, 5442, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48940515518188477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.567253589630127  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5442, 128])
m.shape torch.Size([5424, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5724177360534668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5724177360534668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5424, 128]), torch.Size([1, 5424, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5775904655456543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6950907707214355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5424, 128])
m.shape torch.Size([4940, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7019267082214355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7019267082214355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4940, 128]), torch.Size([1, 4940, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7068848609924316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8478531837463379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4940, 128])
m.shape torch.Size([4571, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8557090759277344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8557090759277344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4571, 128]), torch.Size([1, 4571, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8609309196472168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0178637504577637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4571, 128])
m.shape torch.Size([3933, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0269365310668945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0269365310668945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3933, 128]), torch.Size([1, 3933, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0309333801269531  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.1959857940673828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3933, 128])
m.shape torch.Size([3588, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2060866355895996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2060866355895996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3588, 128]), torch.Size([1, 3588, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.209787368774414  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3815879821777344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3588, 128])
m.shape torch.Size([3264, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3923282623291016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3923282623291016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3264, 128]), torch.Size([1, 3264, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3964614868164062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5807266235351562  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3264, 128])
m.shape torch.Size([2856, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5914268493652344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5914268493652344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2856, 128]), torch.Size([1, 2856, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.594156265258789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7733983993530273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2856, 128])
m.shape torch.Size([2584, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7838926315307617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7838926315307617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2584, 128]), torch.Size([1, 2584, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7865447998046875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9648323059082031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2584, 128])
m.shape torch.Size([2235, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.97532320022583  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.97532320022583  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2235, 128]), torch.Size([1, 2235, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9775357246398926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.150280475616455  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2235, 128])
m.shape torch.Size([2051, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1609506607055664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1609506607055664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2051, 128]), torch.Size([1, 2051, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.16304874420166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3363723754882812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2051, 128])
m.shape torch.Size([1879, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3470420837402344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3470420837402344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1879, 128]), torch.Size([1, 1879, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3488340377807617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.515307903289795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1879, 128])
m.shape torch.Size([1663, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5255136489868164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5255136489868164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1663, 128]), torch.Size([1, 1663, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.527099609375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.687108039855957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1663, 128])
m.shape torch.Size([1540, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6973299980163574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6973299980163574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1540, 128]), torch.Size([1, 1540, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.698798656463623  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8544764518737793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1540, 128])
m.shape torch.Size([1325, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8638510704040527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8638510704040527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1325, 128]), torch.Size([1, 1325, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.865114688873291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.008218288421631  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1325, 128])
m.shape torch.Size([1295, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0180840492248535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0180840492248535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1295, 128]), torch.Size([1, 1295, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0193190574645996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.167520046234131  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1295, 128])
m.shape torch.Size([1187, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.177090644836426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.177090644836426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1187, 128]), torch.Size([1, 1187, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.17822265625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.322664260864258  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1187, 128])
m.shape torch.Size([1037, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.331493377685547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.331493377685547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.33248233795166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.466982364654541  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([16677, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6255321502685547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6255321502685547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16677, 128]), torch.Size([1, 16677, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6414365768432617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.883960723876953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16677, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.555671215057373  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.57280158996582  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.589931964874268  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.572266101837158  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71850, 64])
input nodes number: 141032
output nodes number: 71850
edges number: 738330
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.591136455535889  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.608266830444336  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.612549781799316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.612549781799316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71850, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.612549781799316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2699, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.641940593719482  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.641940593719482  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2699, 64]), torch.Size([1, 2699, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.643228054046631  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.653636932373047  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2699, 64])
m.shape torch.Size([3199, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.654597282409668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.654597282409668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3199, 64]), torch.Size([1, 3199, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.656123161315918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.682461738586426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3199, 64])
m.shape torch.Size([33900, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.706704139709473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.706704139709473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33900, 64]), torch.Size([1, 33900, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.722868919372559  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.078494071960449  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33900, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.053159713745117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.062648296356201  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.072690963745117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.062905788421631  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39798, 64])
input nodes number: 71850
output nodes number: 39798
edges number: 110797
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.073227405548096  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.08271598815918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.085116863250732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.085116863250732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1685, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.096388339996338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.096388339996338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1685, 64]), torch.Size([1, 1685, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.097192287445068  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.103635311126709  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1685, 64])
m.shape torch.Size([1454, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.103948593139648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.103948593139648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1454, 64]), torch.Size([1, 1454, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.104641914367676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.115087509155273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1454, 64])
m.shape torch.Size([1210, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.115633487701416  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.115633487701416  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1210, 64]), torch.Size([1, 1210, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.116210460662842  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1308722496032715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1210, 64])
m.shape torch.Size([904, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.131473064422607  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.131473064422607  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 904, 64]), torch.Size([1, 904, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.131904125213623  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.144404888153076  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 904, 64])
m.shape torch.Size([6115, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.151707172393799  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.151707172393799  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6115, 64]), torch.Size([1, 6115, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.154930591583252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.263339996337891  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6115, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.254350185394287  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.256190776824951  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.258031368255615  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.256105899810791  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39798
output nodes number: 11368
edges number: 42414
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.256293773651123  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.029217064380645752 |0.004559159278869629 |0.11043131351470947 |0.0008488893508911133 |0.05236870050430298 |0.0068929195404052734 |
----------------------------------------------------------pseudo_mini_loss sum 2.1054985523223877
for loop block_dataloader item  time:  1.4517319202423096
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07926750183105469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07926750183105469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141049, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07926750183105469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4333, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4437417984008789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4437417984008789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4333, 128]), torch.Size([1, 4333, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4478740692138672  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48093223571777344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4333, 128])
m.shape torch.Size([5379, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4839959144592285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4839959144592285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5379, 128]), torch.Size([1, 5379, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.49001502990722656  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5669622421264648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5379, 128])
m.shape torch.Size([5360, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5720648765563965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5720648765563965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5360, 128]), torch.Size([1, 5360, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.577176570892334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.694115161895752  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5360, 128])
m.shape torch.Size([4964, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7001347541809082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7001347541809082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4964, 128]), torch.Size([1, 4964, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7048687934875488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.847282886505127  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4964, 128])
m.shape torch.Size([4628, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8567509651184082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8567509651184082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4628, 128]), torch.Size([1, 4628, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8611645698547363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0200543403625488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4628, 128])
m.shape torch.Size([4037, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0293974876403809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0293974876403809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4037, 128]), torch.Size([1, 4037, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.033388614654541  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.200859546661377  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4037, 128])
m.shape torch.Size([3568, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2105627059936523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2105627059936523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3568, 128]), torch.Size([1, 3568, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2143163681030273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.389780044555664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3568, 128])
m.shape torch.Size([3239, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4004344940185547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4004344940185547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3239, 128]), torch.Size([1, 3239, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4038267135620117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5798969268798828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3239, 128])
m.shape torch.Size([2861, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5906305313110352  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5906305313110352  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2861, 128]), torch.Size([1, 2861, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5934066772460938  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.772669792175293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2861, 128])
m.shape torch.Size([2529, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.783151626586914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.783151626586914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2529, 128]), torch.Size([1, 2529, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7857255935668945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9640283584594727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2529, 128])
m.shape torch.Size([2316, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.974733829498291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.974733829498291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2316, 128]), torch.Size([1, 2316, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.977280616760254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1569161415100098  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2316, 128])
m.shape torch.Size([1973, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1671013832092285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1671013832092285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1973, 128]), torch.Size([1, 1973, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.168982982635498  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.334171772003174  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1973, 128])
m.shape torch.Size([1866, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3447980880737305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3447980880737305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3465776443481445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5111427307128906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1691, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5215415954589844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5215415954589844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1691, 128]), torch.Size([1, 1691, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5231542587280273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6838836669921875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1691, 128])
m.shape torch.Size([1542, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6941065788269043  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6941065788269043  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1542, 128]), torch.Size([1, 1542, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6955771446228027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8522047996520996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1542, 128])
m.shape torch.Size([1323, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.861563205718994  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.861563205718994  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1323, 128]), torch.Size([1, 1323, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8628249168395996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0054945945739746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1323, 128])
m.shape torch.Size([1296, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.015369415283203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.015369415283203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1296, 128]), torch.Size([1, 1296, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0166053771972656  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1649208068847656  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1296, 128])
m.shape torch.Size([1164, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1742935180664062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1742935180664062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.175403594970703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.317178726196289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([1009, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3257651329040527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3257651329040527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1009, 128]), torch.Size([1, 1009, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3267273902893066  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.4573144912719727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1009, 128])
m.shape torch.Size([16875, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6177659034729004  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6177659034729004  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16875, 128]), torch.Size([1, 16875, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.633859157562256  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.903007984161377  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16875, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.572509765625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.589664936065674  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.606820106506348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.589128494262695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71953, 64])
input nodes number: 141049
output nodes number: 71953
edges number: 741353
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.607902526855469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.625057697296143  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.62934684753418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.62934684753418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71953, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.62934684753418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2726, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6588664054870605  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6588664054870605  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2726, 64]), torch.Size([1, 2726, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.660166263580322  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.672604084014893  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2726, 64])
m.shape torch.Size([3151, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.673545837402344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.673545837402344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3151, 64]), torch.Size([1, 3151, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.675048828125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.700185775756836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3151, 64])
m.shape torch.Size([34078, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.7245707511901855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.7245707511901855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34078, 64]), torch.Size([1, 34078, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.740820407867432  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.098312854766846  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34078, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.072440147399902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.08244514465332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.092450141906738  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.082147121429443  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39955, 64])
input nodes number: 71953
output nodes number: 39955
edges number: 111262
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.092508792877197  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.102513790130615  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.104552745819092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.104552745819092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1708, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.115854740142822  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.115854740142822  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1708, 64]), torch.Size([1, 1708, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.116669178009033  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.123505115509033  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1708, 64])
m.shape torch.Size([1425, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.123798847198486  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.123798847198486  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1425, 64]), torch.Size([1, 1425, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.124478816986084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.136117458343506  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1425, 64])
m.shape torch.Size([1156, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.136630535125732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.136630535125732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1156, 64]), torch.Size([1, 1156, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.137181758880615  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.153406143188477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1156, 64])
m.shape torch.Size([912, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.154027462005615  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.154027462005615  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 912, 64]), torch.Size([1, 912, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1544623374938965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.167073726654053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 912, 64])
m.shape torch.Size([6167, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.174437999725342  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.174437999725342  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6167, 64]), torch.Size([1, 6167, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.17802619934082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.2887349128723145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6167, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.279936790466309  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.281821250915527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.283705711364746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.281736373901367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39955
output nodes number: 11368
edges number: 42509
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.282163143157959  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028879165649414062 |0.004493331909179688 |0.110267972946167 |0.00084686279296875 |0.05226278305053711 |0.006798982620239258 |
----------------------------------------------------------pseudo_mini_loss sum 2.0267345905303955
for loop block_dataloader item  time:  1.7536652088165283
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07938241958618164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07938241958618164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141146, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07938241958618164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4292, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44577550888061523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44577550888061523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4292, 128]), torch.Size([1, 4292, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44986867904663086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48261404037475586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4292, 128])
m.shape torch.Size([5370, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4856886863708496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4856886863708496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5370, 128]), torch.Size([1, 5370, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.49178171157836914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5686001777648926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5370, 128])
m.shape torch.Size([5350, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.573692798614502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.573692798614502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5350, 128]), torch.Size([1, 5350, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5787949562072754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6956439018249512  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5350, 128])
m.shape torch.Size([5032, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7017741203308105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7017741203308105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5032, 128]), torch.Size([1, 5032, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7065730094909668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.848670482635498  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5032, 128])
m.shape torch.Size([4596, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8572287559509277  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8572287559509277  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4596, 128]), torch.Size([1, 4596, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8616118431091309  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0194029808044434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4596, 128])
m.shape torch.Size([3977, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0285897254943848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0285897254943848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3977, 128]), torch.Size([1, 3977, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0325875282287598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.1980767250061035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3977, 128])
m.shape torch.Size([3537, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2079863548278809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2079863548278809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3537, 128]), torch.Size([1, 3537, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.211653709411621  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3803110122680664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3537, 128])
m.shape torch.Size([3251, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3910260200500488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3910260200500488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3251, 128]), torch.Size([1, 3251, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3942627906799316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.578416347503662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3251, 128])
m.shape torch.Size([2885, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.589247226715088  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.589247226715088  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2885, 128]), torch.Size([1, 2885, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5920233726501465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7715773582458496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2885, 128])
m.shape torch.Size([2609, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.782503604888916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.782503604888916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2609, 128]), torch.Size([1, 2609, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7855682373046875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9679713249206543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2609, 128])
m.shape torch.Size([2315, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.978869915008545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.978869915008545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2315, 128]), torch.Size([1, 2315, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.981229305267334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1602869033813477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2315, 128])
m.shape torch.Size([2118, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.171302318572998  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.171302318572998  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2118, 128]), torch.Size([1, 2118, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1733522415161133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.348544120788574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2118, 128])
m.shape torch.Size([1879, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.358839511871338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.358839511871338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1879, 128]), torch.Size([1, 1879, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3606314659118652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5264511108398438  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1879, 128])
m.shape torch.Size([1676, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.536743640899658  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.536743640899658  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1676, 128]), torch.Size([1, 1676, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.538341999053955  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6988606452941895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1676, 128])
m.shape torch.Size([1564, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7092480659484863  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7092480659484863  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1564, 128]), torch.Size([1, 1564, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7107396125793457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8688435554504395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1564, 128])
m.shape torch.Size([1340, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8783211708068848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8783211708068848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1340, 128]), torch.Size([1, 1340, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.879599094390869  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0240044593811035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1340, 128])
m.shape torch.Size([1287, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0337982177734375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0337982177734375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0350255966186523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1823434829711914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1287, 128])
m.shape torch.Size([1224, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1922354698181152  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1922354698181152  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1224, 128]), torch.Size([1, 1224, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1934027671813965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3462071418762207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1224, 128])
m.shape torch.Size([1068, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.355299472808838  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.355299472808838  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1068, 128]), torch.Size([1, 1068, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3563179969787598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.492800235748291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1068, 128])
m.shape torch.Size([16766, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.652184009552002  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.652184009552002  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16766, 128]), torch.Size([1, 16766, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.668173313140869  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.922665119171143  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16766, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.59104061126709  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.60823917388916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6254377365112305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.607701301574707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72136, 64])
input nodes number: 141146
output nodes number: 72136
edges number: 744069
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.626542568206787  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.643741130828857  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.648040771484375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.648040771484375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72136, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.648040771484375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2719, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.677678108215332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.677678108215332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2719, 64]), torch.Size([1, 2719, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6789751052856445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.691313743591309  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2719, 64])
m.shape torch.Size([3193, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.692263126373291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.692263126373291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3193, 64]), torch.Size([1, 3193, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.693786144256592  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.719606876373291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3193, 64])
m.shape torch.Size([34208, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.745000839233398  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.745000839233398  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34208, 64]), torch.Size([1, 34208, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.761312484741211  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.120168685913086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34208, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.094189643859863  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.103754997253418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.113743782043457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.103879451751709  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([40120, 64])
input nodes number: 72136
output nodes number: 40120
edges number: 111729
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.114282608032227  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.123847961425781  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.126311779022217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.126311779022217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1671, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.137633323669434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.137633323669434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1671, 64]), torch.Size([1, 1671, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.138430595397949  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.14486026763916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1671, 64])
m.shape torch.Size([1453, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.145176410675049  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.145176410675049  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1453, 64]), torch.Size([1, 1453, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.145869731903076  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.157320499420166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1453, 64])
m.shape torch.Size([1131, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.157808780670166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.157808780670166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1131, 64]), torch.Size([1, 1131, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.158348560333252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.171311378479004  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1131, 64])
m.shape torch.Size([905, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.171931743621826  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.171931743621826  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 905, 64]), torch.Size([1, 905, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.172363758087158  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.18488073348999  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 905, 64])
m.shape torch.Size([6208, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.192296504974365  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.192296504974365  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6208, 64]), torch.Size([1, 6208, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.19556188583374  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.304014205932617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6208, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.295455455780029  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.297404766082764  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.2994513511657715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.297417163848877  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 40120
output nodes number: 11368
edges number: 42630
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.297865867614746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02847909927368164 |0.004420916239420573 |0.10994164148966472 |0.0008424123128255209 |0.05232520898183187 |0.006627798080444336 |
----------------------------------------------------------pseudo_mini_loss sum 1.9359461069107056
for loop block_dataloader item  time:  2.0507421493530273
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07915163040161133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07915163040161133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([140648, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07915163040161133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4353, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4418315887451172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4418315887451172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4353, 128]), torch.Size([1, 4353, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4459829330444336  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.47919368743896484  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4353, 128])
m.shape torch.Size([5388, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4822564125061035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4822564125061035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5388, 128]), torch.Size([1, 5388, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48824167251586914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5653176307678223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5388, 128])
m.shape torch.Size([5245, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.57025146484375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.57025146484375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5245, 128]), torch.Size([1, 5245, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5752534866333008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6854343414306641  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5245, 128])
m.shape torch.Size([4965, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6924033164978027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6924033164978027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4965, 128]), torch.Size([1, 4965, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6971383094787598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8396587371826172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4965, 128])
m.shape torch.Size([4614, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8491287231445312  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8491287231445312  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4614, 128]), torch.Size([1, 4614, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8535289764404297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0119380950927734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4614, 128])
m.shape torch.Size([3978, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0211191177368164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0211191177368164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3978, 128]), torch.Size([1, 3978, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.024979591369629  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.18998384475708  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3978, 128])
m.shape torch.Size([3584, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.200049877166748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.200049877166748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3584, 128]), torch.Size([1, 3584, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.203479290008545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3802204132080078  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3584, 128])
m.shape torch.Size([3244, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3899478912353516  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3899478912353516  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3244, 128]), torch.Size([1, 3244, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3930416107177734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5771350860595703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3244, 128])
m.shape torch.Size([2835, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.587754726409912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.587754726409912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2835, 128]), torch.Size([1, 2835, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5906386375427246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7697358131408691  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2835, 128])
m.shape torch.Size([2506, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7797279357910156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7797279357910156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2506, 128]), torch.Size([1, 2506, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.78216552734375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9604034423828125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2506, 128])
m.shape torch.Size([2301, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9708657264709473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9708657264709473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2301, 128]), torch.Size([1, 2301, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.973066806793213  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.15183162689209  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2301, 128])
m.shape torch.Size([2045, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.162436008453369  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.162436008453369  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2045, 128]), torch.Size([1, 2045, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.16438627243042  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3303589820861816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2045, 128])
m.shape torch.Size([1902, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3411741256713867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3411741256713867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1902, 128]), torch.Size([1, 1902, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3429880142211914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.510652542114258  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1902, 128])
m.shape torch.Size([1654, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.520787239074707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.520787239074707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1654, 128]), torch.Size([1, 1654, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.522364616394043  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6821413040161133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1654, 128])
m.shape torch.Size([1514, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6921815872192383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6921815872192383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1514, 128]), torch.Size([1, 1514, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.6936254501342773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.847583770751953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1514, 128])
m.shape torch.Size([1372, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8573293685913086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8573293685913086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1372, 128]), torch.Size([1, 1372, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.858637809753418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0064916610717773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1372, 128])
m.shape torch.Size([1309, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.016448497772217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.016448497772217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1309, 128]), torch.Size([1, 1309, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0176968574523926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1675000190734863  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1309, 128])
m.shape torch.Size([1149, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1767377853393555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1767377853393555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1778335571289062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3179588317871094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([1042, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3268513679504395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3268513679504395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1042, 128]), torch.Size([1, 1042, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3278450965881348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.46152925491333  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1042, 128])
m.shape torch.Size([16658, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6198954582214355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6198954582214355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16658, 128]), torch.Size([1, 16658, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.635781764984131  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.87575101852417  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16658, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.547776699066162  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.564861297607422  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.581945896148682  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.564327239990234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71658, 64])
input nodes number: 140648
output nodes number: 71658
edges number: 737565
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.583136558532715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.600221157073975  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.604492664337158  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.604492664337158  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71658, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.604492664337158  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2719, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6338982582092285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6338982582092285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2719, 64]), torch.Size([1, 2719, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.635195255279541  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.645934104919434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2719, 64])
m.shape torch.Size([3191, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.646880149841309  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.646880149841309  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3191, 64]), torch.Size([1, 3191, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.648402214050293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.674838066101074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3191, 64])
m.shape torch.Size([33910, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.699089527130127  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.699089527130127  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33910, 64]), torch.Size([1, 33910, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.715259075164795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.07098913192749  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33910, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.045229911804199  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.055267333984375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.065304756164551  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0549702644348145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39820, 64])
input nodes number: 71658
output nodes number: 39820
edges number: 110831
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.065296173095703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.075333595275879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.077236652374268  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.077236652374268  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1719, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0884881019592285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0884881019592285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1719, 64]), torch.Size([1, 1719, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.089308261871338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.09588098526001  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1719, 64])
m.shape torch.Size([1455, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.096186637878418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.096186637878418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1455, 64]), torch.Size([1, 1455, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.096880912780762  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.107317924499512  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1455, 64])
m.shape torch.Size([1174, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.107837200164795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.107837200164795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1174, 64]), torch.Size([1, 1174, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.108397006988525  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.121459007263184  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1174, 64])
m.shape torch.Size([948, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.122111797332764  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.122111797332764  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 948, 64]), torch.Size([1, 948, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.12256383895874  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1356730461120605  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 948, 64])
m.shape torch.Size([6072, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.142911911010742  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.142911911010742  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6072, 64]), torch.Size([1, 6072, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.146200180053711  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.252839088439941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6072, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.244540691375732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.246234893798828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.247929096221924  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.246150016784668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39820
output nodes number: 11368
edges number: 42303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.246407508850098  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02814483642578125 |0.004371268408639091 |0.1097001348223005 |0.0008344990866524833 |0.05233618191310337 |0.006895780563354492 |
----------------------------------------------------------pseudo_mini_loss sum 1.9620020389556885
for loop block_dataloader item  time:  2.365419387817383
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07921886444091797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07921886444091797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141006, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07921886444091797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4276, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4436783790588379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4436783790588379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4276, 128]), torch.Size([1, 4276, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.447756290435791  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.480379581451416  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4276, 128])
m.shape torch.Size([5479, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4835658073425293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4835658073425293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5479, 128]), torch.Size([1, 5479, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48974132537841797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5681190490722656  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5479, 128])
m.shape torch.Size([5351, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5731611251831055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5731611251831055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5351, 128]), torch.Size([1, 5351, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5782642364501953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6952252388000488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5351, 128])
m.shape torch.Size([4958, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7012162208557129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7012162208557129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4958, 128]), torch.Size([1, 4958, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7059445381164551  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8480095863342285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4958, 128])
m.shape torch.Size([4626, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8574662208557129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8574662208557129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4626, 128]), torch.Size([1, 4626, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8619046211242676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0207257270812988  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4626, 128])
m.shape torch.Size([4015, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0300068855285645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0300068855285645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4015, 128]), torch.Size([1, 4015, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0339603424072266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2015724182128906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4015, 128])
m.shape torch.Size([3565, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.211557388305664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.211557388305664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3565, 128]), torch.Size([1, 3565, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2153263092041016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3899354934692383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3565, 128])
m.shape torch.Size([3276, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4007325172424316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4007325172424316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3276, 128]), torch.Size([1, 3276, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4049644470214844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5893802642822266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3276, 128])
m.shape torch.Size([2927, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.6011009216308594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.6011009216308594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2927, 128]), torch.Size([1, 2927, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.6040701866149902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7843198776245117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2927, 128])
m.shape torch.Size([2546, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.795485496520996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.795485496520996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2546, 128]), torch.Size([1, 2546, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7979764938354492  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.974137783050537  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2546, 128])
m.shape torch.Size([2298, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9849772453308105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9849772453308105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2298, 128]), torch.Size([1, 2298, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.987292766571045  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.16658353805542  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2298, 128])
m.shape torch.Size([2050, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.177217960357666  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.177217960357666  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2050, 128]), torch.Size([1, 2050, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.179614543914795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3547301292419434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2050, 128])
m.shape torch.Size([1878, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3645243644714355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3645243644714355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1878, 128]), torch.Size([1, 1878, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3663153648376465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5310873985290527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1878, 128])
m.shape torch.Size([1670, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5413403511047363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5413403511047363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1670, 128]), torch.Size([1, 1670, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5429329872131348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7031216621398926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1670, 128])
m.shape torch.Size([1547, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.713390350341797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.713390350341797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1547, 128]), torch.Size([1, 1547, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7148656845092773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.871251106262207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1547, 128])
m.shape torch.Size([1336, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.880706310272217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.880706310272217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1336, 128]), torch.Size([1, 1336, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8819804191589355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0264205932617188  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1336, 128])
m.shape torch.Size([1295, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.036281108856201  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.036281108856201  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1295, 128]), torch.Size([1, 1295, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0375161170959473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1857171058654785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1295, 128])
m.shape torch.Size([1164, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1950902938842773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1950902938842773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1164, 128]), torch.Size([1, 1164, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.196200370788574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3387365341186523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1164, 128])
m.shape torch.Size([1036, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.347567558288574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.347567558288574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1036, 128]), torch.Size([1, 1036, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.348555564880371  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.4812917709350586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1036, 128])
m.shape torch.Size([16669, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.639765739440918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.639765739440918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16669, 128]), torch.Size([1, 16669, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6556625366210938  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.897110939025879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16669, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.567173957824707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.584331035614014  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.60148811340332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.583794593811035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71962, 64])
input nodes number: 141006
output nodes number: 71962
edges number: 739589
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6025848388671875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.619741916656494  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6240315437316895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6240315437316895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71962, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6240315437316895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2655, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.653537273406982  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.653537273406982  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2655, 64]), torch.Size([1, 2655, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.65480375289917  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6663970947265625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2655, 64])
m.shape torch.Size([3250, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.667374610900879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.667374610900879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3250, 64]), torch.Size([1, 3250, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.668924331665039  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.695380210876465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3250, 64])
m.shape torch.Size([34042, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.719715118408203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.719715118408203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34042, 64]), torch.Size([1, 34042, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.735947608947754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.093062400817871  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34042, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.067193031311035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.076717376708984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.086241722106934  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.076419353485107  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39947, 64])
input nodes number: 71962
output nodes number: 39947
edges number: 111281
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0867791175842285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.096303462982178  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0988898277282715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0988898277282715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1675, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.110196590423584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.110196590423584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1675, 64]), torch.Size([1, 1675, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.110995769500732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.117457866668701  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1675, 64])
m.shape torch.Size([1490, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.117791175842285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.117791175842285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1490, 64]), torch.Size([1, 1490, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.118501663208008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.130310535430908  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1490, 64])
m.shape torch.Size([1082, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.130753517150879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.130753517150879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1082, 64]), torch.Size([1, 1082, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.131269454956055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.145351409912109  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1082, 64])
m.shape torch.Size([924, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.146002292633057  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.146002292633057  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 924, 64]), torch.Size([1, 924, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.146442890167236  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.159220218658447  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 924, 64])
m.shape torch.Size([6194, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.166713714599609  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.166713714599609  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6194, 64]), torch.Size([1, 6194, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.170101165771484  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.279534339904785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6194, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.271039962768555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.272787094116211  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.274557113647461  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.2727251052856445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11365, 40])
input nodes number: 39947
output nodes number: 11365
edges number: 42567
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.2730302810668945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027828872203826904 |0.004334241151809692 |0.10966220498085022 |0.0008335709571838379 |0.05233496427536011 |0.006631612777709961 |
----------------------------------------------------------pseudo_mini_loss sum 1.901642918586731
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  2023780
Number of first layer input nodes during this epoch:  1128435
block dataloader generation time/epoch 1.1920928955078125e-06
for loop block_dataloader item  time:  0.10389184951782227
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07906484603881836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07906484603881836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([140918, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07906484603881836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4343, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44162940979003906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.44162940979003906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4343, 128]), torch.Size([1, 4343, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4457712173461914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.47890567779541016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4343, 128])
m.shape torch.Size([5438, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48202085494995117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48202085494995117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5438, 128]), torch.Size([1, 5438, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4880490303039551  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5658402442932129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5438, 128])
m.shape torch.Size([5372, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5709319114685059  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5709319114685059  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5372, 128]), torch.Size([1, 5372, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5760550498962402  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6931471824645996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5372, 128])
m.shape torch.Size([4953, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6991686820983887  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6991686820983887  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4953, 128]), torch.Size([1, 4953, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.7038922309875488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8464241027832031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4953, 128])
m.shape torch.Size([4646, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8558712005615234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8558712005615234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4646, 128]), torch.Size([1, 4646, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8603019714355469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0198097229003906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4646, 128])
m.shape torch.Size([3991, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.029012680053711  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.029012680053711  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3991, 128]), torch.Size([1, 3991, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0329866409301758  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.1998710632324219  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3991, 128])
m.shape torch.Size([3601, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.209486961364746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.209486961364746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3601, 128]), torch.Size([1, 3601, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2131032943725586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3893685340881348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3601, 128])
m.shape torch.Size([3215, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3999156951904297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.3999156951904297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3215, 128]), torch.Size([1, 3215, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4039931297302246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.578758716583252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3215, 128])
m.shape torch.Size([2902, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5896797180175781  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5896797180175781  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2902, 128]), torch.Size([1, 2902, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5926246643066406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7726263999938965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2902, 128])
m.shape torch.Size([2608, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7835383415222168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7835383415222168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2608, 128]), torch.Size([1, 2608, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.786231517791748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.966897964477539  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2608, 128])
m.shape torch.Size([2353, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9779963493347168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9779963493347168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2353, 128]), torch.Size([1, 2353, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9802660942077637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1599016189575195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2353, 128])
m.shape torch.Size([2049, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1706643104553223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1706643104553223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2049, 128]), torch.Size([1, 2049, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.172727108001709  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3471884727478027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2049, 128])
m.shape torch.Size([1879, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3578591346740723  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3578591346740723  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1879, 128]), torch.Size([1, 1879, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3596510887145996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.525217056274414  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1879, 128])
m.shape torch.Size([1672, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.535482883453369  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.535482883453369  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1672, 128]), torch.Size([1, 1672, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5370774269104004  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.697714328765869  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1672, 128])
m.shape torch.Size([1494, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7076029777526855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7076029777526855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1494, 128]), torch.Size([1, 1494, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7090277671813965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.860352039337158  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1494, 128])
m.shape torch.Size([1383, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8701910972595215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8701910972595215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1383, 128]), torch.Size([1, 1383, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8715100288391113  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0205492973327637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1383, 128])
m.shape torch.Size([1302, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0304441452026367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0304441452026367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1302, 128]), torch.Size([1, 1302, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.0316858291625977  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.18068790435791  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1302, 128])
m.shape torch.Size([1163, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.190049171447754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.190049171447754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1163, 128]), torch.Size([1, 1163, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1911582946777344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3336715698242188  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1163, 128])
m.shape torch.Size([1028, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.342430591583252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.342430591583252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3434109687805176  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.4771008491516113  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([16434, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6333374977111816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6333374977111816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16434, 128]), torch.Size([1, 16434, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.649010181427002  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.858858585357666  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16434, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.530634880065918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.547759532928467  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.564884185791016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.547224044799805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71826, 64])
input nodes number: 140918
output nodes number: 71826
edges number: 735572
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.565948486328125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.583073139190674  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.58735466003418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.58735466003418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71826, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.58735466003418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2730, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.616787433624268  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.616787433624268  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2730, 64]), torch.Size([1, 2730, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.618089199066162  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.630038738250732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2730, 64])
m.shape torch.Size([3165, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.63096809387207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.63096809387207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3165, 64]), torch.Size([1, 3165, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.632477760314941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.660158157348633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3165, 64])
m.shape torch.Size([33955, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.684449195861816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.684449195861816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33955, 64]), torch.Size([1, 33955, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.700640678405762  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.056844711303711  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33955, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.031057834625244  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.040558815002441  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.05023193359375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.040433883666992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39850, 64])
input nodes number: 71826
output nodes number: 39850
edges number: 110925
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0507683753967285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.060269355773926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.062675952911377  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.062675952911377  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1701, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0739617347717285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0739617347717285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1701, 64]), torch.Size([1, 1701, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.07477331161499  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.081684112548828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1701, 64])
m.shape torch.Size([1481, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.082006931304932  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.082006931304932  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1481, 64]), torch.Size([1, 1481, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.082713603973389  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.094298839569092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1481, 64])
m.shape torch.Size([1134, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.09478235244751  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.09478235244751  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1134, 64]), torch.Size([1, 1134, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.095323085784912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.110562801361084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1134, 64])
m.shape torch.Size([866, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.111144542694092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.111144542694092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 866, 64]), torch.Size([1, 866, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.111557483673096  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.123532772064209  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 866, 64])
m.shape torch.Size([6186, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.130970478057861  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.130970478057861  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6186, 64]), torch.Size([1, 6186, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.134613513946533  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.245398044586182  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6186, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.236787796020508  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.238645553588867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.240503311157227  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.238560676574707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39850
output nodes number: 11368
edges number: 42459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.239053249359131  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02559685707092285 |0.0042002201080322266 |0.1089010238647461 |0.0008392333984375 |0.05189108848571777 |0.007055997848510742 |
----------------------------------------------------------pseudo_mini_loss sum 1.8574739694595337
for loop block_dataloader item  time:  0.40439820289611816
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07933425903320312  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07933425903320312  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141127, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.07933425903320312  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4271, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4442934989929199  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4442934989929199  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4271, 128]), torch.Size([1, 4271, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.448366641998291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48095178604125977  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4271, 128])
m.shape torch.Size([5281, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4839515686035156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.4839515686035156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5281, 128]), torch.Size([1, 5281, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.48898792266845703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5645332336425781  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5281, 128])
m.shape torch.Size([5365, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5696897506713867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5696897506713867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5365, 128]), torch.Size([1, 5365, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.5748062133789062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6917719841003418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5365, 128])
m.shape torch.Size([5026, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6979193687438965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.6979193687438965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5026, 128]), torch.Size([1, 5026, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.702794075012207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8445029258728027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5026, 128])
m.shape torch.Size([4749, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8540892601013184  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8540892601013184  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4749, 128]), torch.Size([1, 4749, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 0.8586182594299316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0216622352600098  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4749, 128])
m.shape torch.Size([3988, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0308074951171875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0308074951171875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3988, 128]), torch.Size([1, 3988, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.0349526405334473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2018580436706543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3988, 128])
m.shape torch.Size([3601, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2119760513305664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.2119760513305664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3601, 128]), torch.Size([1, 3601, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.21565580368042  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.392590045928955  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3601, 128])
m.shape torch.Size([3259, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4026618003845215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4026618003845215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3259, 128]), torch.Size([1, 3259, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.4058737754821777  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.5925159454345703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3259, 128])
m.shape torch.Size([2892, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.6033730506896973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.6033730506896973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2892, 128]), torch.Size([1, 2892, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.606203556060791  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7855868339538574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2892, 128])
m.shape torch.Size([2565, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7962136268615723  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7962136268615723  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2565, 128]), torch.Size([1, 2565, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.7993054389953613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9767422676086426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2565, 128])
m.shape torch.Size([2271, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9874310493469238  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9874310493469238  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2271, 128]), torch.Size([1, 2271, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 1.9896960258483887  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1631855964660645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2271, 128])
m.shape torch.Size([2030, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1736793518066406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1736793518066406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2030, 128]), torch.Size([1, 2030, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.1756153106689453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3412017822265625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2030, 128])
m.shape torch.Size([1865, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3520212173461914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.3520212173461914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1865, 128]), torch.Size([1, 1865, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.353799819946289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5174312591552734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1865, 128])
m.shape torch.Size([1679, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5277504920959473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5277504920959473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1679, 128]), torch.Size([1, 1679, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.5293517112731934  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.689772129058838  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1679, 128])
m.shape torch.Size([1568, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7001867294311523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7001867294311523  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1568, 128]), torch.Size([1, 1568, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.7016820907592773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.861142158508301  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1568, 128])
m.shape torch.Size([1313, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8704118728637695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.8704118728637695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1313, 128]), torch.Size([1, 1313, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 2.871664047241211  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.013671398162842  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1313, 128])
m.shape torch.Size([1260, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.023259162902832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.023259162902832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1260, 128]), torch.Size([1, 1260, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.024460792541504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.170182228088379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1260, 128])
m.shape torch.Size([1200, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1798810958862305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.1798810958862305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.181025505065918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.326907157897949  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([1054, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3358840942382812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3358840942382812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.3368892669677734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.471860885620117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([16807, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6316423416137695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6316423416137695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16807, 128]), torch.Size([1, 16807, 128])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 3.6476707458496094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.907675743103027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16807, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.577747344970703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.594923973083496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.612100601196289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.594387054443359  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72044, 64])
input nodes number: 141127
output nodes number: 72044
edges number: 742468
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.613155841827393  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6303324699401855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.634626865386963  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.634626865386963  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72044, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.634626865386963  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2635, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.664224624633789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.664224624633789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2635, 64]), torch.Size([1, 2635, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6654815673828125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.6758270263671875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2635, 64])
m.shape torch.Size([3124, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.67683219909668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.67683219909668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3124, 64]), torch.Size([1, 3124, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.678321838378906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.703404426574707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3124, 64])
m.shape torch.Size([34260, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.728816032409668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.728816032409668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34260, 64]), torch.Size([1, 34260, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 5.745152473449707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.104554176330566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34260, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.078557014465332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.0885467529296875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.098088264465332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.087800025939941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([40019, 64])
input nodes number: 72044
output nodes number: 40019
edges number: 111663
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.098626136779785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.108615875244141  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.110584259033203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.110584259033203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1623, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.12191915512085  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.12191915512085  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1623, 64]), torch.Size([1, 1623, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1226935386657715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.129003047943115  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1623, 64])
m.shape torch.Size([1447, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.129327774047852  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.129327774047852  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1447, 64]), torch.Size([1, 1447, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.13001823425293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.140698432922363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1447, 64])
m.shape torch.Size([1181, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1412248611450195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.1412248611450195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1181, 64]), torch.Size([1, 1181, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.141788482666016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.154359817504883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1181, 64])
m.shape torch.Size([910, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.154973030090332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.154973030090332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 910, 64]), torch.Size([1, 910, 64])
----------------------------------------3
 Nvidia-smi: 9.9481201171875 GB
    Memory Allocated: 6.155406951904297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.167990684509277  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 910, 64])
m.shape torch.Size([6207, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1754045486450195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1754045486450195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6207, 64]), torch.Size([1, 6207, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1785783767700195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.288590908050537  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6207, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.279224395751953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.281142234802246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.283143043518066  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.281140327453613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 40019
output nodes number: 11368
edges number: 42735
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.281583786010742  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02585017681121826 |0.004046916961669922 |0.11002063751220703 |0.0008533000946044922 |0.05332005023956299 |0.006970405578613281 |
----------------------------------------------------------pseudo_mini_loss sum 1.8539965152740479
for loop block_dataloader item  time:  0.7504532337188721
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07946300506591797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07946300506591797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141275, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07946300506591797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4353, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4443645477294922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4443645477294922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4353, 128]), torch.Size([1, 4353, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4485158920288086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48172664642333984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4353, 128])
m.shape torch.Size([5463, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.484860897064209  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.484860897064209  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5463, 128]), torch.Size([1, 5463, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49088191986083984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.56903076171875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5463, 128])
m.shape torch.Size([5383, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5741262435913086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5741262435913086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5383, 128]), torch.Size([1, 5383, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5792598724365234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.696465015411377  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5383, 128])
m.shape torch.Size([4962, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7025246620178223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7025246620178223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4962, 128]), torch.Size([1, 4962, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7072567939758301  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8495583534240723  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4962, 128])
m.shape torch.Size([4526, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8579831123352051  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8579831123352051  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4526, 128]), torch.Size([1, 4526, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8622994422912598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0185494422912598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4526, 128])
m.shape torch.Size([4001, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0278382301330566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0278382301330566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4001, 128]), torch.Size([1, 4001, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0318217277526855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.199221134185791  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4001, 128])
m.shape torch.Size([3620, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2089433670043945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2089433670043945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3620, 128]), torch.Size([1, 3620, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2136650085449219  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3906307220458984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3620, 128])
m.shape torch.Size([3264, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4013557434082031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4013557434082031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3264, 128]), torch.Size([1, 3264, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4046382904052734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5889034271240234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3264, 128])
m.shape torch.Size([2910, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5998353958129883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5998353958129883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2910, 128]), torch.Size([1, 2910, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.602738380432129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7815804481506348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2910, 128])
m.shape torch.Size([2568, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.79243803024292  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.79243803024292  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2568, 128]), torch.Size([1, 2568, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7950358390808105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9710817337036133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2568, 128])
m.shape torch.Size([2310, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.981973648071289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.981973648071289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2310, 128]), torch.Size([1, 2310, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9843006134033203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.165903091430664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2310, 128])
m.shape torch.Size([2069, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.176640510559082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.176640510559082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2069, 128]), torch.Size([1, 2069, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.178673267364502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3517050743103027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2069, 128])
m.shape torch.Size([1875, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3623414039611816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3623414039611816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1875, 128]), torch.Size([1, 1875, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3641295433044434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5304431915283203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1875, 128])
m.shape torch.Size([1691, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5408377647399902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5408377647399902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1691, 128]), torch.Size([1, 1691, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.542450428009033  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7033591270446777  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1691, 128])
m.shape torch.Size([1549, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.713632106781006  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.713632106781006  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1549, 128]), torch.Size([1, 1549, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.715109348297119  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.871696949005127  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1549, 128])
m.shape torch.Size([1332, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8811206817626953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8811206817626953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1332, 128]), torch.Size([1, 1332, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8823909759521484  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0259366035461426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1332, 128])
m.shape torch.Size([1277, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0356531143188477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0356531143188477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1277, 128]), torch.Size([1, 1277, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0368709564208984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.183286666870117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1277, 128])
m.shape torch.Size([1129, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1923680305480957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1923680305480957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1129, 128]), torch.Size([1, 1129, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1934447288513184  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3313193321228027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1129, 128])
m.shape torch.Size([1048, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.340275764465332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.340275764465332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.341275215148926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.47554874420166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([16812, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.635380744934082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.635380744934082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16812, 128]), torch.Size([1, 16812, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.651413917541504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.912091255187988  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16812, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.580256938934326  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.597456932067871  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.614656925201416  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.596919059753418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72142, 64])
input nodes number: 141275
output nodes number: 72142
edges number: 742251
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.615747928619385  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.63294792175293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6372480392456055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6372480392456055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72142, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6372480392456055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2682, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.666882514953613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.666882514953613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2682, 64]), torch.Size([1, 2682, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.668161392211914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.679052352905273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2682, 64])
m.shape torch.Size([3189, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.680001735687256  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.680001735687256  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3189, 64]), torch.Size([1, 3189, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.681522846221924  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.70672082901001  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3189, 64])
m.shape torch.Size([34233, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.732116222381592  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.732116222381592  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34233, 64]), torch.Size([1, 34233, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.748440265655518  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.107560634613037  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34233, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.081565856933594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.091127395629883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.100688934326172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0908284187316895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([40104, 64])
input nodes number: 72142
output nodes number: 40104
edges number: 111759
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101635932922363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.111197471618652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114404678344727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114404678344727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1657, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.125711917877197  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.125711917877197  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1657, 64]), torch.Size([1, 1657, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.126502513885498  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.133033275604248  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1657, 64])
m.shape torch.Size([1491, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.133371353149414  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.133371353149414  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1491, 64]), torch.Size([1, 1491, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.134082794189453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145430564880371  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1491, 64])
m.shape torch.Size([1123, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145903587341309  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145903587341309  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1123, 64]), torch.Size([1, 1123, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.146439552307129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.158814430236816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1123, 64])
m.shape torch.Size([896, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.159427642822266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.159427642822266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 896, 64]), torch.Size([1, 896, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.159854888916016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.172245025634766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 896, 64])
m.shape torch.Size([6201, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.179655075073242  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.179655075073242  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6201, 64]), torch.Size([1, 6201, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.182862758636475  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.292568683624268  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6201, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.283771991729736  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.285576343536377  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.287380695343018  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.285491466522217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 40104
output nodes number: 11368
edges number: 42597
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.285761833190918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02585577964782715 |0.004072825113932292 |0.10933454831441243 |0.0008541742960611979 |0.05309414863586426 |0.007061481475830078 |
----------------------------------------------------------pseudo_mini_loss sum 1.7866071462631226
for loop block_dataloader item  time:  1.0548436641693115
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07927513122558594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07927513122558594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07927513122558594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4336, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44376087188720703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44376087188720703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4336, 128]), torch.Size([1, 4336, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44789600372314453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48097705841064453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4336, 128])
m.shape torch.Size([5376, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4840364456176758  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4840364456176758  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5376, 128]), torch.Size([1, 5376, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4900484085083008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5669527053833008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5376, 128])
m.shape torch.Size([5381, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5720868110656738  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5720868110656738  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5381, 128]), torch.Size([1, 5381, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5772185325622559  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6943292617797852  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5381, 128])
m.shape torch.Size([4996, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7004499435424805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7004499435424805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4996, 128]), torch.Size([1, 4996, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7053933143615723  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8474826812744141  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4996, 128])
m.shape torch.Size([4601, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8570117950439453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8570117950439453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4601, 128]), torch.Size([1, 4601, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8613996505737305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.019362449645996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4601, 128])
m.shape torch.Size([4013, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0286498069763184  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0286498069763184  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4013, 128]), torch.Size([1, 4013, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.032609462738037  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1989307403564453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4013, 128])
m.shape torch.Size([3611, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2090702056884766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2090702056884766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3611, 128]), torch.Size([1, 3611, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2127056121826172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3915271759033203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3611, 128])
m.shape torch.Size([3251, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4022068977355957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4022068977355957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3251, 128]), torch.Size([1, 3251, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4056110382080078  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5897645950317383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3251, 128])
m.shape torch.Size([2888, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6006083488464355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6006083488464355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2888, 128]), torch.Size([1, 2888, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.603370189666748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7826576232910156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2888, 128])
m.shape torch.Size([2585, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7934226989746094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7934226989746094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2585, 128]), torch.Size([1, 2585, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7962841987609863  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9745612144470215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2585, 128])
m.shape torch.Size([2311, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.985450267791748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.985450267791748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2311, 128]), torch.Size([1, 2311, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9876618385314941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.168159008026123  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2311, 128])
m.shape torch.Size([2067, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.178884506225586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.178884506225586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2067, 128]), torch.Size([1, 2067, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.180952548980713  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.354368209838867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2067, 128])
m.shape torch.Size([1876, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.365011692047119  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.365011692047119  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1876, 128]), torch.Size([1, 1876, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3668007850646973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5328736305236816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1876, 128])
m.shape torch.Size([1686, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.543234348297119  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.543234348297119  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1686, 128]), torch.Size([1, 1686, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.54484224319458  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7054429054260254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1686, 128])
m.shape torch.Size([1549, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7157182693481445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7157182693481445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1549, 128]), torch.Size([1, 1549, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.717195510864258  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8737831115722656  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1549, 128])
m.shape torch.Size([1307, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8830161094665527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8830161094665527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1307, 128]), torch.Size([1, 1307, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8842625617980957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0253963470458984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1307, 128])
m.shape torch.Size([1287, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.035205841064453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.035205841064453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.036433219909668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.183718681335449  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1287, 128])
m.shape torch.Size([1174, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1931815147399902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1931815147399902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1174, 128]), torch.Size([1, 1174, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.194301128387451  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.338181972503662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1174, 128])
m.shape torch.Size([1020, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.346863269805908  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.346863269805908  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3478360176086426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.479801654815674  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
m.shape torch.Size([16703, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6386075019836426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6386075019836426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16703, 128]), torch.Size([1, 16703, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.654536724090576  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.900557041168213  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16703, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.570366382598877  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.587536811828613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.60470724105835  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.586999893188477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72018, 64])
input nodes number: 141161
output nodes number: 72018
edges number: 740240
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.605940818786621  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.623111248016357  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.62740421295166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.62740421295166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72018, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.62740421295166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2701, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.656909942626953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.656909942626953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2701, 64]), torch.Size([1, 2701, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.658198356628418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6687822341918945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2701, 64])
m.shape torch.Size([3226, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.669736385345459  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.669736385345459  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3226, 64]), torch.Size([1, 3226, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.671274662017822  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6975016593933105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3226, 64])
m.shape torch.Size([34026, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.721830368041992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.721830368041992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34026, 64]), torch.Size([1, 34026, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.738055229187012  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.095002174377441  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34026, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.069148540496826  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.07867431640625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.088679790496826  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.078855991363525  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39953, 64])
input nodes number: 72018
output nodes number: 39953
edges number: 111231
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.089217662811279  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.098743438720703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101306915283203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101306915283203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1717, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113452434539795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113452434539795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1717, 64]), torch.Size([1, 1717, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114271640777588  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.12083101272583  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1717, 64])
m.shape torch.Size([1463, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.121140956878662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.121140956878662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1463, 64]), torch.Size([1, 1463, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1218390464782715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1336493492126465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1463, 64])
m.shape torch.Size([1147, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.134146690368652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.134146690368652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1147, 64]), torch.Size([1, 1147, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1346940994262695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.148985862731934  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1147, 64])
m.shape torch.Size([884, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1495819091796875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1495819091796875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 884, 64]), torch.Size([1, 884, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.150003433227539  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.162227630615234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 884, 64])
m.shape torch.Size([6157, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.169586658477783  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.169586658477783  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6157, 64]), torch.Size([1, 6157, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.172867298126221  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.282795429229736  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6157, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.272729873657227  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.274629592895508  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2768235206604  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.274838924407959  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39953
output nodes number: 11368
edges number: 42405
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.275317192077637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025967836380004883 |0.0040705204010009766 |0.10949963331222534 |0.0008620619773864746 |0.052813947200775146 |0.007059574127197266 |
----------------------------------------------------------pseudo_mini_loss sum 1.757932424545288
for loop block_dataloader item  time:  1.352064847946167
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07945585250854492  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07945585250854492  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141300, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07945585250854492  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4417, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44429683685302734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44429683685302734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4417, 128]), torch.Size([1, 4417, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44850921630859375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.482208251953125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4417, 128])
m.shape torch.Size([5413, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48526430130004883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48526430130004883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5413, 128]), torch.Size([1, 5413, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49113941192626953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.568572998046875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5413, 128])
m.shape torch.Size([5391, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5737037658691406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5737037658691406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5391, 128]), torch.Size([1, 5391, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5788450241088867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6960673332214355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5391, 128])
m.shape torch.Size([5067, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7023425102233887  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7023425102233887  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5067, 128]), torch.Size([1, 5067, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7081480026245117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8500018119812012  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5067, 128])
m.shape torch.Size([4703, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8596663475036621  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8596663475036621  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4703, 128]), torch.Size([1, 4703, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8641514778137207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.02561616897583  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4703, 128])
m.shape torch.Size([3978, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.034754753112793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.034754753112793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3978, 128]), torch.Size([1, 3978, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0389351844787598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2054805755615234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3978, 128])
m.shape torch.Size([3479, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.215196132659912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.215196132659912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3479, 128]), torch.Size([1, 3479, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2187519073486328  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3846435546875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3479, 128])
m.shape torch.Size([3228, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3952984809875488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3952984809875488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3228, 128]), torch.Size([1, 3228, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.39847993850708  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5751399993896484  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3228, 128])
m.shape torch.Size([2851, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5858359336853027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5858359336853027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2851, 128]), torch.Size([1, 2851, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5886244773864746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7650055885314941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2851, 128])
m.shape torch.Size([2562, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7753639221191406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7753639221191406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2562, 128]), torch.Size([1, 2562, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7779302597045898  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9566736221313477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2562, 128])
m.shape torch.Size([2285, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9674372673034668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9674372673034668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2285, 128]), torch.Size([1, 2285, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9698128700256348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.143826484680176  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2285, 128])
m.shape torch.Size([2146, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.155730724334717  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.155730724334717  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2146, 128]), torch.Size([1, 2146, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1578078269958496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.332608222961426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2146, 128])
m.shape torch.Size([1895, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.343331813812256  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.343331813812256  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1895, 128]), torch.Size([1, 1895, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3451390266418457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.511958122253418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1895, 128])
m.shape torch.Size([1656, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5221095085144043  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5221095085144043  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1656, 128]), torch.Size([1, 1656, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.523688793182373  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6835169792175293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1656, 128])
m.shape torch.Size([1509, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6935205459594727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6935205459594727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1509, 128]), torch.Size([1, 1509, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6949596405029297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.847607135772705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1509, 128])
m.shape torch.Size([1334, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8577842712402344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8577842712402344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1334, 128]), torch.Size([1, 1334, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8590564727783203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0028152465820312  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1334, 128])
m.shape torch.Size([1276, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0125226974487305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0125226974487305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1276, 128]), torch.Size([1, 1276, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.013739585876465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.16007137298584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1276, 128])
m.shape torch.Size([1199, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1697540283203125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1697540283203125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1199, 128]), torch.Size([1, 1199, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1708974838256836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3164167404174805  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1199, 128])
m.shape torch.Size([1066, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.325502872467041  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.325502872467041  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1066, 128]), torch.Size([1, 1066, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.32651948928833  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.4641194343566895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1066, 128])
m.shape torch.Size([16766, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.623504161834717  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.623504161834717  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16766, 128]), torch.Size([1, 16766, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.639493465423584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.893985271453857  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16766, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.56427526473999  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.581494331359863  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.598713397979736  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.580955982208252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72221, 64])
input nodes number: 141300
output nodes number: 72221
edges number: 742056
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.599803924560547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.61702299118042  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.621327877044678  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.621327877044678  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72221, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.621327877044678  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2767, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.651031494140625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.651031494140625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2767, 64]), torch.Size([1, 2767, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.652351379394531  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.665464401245117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2767, 64])
m.shape torch.Size([3229, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.666511535644531  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.666511535644531  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3229, 64]), torch.Size([1, 3229, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.668051719665527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6939239501953125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3229, 64])
m.shape torch.Size([34235, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7193098068237305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7193098068237305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34235, 64]), torch.Size([1, 34235, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.735634803771973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094776153564453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34235, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.068767070770264  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.078359127044678  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.088298320770264  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.07840633392334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([40231, 64])
input nodes number: 72221
output nodes number: 40231
edges number: 111930
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.088837623596191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0984296798706055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.100889205932617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.100889205932617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1665, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.112152099609375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.112152099609375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1665, 64]), torch.Size([1, 1665, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.112946510314941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.119696617126465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1665, 64])
m.shape torch.Size([1469, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.120021820068359  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.120021820068359  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1469, 64]), torch.Size([1, 1469, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.120722770690918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.131542205810547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1469, 64])
m.shape torch.Size([1198, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.132075786590576  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.132075786590576  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1198, 64]), torch.Size([1, 1198, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1326470375061035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145949840545654  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1198, 64])
m.shape torch.Size([980, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.146628379821777  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.146628379821777  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 980, 64]), torch.Size([1, 980, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.147095680236816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.160647392272949  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 980, 64])
m.shape torch.Size([6056, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.167859077453613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.167859077453613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6056, 64]), torch.Size([1, 6056, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.170777320861816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.279886722564697  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6056, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.270153522491455  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.272396087646484  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.274708271026611  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.272380828857422  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 40231
output nodes number: 11368
edges number: 42397
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.27310848236084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025814008712768555 |0.0040802001953125 |0.10960807800292968 |0.0008574485778808594 |0.05278558731079101 |0.006951570510864258 |
----------------------------------------------------------pseudo_mini_loss sum 1.7489049434661865
for loop block_dataloader item  time:  1.6501977443695068
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0797429084777832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0797429084777832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141185, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0797429084777832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4360, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44399309158325195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44399309158325195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4360, 128]), torch.Size([1, 4360, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4481511116027832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4814152717590332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4360, 128])
m.shape torch.Size([5497, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48457860946655273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48457860946655273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5497, 128]), torch.Size([1, 5497, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49138402938842773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5700192451477051  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5497, 128])
m.shape torch.Size([5287, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5749611854553223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5749611854553223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5287, 128]), torch.Size([1, 5287, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5801033973693848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6918792724609375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5287, 128])
m.shape torch.Size([4952, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6988034248352051  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6988034248352051  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4952, 128]), torch.Size([1, 4952, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7035260200500488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8449673652648926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4952, 128])
m.shape torch.Size([4654, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8530611991882324  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8530611991882324  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4654, 128]), torch.Size([1, 4654, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8582825660705566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0180649757385254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4654, 128])
m.shape torch.Size([4054, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0274443626403809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0274443626403809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4054, 128]), torch.Size([1, 4054, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.031456470489502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1991047859191895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4054, 128])
m.shape torch.Size([3545, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2088041305541992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2088041305541992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3545, 128]), torch.Size([1, 3545, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2122745513916016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3855443000793457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3545, 128])
m.shape torch.Size([3252, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3962593078613281  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3962593078613281  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3252, 128]), torch.Size([1, 3252, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3995285034179688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.584083080291748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3252, 128])
m.shape torch.Size([2879, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5948877334594727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5948877334594727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2879, 128]), torch.Size([1, 2879, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5978527069091797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7787361145019531  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2879, 128])
m.shape torch.Size([2640, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.789639949798584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.789639949798584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2640, 128]), torch.Size([1, 2640, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7922873497009277  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.975954532623291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2640, 128])
m.shape torch.Size([2260, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9865498542785645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9865498542785645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2260, 128]), torch.Size([1, 2260, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.988985538482666  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1613221168518066  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2260, 128])
m.shape torch.Size([2049, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.171968936920166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.171968936920166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2049, 128]), torch.Size([1, 2049, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1740612983703613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.347160816192627  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2049, 128])
m.shape torch.Size([1892, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3569445610046387  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3569445610046387  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1892, 128]), torch.Size([1, 1892, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3587489128112793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.526803493499756  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1892, 128])
m.shape torch.Size([1661, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.536989688873291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.536989688873291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.538573741912842  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6990532875061035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([1511, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.709068775177002  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.709068775177002  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1511, 128]), torch.Size([1, 1511, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.710509777069092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.863373279571533  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1511, 128])
m.shape torch.Size([1315, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.872685432434082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.872685432434082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1315, 128]), torch.Size([1, 1315, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8739395141601562  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0157556533813477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1315, 128])
m.shape torch.Size([1303, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.025691032409668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.025691032409668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1303, 128]), torch.Size([1, 1303, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0269336700439453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1760501861572266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1303, 128])
m.shape torch.Size([1170, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1854710578918457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1854710578918457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1170, 128]), torch.Size([1, 1170, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.186586856842041  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.328901767730713  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1170, 128])
m.shape torch.Size([1051, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3378658294677734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3378658294677734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1051, 128]), torch.Size([1, 1051, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3388681411743164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.474085807800293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1051, 128])
m.shape torch.Size([16816, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6339545249938965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6339545249938965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16816, 128]), torch.Size([1, 16816, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.649991512298584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.9112067222595215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16816, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.581977844238281  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.599179267883301  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.61638069152832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.598641395568848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72148, 64])
input nodes number: 141185
output nodes number: 72148
edges number: 742262
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.617464542388916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6346659660339355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6389665603637695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6389665603637695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72148, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6389665603637695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2717, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.668537139892578  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.668537139892578  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2717, 64]), torch.Size([1, 2717, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.669833183288574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.681168079376221  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2717, 64])
m.shape torch.Size([3236, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.682119369506836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.682119369506836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3236, 64]), torch.Size([1, 3236, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.683662414550781  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.709257125854492  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3236, 64])
m.shape torch.Size([34094, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.733633995056152  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.733633995056152  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34094, 64]), torch.Size([1, 34094, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.74989128112793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.107551574707031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34094, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.081645965576172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.091194152832031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101177215576172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.091330528259277  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([40047, 64])
input nodes number: 72148
output nodes number: 40047
edges number: 111471
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101716041564941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.111264228820801  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113785266876221  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113785266876221  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1689, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.125750541687012  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.125750541687012  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1689, 64]), torch.Size([1, 1689, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.126556396484375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.133203506469727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1689, 64])
m.shape torch.Size([1391, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.133484840393066  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.133484840393066  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1391, 64]), torch.Size([1, 1391, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.134148597717285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.144951343536377  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1391, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145467281341553  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145467281341553  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1149, 64]), torch.Size([1, 1149, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.146015644073486  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.158371448516846  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1149, 64])
m.shape torch.Size([944, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1590256690979  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1590256690979  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 944, 64]), torch.Size([1, 944, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.159475803375244  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.172529697418213  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 944, 64])
m.shape torch.Size([6195, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.179920673370361  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.179920673370361  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6195, 64]), torch.Size([1, 6195, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.182898044586182  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.29163932800293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6195, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2816572189331055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.283631324768066  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.285605430603027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.283546447753906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 40047
output nodes number: 11368
edges number: 42669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.283661365509033  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02886021137237549 |0.004629969596862793 |0.1113966703414917 |0.0008622010548909506 |0.05303311347961426 |0.007029056549072266 |
----------------------------------------------------------pseudo_mini_loss sum 1.7314409017562866
for loop block_dataloader item  time:  1.9949440956115723
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07940912246704102  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07940912246704102  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141098, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07940912246704102  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4326, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44388866424560547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44388866424560547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4326, 128]), torch.Size([1, 4326, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4480142593383789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4810190200805664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4326, 128])
m.shape torch.Size([5432, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48413658142089844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48413658142089844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5432, 128]), torch.Size([1, 5432, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49019432067871094  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5678997039794922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5432, 128])
m.shape torch.Size([5305, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5728983879089355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5728983879089355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5305, 128]), torch.Size([1, 5305, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5779576301574707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6893820762634277  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5305, 128])
m.shape torch.Size([5076, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6965341567993164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6965341567993164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5076, 128]), torch.Size([1, 5076, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7013750076293945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8432798385620117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5076, 128])
m.shape torch.Size([4695, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.852961540222168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.852961540222168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4695, 128]), torch.Size([1, 4695, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8574390411376953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0186290740966797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4695, 128])
m.shape torch.Size([3973, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.027757167816162  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.027757167816162  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3973, 128]), torch.Size([1, 3973, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0318856239318848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1984004974365234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3973, 128])
m.shape torch.Size([3511, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2082252502441406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2082252502441406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3511, 128]), torch.Size([1, 3511, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2117938995361328  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.37921142578125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3511, 128])
m.shape torch.Size([3218, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.38981294631958  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.38981294631958  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3218, 128]), torch.Size([1, 3218, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3930134773254395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5689945220947266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3218, 128])
m.shape torch.Size([2849, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5797357559204102  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5797357559204102  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2849, 128]), torch.Size([1, 2849, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.582545280456543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7609848976135254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2849, 128])
m.shape torch.Size([2572, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.771890640258789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.771890640258789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2572, 128]), torch.Size([1, 2572, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7744393348693848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.949723243713379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2572, 128])
m.shape torch.Size([2220, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9607610702514648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9607610702514648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2220, 128]), torch.Size([1, 2220, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9629549980163574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1346282958984375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2220, 128])
m.shape torch.Size([2051, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.145305633544922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.145305633544922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2051, 128]), torch.Size([1, 2051, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.147353172302246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.319965362548828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2051, 128])
m.shape torch.Size([1885, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3306946754455566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3306946754455566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1885, 128]), torch.Size([1, 1885, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3324923515319824  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.499030590057373  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1885, 128])
m.shape torch.Size([1703, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.509500503540039  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.509500503540039  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1703, 128]), torch.Size([1, 1703, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.511124610900879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6721630096435547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1703, 128])
m.shape torch.Size([1524, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.682251453399658  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.682251453399658  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1524, 128]), torch.Size([1, 1524, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6837048530578613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8384900093078613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1524, 128])
m.shape torch.Size([1334, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8479409217834473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8479409217834473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1334, 128]), torch.Size([1, 1334, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.849213123321533  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9932446479797363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1334, 128])
m.shape torch.Size([1263, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0028467178344727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0028467178344727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1263, 128]), torch.Size([1, 1263, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0040512084960938  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1501903533935547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1263, 128])
m.shape torch.Size([1184, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.159750461578369  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.159750461578369  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1184, 128]), torch.Size([1, 1184, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.160879611968994  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.304617404937744  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1184, 128])
m.shape torch.Size([1028, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.313366413116455  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.313366413116455  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3143467903137207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.446495532989502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([16767, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.605907917022705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.605907917022705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16767, 128]), torch.Size([1, 16767, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6218981742858887  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.876524448394775  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16767, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.547072887420654  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.564218997955322  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.58136510848999  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.563683032989502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71916, 64])
input nodes number: 141098
output nodes number: 71916
edges number: 739642
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5825886726379395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.599734783172607  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6040215492248535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6040215492248535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71916, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6040215492248535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2661, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.633456707000732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.633456707000732  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2661, 64]), torch.Size([1, 2661, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.634726047515869  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6449809074401855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2661, 64])
m.shape torch.Size([3230, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.645948886871338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.645948886871338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3230, 64]), torch.Size([1, 3230, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.647489070892334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.673355579376221  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3230, 64])
m.shape torch.Size([33960, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.697634696960449  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.697634696960449  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33960, 64]), torch.Size([1, 33960, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.713828086853027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.070082664489746  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33960, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.044277667999268  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.054307460784912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.063808917999268  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0534820556640625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39851, 64])
input nodes number: 71916
output nodes number: 39851
edges number: 111001
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.064345836639404  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.074375629425049  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.076232433319092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.076232433319092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1674, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.087520122528076  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.087520122528076  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1674, 64]), torch.Size([1, 1674, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.088318347930908  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094975471496582  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1674, 64])
m.shape torch.Size([1464, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.095296382904053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.095296382904053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1464, 64]), torch.Size([1, 1464, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.095994472503662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.10687780380249  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1464, 64])
m.shape torch.Size([1166, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.107388973236084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.107388973236084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1166, 64]), torch.Size([1, 1166, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.107944965362549  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1211724281311035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1166, 64])
m.shape torch.Size([927, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1218061447143555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1218061447143555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 927, 64]), torch.Size([1, 927, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.122248649597168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.135069847106934  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 927, 64])
m.shape torch.Size([6137, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.142393589019775  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.142393589019775  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6137, 64]), torch.Size([1, 6137, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145463466644287  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.253870010375977  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6137, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.24488639831543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.246606826782227  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.248386383056641  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.246581077575684  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39851
output nodes number: 11368
edges number: 42493
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.24670934677124  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02890300750732422 |0.004594598497663226 |0.11128401756286621 |0.000869819096156529 |0.052977255412510464 |0.006974697113037109 |
----------------------------------------------------------pseudo_mini_loss sum 1.6763834953308105
for loop block_dataloader item  time:  2.375241756439209
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07901811599731445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07901811599731445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([140862, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07901811599731445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4356, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4415755271911621  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4415755271911621  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4356, 128]), torch.Size([1, 4356, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44572973251342773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.47896337509155273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4356, 128])
m.shape torch.Size([5471, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4821038246154785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4821038246154785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5471, 128]), torch.Size([1, 5471, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48812294006347656  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5663862228393555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5471, 128])
m.shape torch.Size([5365, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5714521408081055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5714521408081055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5365, 128]), torch.Size([1, 5365, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.576568603515625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6936354637145996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5365, 128])
m.shape torch.Size([4965, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6996665000915527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6996665000915527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4965, 128]), torch.Size([1, 4965, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7044014930725098  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8469219207763672  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4965, 128])
m.shape torch.Size([4582, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8563919067382812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8563919067382812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4582, 128]), torch.Size([1, 4582, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8607616424560547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0180721282958984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4582, 128])
m.shape torch.Size([3944, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0271711349487305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0271711349487305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3944, 128]), torch.Size([1, 3944, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.031275749206543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1963348388671875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3944, 128])
m.shape torch.Size([3623, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2065472602844238  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2065472602844238  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3623, 128]), torch.Size([1, 3623, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2102532386779785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3835391998291016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3623, 128])
m.shape torch.Size([3239, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.394167423248291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.394167423248291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3239, 128]), torch.Size([1, 3239, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3981504440307617  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5742206573486328  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3239, 128])
m.shape torch.Size([2875, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5850143432617188  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5850143432617188  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2875, 128]), torch.Size([1, 2875, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5879859924316406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7679142951965332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2875, 128])
m.shape torch.Size([2522, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7785429954528809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7785429954528809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2522, 128]), torch.Size([1, 2522, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7811102867126465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.955763816833496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2522, 128])
m.shape torch.Size([2294, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9665937423706055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9665937423706055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2294, 128]), torch.Size([1, 2294, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9688835144042969  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.148562431335449  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2294, 128])
m.shape torch.Size([2113, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.158623695373535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.158623695373535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1606855392456055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3341054916381836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([1908, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3445377349853516  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3445377349853516  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1908, 128]), torch.Size([1, 1908, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3463573455810547  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.514519691467285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1908, 128])
m.shape torch.Size([1646, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5245981216430664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5245981216430664  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.526167869567871  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6870927810668945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([1542, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6973371505737305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6973371505737305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1542, 128]), torch.Size([1, 1542, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.698807716369629  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8546876907348633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1542, 128])
m.shape torch.Size([1337, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8641529083251953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8641529083251953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1337, 128]), torch.Size([1, 1337, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8654279708862305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.009579658508301  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1337, 128])
m.shape torch.Size([1274, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0192694664001465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0192694664001465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1274, 128]), torch.Size([1, 1274, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.020484447479248  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1668314933776855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1274, 128])
m.shape torch.Size([1152, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1761116981506348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1761116981506348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1152, 128]), torch.Size([1, 1152, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1772103309631348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.317098617553711  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1152, 128])
m.shape torch.Size([1054, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3260984420776367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3260984420776367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1054, 128]), torch.Size([1, 1054, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.327103614807129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.461796760559082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1054, 128])
m.shape torch.Size([16559, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.619497299194336  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.619497299194336  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16559, 128]), torch.Size([1, 16559, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.635289192199707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.861946105957031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16559, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.533759117126465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.550882816314697  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.56800651550293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.550347328186035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71821, 64])
input nodes number: 140862
output nodes number: 71821
edges number: 736755
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.569101333618164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5862250328063965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.590506076812744  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.590506076812744  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71821, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.590506076812744  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2683, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.619901657104492  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.619901657104492  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2683, 64]), torch.Size([1, 2683, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.621181488037109  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.631914138793945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2683, 64])
m.shape torch.Size([3264, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.632942199707031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.632942199707031  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3264, 64]), torch.Size([1, 3264, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.634498596191406  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.661303520202637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3264, 64])
m.shape torch.Size([33872, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.68550968170166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.68550968170166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33872, 64]), torch.Size([1, 33872, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.701661109924316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.056992530822754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33872, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.031243801116943  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.040737628936768  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.050741672515869  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.040950775146484  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39819, 64])
input nodes number: 71821
output nodes number: 39819
edges number: 110827
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.051278114318848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.060771942138672  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0631794929504395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0631794929504395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1702, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.074413776397705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.074413776397705  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1702, 64]), torch.Size([1, 1702, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.075225353240967  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.081889629364014  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1702, 64])
m.shape torch.Size([1500, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082221508026123  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082221508026123  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1500, 64]), torch.Size([1, 1500, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082936763763428  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0937113761901855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1500, 64])
m.shape torch.Size([1179, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094223976135254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094223976135254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1179, 64]), torch.Size([1, 1179, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094786643981934  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.10854959487915  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1179, 64])
m.shape torch.Size([913, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.109166622161865  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.109166622161865  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 913, 64]), torch.Size([1, 913, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.109602451324463  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.122230052947998  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 913, 64])
m.shape torch.Size([6071, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.129476070404053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.129476070404053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6071, 64]), torch.Size([1, 6071, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.132574081420898  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.238852500915527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6071, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.230744361877441  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2324538230896  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.234218120574951  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.232423782348633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11365, 40])
input nodes number: 39819
output nodes number: 11365
edges number: 42246
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.232794761657715  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02842232584953308 |0.004522442817687988 |0.11108842492103577 |0.0008653104305267334 |0.05290767550468445 |0.006747722625732422 |
----------------------------------------------------------pseudo_mini_loss sum 1.6795017719268799
Total (block generation + training)time/epoch 2.5808207988739014
Training time/epoch 2.5806829929351807
Training time without block to device /epoch 2.5445034503936768
Training time without total dataloading part /epoch 1.325639009475708
load block tensor time/epoch 0.22737860679626465
block to device time/epoch 0.036179542541503906
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  2024936
Number of first layer input nodes during this epoch:  1128926
block dataloader generation time/epoch 9.5367431640625e-07
for loop block_dataloader item  time:  0.10712552070617676
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.08020877838134766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.08020877838134766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141495, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.08020877838134766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4343, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44286155700683594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44286155700683594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4343, 128]), torch.Size([1, 4343, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4470033645629883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48013782501220703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4343, 128])
m.shape torch.Size([5531, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48334169387817383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48334169387817383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5531, 128]), torch.Size([1, 5531, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4894142150878906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5685358047485352  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5531, 128])
m.shape torch.Size([5456, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5737032890319824  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5737032890319824  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5456, 128]), torch.Size([1, 5456, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5789065361022949  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6967682838439941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5456, 128])
m.shape torch.Size([4979, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7029995918273926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7029995918273926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4979, 128]), torch.Size([1, 4979, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7086391448974609  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8509368896484375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4979, 128])
m.shape torch.Size([4664, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8604335784912109  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8604335784912109  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4664, 128]), torch.Size([1, 4664, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8648815155029297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0250072479248047  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4664, 128])
m.shape torch.Size([4036, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0343303680419922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0343303680419922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4036, 128]), torch.Size([1, 4036, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0383257865905762  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.205665111541748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4036, 128])
m.shape torch.Size([3583, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.215414047241211  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.215414047241211  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3583, 128]), torch.Size([1, 3583, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.218893051147461  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3933744430541992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3583, 128])
m.shape torch.Size([3249, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4033417701721191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4033417701721191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3249, 128]), torch.Size([1, 3249, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4073176383972168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.591454029083252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3249, 128])
m.shape torch.Size([2848, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6021270751953125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6021270751953125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2848, 128]), torch.Size([1, 2848, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6048555374145508  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7847204208374023  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2848, 128])
m.shape torch.Size([2614, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7953081130981445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7953081130981445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2614, 128]), torch.Size([1, 2614, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7979326248168945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9810857772827148  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2614, 128])
m.shape torch.Size([2263, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9917092323303223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9917092323303223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2263, 128]), torch.Size([1, 2263, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9940476417541504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1655049324035645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2263, 128])
m.shape torch.Size([2058, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1760940551757812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1760940551757812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2058, 128]), torch.Size([1, 2058, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1783370971679688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.351388931274414  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2058, 128])
m.shape torch.Size([1885, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3620924949645996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3620924949645996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1885, 128]), torch.Size([1, 1885, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3638901710510254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.530965805053711  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1885, 128])
m.shape torch.Size([1674, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5412421226501465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5412421226501465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1674, 128]), torch.Size([1, 1674, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5428385734558105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7031302452087402  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1674, 128])
m.shape torch.Size([1534, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.713304042816162  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.713304042816162  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1534, 128]), torch.Size([1, 1534, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7147669792175293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.869838237762451  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1534, 128])
m.shape torch.Size([1337, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8798604011535645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8798604011535645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1337, 128]), torch.Size([1, 1337, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8811354637145996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0252175331115723  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1337, 128])
m.shape torch.Size([1266, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0348424911499023  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0348424911499023  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1266, 128]), torch.Size([1, 1266, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0360498428344727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.182000160217285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1266, 128])
m.shape torch.Size([1192, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1916275024414062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1916275024414062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1927642822265625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3377819061279297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([1016, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3464183807373047  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3464183807373047  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1016, 128]), torch.Size([1, 1016, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3473873138427734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.479093551635742  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1016, 128])
m.shape torch.Size([16560, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.636812210083008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.636812210083008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16560, 128]), torch.Size([1, 16560, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6526050567626953  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.879396438598633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16560, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.551605701446533  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.568792819976807  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.58597993850708  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.568255424499512  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72088, 64])
input nodes number: 141495
output nodes number: 72088
edges number: 737484
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.58705997467041  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.604247093200684  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.608543872833252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.608543872833252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72088, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.608543872833252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2662, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.63803243637085  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.63803243637085  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2662, 64]), torch.Size([1, 2662, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.639301776885986  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.650655269622803  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2662, 64])
m.shape torch.Size([3232, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.651618003845215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.651618003845215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3232, 64]), torch.Size([1, 3232, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.653159141540527  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.67993688583374  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3232, 64])
m.shape torch.Size([34030, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.704267501831055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.704267501831055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34030, 64]), torch.Size([1, 34030, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.720494270324707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.077483177185059  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34030, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.051627159118652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.061145782470703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.071158409118652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.061342239379883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39924, 64])
input nodes number: 72088
output nodes number: 39924
edges number: 111216
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.071696758270264  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0812153816223145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.084519863128662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.084519863128662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1636, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0958170890808105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0958170890808105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1636, 64]), torch.Size([1, 1636, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.096597194671631  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1030097007751465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1636, 64])
m.shape torch.Size([1462, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.103338718414307  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.103338718414307  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1462, 64]), torch.Size([1, 1462, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1040358543396  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.115454196929932  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1462, 64])
m.shape torch.Size([1207, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.115996360778809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.115996360778809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1207, 64]), torch.Size([1, 1207, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.116572380065918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.131525993347168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1207, 64])
m.shape torch.Size([920, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.132143020629883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.132143020629883  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 920, 64]), torch.Size([1, 920, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.13258171081543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145303726196289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 920, 64])
m.shape torch.Size([6143, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.152636528015137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.152636528015137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6143, 64]), torch.Size([1, 6143, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.155871391296387  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.263156890869141  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6143, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.255136966705322  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.256845474243164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.258744716644287  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.256951332092285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39924
output nodes number: 11368
edges number: 42576
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.257332801818848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026238679885864258 |0.0040645599365234375 |0.10973215103149414 |0.0008494853973388672 |0.052150726318359375 |0.006607770919799805 |
----------------------------------------------------------pseudo_mini_loss sum 1.6849440336227417
for loop block_dataloader item  time:  0.4052307605743408
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0791478157043457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0791478157043457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141075, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0791478157043457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4279, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4431018829345703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4431018829345703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4279, 128]), torch.Size([1, 4279, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44718265533447266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4798288345336914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4279, 128])
m.shape torch.Size([5452, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4829878807067871  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4829878807067871  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5452, 128]), torch.Size([1, 5452, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49010229110717773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5680937767028809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5452, 128])
m.shape torch.Size([5232, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5729784965515137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5729784965515137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5232, 128]), torch.Size([1, 5232, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5780730247497559  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6878447532653809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5232, 128])
m.shape torch.Size([5019, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.694922924041748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.694922924041748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5019, 128]), torch.Size([1, 5019, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.699709415435791  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.841214656829834  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5019, 128])
m.shape torch.Size([4614, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8494367599487305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8494367599487305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4614, 128]), torch.Size([1, 4614, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8544154167175293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.012824535369873  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4614, 128])
m.shape torch.Size([4022, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0221314430236816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0221314430236816  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4022, 128]), torch.Size([1, 4022, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0259919166564941  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1921939849853516  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4022, 128])
m.shape torch.Size([3529, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2020554542541504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2020554542541504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3529, 128]), torch.Size([1, 3529, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.205482006072998  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3776607513427734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3529, 128])
m.shape torch.Size([3197, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3873505592346191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3873505592346191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3197, 128]), torch.Size([1, 3197, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3904047012329102  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5641918182373047  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3197, 128])
m.shape torch.Size([2857, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5749282836914062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5749282836914062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2857, 128]), torch.Size([1, 2857, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5777082443237305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7596001625061035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2857, 128])
m.shape torch.Size([2583, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.770554542541504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.770554542541504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2583, 128]), torch.Size([1, 2583, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7730302810668945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9495115280151367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2583, 128])
m.shape torch.Size([2253, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.960585594177246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.960585594177246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2253, 128]), torch.Size([1, 2253, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9628829956054688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.136505126953125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2253, 128])
m.shape torch.Size([2093, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.148322582244873  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.148322582244873  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2093, 128]), torch.Size([1, 2093, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.150399684906006  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.324942111968994  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2093, 128])
m.shape torch.Size([1944, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3359947204589844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3359947204589844  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1944, 128]), torch.Size([1, 1944, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.337848663330078  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5084762573242188  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1944, 128])
m.shape torch.Size([1686, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.519664764404297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.519664764404297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1686, 128]), torch.Size([1, 1686, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.521272659301758  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.682220458984375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1686, 128])
m.shape torch.Size([1565, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.692610263824463  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.692610263824463  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1565, 128]), torch.Size([1, 1565, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6941027641296387  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8527750968933105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1565, 128])
m.shape torch.Size([1335, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8622140884399414  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8622140884399414  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1335, 128]), torch.Size([1, 1335, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8634872436523438  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0073537826538086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1335, 128])
m.shape torch.Size([1309, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0173282623291016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0173282623291016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1309, 128]), torch.Size([1, 1309, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0185766220092773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.168379783630371  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1309, 128])
m.shape torch.Size([1188, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.177952289581299  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.177952289581299  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1188, 128]), torch.Size([1, 1188, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1790852546691895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.323073387145996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1188, 128])
m.shape torch.Size([1061, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.332974433898926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.332974433898926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.333986282348633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.469839096069336  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([16718, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6287684440612793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6287684440612793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16718, 128]), torch.Size([1, 16718, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.644711971282959  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.892749309539795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16718, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.563506603240967  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.580657482147217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.597808361053467  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5801215171813965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71936, 64])
input nodes number: 141075
output nodes number: 71936
edges number: 741745
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.598883628845215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.616034507751465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.620322227478027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.620322227478027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71936, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.620322227478027  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2722, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.649823188781738  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.649823188781738  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2722, 64]), torch.Size([1, 2722, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.651121139526367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.66237735748291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2722, 64])
m.shape torch.Size([3251, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.663398265838623  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.663398265838623  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3251, 64]), torch.Size([1, 3251, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6649489402771  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.691127300262451  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3251, 64])
m.shape torch.Size([33989, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.715423107147217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.715423107147217  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33989, 64]), torch.Size([1, 33989, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.731630802154541  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.088191509246826  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33989, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.062357425689697  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.071885108947754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.081888675689697  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.072062969207764  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39962, 64])
input nodes number: 71936
output nodes number: 39962
edges number: 111191
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082425594329834  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.091953277587891  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094346523284912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094346523284912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1745, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1065850257873535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1065850257873535  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1745, 64]), torch.Size([1, 1745, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.107417583465576  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114179611206055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1745, 64])
m.shape torch.Size([1462, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114482402801514  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114482402801514  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1462, 64]), torch.Size([1, 1462, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.115179538726807  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1256937980651855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1462, 64])
m.shape torch.Size([1114, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.126167297363281  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.126167297363281  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1114, 64]), torch.Size([1, 1114, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1266984939575195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.140312194824219  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1114, 64])
m.shape torch.Size([919, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.140950679779053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.140950679779053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 919, 64]), torch.Size([1, 919, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1413893699646  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.154099941253662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 919, 64])
m.shape torch.Size([6128, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.16141414642334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.16141414642334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6128, 64]), torch.Size([1, 6128, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.164559841156006  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.272748947143555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6128, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.262814044952393  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.26463508605957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2668352127075195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.264929294586182  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39962
output nodes number: 11368
edges number: 42327
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.265424728393555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025896072387695312 |0.0040128231048583984 |0.10927963256835938 |0.0008355379104614258 |0.05239081382751465 |0.006947994232177734 |
----------------------------------------------------------pseudo_mini_loss sum 1.6091420650482178
for loop block_dataloader item  time:  0.7032132148742676
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07933616638183594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07933616638183594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141244, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07933616638183594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4354, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4438285827636719  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4438285827636719  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4354, 128]), torch.Size([1, 4354, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4479808807373047  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4811992645263672  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4354, 128])
m.shape torch.Size([5386, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48425960540771484  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48425960540771484  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5386, 128]), torch.Size([1, 5386, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49024200439453125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5672893524169922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5386, 128])
m.shape torch.Size([5386, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5724258422851562  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5724258422851562  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5386, 128]), torch.Size([1, 5386, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5775623321533203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6947183609008789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5386, 128])
m.shape torch.Size([4882, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7006311416625977  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7006311416625977  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4882, 128]), torch.Size([1, 4882, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.705286979675293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8480229377746582  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4882, 128])
m.shape torch.Size([4653, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8573346138000488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8573346138000488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4653, 128]), torch.Size([1, 4653, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8617720603942871  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0215201377868652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4653, 128])
m.shape torch.Size([3989, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0307140350341797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0307140350341797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3989, 128]), torch.Size([1, 3989, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0346922874450684  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2015304565429688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3989, 128])
m.shape torch.Size([3623, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2112112045288086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2112112045288086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3623, 128]), torch.Size([1, 3623, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2147741317749023  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3916974067687988  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3623, 128])
m.shape torch.Size([3302, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4025659561157227  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4025659561157227  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3302, 128]), torch.Size([1, 3302, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4065489768981934  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5911402702331543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3302, 128])
m.shape torch.Size([2899, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6020069122314453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6020069122314453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2899, 128]), torch.Size([1, 2899, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.604898452758789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7840094566345215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2899, 128])
m.shape torch.Size([2590, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7947988510131836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7947988510131836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2590, 128]), torch.Size([1, 2590, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7974748611450195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.975583553314209  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2590, 128])
m.shape torch.Size([2256, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9861817359924316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9861817359924316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2256, 128]), torch.Size([1, 2256, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.988492488861084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.160022258758545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2256, 128])
m.shape torch.Size([2065, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.170762538909912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.170762538909912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2065, 128]), torch.Size([1, 2065, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.172736644744873  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.344046115875244  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2065, 128])
m.shape torch.Size([1933, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.355043888092041  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.355043888092041  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1933, 128]), torch.Size([1, 1933, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3568873405456543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.527359962463379  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1933, 128])
m.shape torch.Size([1620, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.537252902984619  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.537252902984619  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1620, 128]), torch.Size([1, 1620, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5387978553771973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6917481422424316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1620, 128])
m.shape torch.Size([1523, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.701869010925293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.701869010925293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1523, 128]), torch.Size([1, 1523, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7033214569091797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.857280731201172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1523, 128])
m.shape torch.Size([1319, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8666176795959473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8666176795959473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1319, 128]), torch.Size([1, 1319, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.867875576019287  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0103302001953125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1319, 128])
m.shape torch.Size([1245, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0197935104370117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0197935104370117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1245, 128]), torch.Size([1, 1245, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0209808349609375  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1666641235351562  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1245, 128])
m.shape torch.Size([1173, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.176138401031494  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.176138401031494  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1173, 128]), torch.Size([1, 1173, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1772570610046387  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.319566249847412  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1173, 128])
m.shape torch.Size([1081, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3295888900756836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3295888900756836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3306198120117188  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.473917007446289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([16739, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6330370903015137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6330370903015137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16739, 128]), torch.Size([1, 16739, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.649000644683838  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.899861812591553  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16739, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.570423603057861  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.587594032287598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.604764461517334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.587057113647461  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72018, 64])
input nodes number: 141244
output nodes number: 72018
edges number: 740731
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.605841159820557  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.623011589050293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.627304553985596  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.627304553985596  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72018, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.627304553985596  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2697, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.656822681427002  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.656822681427002  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2697, 64]), torch.Size([1, 2697, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.658109188079834  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.669888973236084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2697, 64])
m.shape torch.Size([3136, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.670866966247559  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.670866966247559  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3136, 64]), torch.Size([1, 3136, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.672362327575684  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.698254585266113  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3136, 64])
m.shape torch.Size([34106, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.722663879394531  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.722663879394531  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34106, 64]), torch.Size([1, 34106, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.738926887512207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.096713066101074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34106, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.07082462310791  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.080347061157227  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.089869499206543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.08004903793335  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39939, 64])
input nodes number: 72018
output nodes number: 39939
edges number: 111287
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.090893745422363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.10041618347168  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.102984428405762  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.102984428405762  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1704, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114290714263916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114290714263916  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1704, 64]), torch.Size([1, 1704, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.115103244781494  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.121626377105713  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1704, 64])
m.shape torch.Size([1444, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1219305992126465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1219305992126465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1444, 64]), torch.Size([1, 1444, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.122619152069092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.134594917297363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1444, 64])
m.shape torch.Size([1135, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1350884437561035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1350884437561035  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1135, 64]), torch.Size([1, 1135, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.135630130767822  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.148029327392578  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1135, 64])
m.shape torch.Size([878, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.148622035980225  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.148622035980225  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 878, 64]), torch.Size([1, 878, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.149040699005127  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.161181926727295  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 878, 64])
m.shape torch.Size([6207, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.168603420257568  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.168603420257568  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6207, 64]), torch.Size([1, 6207, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.172178745269775  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2854838371276855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6207, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.275710582733154  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.278071403503418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.280432224273682  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.277986526489258  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39939
output nodes number: 11368
edges number: 42544
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.278909206390381  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02583909034729004 |0.004003842671712239 |0.10973374048868816 |0.0008245309193929037 |0.05240408579508463 |0.0068018436431884766 |
----------------------------------------------------------pseudo_mini_loss sum 1.6136319637298584
for loop block_dataloader item  time:  1.0043222904205322
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07957744598388672  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07957744598388672  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([140754, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07957744598388672  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4305, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44045495986938477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44045495986938477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4305, 128]), torch.Size([1, 4305, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44456052780151367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4774050712585449  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4305, 128])
m.shape torch.Size([5424, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48052501678466797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48052501678466797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5424, 128]), torch.Size([1, 5424, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4866189956665039  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5642099380493164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5424, 128])
m.shape torch.Size([5230, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5691051483154297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5691051483154297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5230, 128]), torch.Size([1, 5230, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5740928649902344  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6840076446533203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5230, 128])
m.shape torch.Size([4900, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6908597946166992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6908597946166992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4900, 128]), torch.Size([1, 4900, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6955327987670898  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.837949275970459  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4900, 128])
m.shape torch.Size([4578, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8472952842712402  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8472952842712402  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4578, 128]), torch.Size([1, 4578, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.851661205291748  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0088343620300293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4578, 128])
m.shape torch.Size([3937, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0179152488708496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0179152488708496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3937, 128]), torch.Size([1, 3937, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0220355987548828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1870183944702148  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3937, 128])
m.shape torch.Size([3538, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1969504356384277  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1969504356384277  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3538, 128]), torch.Size([1, 3538, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.200437068939209  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.370565414428711  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3538, 128])
m.shape torch.Size([3233, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.381211280822754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.381211280822754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3233, 128]), torch.Size([1, 3233, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3845558166503906  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5602998733520508  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3233, 128])
m.shape torch.Size([2852, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.570997714996338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.570997714996338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2852, 128]), torch.Size([1, 2852, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5737309455871582  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.752152442932129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2852, 128])
m.shape torch.Size([2544, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.762923240661621  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.762923240661621  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2544, 128]), torch.Size([1, 2544, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7654962539672852  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9450840950012207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2544, 128])
m.shape torch.Size([2291, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9561238288879395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9561238288879395  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2291, 128]), torch.Size([1, 2291, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9584012031555176  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.137004852294922  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2291, 128])
m.shape torch.Size([2031, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.146574020385742  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.146574020385742  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2031, 128]), torch.Size([1, 2031, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1485109329223633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3142833709716797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2031, 128])
m.shape torch.Size([1864, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3248696327209473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3248696327209473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1864, 128]), torch.Size([1, 1864, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3266472816467285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.491856098175049  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1864, 128])
m.shape torch.Size([1649, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5019755363464355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5019755363464355  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5035481452941895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.663196086883545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1545, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6734604835510254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6734604835510254  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1545, 128]), torch.Size([1, 1545, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.674933910369873  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8311171531677246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1545, 128])
m.shape torch.Size([1324, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.840481758117676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.840481758117676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1324, 128]), torch.Size([1, 1324, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8417444229125977  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9844870567321777  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1324, 128])
m.shape torch.Size([1253, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9940128326416016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9940128326416016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1253, 128]), torch.Size([1, 1253, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9952077865600586  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1410741806030273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1253, 128])
m.shape torch.Size([1138, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1502442359924316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1502442359924316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1138, 128]), torch.Size([1, 1138, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.151329517364502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.2901854515075684  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1138, 128])
m.shape torch.Size([1064, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.2992825508117676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.2992825508117676  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.300297260284424  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.437154769897461  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([16593, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.594890594482422  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.594890594482422  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16593, 128]), torch.Size([1, 16593, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.610714912414551  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.841943740844727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16593, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.515321254730225  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.532319068908691  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.549316883087158  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.531787872314453  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71293, 64])
input nodes number: 140754
output nodes number: 71293
edges number: 733804
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.550374507904053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5673723220825195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.571621894836426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.571621894836426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71293, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.571621894836426  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2693, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.60080099105835  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.60080099105835  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2693, 64]), torch.Size([1, 2693, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.602085590362549  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6130523681640625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2693, 64])
m.shape torch.Size([3236, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.614013195037842  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.614013195037842  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3236, 64]), torch.Size([1, 3236, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.615556240081787  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.64242696762085  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3236, 64])
m.shape torch.Size([33603, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.666441917419434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.666441917419434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33603, 64]), torch.Size([1, 33603, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.682465553283691  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.034976959228516  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33603, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.009430408477783  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.01953649520874  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.029642581939697  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.019241809844971  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39532, 64])
input nodes number: 71293
output nodes number: 39532
edges number: 109974
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.029493808746338  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.039599895477295  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.041412830352783  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.041412830352783  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1749, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.05269193649292  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.05269193649292  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1749, 64]), torch.Size([1, 1749, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.053526401519775  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.060314655303955  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1749, 64])
m.shape torch.Size([1540, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.060655117034912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.060655117034912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1540, 64]), torch.Size([1, 1540, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.061389446258545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.072906494140625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1540, 64])
m.shape torch.Size([1114, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.073361396789551  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.073361396789551  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1114, 64]), torch.Size([1, 1114, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.073892593383789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.087172031402588  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1114, 64])
m.shape torch.Size([908, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.087799549102783  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.087799549102783  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 908, 64]), torch.Size([1, 908, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.088232517242432  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.100788593292236  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 908, 64])
m.shape torch.Size([6057, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108067989349365  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108067989349365  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6057, 64]), torch.Size([1, 6057, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.111078262329102  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.216378211975098  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6057, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.208695411682129  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.210450172424316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.212204933166504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.210365295410156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39532
output nodes number: 11368
edges number: 42088
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.21013879776001  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025975584983825684 |0.004056572914123535 |0.1094326376914978 |0.0008229613304138184 |0.05230754613876343 |0.00684809684753418 |
----------------------------------------------------------pseudo_mini_loss sum 1.5801513195037842
for loop block_dataloader item  time:  1.2985036373138428
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0791177749633789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0791177749633789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([140949, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.0791177749633789  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4314, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44259214401245117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44259214401245117  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4314, 128]), torch.Size([1, 4314, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44670629501342773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.47961950302124023  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4314, 128])
m.shape torch.Size([5317, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.482633113861084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.482633113861084  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5317, 128]), torch.Size([1, 5317, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4886589050292969  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5647192001342773  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5317, 128])
m.shape torch.Size([5331, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5698099136352539  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5698099136352539  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5331, 128]), torch.Size([1, 5331, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5748939514160156  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.691551685333252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5331, 128])
m.shape torch.Size([4904, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6974015235900879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6974015235900879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4904, 128]), torch.Size([1, 4904, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7022686004638672  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8448777198791504  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4904, 128])
m.shape torch.Size([4535, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8542313575744629  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8542313575744629  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4535, 128]), torch.Size([1, 4535, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8585562705993652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0148062705993652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4535, 128])
m.shape torch.Size([3936, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.023904800415039  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.023904800415039  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3936, 128]), torch.Size([1, 3936, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0278387069702148  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1944642066955566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3936, 128])
m.shape torch.Size([3604, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2038540840148926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2038540840148926  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3604, 128]), torch.Size([1, 3604, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2091336250305176  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3841233253479004  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3604, 128])
m.shape torch.Size([3264, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3948559761047363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3948559761047363  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3264, 128]), torch.Size([1, 3264, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3979973793029785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5827288627624512  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3264, 128])
m.shape torch.Size([2860, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5934462547302246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5934462547302246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2860, 128]), torch.Size([1, 2860, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5963129997253418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7761998176574707  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2860, 128])
m.shape torch.Size([2577, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7866854667663574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7866854667663574  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2577, 128]), torch.Size([1, 2577, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.790276050567627  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9654755592346191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2577, 128])
m.shape torch.Size([2263, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.97611665725708  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.97611665725708  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2263, 128]), torch.Size([1, 2263, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9782757759094238  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.149198055267334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2263, 128])
m.shape torch.Size([2073, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1599807739257812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1599807739257812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2073, 128]), torch.Size([1, 2073, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1620535850524902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3352532386779785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2073, 128])
m.shape torch.Size([1888, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3452181816101074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3452181816101074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1888, 128]), torch.Size([1, 1888, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3470187187194824  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.513637065887451  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1888, 128])
m.shape torch.Size([1695, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.524052143096924  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.524052143096924  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1695, 128]), torch.Size([1, 1695, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5256686210632324  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6865010261535645  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1695, 128])
m.shape torch.Size([1489, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.696342945098877  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.696342945098877  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1489, 128]), torch.Size([1, 1489, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.697762966156006  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8486461639404297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1489, 128])
m.shape torch.Size([1332, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.858947277069092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.858947277069092  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1332, 128]), torch.Size([1, 1332, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.860217571258545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0039472579956055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1332, 128])
m.shape torch.Size([1297, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0138258934020996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0138258934020996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1297, 128]), torch.Size([1, 1297, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0150628089904785  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.163595676422119  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1297, 128])
m.shape torch.Size([1212, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.173379898071289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.173379898071289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1212, 128]), torch.Size([1, 1212, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1745357513427734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3215560913085938  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1212, 128])
m.shape torch.Size([1041, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.330409526824951  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.330409526824951  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1041, 128]), torch.Size([1, 1041, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.33140230178833  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.465958595275879  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1041, 128])
m.shape torch.Size([16713, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.624849796295166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.624849796295166  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16713, 128]), torch.Size([1, 16713, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6407885551452637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.888153553009033  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16713, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.558916091918945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.575997829437256  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.593079566955566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.575463771820068  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71645, 64])
input nodes number: 140949
output nodes number: 71645
edges number: 739292
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.59426736831665  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.611349105834961  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.615619659423828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.615619659423828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71645, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.615619659423828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2697, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.64511251449585  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.64511251449585  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2697, 64]), torch.Size([1, 2697, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.646399021148682  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.657278537750244  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2697, 64])
m.shape torch.Size([3226, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.658239841461182  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.658239841461182  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3226, 64]), torch.Size([1, 3226, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.659778118133545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.685947895050049  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3226, 64])
m.shape torch.Size([34013, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.710267543792725  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.710267543792725  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34013, 64]), torch.Size([1, 34013, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.726486682891846  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.083299160003662  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34013, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.057454586029053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.066976070404053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.076985836029053  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.067166805267334  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39936, 64])
input nodes number: 71645
output nodes number: 39936
edges number: 111188
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.077520847320557  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.087042331695557  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.089491844177246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.089491844177246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1673, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.100801467895508  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.100801467895508  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1673, 64]), torch.Size([1, 1673, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.10159969329834  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108060359954834  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1673, 64])
m.shape torch.Size([1447, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108373165130615  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108373165130615  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1447, 64]), torch.Size([1, 1447, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.109063625335693  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.120290279388428  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1447, 64])
m.shape torch.Size([1132, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1207804679870605  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1207804679870605  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1132, 64]), torch.Size([1, 1132, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1213202476501465  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1352996826171875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1132, 64])
m.shape torch.Size([965, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.135979175567627  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.135979175567627  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 965, 64]), torch.Size([1, 965, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.136439800262451  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.149786472320557  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 965, 64])
m.shape torch.Size([6151, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.157118320465088  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.157118320465088  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6151, 64]), torch.Size([1, 6151, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.160440921783447  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2694830894470215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6151, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.260737419128418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2626142501831055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.264508247375488  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.262546539306641  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39936
output nodes number: 11368
edges number: 42578
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2630510330200195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025940418243408203 |0.004033184051513672 |0.10931267738342285 |0.0008296966552734375 |0.0523493766784668 |0.006738901138305664 |
----------------------------------------------------------pseudo_mini_loss sum 1.55684494972229
for loop block_dataloader item  time:  1.6473407745361328
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07943248748779297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07943248748779297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([141335, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07943248748779297  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4355, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44448232650756836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44448232650756836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4355, 128]), torch.Size([1, 4355, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4486355781555176  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48186159133911133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4355, 128])
m.shape torch.Size([5394, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48492908477783203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48492908477783203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5394, 128]), torch.Size([1, 5394, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49175357818603516  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5689153671264648  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5394, 128])
m.shape torch.Size([5393, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5740580558776855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5740580558776855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5393, 128]), torch.Size([1, 5393, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5792016983032227  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6964211463928223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5393, 128])
m.shape torch.Size([4927, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7024331092834473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7024331092834473  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4927, 128]), torch.Size([1, 4927, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7071318626403809  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8485493659973145  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4927, 128])
m.shape torch.Size([4574, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8563690185546875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8563690185546875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4574, 128]), torch.Size([1, 4574, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.861635684967041  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0186715126037598  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4574, 128])
m.shape torch.Size([3975, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0278630256652832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0278630256652832  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3975, 128]), torch.Size([1, 3975, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0318541526794434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.197962760925293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3975, 128])
m.shape torch.Size([3582, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2080235481262207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2080235481262207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3582, 128]), torch.Size([1, 3582, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2116131782531738  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3900089263916016  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3582, 128])
m.shape torch.Size([3206, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3995790481567383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3995790481567383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3206, 128]), torch.Size([1, 3206, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4026365280151367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5769128799438477  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3206, 128])
m.shape torch.Size([2884, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5877609252929688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5877609252929688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2884, 128]), torch.Size([1, 2884, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5906009674072266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.769815444946289  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2884, 128])
m.shape torch.Size([2573, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.780430793762207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.780430793762207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2573, 128]), torch.Size([1, 2573, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7829923629760742  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.961428165435791  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2573, 128])
m.shape torch.Size([2340, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9724750518798828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9724750518798828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2340, 128]), torch.Size([1, 2340, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.974733829498291  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1562976837158203  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2340, 128])
m.shape torch.Size([2004, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1668930053710938  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1668930053710938  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2004, 128]), torch.Size([1, 2004, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.168804168701172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3341903686523438  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2004, 128])
m.shape torch.Size([1871, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3448328971862793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3448328971862793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1871, 128]), torch.Size([1, 1871, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3466172218322754  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.511317253112793  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1871, 128])
m.shape torch.Size([1688, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.521693706512451  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.521693706512451  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1688, 128]), torch.Size([1, 1688, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.523303508758545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.683955669403076  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1688, 128])
m.shape torch.Size([1551, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.694244384765625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.694244384765625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1551, 128]), torch.Size([1, 1551, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.695723533630371  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.852513313293457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1551, 128])
m.shape torch.Size([1308, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8624300956726074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8624300956726074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1308, 128]), torch.Size([1, 1308, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.863677501678467  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.004634380340576  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1308, 128])
m.shape torch.Size([1298, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0145325660705566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0145325660705566  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1298, 128]), torch.Size([1, 1298, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.015770435333252  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1643147468566895  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1298, 128])
m.shape torch.Size([1181, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.173832416534424  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.173832416534424  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1181, 128]), torch.Size([1, 1181, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1749587059020996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3189101219177246  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1181, 128])
m.shape torch.Size([1003, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3274340629577637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3274340629577637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1003, 128]), torch.Size([1, 1003, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.328390598297119  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.4618372917175293  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1003, 128])
m.shape torch.Size([16827, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6218338012695312  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6218338012695312  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16827, 128]), torch.Size([1, 16827, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.637881278991699  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.900575637817383  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16827, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.572257995605469  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5894083976745605  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.606558799743652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.58887243270874  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71934, 64])
input nodes number: 141335
output nodes number: 71934
edges number: 741015
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.607661247253418  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.62481164932251  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.629099369049072  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.629099369049072  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([71934, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.629099369049072  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2740, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6584882736206055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6584882736206055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2740, 64]), torch.Size([1, 2740, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.659794807434082  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6721696853637695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2740, 64])
m.shape torch.Size([3196, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.673092842102051  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.673092842102051  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3196, 64]), torch.Size([1, 3196, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.674616813659668  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.700091361999512  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3196, 64])
m.shape torch.Size([33872, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.724313735961914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.724313735961914  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 33872, 64]), torch.Size([1, 33872, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.74046516418457  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.095796585083008  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 33872, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.070064544677734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.080104827880859  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.089595794677734  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.079258918762207  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([39808, 64])
input nodes number: 71934
output nodes number: 39808
edges number: 110748
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.090132713317871  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.100172996520996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.102553844451904  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.102553844451904  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113795280456543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113795280456543  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1695, 64]), torch.Size([1, 1695, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1146039962768555  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.121275901794434  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1695, 64])
m.shape torch.Size([1487, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.121603012084961  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.121603012084961  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1487, 64]), torch.Size([1, 1487, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.122312545776367  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.133576393127441  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1487, 64])
m.shape torch.Size([1213, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1341166496276855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1341166496276855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1213, 64]), torch.Size([1, 1213, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.134695529937744  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1509246826171875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1213, 64])
m.shape torch.Size([890, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.151510715484619  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.151510715484619  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 890, 64]), torch.Size([1, 890, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.15193510055542  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.164242267608643  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 890, 64])
m.shape torch.Size([6083, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1715087890625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1715087890625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6083, 64]), torch.Size([1, 6083, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.175071716308594  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.285257339477539  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 6083, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2751383781433105  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.277487754821777  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2798686027526855  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.277434349060059  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([11368, 40])
input nodes number: 39808
output nodes number: 11368
edges number: 42283
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2782883644104  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025892257690429688 |0.004034678141276042 |0.10918374856313069 |0.0008292992909749349 |0.052218874295552574 |0.0067365169525146484 |
----------------------------------------------------------pseudo_mini_loss sum 1.5566534996032715
for loop block_dataloader item  time:  1.940744400024414
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07978153228759766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07978153228759766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([140966, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07978153228759766  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([4307, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4464845657348633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4464845657348633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4307, 128]), torch.Size([1, 4307, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.450592041015625  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48345184326171875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4307, 128])
m.shape torch.Size([5400, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48654794692993164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48654794692993164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5400, 128]), torch.Size([1, 5400, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4926266670227051  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5698742866516113  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5400, 128])
m.shape torch.Size([5344, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.574944019317627  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.574944019317627  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5344, 128]), torch.Size([1, 5344, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.580040454864502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6968693733215332  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5344, 128])
m.shape torch.Size([5051, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7030243873596191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7030243873596191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 5051, 128]), torch.Size([1, 5051, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7078413963317871  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8493771553039551  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 5051, 128])
m.shape torch.Size([4625, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8577322959899902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8577322959899902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4625, 128]), torch.Size([1, 4625, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8626093864440918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0213961601257324  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4625, 128])
m.shape torch.Size([4058, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0308008193969727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0308008193969727  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 4058, 128]), torch.Size([1, 4058, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0350265502929688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2027053833007812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 4058, 128])
m.shape torch.Size([3651, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2129569053649902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2129569053649902  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3651, 128]), torch.Size([1, 3651, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.216733455657959  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3939528465270996  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3651, 128])
m.shape torch.Size([3168, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4039158821105957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4039158821105957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3168, 128]), torch.Size([1, 3168, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4069676399230957  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5810794830322266  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3168, 128])
m.shape torch.Size([2864, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5918598175048828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5918598175048828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2864, 128]), torch.Size([1, 2864, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5946674346923828  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.772082805633545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2864, 128])
m.shape torch.Size([2623, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7828125953674316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7828125953674316  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2623, 128]), torch.Size([1, 2623, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7858409881591797  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9699015617370605  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2623, 128])
m.shape torch.Size([2282, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9806203842163086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9806203842163086  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2282, 128]), torch.Size([1, 2282, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9830126762390137  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1549410820007324  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2282, 128])
m.shape torch.Size([2081, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1657605171203613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1657605171203613  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2081, 128]), torch.Size([1, 2081, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1678261756896973  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.340435028076172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2081, 128])
m.shape torch.Size([1883, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3511152267456055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3511152267456055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1883, 128]), torch.Size([1, 1883, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3529109954833984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.518986225128174  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1883, 128])
m.shape torch.Size([1726, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5296106338500977  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5296106338500977  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1726, 128]), torch.Size([1, 1726, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.531256675720215  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6942148208618164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1726, 128])
m.shape torch.Size([1526, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7043066024780273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7043066024780273  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1526, 128]), torch.Size([1, 1526, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7057619094848633  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.861687660217285  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1526, 128])
m.shape torch.Size([1312, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.870969772338867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.870969772338867  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1312, 128]), torch.Size([1, 1312, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.872220993041992  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0142831802368164  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1312, 128])
m.shape torch.Size([1294, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0241470336914062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0241470336914062  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1294, 128]), torch.Size([1, 1294, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.025381088256836  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1734676361083984  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1294, 128])
m.shape torch.Size([1182, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1829957962036133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1829957962036133  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1182, 128]), torch.Size([1, 1182, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1841230392456055  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.328078269958496  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1182, 128])
m.shape torch.Size([1072, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3372268676757812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3372268676757812  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1072, 128]), torch.Size([1, 1072, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3382492065429688  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.475360870361328  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1072, 128])
m.shape torch.Size([16908, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.636096954345703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.636096954345703  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 16908, 128]), torch.Size([1, 16908, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6522216796875  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.983028411865234  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 16908, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.650480270385742  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.667731761932373  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.684983253479004  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.667192459106445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72357, 64])
input nodes number: 140966
output nodes number: 72357
edges number: 746124
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.68607234954834  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.703323841094971  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.707636833190918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.707636833190918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([72357, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.707636833190918  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([2587, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7373247146606445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7373247146606445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 2587, 64]), torch.Size([1, 2587, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.738558769226074  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.750414848327637  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 2587, 64])
m.shape torch.Size([3186, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7514190673828125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7514190673828125  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 3186, 64]), torch.Size([1, 3186, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.752938270568848  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.777935028076172  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 3186, 64])
m.shape torch.Size([34368, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.8033342361450195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.8033342361450195  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 34368, 64]), torch.Size([1, 34368, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.8197221755981445  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1802568435668945  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 34368, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.154166221618652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.163736820220947  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.173697471618652  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.163827419281006  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

torch.Size([40141, 64])
input nodes number: 72357
output nodes number: 40141
edges number: 112063
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1742377281188965  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.183808326721191  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.186216831207275  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.186216831207275  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

m.shape torch.Size([1580, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.197598934173584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.197598934173584  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1580, 64]), torch.Size([1, 1580, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.198352336883545  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.204516887664795  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1580, 64])
m.shape torch.Size([1433, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.204844951629639  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.204844951629639  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1433, 64]), torch.Size([1, 1433, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.205528736114502  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.216416835784912  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1433, 64])
m.shape torch.Size([1155, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.216927528381348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.216927528381348  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 1155, 64]), torch.Size([1, 1155, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2174787521362305  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.231545448303223  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 1155, 64])
m.shape torch.Size([939, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.232193470001221  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.232193470001221  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 939, 64]), torch.Size([1, 939, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.232641696929932  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.245628833770752  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

rst.shape  torch.Size([1, 939, 64])
m.shape torch.Size([6261, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2531023025512695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2531023025512695  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

 h.shape torch.Size([1, 6261, 64]), torch.Size([1, 6261, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.256480693817139  GigaBytes
Max Memory Allocated: 6.373420238494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.369944095611572  GigaBytes
Max Memory Allocated: 6.377408027648926  GigaBytes

rst.shape  torch.Size([1, 6261, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.360381603240967  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.362435340881348  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.364640712738037  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.362502098083496  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([11368, 40])
input nodes number: 40141
output nodes number: 11368
edges number: 42972
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.362590789794922  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02581446511404855 |0.00403942380632673 |0.1091465950012207 |0.000827653067452567 |0.052270855222429545 |0.006797313690185547 |
----------------------------------------------------------pseudo_mini_loss sum 1.5094335079193115
for loop block_dataloader item  time:  2.233473062515259
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07945919036865234  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07945919036865234  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([141006, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07945919036865234  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

m.shape torch.Size([4230, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4445652961730957  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4445652961730957  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 4230, 128]), torch.Size([1, 4230, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44859933853149414  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4819760322570801  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 4230, 128])
m.shape torch.Size([5412, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4849057197570801  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4849057197570801  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 5412, 128]), torch.Size([1, 5412, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4900670051574707  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5674862861633301  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 5412, 128])
m.shape torch.Size([5424, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.572664737701416  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.572664737701416  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 5424, 128]), torch.Size([1, 5424, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5778374671936035  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6953377723693848  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 5424, 128])
m.shape torch.Size([5011, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7023091316223145  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7023091316223145  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 5011, 128]), torch.Size([1, 5011, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7074646949768066  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8485684394836426  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 5011, 128])
m.shape torch.Size([4673, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8569045066833496  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8569045066833496  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 4673, 128]), torch.Size([1, 4673, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8619379997253418  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0223727226257324  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 4673, 128])
m.shape torch.Size([3984, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0315427780151367  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0315427780151367  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 3984, 128]), torch.Size([1, 3984, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0354738235473633  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.202171802520752  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 3984, 128])
m.shape torch.Size([3573, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2116641998291016  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2116641998291016  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 3573, 128]), torch.Size([1, 3573, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2150745391845703  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3903508186340332  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 3573, 128])
m.shape torch.Size([3188, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.400808334350586  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.400808334350586  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 3188, 128]), torch.Size([1, 3188, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4039859771728516  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5777287483215332  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 3188, 128])
m.shape torch.Size([2888, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5886025428771973  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5886025428771973  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2888, 128]), torch.Size([1, 2888, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5913949012756348  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.771561622619629  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2888, 128])
m.shape torch.Size([2563, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7824058532714844  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7824058532714844  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2563, 128]), torch.Size([1, 2563, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7849845886230469  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9614076614379883  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2563, 128])
m.shape torch.Size([2261, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9714832305908203  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9714832305908203  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2261, 128]), torch.Size([1, 2261, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.974466323852539  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.148289203643799  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2261, 128])
m.shape torch.Size([2039, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1588783264160156  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1588783264160156  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2039, 128]), torch.Size([1, 2039, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.160822868347168  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.326709747314453  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2039, 128])
m.shape torch.Size([1925, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.33767032623291  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.33767032623291  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1925, 128]), torch.Size([1, 1925, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.339506149291992  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.508960247039795  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1925, 128])
m.shape torch.Size([1626, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.51889705657959  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.51889705657959  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5204477310180664  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6797614097595215  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
m.shape torch.Size([1549, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.690065383911133  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.690065383911133  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1549, 128]), torch.Size([1, 1549, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.691542625427246  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.848130226135254  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1549, 128])
m.shape torch.Size([1312, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8574013710021973  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8574013710021973  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1312, 128]), torch.Size([1, 1312, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8586525917053223  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0000810623168945  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1312, 128])
m.shape torch.Size([1289, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.009904384613037  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.009904384613037  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1289, 128]), torch.Size([1, 1289, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0111336708068848  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1586480140686035  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1289, 128])
m.shape torch.Size([1165, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.168032646179199  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.168032646179199  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1691436767578125  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.311616897583008  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([1035, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3204383850097656  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3204383850097656  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1035, 128]), torch.Size([1, 1035, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.321425437927246  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.4539709091186523  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1035, 128])
m.shape torch.Size([16821, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6138949394226074  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6138949394226074  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 16821, 128]), torch.Size([1, 16821, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.629936695098877  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.891824245452881  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 16821, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.563043117523193  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.580201625823975  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.597360134124756  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.579665184020996  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([71968, 64])
input nodes number: 141006
output nodes number: 71968
edges number: 741099
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.598421573638916  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.615580081939697  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.619869709014893  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.619869709014893  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([71968, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.619869709014893  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

m.shape torch.Size([2666, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.649384021759033  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.649384021759033  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2666, 64]), torch.Size([1, 2666, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.650655269622803  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.661854267120361  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2666, 64])
m.shape torch.Size([3186, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.662786483764648  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.662786483764648  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 3186, 64]), torch.Size([1, 3186, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.664305686950684  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.689800262451172  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 3186, 64])
m.shape torch.Size([34090, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.71418571472168  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.71418571472168  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 34090, 64]), torch.Size([1, 34090, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.730441093444824  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.088059425354004  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 34090, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.06217098236084  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.072179317474365  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082187652587891  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.071881294250488  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([39942, 64])
input nodes number: 71968
output nodes number: 39942
edges number: 111308
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082239627838135  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.09224796295166  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094151973724365  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094151973724365  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

m.shape torch.Size([1646, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.105467796325684  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.105467796325684  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1646, 64]), torch.Size([1, 1646, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.106252670288086  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.112868785858154  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1646, 64])
m.shape torch.Size([1431, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113180160522461  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113180160522461  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1431, 64]), torch.Size([1, 1431, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113862991333008  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1264567375183105  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1431, 64])
m.shape torch.Size([1207, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1270060539245605  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1270060539245605  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1207, 64]), torch.Size([1, 1207, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.12758207321167  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.140536308288574  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1207, 64])
m.shape torch.Size([901, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.141134738922119  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.141134738922119  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 901, 64]), torch.Size([1, 901, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.141564846038818  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.154026508331299  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 901, 64])
m.shape torch.Size([6180, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1614089012146  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1614089012146  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 6180, 64]), torch.Size([1, 6180, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.164937496185303  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.275712966918945  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 6180, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.266726970672607  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.268630504608154  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.270786762237549  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.268798351287842  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([11365, 40])
input nodes number: 39942
output nodes number: 11365
edges number: 42633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.269031047821045  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025787025690078735 |0.004023104906082153 |0.10908159613609314 |0.0008266866207122803 |0.0522860586643219 |0.0067479610443115234 |
----------------------------------------------------------pseudo_mini_loss sum 1.4861747026443481
Total (block generation + training)time/epoch 2.509324789047241
Training time/epoch 2.437753677368164
Training time without block to device /epoch 2.405568838119507
Training time without total dataloading part /epoch 1.30430269241333
load block tensor time/epoch 0.20629620552062988
block to device time/epoch 0.03218483924865723
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  2023247
Number of first layer input nodes during this epoch:  1128824
block dataloader generation time/epoch 8.742014567057291e-07
for loop block_dataloader item  time:  0.09328985214233398
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.08049917221069336  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.08049917221069336  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([141450, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.08049917221069336  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

m.shape torch.Size([4297, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44883012771606445  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44883012771606445  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 4297, 128]), torch.Size([1, 4297, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4529280662536621  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48571157455444336  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 4297, 128])
m.shape torch.Size([5495, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4889030456542969  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4889030456542969  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 5495, 128]), torch.Size([1, 5495, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49504613876342773  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5736527442932129  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 5495, 128])
m.shape torch.Size([5382, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5787315368652344  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5787315368652344  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 5382, 128]), torch.Size([1, 5382, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5838642120361328  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7010917663574219  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 5382, 128])
m.shape torch.Size([4934, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7070960998535156  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7070960998535156  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 4934, 128]), torch.Size([1, 4934, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7118015289306641  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8542394638061523  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 4934, 128])
m.shape torch.Size([4722, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8636503219604492  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8636503219604492  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 4722, 128]), torch.Size([1, 4722, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8681535720825195  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0302705764770508  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 4722, 128])
m.shape torch.Size([3991, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0394372940063477  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0394372940063477  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 3991, 128]), torch.Size([1, 3991, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0435776710510254  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2102446556091309  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 3991, 128])
m.shape torch.Size([3617, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2199139595031738  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2199139595031738  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 3617, 128]), torch.Size([1, 3617, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.224184513092041  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.40128755569458  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 3617, 128])
m.shape torch.Size([3266, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4120216369628906  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4120216369628906  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 3266, 128]), torch.Size([1, 3266, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4160304069519043  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6003127098083496  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 3266, 128])
m.shape torch.Size([2922, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.611295223236084  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.611295223236084  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2922, 128]), torch.Size([1, 2922, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.6142020225524902  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.794377326965332  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2922, 128])
m.shape torch.Size([2597, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.8054990768432617  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.8054990768432617  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2597, 128]), torch.Size([1, 2597, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.8080825805664062  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9883627891540527  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2597, 128])
m.shape torch.Size([2333, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9984054565429688  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9984054565429688  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2333, 128]), torch.Size([1, 2333, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.0008811950683594  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.181032180786133  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2333, 128])
m.shape torch.Size([2030, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.191535472869873  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.191535472869873  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2030, 128]), torch.Size([1, 2030, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1934714317321777  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.359057903289795  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2030, 128])
m.shape torch.Size([1922, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.370004177093506  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.370004177093506  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1922, 128]), torch.Size([1, 1922, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3718371391296387  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5413384437561035  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1922, 128])
m.shape torch.Size([1683, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.551657199859619  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.551657199859619  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1683, 128]), torch.Size([1, 1683, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.553262233734131  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7137856483459473  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1683, 128])
m.shape torch.Size([1540, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7239980697631836  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7239980697631836  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1540, 128]), torch.Size([1, 1540, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.725466728210449  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.881960868835449  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1540, 128])
m.shape torch.Size([1338, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.891434669494629  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.891434669494629  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1338, 128]), torch.Size([1, 1338, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8927106857299805  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.036990165710449  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1338, 128])
m.shape torch.Size([1242, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.046420097351074  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.046420097351074  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1242, 128]), torch.Size([1, 1242, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.047604560852051  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1932191848754883  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1242, 128])
m.shape torch.Size([1213, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.203038215637207  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.203038215637207  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1213, 128]), torch.Size([1, 1213, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.204195022583008  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.351109504699707  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1213, 128])
m.shape torch.Size([1082, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3608078956604004  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3608078956604004  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1082, 128]), torch.Size([1, 1082, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.361839771270752  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.5062546730041504  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1082, 128])
m.shape torch.Size([16989, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6677584648132324  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6677584648132324  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 16989, 128]), torch.Size([1, 16989, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.683960437774658  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0163893699646  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 16989, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.683080196380615  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.700388431549072  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.717696666717529  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.699847221374512  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([72595, 64])
input nodes number: 141450
output nodes number: 72595
edges number: 748805
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.718759059906006  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.736067295074463  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.740394592285156  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.740394592285156  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([72595, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.740394592285156  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

m.shape torch.Size([2672, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.770206451416016  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.770206451416016  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 2672, 64]), torch.Size([1, 2672, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.771480560302734  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.782114028930664  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 2672, 64])
m.shape torch.Size([3243, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7831926345825195  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7831926345825195  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 3243, 64]), torch.Size([1, 3243, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7847394943237305  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.809355735778809  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 3243, 64])
m.shape torch.Size([34432, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.834742546081543  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.834742546081543  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 34432, 64]), torch.Size([1, 34432, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.851161003112793  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.212367057800293  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 34432, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.186213493347168  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.195833206176758  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.205452919006348  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.195532321929932  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

torch.Size([40347, 64])
input nodes number: 72595
output nodes number: 40347
edges number: 112454
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.205995082855225  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2156147956848145  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.218677043914795  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.218677043914795  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

m.shape torch.Size([1633, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.230020046234131  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.230020046234131  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1633, 64]), torch.Size([1, 1633, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.230799198150635  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.237358570098877  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1633, 64])
m.shape torch.Size([1443, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2376790046691895  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2376790046691895  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1443, 64]), torch.Size([1, 1443, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.238367557525635  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.250279426574707  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1443, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2507829666137695  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2507829666137695  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 1149, 64]), torch.Size([1, 1149, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.251331329345703  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.264371871948242  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 1149, 64])
m.shape torch.Size([923, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.265005588531494  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.265005588531494  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 923, 64]), torch.Size([1, 923, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.265446186065674  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.278212070465088  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

rst.shape  torch.Size([1, 923, 64])
m.shape torch.Size([6220, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.285638332366943  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.285638332366943  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

 h.shape torch.Size([1, 6220, 64]), torch.Size([1, 6220, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.289289474487305  GigaBytes
Max Memory Allocated: 6.377408504486084  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.402957916259766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 6220, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.393071174621582  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.395294189453125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.396988391876221  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.394680500030518  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([11368, 40])
input nodes number: 40347
output nodes number: 11368
edges number: 42758
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.3953857421875  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.028783559799194336 |0.0040111541748046875 |0.10936856269836426 |0.0008323192596435547 |0.05617356300354004 |0.007198333740234375 |
----------------------------------------------------------pseudo_mini_loss sum 1.4988014698028564
for loop block_dataloader item  time:  0.4054875373840332
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07957696914672852  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07957696914672852  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([140928, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07957696914672852  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([4368, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4440798759460449  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4440798759460449  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4368, 128]), torch.Size([1, 4368, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4482455253601074  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4815707206726074  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4368, 128])
m.shape torch.Size([5401, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48463869094848633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48463869094848633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5401, 128]), torch.Size([1, 5401, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4906015396118164  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5678634643554688  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5401, 128])
m.shape torch.Size([5298, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5728669166564941  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5728669166564941  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5298, 128]), torch.Size([1, 5298, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5779194831848145  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6891741752624512  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5298, 128])
m.shape torch.Size([5003, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.696190357208252  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.696190357208252  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5003, 128]), torch.Size([1, 5003, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7009615898132324  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8429441452026367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5003, 128])
m.shape torch.Size([4543, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8513898849487305  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8513898849487305  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4543, 128]), torch.Size([1, 4543, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8557224273681641  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.011972427368164  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4543, 128])
m.shape torch.Size([3994, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.021233081817627  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.021233081817627  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3994, 128]), torch.Size([1, 3994, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0252203941345215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1924829483032227  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3994, 128])
m.shape torch.Size([3584, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2020549774169922  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2020549774169922  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3584, 128]), torch.Size([1, 3584, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2068367004394531  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3831520080566406  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3584, 128])
m.shape torch.Size([3255, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.39385986328125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.39385986328125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3255, 128]), torch.Size([1, 3255, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3970441818237305  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.581573486328125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3255, 128])
m.shape torch.Size([2847, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5922393798828125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5922393798828125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2847, 128]), torch.Size([1, 2847, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5950736999511719  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7729740142822266  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2847, 128])
m.shape torch.Size([2588, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7839570045471191  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7839570045471191  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2588, 128]), torch.Size([1, 2588, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7865662574768066  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9650859832763672  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2588, 128])
m.shape torch.Size([2308, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9759578704833984  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9759578704833984  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2308, 128]), torch.Size([1, 2308, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.978342056274414  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1587319374084473  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2308, 128])
m.shape torch.Size([2054, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.169384479522705  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.169384479522705  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2054, 128]), torch.Size([1, 2054, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1714253425598145  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.344231128692627  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2054, 128])
m.shape torch.Size([1841, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.354947566986084  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.354947566986084  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1841, 128]), torch.Size([1, 1841, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.356703281402588  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5192761421203613  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1841, 128])
m.shape torch.Size([1672, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.529560089111328  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.529560089111328  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1672, 128]), torch.Size([1, 1672, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5311546325683594  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.691394805908203  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1672, 128])
m.shape torch.Size([1484, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.701211929321289  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.701211929321289  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1484, 128]), torch.Size([1, 1484, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.702627182006836  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8538246154785156  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1484, 128])
m.shape torch.Size([1353, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8634395599365234  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8634395599365234  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1353, 128]), torch.Size([1, 1353, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.864729881286621  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.010753631591797  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1353, 128])
m.shape torch.Size([1307, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0207033157348633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0207033157348633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1307, 128]), torch.Size([1, 1307, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0219497680664062  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.171855926513672  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1307, 128])
m.shape torch.Size([1175, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1813178062438965  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1813178062438965  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1175, 128]), torch.Size([1, 1175, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.182438373565674  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3249802589416504  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1175, 128])
m.shape torch.Size([1037, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.333815097808838  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.333815097808838  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1037, 128]), torch.Size([1, 1037, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.334804058074951  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.467942714691162  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1037, 128])
m.shape torch.Size([16730, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.626997947692871  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.626997947692871  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 16730, 128]), torch.Size([1, 16730, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6429529190063477  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.892603874206543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 16730, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.562284469604492  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.579412937164307  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.596541404724121  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5788774490356445  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71842, 64])
input nodes number: 140928
output nodes number: 71842
edges number: 739343
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.59764289855957  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.614771366119385  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.619053840637207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.619053840637207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71842, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.619053840637207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([2729, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.64856481552124  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.64856481552124  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2729, 64]), torch.Size([1, 2729, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.649866580963135  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.661759376525879  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2729, 64])
m.shape torch.Size([3212, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.662708759307861  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.662708759307861  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3212, 64]), torch.Size([1, 3212, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.66424036026001  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.690292835235596  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3212, 64])
m.shape torch.Size([34024, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.71462345123291  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.71462345123291  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 34024, 64]), torch.Size([1, 34024, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.730847358703613  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.087773323059082  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 34024, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.061924457550049  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.071453094482422  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.081455707550049  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.071629047393799  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([39965, 64])
input nodes number: 71842
output nodes number: 39965
edges number: 111225
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.081992149353027  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0915207862854  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.093923568725586  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.093923568725586  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.105220317840576  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.105220317840576  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1695, 64]), torch.Size([1, 1695, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.106029033660889  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1127095222473145  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1695, 64])
m.shape torch.Size([1470, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113028049468994  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113028049468994  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1470, 64]), torch.Size([1, 1470, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113729000091553  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.124600410461426  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1470, 64])
m.shape torch.Size([1107, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.125066757202148  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.125066757202148  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1107, 64]), torch.Size([1, 1107, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1255950927734375  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.139287948608398  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1107, 64])
m.shape torch.Size([931, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.139939785003662  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.139939785003662  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 931, 64]), torch.Size([1, 931, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.140384197235107  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.153260707855225  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 931, 64])
m.shape torch.Size([6165, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.160617828369141  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.160617828369141  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 6165, 64]), torch.Size([1, 6165, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.163822174072266  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.273077487945557  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 6165, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.263846397399902  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.265820503234863  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.267794609069824  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.265735626220703  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([11368, 40])
input nodes number: 39965
output nodes number: 11368
edges number: 42505
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.265869617462158  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0270993709564209 |0.004042148590087891 |0.10958576202392578 |0.0008392333984375 |0.054308533668518066 |0.006781816482543945 |
----------------------------------------------------------pseudo_mini_loss sum 1.4968669414520264
for loop block_dataloader item  time:  0.7474842071533203
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07932043075561523  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07932043075561523  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([141022, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07932043075561523  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([4335, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.43982982635498047  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.43982982635498047  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4335, 128]), torch.Size([1, 4335, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44396400451660156  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4770374298095703  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4335, 128])
m.shape torch.Size([5453, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48017072677612305  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48017072677612305  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5453, 128]), torch.Size([1, 5453, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48707151412963867  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5650773048400879  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5453, 128])
m.shape torch.Size([5438, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.570256233215332  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.570256233215332  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5438, 128]), torch.Size([1, 5438, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5754494667053223  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6930766105651855  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5438, 128])
m.shape torch.Size([5003, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6993193626403809  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6993193626403809  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5003, 128]), torch.Size([1, 5003, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7050046920776367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8465228080749512  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5003, 128])
m.shape torch.Size([4676, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8560652732849121  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8560652732849121  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4676, 128]), torch.Size([1, 4676, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8611268997192383  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0216646194458008  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4676, 128])
m.shape torch.Size([3989, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0308475494384766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0308475494384766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3989, 128]), torch.Size([1, 3989, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0348167419433594  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2020883560180664  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3989, 128])
m.shape torch.Size([3620, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2122693061828613  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2122693061828613  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3620, 128]), torch.Size([1, 3620, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.215897560119629  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3929548263549805  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3620, 128])
m.shape torch.Size([3237, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4030332565307617  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.4030332565307617  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3237, 128]), torch.Size([1, 3237, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.406364917755127  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5850129127502441  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3237, 128])
m.shape torch.Size([2930, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.596043586730957  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.596043586730957  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2930, 128]), torch.Size([1, 2930, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5991268157958984  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7789888381958008  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2930, 128])
m.shape torch.Size([2544, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7897224426269531  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7897224426269531  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2544, 128]), torch.Size([1, 2544, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7922782897949219  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9684114456176758  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2544, 128])
m.shape torch.Size([2279, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9789819717407227  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9789819717407227  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2279, 128]), torch.Size([1, 2279, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9811649322509766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.152719497680664  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2279, 128])
m.shape torch.Size([2033, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1632657051086426  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1632657051086426  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2033, 128]), torch.Size([1, 2033, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1652045249938965  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.331005573272705  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2033, 128])
m.shape torch.Size([1837, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.341423511505127  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.341423511505127  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1837, 128]), torch.Size([1, 1837, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3431754112243652  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5048670768737793  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1837, 128])
m.shape torch.Size([1684, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.515233039855957  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.515233039855957  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1684, 128]), torch.Size([1, 1684, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.516839027404785  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6773881912231445  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1684, 128])
m.shape torch.Size([1549, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.68766450881958  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.68766450881958  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1549, 128]), torch.Size([1, 1549, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6891417503356934  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8462462425231934  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1549, 128])
m.shape torch.Size([1314, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.855532646179199  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.855532646179199  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1314, 128]), torch.Size([1, 1314, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.856785774230957  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9984259605407715  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1314, 128])
m.shape torch.Size([1268, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.008078098297119  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.008078098297119  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1268, 128]), torch.Size([1, 1268, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0092873573303223  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1554970741271973  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1268, 128])
m.shape torch.Size([1186, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.165071964263916  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.165071964263916  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1186, 128]), torch.Size([1, 1186, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.166203022003174  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.309847354888916  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1186, 128])
m.shape torch.Size([1023, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3185501098632812  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3185501098632812  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1023, 128]), torch.Size([1, 1023, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.319525718688965  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.4524121284484863  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1023, 128])
m.shape torch.Size([16359, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.607935905456543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.607935905456543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 16359, 128]), torch.Size([1, 16359, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6235647201538086  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.823328018188477  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 16359, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.499309062957764  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.516417503356934  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5335259437561035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.51588249206543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71757, 64])
input nodes number: 141022
output nodes number: 71757
edges number: 732629
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.534584045410156  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.551692485809326  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.556885719299316  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.556885719299316  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71757, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.556885719299316  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([2687, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.586325645446777  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.586325645446777  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2687, 64]), torch.Size([1, 2687, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.587607383728027  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.597858428955078  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2687, 64])
m.shape torch.Size([3222, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.598809242248535  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.598809242248535  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3222, 64]), torch.Size([1, 3222, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.600345611572266  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.628535270690918  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3222, 64])
m.shape torch.Size([33955, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.652812957763672  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.652812957763672  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 33955, 64]), torch.Size([1, 33955, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.669004440307617  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.025208473205566  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 33955, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.99940824508667  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.009435176849365  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.01893949508667  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.008615493774414  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([39864, 64])
input nodes number: 71757
output nodes number: 39864
edges number: 110996
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.01947546005249  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0295023918151855  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.031888008117676  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.031888008117676  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([1695, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.043171405792236  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.043171405792236  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1695, 64]), torch.Size([1, 1695, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.043980121612549  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.05093240737915  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1695, 64])
m.shape torch.Size([1470, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.05125093460083  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.05125093460083  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1470, 64]), torch.Size([1, 1470, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.051951885223389  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0626606941223145  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1470, 64])
m.shape torch.Size([1125, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.063140392303467  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.063140392303467  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1125, 64]), torch.Size([1, 1125, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0636773109436035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.078326225280762  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1125, 64])
m.shape torch.Size([941, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.078983306884766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.078983306884766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 941, 64]), torch.Size([1, 941, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.079432487487793  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.092447280883789  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 941, 64])
m.shape torch.Size([6137, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.099767684936523  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.099767684936523  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 6137, 64]), torch.Size([1, 6137, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.103376388549805  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.214199066162109  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 6137, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.205291748046875  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.207292556762695  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.209293365478516  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.207207679748535  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([11368, 40])
input nodes number: 39864
output nodes number: 11368
edges number: 42459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.207616329193115  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02655331293741862 |0.004029035568237305 |0.10904971758524577 |0.0008324782053629557 |0.05365896224975586 |0.0069849491119384766 |
----------------------------------------------------------pseudo_mini_loss sum 1.4731483459472656
for loop block_dataloader item  time:  1.057126522064209
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07949638366699219  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07949638366699219  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([141223, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07949638366699219  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([4423, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44402027130126953  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44402027130126953  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4423, 128]), torch.Size([1, 4423, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4482383728027344  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4819831848144531  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4423, 128])
m.shape torch.Size([5390, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4850144386291504  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4850144386291504  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5390, 128]), torch.Size([1, 5390, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49086713790893555  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5679717063903809  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5390, 128])
m.shape torch.Size([5415, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5731477737426758  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5731477737426758  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5415, 128]), torch.Size([1, 5415, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5783119201660156  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6957306861877441  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5415, 128])
m.shape torch.Size([4971, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7018685340881348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7018685340881348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4971, 128]), torch.Size([1, 4971, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7077703475952148  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8495864868164062  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4971, 128])
m.shape torch.Size([4611, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8590679168701172  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8590679168701172  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4611, 128]), torch.Size([1, 4611, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8634653091430664  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0217714309692383  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4611, 128])
m.shape torch.Size([3924, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.030799388885498  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.030799388885498  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3924, 128]), torch.Size([1, 3924, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0346827507019043  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1978635787963867  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3924, 128])
m.shape torch.Size([3493, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2076516151428223  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2076516151428223  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3493, 128]), torch.Size([1, 3493, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2111883163452148  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3777475357055664  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3493, 128])
m.shape torch.Size([3166, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3881592750549316  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3881592750549316  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3166, 128]), torch.Size([1, 3166, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3911786079406738  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.564803123474121  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3166, 128])
m.shape torch.Size([2883, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5756659507751465  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5756659507751465  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2883, 128]), torch.Size([1, 2883, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5784435272216797  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7554206848144531  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2883, 128])
m.shape torch.Size([2532, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7660560607910156  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7660560607910156  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2532, 128]), torch.Size([1, 2532, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7684969902038574  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9461956024169922  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2532, 128])
m.shape torch.Size([2257, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9568266868591309  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9568266868591309  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2257, 128]), torch.Size([1, 2257, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9591736793518066  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.130331039428711  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2257, 128])
m.shape torch.Size([2056, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.141019344329834  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.141019344329834  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2056, 128]), torch.Size([1, 2056, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1433310508728027  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.317086696624756  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2056, 128])
m.shape torch.Size([1899, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.327877998352051  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.327877998352051  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1899, 128]), torch.Size([1, 1899, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3296890258789062  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.4975647926330566  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1899, 128])
m.shape torch.Size([1678, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5078611373901367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5078611373901367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1678, 128]), torch.Size([1, 1678, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5094614028930664  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.669856071472168  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1678, 128])
m.shape torch.Size([1518, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6799135208129883  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6799135208129883  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.681361198425293  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.83481502532959  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1518, 128])
m.shape torch.Size([1305, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8440475463867188  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8440475463867188  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1305, 128]), torch.Size([1, 1305, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.845292091369629  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.986802101135254  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1305, 128])
m.shape torch.Size([1310, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9967989921569824  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9967989921569824  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1310, 128]), torch.Size([1, 1310, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9980483055114746  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.147965908050537  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1310, 128])
m.shape torch.Size([1162, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1573147773742676  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1573147773742676  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1162, 128]), torch.Size([1, 1162, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1584229469299316  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3002419471740723  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1162, 128])
m.shape torch.Size([1062, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.309309482574463  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.309309482574463  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3103222846984863  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.4474949836730957  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([16826, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6074538230895996  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6074538230895996  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 16826, 128]), torch.Size([1, 16826, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.623500347137451  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.8860602378845215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 16826, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5552978515625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5724358558654785  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.589573860168457  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.571899890899658  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71881, 64])
input nodes number: 141223
output nodes number: 71881
edges number: 740189
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.590651035308838  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.607789039611816  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.61207389831543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.61207389831543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71881, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.61207389831543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([2754, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.641519546508789  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.641519546508789  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2754, 64]), torch.Size([1, 2754, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6428327560424805  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.65410852432251  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2754, 64])
m.shape torch.Size([3182, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.655165195465088  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.655165195465088  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3182, 64]), torch.Size([1, 3182, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.65668249130249  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.681329250335693  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3182, 64])
m.shape torch.Size([33943, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.705607891082764  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.705607891082764  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 33943, 64]), torch.Size([1, 33943, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7217936515808105  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.077871799468994  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 33943, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.052089691162109  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.062112808227539  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.071620941162109  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.061300277709961  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([39879, 64])
input nodes number: 71881
output nodes number: 39879
edges number: 110947
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.072157859802246  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082180976867676  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.084574222564697  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.084574222564697  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([1736, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.095806121826172  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.095806121826172  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1736, 64]), torch.Size([1, 1736, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0966339111328125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.103603839874268  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1736, 64])
m.shape torch.Size([1472, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1039137840271  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1039137840271  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1472, 64]), torch.Size([1, 1472, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.104615688323975  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1152424812316895  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1472, 64])
m.shape torch.Size([1201, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.115777969360352  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.115777969360352  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1201, 64]), torch.Size([1, 1201, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.116351127624512  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.132419586181641  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1201, 64])
m.shape torch.Size([872, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.132990837097168  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.132990837097168  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 872, 64]), torch.Size([1, 872, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.133406639099121  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.145464897155762  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 872, 64])
m.shape torch.Size([6087, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.152740478515625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.152740478515625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 6087, 64]), torch.Size([1, 6087, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.156410217285156  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.267026424407959  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 6087, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.258698463439941  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.260392665863037  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.262086868286133  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.260307788848877  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([11368, 40])
input nodes number: 39879
output nodes number: 11368
edges number: 42206
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.260383605957031  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027931571006774902 |0.004432797431945801 |0.10898655652999878 |0.0008354783058166504 |0.05388718843460083 |0.007126331329345703 |
----------------------------------------------------------pseudo_mini_loss sum 1.471687912940979
for loop block_dataloader item  time:  1.3699698448181152
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.080230712890625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.080230712890625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([141336, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.080230712890625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([4285, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44525814056396484  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44525814056396484  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4285, 128]), torch.Size([1, 4285, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4493446350097656  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4820365905761719  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4285, 128])
m.shape torch.Size([5431, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48517274856567383  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48517274856567383  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5431, 128]), torch.Size([1, 5431, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49130821228027344  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5689992904663086  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5431, 128])
m.shape torch.Size([5421, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5741643905639648  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5741643905639648  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5421, 128]), torch.Size([1, 5421, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5793342590332031  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6968169212341309  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5421, 128])
m.shape torch.Size([4923, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7028746604919434  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7028746604919434  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4923, 128]), torch.Size([1, 4923, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7075695991516113  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8489832878112793  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4923, 128])
m.shape torch.Size([4658, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.856989860534668  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.856989860534668  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4658, 128]), torch.Size([1, 4658, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8623099327087402  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0222296714782715  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4658, 128])
m.shape torch.Size([3909, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0311923027038574  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0311923027038574  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3909, 128]), torch.Size([1, 3909, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0353784561157227  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.201920509338379  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3909, 128])
m.shape torch.Size([3505, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2117557525634766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2117557525634766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3505, 128]), torch.Size([1, 3505, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.215280532836914  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.383242130279541  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3505, 128])
m.shape torch.Size([3262, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3940143585205078  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3940143585205078  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3262, 128]), torch.Size([1, 3262, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3973016738891602  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5815496444702148  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3262, 128])
m.shape torch.Size([2827, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5921263694763184  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5921263694763184  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2827, 128]), torch.Size([1, 2827, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.594846248626709  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.771005630493164  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2827, 128])
m.shape torch.Size([2611, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7819533348083496  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7819533348083496  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2611, 128]), torch.Size([1, 2611, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.784472942352295  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9698667526245117  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2611, 128])
m.shape torch.Size([2296, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9806647300720215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9806647300720215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2296, 128]), torch.Size([1, 2296, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9829626083374023  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1633763313293457  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2296, 128])
m.shape torch.Size([2108, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.173424243927002  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.173424243927002  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2108, 128]), torch.Size([1, 2108, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1754345893859863  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3496880531311035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2108, 128])
m.shape torch.Size([1869, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3602685928344727  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3602685928344727  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1869, 128]), torch.Size([1, 1869, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.362051010131836  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.526393413543701  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1869, 128])
m.shape torch.Size([1690, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5367841720581055  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5367841720581055  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1690, 128]), torch.Size([1, 1690, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.538395881652832  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.699324607849121  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1690, 128])
m.shape torch.Size([1526, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7094335556030273  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7094335556030273  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1526, 128]), torch.Size([1, 1526, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7108888626098633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8651514053344727  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1526, 128])
m.shape torch.Size([1327, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8745479583740234  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8745479583740234  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1327, 128]), torch.Size([1, 1327, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8758134841918945  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.018817901611328  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1327, 128])
m.shape torch.Size([1293, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0286664962768555  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0286664962768555  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1293, 128]), torch.Size([1, 1293, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0298995971679688  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1778879165649414  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1293, 128])
m.shape torch.Size([1192, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.187502384185791  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.187502384185791  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1192, 128]), torch.Size([1, 1192, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1886391639709473  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3331265449523926  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1192, 128])
m.shape torch.Size([1032, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3419079780578613  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3419079780578613  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1032, 128]), torch.Size([1, 1032, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3428921699523926  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.4778943061828613  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1032, 128])
m.shape torch.Size([16845, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6380486488342285  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6380486488342285  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 16845, 128]), torch.Size([1, 16845, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.654113292694092  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.9192280769348145  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 16845, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.587804317474365  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.604972839355469  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.622141361236572  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.604435920715332  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([72010, 64])
input nodes number: 141336
output nodes number: 72010
edges number: 742606
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.623197078704834  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6403656005859375  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.644658088684082  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.644658088684082  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([72010, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.644658088684082  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([2683, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.674121856689453  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.674121856689453  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2683, 64]), torch.Size([1, 2683, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.67540168762207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.686638832092285  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2683, 64])
m.shape torch.Size([3245, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.687602996826172  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.687602996826172  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3245, 64]), torch.Size([1, 3245, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.689150810241699  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.714593887329102  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3245, 64])
m.shape torch.Size([33975, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.738880634307861  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.738880634307861  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 33975, 64]), torch.Size([1, 33975, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.755081653594971  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.111495494842529  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 33975, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.085676193237305  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.095190048217773  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.104703903198242  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094892501831055  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([39903, 64])
input nodes number: 72010
output nodes number: 39903
edges number: 111098
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.105241775512695  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114755630493164  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.117198944091797  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.117198944091797  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([1638, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.128493309020996  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.128493309020996  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1638, 64]), torch.Size([1, 1638, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.129274368286133  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.135866165161133  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1638, 64])
m.shape torch.Size([1457, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.136192321777344  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.136192321777344  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1457, 64]), torch.Size([1, 1457, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.136887550354004  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.14877462387085  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1457, 64])
m.shape torch.Size([1216, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1493239402771  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1493239402771  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1216, 64]), torch.Size([1, 1216, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.149903774261475  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.165496349334717  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1216, 64])
m.shape torch.Size([924, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1661152839660645  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1661152839660645  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 924, 64]), torch.Size([1, 924, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.166555881500244  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.179333209991455  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 924, 64])
m.shape torch.Size([6133, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1868085861206055  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1868085861206055  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 6133, 64]), torch.Size([1, 6133, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.190436363220215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.300787925720215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 6133, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.291685104370117  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.293728351593018  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.295949459075928  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.293821334838867  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([11368, 40])
input nodes number: 39903
output nodes number: 11368
edges number: 42561
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.294552803039551  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02751607894897461 |0.004354238510131836 |0.10907220840454102 |0.0008277416229248047 |0.053626728057861325 |0.006861448287963867 |
----------------------------------------------------------pseudo_mini_loss sum 1.4522347450256348
for loop block_dataloader item  time:  1.6722230911254883
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07936525344848633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07936525344848633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([140869, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07936525344848633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([4281, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44443321228027344  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44443321228027344  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4281, 128]), torch.Size([1, 4281, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4485158920288086  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48207855224609375  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4281, 128])
m.shape torch.Size([5477, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4851560592651367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4851560592651367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5477, 128]), torch.Size([1, 5477, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49037933349609375  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5687284469604492  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5477, 128])
m.shape torch.Size([5374, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5739517211914062  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5739517211914062  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5374, 128]), torch.Size([1, 5374, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5790767669677734  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6961240768432617  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5374, 128])
m.shape torch.Size([4914, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7020750045776367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7020750045776367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4914, 128]), torch.Size([1, 4914, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.706761360168457  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8479471206665039  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4914, 128])
m.shape torch.Size([4516, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8555850982666016  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8555850982666016  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4516, 128]), torch.Size([1, 4516, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8609657287597656  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0170650482177734  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4516, 128])
m.shape torch.Size([3952, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0262184143066406  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0262184143066406  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3952, 128]), torch.Size([1, 3952, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0306367874145508  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1975069046020508  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3952, 128])
m.shape torch.Size([3488, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2072649002075195  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2072649002075195  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3488, 128]), torch.Size([1, 3488, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2109918594360352  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3773126602172852  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3488, 128])
m.shape torch.Size([3238, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3880014419555664  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3880014419555664  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3238, 128]), torch.Size([1, 3238, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3911218643188477  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5676240921020508  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3238, 128])
m.shape torch.Size([2905, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5785470008850098  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5785470008850098  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2905, 128]), torch.Size([1, 2905, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.581484317779541  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7604560852050781  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2905, 128])
m.shape torch.Size([2532, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7710061073303223  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7710061073303223  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2532, 128]), torch.Size([1, 2532, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7734780311584473  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.948361873626709  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2532, 128])
m.shape torch.Size([2318, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.959312915802002  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.959312915802002  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2318, 128]), torch.Size([1, 2318, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.961564540863037  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.140564441680908  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2318, 128])
m.shape torch.Size([2074, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1513266563415527  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1513266563415527  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1533331871032715  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3264269828796387  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
m.shape torch.Size([1902, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.336487293243408  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.336487293243408  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1902, 128]), torch.Size([1, 1902, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.338301181793213  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.506312847137451  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1902, 128])
m.shape torch.Size([1690, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5166878700256348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5166878700256348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1690, 128]), torch.Size([1, 1690, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5182995796203613  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6791939735412598  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1690, 128])
m.shape torch.Size([1498, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6891026496887207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6891026496887207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1498, 128]), torch.Size([1, 1498, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6905312538146973  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8422083854675293  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1498, 128])
m.shape torch.Size([1348, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.851778507232666  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.851778507232666  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1348, 128]), torch.Size([1, 1348, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8530640602111816  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.9984793663024902  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1348, 128])
m.shape torch.Size([1266, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.00809907913208  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.00809907913208  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1266, 128]), torch.Size([1, 1266, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0093064308166504  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.155470371246338  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1266, 128])
m.shape torch.Size([1204, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.165200710296631  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.165200710296631  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1204, 128]), torch.Size([1, 1204, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.166348934173584  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.312814235687256  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1204, 128])
m.shape torch.Size([1043, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3216896057128906  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3216896057128906  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1043, 128]), torch.Size([1, 1043, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3226842880249023  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.456188678741455  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1043, 128])
m.shape torch.Size([16752, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.615450859069824  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.615450859069824  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 16752, 128]), torch.Size([1, 16752, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6314268112182617  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.884036064147949  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 16752, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.555652618408203  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5727643966674805  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.589876174926758  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.572229385375977  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71772, 64])
input nodes number: 140869
output nodes number: 71772
edges number: 739951
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.590982437133789  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.608094215393066  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.612372398376465  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.612372398376465  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71772, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.612372398376465  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([2676, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.641671180725098  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.641671180725098  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2676, 64]), torch.Size([1, 2676, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.642947196960449  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.653244495391846  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2676, 64])
m.shape torch.Size([3262, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.654282093048096  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.654282093048096  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3262, 64]), torch.Size([1, 3262, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.655837535858154  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.681835651397705  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3262, 64])
m.shape torch.Size([33754, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.705955505371094  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.705955505371094  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 33754, 64]), torch.Size([1, 33754, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.722050666809082  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.076144218444824  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 33754, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.050482749938965  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.060550689697266  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.070618629455566  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0602545738220215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([39692, 64])
input nodes number: 71772
output nodes number: 39692
edges number: 110462
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.070549964904785  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.080617904663086  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082432746887207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.082432746887207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([1674, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.09410285949707  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.09410285949707  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1674, 64]), torch.Size([1, 1674, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.094901084899902  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101378440856934  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1674, 64])
m.shape torch.Size([1524, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101728916168213  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101728916168213  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1524, 64]), torch.Size([1, 1524, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1024556159973145  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.113836765289307  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1524, 64])
m.shape torch.Size([1173, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1143388748168945  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1143388748168945  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1173, 64]), torch.Size([1, 1173, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.114898681640625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.127893924713135  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1173, 64])
m.shape torch.Size([884, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.128483772277832  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.128483772277832  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 884, 64]), torch.Size([1, 884, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.128905296325684  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.141129493713379  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 884, 64])
m.shape torch.Size([6113, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.148434162139893  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.148434162139893  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 6113, 64]), torch.Size([1, 6113, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1515116691589355  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.261756896972656  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 6113, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.253074645996094  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2547688484191895  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.256463050842285  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.254683971405029  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([11368, 40])
input nodes number: 39692
output nodes number: 11368
edges number: 42342
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.254763603210449  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02710560957590739 |0.004308342933654785 |0.10897437731424968 |0.0008289019266764323 |0.05342733860015869 |0.006754875183105469 |
----------------------------------------------------------pseudo_mini_loss sum 1.4253543615341187
for loop block_dataloader item  time:  1.9667644500732422
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07905960083007812  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07905960083007812  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([140828, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07905960083007812  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([4266, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44350337982177734  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.44350337982177734  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4266, 128]), torch.Size([1, 4266, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4475717544555664  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4801187515258789  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4266, 128])
m.shape torch.Size([5359, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48319530487060547  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48319530487060547  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5359, 128]), torch.Size([1, 5359, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48830604553222656  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.564967155456543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5359, 128])
m.shape torch.Size([5216, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5698733329772949  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5698733329772949  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5216, 128]), torch.Size([1, 5216, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5748476982116699  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.684420108795166  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5216, 128])
m.shape torch.Size([4995, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.691460132598877  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.691460132598877  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4995, 128]), torch.Size([1, 4995, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6962237358093262  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8388781547546387  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4995, 128])
m.shape torch.Size([4654, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8484053611755371  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8484053611755371  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4654, 128]), torch.Size([1, 4654, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8528437614440918  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0126261711120605  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4654, 128])
m.shape torch.Size([3990, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.021822452545166  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.021822452545166  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3990, 128]), torch.Size([1, 3990, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.025759220123291  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.1926054954528809  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3990, 128])
m.shape torch.Size([3597, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2022037506103516  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2022037506103516  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3597, 128]), torch.Size([1, 3597, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2057437896728516  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3810486793518066  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3597, 128])
m.shape torch.Size([3260, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3917694091796875  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3917694091796875  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3260, 128]), torch.Size([1, 3260, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.3949003219604492  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.579291820526123  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3260, 128])
m.shape torch.Size([2840, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5899252891540527  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5899252891540527  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2840, 128]), torch.Size([1, 2840, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5929198265075684  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7729058265686035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2840, 128])
m.shape torch.Size([2645, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7835917472839355  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7835917472839355  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2645, 128]), torch.Size([1, 2645, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7868595123291016  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9716672897338867  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2645, 128])
m.shape torch.Size([2258, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.982405662536621  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.982405662536621  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2258, 128]), torch.Size([1, 2258, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9846820831298828  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1558780670166016  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2258, 128])
m.shape torch.Size([2098, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1666555404663086  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1666555404663086  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2098, 128]), torch.Size([1, 2098, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1689095497131348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3430886268615723  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2098, 128])
m.shape torch.Size([1906, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.353379726409912  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.353379726409912  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1906, 128]), torch.Size([1, 1906, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3551974296569824  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.522871494293213  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1906, 128])
m.shape torch.Size([1677, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5331578254699707  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5331578254699707  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1677, 128]), torch.Size([1, 1677, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.534757137298584  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6954522132873535  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1677, 128])
m.shape torch.Size([1536, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.705638885498047  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.705638885498047  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1536, 128]), torch.Size([1, 1536, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.707103729248047  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.862985610961914  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1536, 128])
m.shape torch.Size([1354, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8725833892822266  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8725833892822266  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1354, 128]), torch.Size([1, 1354, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8738746643066406  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0198917388916016  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1354, 128])
m.shape torch.Size([1304, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0298166275024414  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0298166275024414  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1304, 128]), torch.Size([1, 1304, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.031060218811035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.180328369140625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1304, 128])
m.shape torch.Size([1178, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.189817428588867  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.189817428588867  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1178, 128]), torch.Size([1, 1178, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.1909408569335938  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3340492248535156  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1178, 128])
m.shape torch.Size([1026, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.342782974243164  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.342782974243164  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1026, 128]), torch.Size([1, 1026, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.343761444091797  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.476024627685547  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1026, 128])
m.shape torch.Size([16678, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.634589195251465  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.634589195251465  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 16678, 128]), torch.Size([1, 16678, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6504945755004883  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.893153190612793  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 16678, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.563517093658447  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.580644607543945  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.597772121429443  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.580109119415283  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71837, 64])
input nodes number: 140828
output nodes number: 71837
edges number: 740491
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5988383293151855  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.615965843200684  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.620247840881348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.620247840881348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([71837, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.620247840881348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([2626, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.649784088134766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.649784088134766  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2626, 64]), torch.Size([1, 2626, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.651036262512207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.661550045013428  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2626, 64])
m.shape torch.Size([3187, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6624956130981445  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6624956130981445  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3187, 64]), torch.Size([1, 3187, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.664015769958496  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.69033145904541  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3187, 64])
m.shape torch.Size([34144, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.715725421905518  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.715725421905518  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 34144, 64]), torch.Size([1, 34144, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.732006549835205  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.09019136428833  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 34144, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.065023422241211  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.074550151824951  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.084076881408691  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.074252128601074  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([39957, 64])
input nodes number: 71837
output nodes number: 39957
edges number: 111432
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.08461332321167  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.09414005279541  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.096543788909912  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.096543788909912  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([1671, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.107883453369141  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.107883453369141  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1671, 64]), torch.Size([1, 1671, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108680725097656  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.115841388702393  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1671, 64])
m.shape torch.Size([1409, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.116136074066162  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.116136074066162  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1409, 64]), torch.Size([1, 1409, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1168084144592285  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.126950740814209  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1409, 64])
m.shape torch.Size([1149, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.127462387084961  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.127462387084961  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1149, 64]), torch.Size([1, 1149, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1280107498168945  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.142575263977051  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1149, 64])
m.shape torch.Size([930, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.143216133117676  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.143216133117676  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 930, 64]), torch.Size([1, 930, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.143659591674805  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.156519889831543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 930, 64])
m.shape torch.Size([6209, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.164016246795654  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.164016246795654  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 6209, 64]), torch.Size([1, 6209, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1671271324157715  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.27717924118042  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 6209, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.268179416656494  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2700982093811035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2720513343811035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.270047664642334  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([11368, 40])
input nodes number: 39957
output nodes number: 11368
edges number: 42701
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2706074714660645  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0268920830317906 |0.004254715783255441 |0.10891665731157575 |0.0008303778512137276 |0.0532407420022147 |0.0069446563720703125 |
----------------------------------------------------------pseudo_mini_loss sum 1.3974167108535767
for loop block_dataloader item  time:  2.265868663787842
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07943248748779297  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07943248748779297  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([141251, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.07943248748779297  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([4371, 1, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4439377784729004  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4439377784729004  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4371, 128]), torch.Size([1, 4371, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.4481062889099121  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48145437240600586  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4371, 128])
m.shape torch.Size([5419, 2, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48453807830810547  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.48453807830810547  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5419, 128]), torch.Size([1, 5419, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.49050378799438477  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5680232048034668  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5419, 128])
m.shape torch.Size([5341, 3, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5730795860290527  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5730795860290527  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 5341, 128]), torch.Size([1, 5341, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.5781731605529785  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.6949958801269531  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 5341, 128])
m.shape torch.Size([4966, 4, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7009830474853516  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.7009830474853516  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4966, 128]), torch.Size([1, 4966, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.705718994140625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8480825424194336  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4966, 128])
m.shape torch.Size([4674, 5, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8575544357299805  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8575544357299805  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4674, 128]), torch.Size([1, 4674, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 0.8620119094848633  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.0224809646606445  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4674, 128])
m.shape torch.Size([4013, 6, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.031733512878418  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.031733512878418  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 4013, 128]), torch.Size([1, 4013, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.035731315612793  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2027740478515625  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 4013, 128])
m.shape torch.Size([3600, 7, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2124810218811035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2124810218811035  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3600, 128]), torch.Size([1, 3600, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.2166814804077148  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.39310884475708  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3600, 128])
m.shape torch.Size([3210, 8, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.403637409210205  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.403637409210205  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3210, 128]), torch.Size([1, 3210, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.406700611114502  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5837531089782715  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3210, 128])
m.shape torch.Size([2911, 9, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5947151184082031  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.5947151184082031  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2911, 128]), torch.Size([1, 2911, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.597555160522461  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.777486801147461  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2911, 128])
m.shape torch.Size([2595, 10, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7884726524353027  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7884726524353027  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2595, 128]), torch.Size([1, 2595, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.7910676002502441  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9716978073120117  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2595, 128])
m.shape torch.Size([2287, 11, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9824562072753906  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.9824562072753906  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2287, 128]), torch.Size([1, 2287, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 1.984736442565918  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1578750610351562  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2287, 128])
m.shape torch.Size([2055, 12, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1685433387756348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.1685433387756348  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2055, 128]), torch.Size([1, 2055, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.170527935028076  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3443517684936523  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2055, 128])
m.shape torch.Size([1895, 13, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.355118751525879  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.355118751525879  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1895, 128]), torch.Size([1, 1895, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.3569259643554688  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.523916721343994  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1895, 128])
m.shape torch.Size([1701, 14, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5343685150146484  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5343685150146484  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1701, 128]), torch.Size([1, 1701, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.5359907150268555  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.6969776153564453  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1701, 128])
m.shape torch.Size([1484, 15, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7067809104919434  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7067809104919434  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1484, 128]), torch.Size([1, 1484, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.7081961631774902  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.859117031097412  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1484, 128])
m.shape torch.Size([1287, 16, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8682284355163574  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8682284355163574  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 2.8694558143615723  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0091795921325684  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1287, 128])
m.shape torch.Size([1290, 17, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0190229415893555  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0190229415893555  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1290, 128]), torch.Size([1, 1290, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.0202531814575195  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.167881965637207  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1290, 128])
m.shape torch.Size([1201, 18, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.17757511138916  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.17757511138916  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1201, 128]), torch.Size([1, 1201, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.178720474243164  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3246450424194336  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1201, 128])
m.shape torch.Size([1058, 19, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.333657741546631  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.333657741546631  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.3346667289733887  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.470034122467041  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([16683, 20, 128])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.628631114959717  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.628631114959717  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 16683, 128]), torch.Size([1, 16683, 128])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 3.6445412635803223  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.887872219085693  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 16683, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.556790351867676  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.5739665031433105  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.591142654418945  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.573429584503174  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([72041, 64])
input nodes number: 141251
output nodes number: 72041
edges number: 740001
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.592234134674072  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.609410285949707  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.613704681396484  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.613704681396484  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([72041, 64])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.613704681396484  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([2696, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.643265724182129  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.643265724182129  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 2696, 64]), torch.Size([1, 2696, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.6445512771606445  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.655534744262695  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 2696, 64])
m.shape torch.Size([3197, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.65647029876709  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.65647029876709  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 3197, 64]), torch.Size([1, 3197, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.657995223999023  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.68366813659668  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 3197, 64])
m.shape torch.Size([34122, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.708074569702148  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.708074569702148  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 34122, 64]), torch.Size([1, 34122, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 5.7243452072143555  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.08229923248291  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 34122, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0563836097717285  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0663743019104  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0759148597717285  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0656256675720215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([40015, 64])
input nodes number: 72041
output nodes number: 40015
edges number: 111456
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.076452732086182  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.0864434242248535  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.089253902435303  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.089253902435303  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

m.shape torch.Size([1686, 1, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1005401611328125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1005401611328125  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1686, 64]), torch.Size([1, 1686, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.101344108581543  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108246803283691  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1686, 64])
m.shape torch.Size([1461, 2, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108563423156738  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.108563423156738  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1461, 64]), torch.Size([1, 1461, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.109260559082031  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1201066970825195  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1461, 64])
m.shape torch.Size([1157, 3, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.120612144470215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.120612144470215  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 1157, 64]), torch.Size([1, 1157, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.121164321899414  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.1349897384643555  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 1157, 64])
m.shape torch.Size([915, 4, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.135613918304443  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.135613918304443  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 915, 64]), torch.Size([1, 915, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.136050701141357  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.148705959320068  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 915, 64])
m.shape torch.Size([6146, 5, 64])
----------------------------------------1
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.156043529510498  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.156043529510498  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

 h.shape torch.Size([1, 6146, 64]), torch.Size([1, 6146, 64])
----------------------------------------3
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.159152030944824  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.270557403564453  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

rst.shape  torch.Size([1, 6146, 64])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.262607097625732  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.264402389526367  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.266096115112305  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.26421594619751  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

torch.Size([11365, 40])
input nodes number: 40015
output nodes number: 11365
edges number: 42469
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9578857421875 GB
    Memory Allocated: 6.2644758224487305  GigaBytes
Max Memory Allocated: 6.410372734069824  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026810020208358765 |0.004211157560348511 |0.10893625020980835 |0.0008330345153808594 |0.05329453945159912 |0.0069200992584228516 |
----------------------------------------------------------pseudo_mini_loss sum 1.402294397354126
Total (block generation + training)time/epoch 2.4985243479410806
Training time/epoch 2.4768452644348145
Training time without block to device /epoch 2.4431560039520264
Training time without total dataloading part /epoch 1.3114306926727295
load block tensor time/epoch 0.21448016166687012
block to device time/epoch 0.033689260482788086
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  2024264
Number of first layer input nodes during this epoch:  1128907
